<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Re百题计划（ | 能打一辈子CTF吗？</title><meta name="author" content="wind_9233,1768765226@qq.com"><meta name="copyright" content="wind_9233"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Re百题计划（1.你是真的大学生吗？硬读汇编1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253start          					 proc nearseg001:0000                 mov     ax, seg dsegseg"><meta property="og:type" content="article"><meta property="og:title" content="Re百题计划（"><meta property="og:url" content="https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/index.html"><meta property="og:site_name" content="能打一辈子CTF吗？"><meta property="og:description" content="Re百题计划（1.你是真的大学生吗？硬读汇编1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253start          					 proc nearseg001:0000                 mov     ax, seg dsegseg"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg"><meta property="article:published_time" content="2024-05-03T16:00:00.000Z"><meta property="article:modified_time" content="2024-10-24T19:44:10.681Z"><meta property="article:author" content="wind_9233"><meta property="article:tag" content="逆向"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Re百题计划（",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-25 03:44:10"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="能打一辈子CTF吗？" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img1.baidu.com/it/u=38471470,3942836709&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=889&amp;h=500" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://images.dmzj.com/news/article/77394/row_6409512934343.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">能打一辈子CTF吗？</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Re百题计划（</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-05-03T16:00:00.000Z" title="发表于 2024-05-04 00:00:00">2024-05-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-24T19:44:10.681Z" title="更新于 2024-10-25 03:44:10">2024-10-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Re百题计划（"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Re百题计划（"><a href="#Re百题计划（" class="headerlink" title="Re百题计划（"></a>Re百题计划（</h1><h2 id="1-你是真的大学生吗？"><a href="#1-你是真的大学生吗？" class="headerlink" title="1.你是真的大学生吗？"></a>1.你是真的大学生吗？</h2><h5 id="硬读汇编"><a href="#硬读汇编" class="headerlink" title="硬读汇编"></a>硬读汇编</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">start          					 proc near</span><br><span class="line">seg001:<span class="number">0000</span>                 mov     ax, seg dseg</span><br><span class="line">seg001:<span class="number">0003</span>                 mov     ds, ax</span><br><span class="line">seg001:<span class="number">0005</span>                 assume ds:dseg</span><br><span class="line">seg001:<span class="number">0005</span>                 lea     dx, unk_10000</span><br><span class="line">seg001:<span class="number">0009</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">000</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">000</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">000</span>D                 lea     dx, unk_1002D</span><br><span class="line">seg001:<span class="number">0011</span>                 mov     ah, <span class="number">0</span>Ah</span><br><span class="line">seg001:<span class="number">0013</span>                 int     <span class="number">21</span>h             ; DOS - BUFFERED KEYBOARD INPUT</span><br><span class="line">seg001:<span class="number">0013</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> buffer</span><br><span class="line">seg001:<span class="number">0015</span>                 lea     dx, unk_10010</span><br><span class="line">seg001:<span class="number">0019</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">001</span>B                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">001</span>B                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">001</span>D                 xor     cx, cx</span><br><span class="line">seg001:<span class="number">001</span>F                 xor     ax, ax</span><br><span class="line">seg001:<span class="number">0021</span>                 mov     cl, byte_1002E</span><br><span class="line">seg001:<span class="number">0025</span>                 mov     si, <span class="number">2</span>Fh ; <span class="string">&#x27;/&#x27;</span></span><br><span class="line">seg001:<span class="number">0028</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">002</span>A                 add     si, cx</span><br><span class="line">seg001:<span class="number">002</span>C</span><br><span class="line">seg001:<span class="number">002</span>C loc_1007C:                              ; CODE XREF: start+<span class="number">37</span>↓j</span><br><span class="line">seg001:<span class="number">002</span>C                 sub     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">002</span>F                 xor     [si], al</span><br><span class="line">seg001:<span class="number">0031</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0033</span>                 dec     cx</span><br><span class="line">seg001:<span class="number">0034</span>                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0037</span>                 jnz     short loc_1007C</span><br><span class="line">seg001:<span class="number">0039</span>                 lea     si, unk_1002F</span><br><span class="line">seg001:<span class="number">003</span>D                 lea     di, unk_10019<span class="comment">///////</span></span><br><span class="line">seg001:<span class="number">0041</span></span><br><span class="line">seg001:<span class="number">0041</span> loc_10091:                              ; CODE XREF: start+<span class="number">50</span>↓j</span><br><span class="line">seg001:<span class="number">0041</span>                 mov     al, [si]</span><br><span class="line">seg001:<span class="number">0043</span>                 mov     bl, [di]</span><br><span class="line">seg001:<span class="number">0045</span>                 add     si, <span class="number">1</span></span><br><span class="line">seg001:<span class="number">0048</span>                 inc     di</span><br><span class="line">seg001:<span class="number">0049</span>                 cmp     al, bl</span><br><span class="line">seg001:<span class="number">004</span>B                 jnz     short loc_100AA</span><br><span class="line">seg001:<span class="number">004</span>D                 cmp     cx, <span class="number">0</span></span><br><span class="line">seg001:<span class="number">0050</span>                 jnz     short loc_10091</span><br><span class="line">seg001:<span class="number">0052</span>                 lea     dx, unk_10013</span><br><span class="line">seg001:<span class="number">0056</span>                 mov     ah, <span class="number">9</span></span><br><span class="line">seg001:<span class="number">0058</span>                 int     <span class="number">21</span>h             ; DOS - PRINT STRING</span><br><span class="line">seg001:<span class="number">0058</span>                                         ; DS:DX <span class="punctuation">-&gt;</span> string terminated by <span class="string">&quot;$&quot;</span></span><br><span class="line">seg001:<span class="number">005</span>A</span><br><span class="line">seg001:<span class="number">005</span>A loc_100AA:                              ; CODE XREF: start+<span class="number">4</span>B↑j</span><br><span class="line">seg001:<span class="number">005</span>A                 mov     ah, <span class="number">4</span>Ch</span><br><span class="line">seg001:<span class="number">005</span>C                 int     <span class="number">21</span>h             ; DOS - <span class="number">2</span>+ - QUIT WITH EXIT <span class="title function_ invoke__">CODE</span> (EXIT)</span><br><span class="line">seg001:<span class="number">005</span>C start           endp                    ; AL = exit code</span><br><span class="line">seg001:<span class="number">005</span>C</span><br><span class="line">seg001:<span class="number">005</span>C seg001          ends</span><br></pre></td></tr></table></figure><p>没有找到其他方法，硬读汇编qwq<br>输入—-每一位与后面一位异或—–与d数组比对。<br>#看到说是循环异或</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428202306830.png" alt="image-20240428202306830"></p><p>解密：（最后一个没出，但是可能和第一个异或？</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">0x76</span>, <span class="number">0x0E</span>, <span class="number">0x77</span>, <span class="number">0x14</span>, <span class="number">0x60</span>, <span class="number">0x06</span>, <span class="number">0x7D</span>, <span class="number">0x04</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x41</span>,</span><br><span class="line"><span class="number">0x2A</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x5C</span>, <span class="number">0x03</span>, <span class="number">0x3B</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0x05</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">	cipher[i] = cipher[i] ^ cipher[i + <span class="number">1</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">	<span class="keyword">if</span> i != (<span class="built_in">len</span>(cipher) - <span class="number">1</span>):</span><br><span class="line">		flag += <span class="built_in">chr</span>(cipher[i])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(cipher[i] ^ cipher[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># xyctf&#123;you_know_8086&#125;</span></span><br></pre></td></tr></table></figure><p>#放个16位<br><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428204644536.png" alt="image-20240428204644536"></p><h2 id="2-Debugme"><a href="#2-Debugme" class="headerlink" title="2.Debugme"></a>2.Debugme</h2><h5 id="动态调试apk"><a href="#动态调试apk" class="headerlink" title="动态调试apk"></a>动态调试apk</h5><p>说是动态调试apk</p><blockquote><p><a href="http://t.csdnimg.cn/Xk9op">http://t.csdnimg.cn/Xk9op</a><br>1、jeb打开apk，分析源码，下好断点；<br>2、启动模拟器，安装好apk；<br>3、adb命令连接模拟器，启动apk，adb shell am start -D -n （包名）&#x2F;（.主窗体）<br>4、jeb附加对应的进程，开始愉快的调试。</p></blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am <span class="built_in">start</span> -D -n com.xyctf.ezapk/.MainActivity</span><br></pre></td></tr></table></figure><h2 id="3-Trustme"><a href="#3-Trustme" class="headerlink" title="3.*Trustme"></a>3.*Trustme</h2><h5><a href="#" class="headerlink"></a></h5><p>#放个jadx支持的文件种类：apk、dex、jar、zip、class、aar</p><p><a href="http://t.csdnimg.cn/35N5aadb%E8%BF%9E%E6%8E%A5MuMu%E3%80%81%E9%80%8D%E9%81%A5%E3%80%81%E5%A4%9C%E7%A5%9E%E3%80%81%E9%9B%B7%E7%94%B5%E6%A8%A1%E6%8B%9F%E5%99%A8%E4%BB%A5%E5%8F%8A%E8%85%BE%E8%AE%AF%E6%89%8B%E6%B8%B8%E5%8A%A9%E6%89%8B%E4%BB%A5%E5%8F%8A%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5_%E9%9B%B7%E7%94%B5adb%E8%BF%9E%E6%8E%A5%E5%9C%B0%E5%9D%80-CSDN%E5%8D%9A%E5%AE%A2">http://t.csdnimg.cn/35N5aadb连接MuMu、逍遥、夜神、雷电模拟器以及腾讯手游助手以及断开连接_雷电adb连接地址-CSDN博客</a></p><p>？放一下</p><h2 id="4-ez-cube"><a href="#4-ez-cube" class="headerlink" title="4.ez_cube"></a>4.ez_cube</h2><h5 id="模拟-拧魔方？"><a href="#模拟-拧魔方？" class="headerlink" title="模拟+拧魔方？"></a>模拟+拧魔方？</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222750041.png" alt="image-20240428222750041"></p><p>分别是面颜色–现在状态–操作行为</p><p>#拿着魔方拧一下</p><p>cmp函数是验证是否复原，以及复原步骤是否&lt;&#x3D;12</p><p>拿魔方手操：RuRURURuruRR</p><h2 id="5-今夕是何年"><a href="#5-今夕是何年" class="headerlink" title="5.今夕是何年"></a>5.今夕是何年</h2><h5 id="龙芯loongarch"><a href="#龙芯loongarch" class="headerlink" title="龙芯loongarch"></a>龙芯loongarch</h5><p>#<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428222956978.png" alt="image-20240428222956978"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240428223006225.png" alt="image-20240428223006225"></p><h2 id="6-baby-unity"><a href="#6-baby-unity" class="headerlink" title="6.*baby unity"></a>6.*baby unity</h2><p>好难</p><h2 id="7-ez-rand"><a href="#7-ez-rand" class="headerlink" title="7.ez_rand"></a>7.ez_rand</h2><h5 id="随机数种子"><a href="#随机数种子" class="headerlink" title="随机数种子"></a>随机数种子</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v4; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  __int64 v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9[<span class="number">7</span>]; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+3Ch] [rbp-34h]</span></span><br><span class="line">  __int16 v11; <span class="comment">// [rsp+3Dh] [rbp-33h]</span></span><br><span class="line">  __int128 v12; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+5Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+5Eh] [rbp-12h]</span></span><br><span class="line"></span><br><span class="line">  v13 = <span class="number">0</span>i64;</span><br><span class="line">  v12 = <span class="number">0</span>i64;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  sub_140001020(<span class="string">&quot;请输入flag:&quot;</span>);</span><br><span class="line">  sub_140001080(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">0xEA6C0C5D</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">-1</span>i64;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">0x34FC1946</span>;</span><br><span class="line">  v9[<span class="number">2</span>] = <span class="number">0x72362B2</span>;</span><br><span class="line">  v9[<span class="number">3</span>] = <span class="number">0xFB6E2262</span>;</span><br><span class="line">  v9[<span class="number">4</span>] = <span class="number">0xA9F2E8B4</span>;</span><br><span class="line">  v9[<span class="number">5</span>] = <span class="number">0x86211291</span>;</span><br><span class="line">  v9[<span class="number">6</span>] = <span class="number">0x43E98EDB</span>;</span><br><span class="line">  v10 = <span class="number">77</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)&amp;v12 + v3) );</span><br><span class="line">  v4 = time64(<span class="number">0</span>i64);</span><br><span class="line">  srand(v4);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 = rand();</span><br><span class="line">      <span class="keyword">if</span> ( (*((_BYTE *)&amp;v12 + v6) ^ (<span class="type">unsigned</span> __int8)(v7</span><br><span class="line">                                                    + ((((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span>i64)</span><br><span class="line">                                                    + ((<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span>i64 * v7) &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">7</span>))) != *((_BYTE *)v9 + v6) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_140001020(<span class="string">&quot;Error???\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      ++v5;</span><br><span class="line">      ++v6;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 &lt; v3 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001020(<span class="string">&quot;Right???\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v4是种子，srand函数和rand函数根据种子来生成随机数，input加密逻辑使用v7</p><p>那么首先想到的是爆破种子，来推flag</p><p>再看v4，<strong>unsigned __int16 v4</strong>无符号16位整数型，v4范围为0~2**16-1(65535)，结合flag固定格式</p><p>XYCTF{}</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">containsXYCTF</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strstr</span>(str, <span class="string">&quot;XYCTF&quot;</span>) != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 包含&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 不包含&quot;XYCTF&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cipher[<span class="number">29</span>] = &#123;<span class="number">0x5D</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0xEA</span>, <span class="number">0x46</span>, <span class="number">0x19</span>, <span class="number">0xFC</span>, <span class="number">0x34</span>,</span><br><span class="line"><span class="number">0xB2</span>, <span class="number">0x62</span>, <span class="number">0x23</span>, <span class="number">0x07</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x6E</span>, <span class="number">0xFB</span>, <span class="number">0xB4</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xA9</span>, <span class="number">0x91</span>,</span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDB</span>, <span class="number">0x8E</span>, <span class="number">0xE9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v7;</span><br><span class="line"><span class="type">char</span> flag[<span class="number">29</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> seed = <span class="number">0</span>; seed &lt; <span class="number">65536</span>; seed++)</span><br><span class="line">&#123;</span><br><span class="line">srand(seed);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v7 = rand();</span><br><span class="line"><span class="type">int</span> num = (<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span> * v7) &gt;&gt; <span class="number">32</span>);</span><br><span class="line"><span class="type">unsigned</span> __int8 data = (<span class="type">unsigned</span> __int8)(v7 + ((num &amp; <span class="number">0x80000000</span>) !=</span><br><span class="line"><span class="number">0</span>) + (num &gt;&gt; <span class="number">7</span>));</span><br><span class="line">flag[i] = cipher[i] ^ data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (containsXYCTF(flag))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;success\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;seed = %d\n&quot;</span>, seed);</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// seed = 21308</span></span><br><span class="line"><span class="comment">// XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="8-何须相思煮余年"><a href="#8-何须相思煮余年" class="headerlink" title="8.何须相思煮余年"></a>8.何须相思煮余年</h2><h5 id="转汇编，去花指令"><a href="#转汇编，去花指令" class="headerlink" title="转汇编，去花指令"></a>转汇编，去花指令</h5><p>一堆十六进制应该是要转汇编</p><p>朝的脚本转二进制：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">hex_data = <span class="string">&quot;0x55 0x8b 0xec 0x81 0xec 0xa8 0x0 0x0 0x0 0xa1 0x0 0x40 0x41 0x0</span></span><br><span class="line"><span class="string">0x33 0xc5 0x89 0x45 0xfc 0x68 0x9c 0x0 0x0 0x0 0x6a 0x0 0x8d 0x85 0x60 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x50 0xe8 0x7a 0xc 0x0 0x0 0x83 0xc4 0xc 0xc7 0x85 0x58 0xff 0xff 0xff 0x27</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0xc7 0x85 0x5c 0xff 0xff 0xff 0x0 0x0 0x0 0x0 0xeb 0xf 0x8b 0x8d 0x5c</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0x83 0xc1 0x1 0x89 0x8d 0x5c 0xff 0xff 0xff 0x83 0xbd 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x27 0xf 0x8d 0xed 0x0 0x0 0x0 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2</span></span><br><span class="line"><span class="string">0x3 0x0 0x0 0x80 0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x85 0xd2 0x75 0x25 0x8b 0x85</span></span><br><span class="line"><span class="string">0x5c 0xff 0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x3 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x8b 0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xac</span></span><br><span class="line"><span class="string">0x0 0x0 0x0 0x8b 0x85 0x5c 0xff 0xff 0xff 0x25 0x3 0x0 0x0 0x80 0x79 0x5 0x48</span></span><br><span class="line"><span class="string">0x83 0xc8 0xfc 0x40 0x83 0xf8 0x1 0x75 0x22 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x94 0x8d 0x60 0xff 0xff 0xff 0x2b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x89 0x94 0x85 0x60 0xff 0xff 0xff 0xeb 0x73 0x8b 0x8d 0x5c 0xff 0xff</span></span><br><span class="line"><span class="string">0xff 0x81 0xe1 0x3 0x0 0x0 0x80 0x79 0x5 0x49 0x83 0xc9 0xfc 0x41 0x83 0xf9 0x2</span></span><br><span class="line"><span class="string">0x75 0x23 0x8b 0x95 0x5c 0xff 0xff 0xff 0x8b 0x84 0x95 0x60 0xff 0xff 0xff 0xf</span></span><br><span class="line"><span class="string">0xaf 0x85 0x5c 0xff 0xff 0xff 0x8b 0x8d 0x5c 0xff 0xff 0xff 0x89 0x84 0x8d 0x60</span></span><br><span class="line"><span class="string">0xff 0xff 0xff 0xeb 0x38 0x8b 0x95 0x5c 0xff 0xff 0xff 0x81 0xe2 0x3 0x0 0x0 0x80</span></span><br><span class="line"><span class="string">0x79 0x5 0x4a 0x83 0xca 0xfc 0x42 0x83 0xfa 0x3 0x75 0x20 0x8b 0x85 0x5c 0xff</span></span><br><span class="line"><span class="string">0xff 0xff 0x8b 0x8c 0x85 0x60 0xff 0xff 0xff 0x33 0x8d 0x5c 0xff 0xff 0xff 0x8b</span></span><br><span class="line"><span class="string">0x95 0x5c 0xff 0xff 0xff 0x89 0x8c 0x95 0x60 0xff 0xff 0xff 0xe9 0xf7 0xfe 0xff</span></span><br><span class="line"><span class="string">0xff 0x33 0xc0 0x8b 0x4d 0xfc 0x33 0xcd 0xe8 0x4 0x0 0x0 0x0 0x8b 0xe5 0x5d</span></span><br><span class="line"><span class="string">0xc3&quot;</span></span><br><span class="line"><span class="comment"># 去除空格并将十六进制数据字符串分割成十六进制值的列表</span></span><br><span class="line">hex_values = hex_data.split()</span><br><span class="line"><span class="comment"># 将每个十六进制值转换为相应的整数值</span></span><br><span class="line">int_values = [<span class="built_in">int</span>(value, <span class="number">16</span>) <span class="keyword">for</span> value <span class="keyword">in</span> hex_values]</span><br><span class="line"><span class="comment"># 将整数值列表转换为字节</span></span><br><span class="line">binary_data = <span class="built_in">bytes</span>(int_values)</span><br><span class="line"><span class="comment"># 将二进制数据写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(binary_data)</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">code =</span><br><span class="line"><span class="string">b&#x27;\x55\x8b\xec\x81\xec\xa8\x00\x00\x00\xa1\x00\x40\x41\x00\x33\xc5\x89\x</span></span><br><span class="line"><span class="string">45\xfc\x68\x9c\x00\x00\x00\x6a\x00\x8d\x85\x60\xff\xff\xff\x50\xe8\x7a\x</span></span><br><span class="line"><span class="string">0c\x00\x00\x83\xc4\x0c\xc7\x85\x58\xff\xff\xff\x27\x00\x00\x00\xc7\x85\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x8d\x5c\xff\xff\xff\x83\xc1\x</span></span><br><span class="line"><span class="string">01\x89\x8d\x5c\xff\xff\xff\x83\xbd\x5c\xff\xff\xff\x27\x0f\x8d\xed\x00\x</span></span><br><span class="line"><span class="string">00\x00\x8b\x95\x5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\x</span></span><br><span class="line"><span class="string">ca\xfc\x42\x85\xd2\x75\x25\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x03\x8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\x</span></span><br><span class="line"><span class="string">ff\xff\xff\xe9\xac\x00\x00\x00\x8b\x85\x5c\xff\xff\xff\x25\x03\x00\x00\x</span></span><br><span class="line"><span class="string">80\x79\x05\x48\x83\xc8\xfc\x40\x83\xf8\x01\x75\x22\x8b\x8d\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x94\x8d\x60\xff\xff\xff\x2b\x95\x5c\xff\xff\xff\x8b\x85\x5c\xff\x</span></span><br><span class="line"><span class="string">ff\xff\x89\x94\x85\x60\xff\xff\xff\xeb\x73\x8b\x8d\x5c\xff\xff\xff\x81\x</span></span><br><span class="line"><span class="string">e1\x03\x00\x00\x80\x79\x05\x49\x83\xc9\xfc\x41\x83\xf9\x02\x75\x23\x8b\x</span></span><br><span class="line"><span class="string">95\x5c\xff\xff\xff\x8b\x84\x95\x60\xff\xff\xff\x0f\xaf\x85\x5c\xff\xff\x</span></span><br><span class="line"><span class="string">ff\x8b\x8d\x5c\xff\xff\xff\x89\x84\x8d\x60\xff\xff\xff\xeb\x38\x8b\x95\x</span></span><br><span class="line"><span class="string">5c\xff\xff\xff\x81\xe2\x03\x00\x00\x80\x79\x05\x4a\x83\xca\xfc\x42\x83\x</span></span><br><span class="line"><span class="string">fa\x03\x75\x20\x8b\x85\x5c\xff\xff\xff\x8b\x8c\x85\x60\xff\xff\xff\x33\x</span></span><br><span class="line"><span class="string">8d\x5c\xff\xff\xff\x8b\x95\x5c\xff\xff\xff\x89\x8c\x95\x60\xff\xff\xff\x</span></span><br><span class="line"><span class="string">e9\xf7\xfe\xff\xff\x33\xc0\x8b\x4d\xfc\x33\xcd\xe8\x04\x00\x00\x00\x8b\x</span></span><br><span class="line"><span class="string">e5\x5d\xc3&#x27;</span></span><br><span class="line">assembly = disasm(code)</span><br><span class="line"><span class="built_in">print</span>(assembly)</span><br><span class="line"><span class="comment">#这个直接读汇编出exp？</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429004853677.png" alt="image-20240429004853677"></p><p>这里的call和下面的call的地址一眼假，当作花指令nop掉</p><p>u、p操作复原函数</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005643337.png" alt="image-20240429005643337"><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429005753142.png" alt="image-20240429005753142"></p><p>EXP:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">88</span>, <span class="number">88</span>, <span class="number">134</span>, <span class="number">87</span>, <span class="number">74</span>, <span class="number">118</span>, <span class="number">318</span>, <span class="number">101</span>, <span class="number">59</span>, <span class="number">92</span>, <span class="number">480</span>, <span class="number">60</span>, <span class="number">65</span>, <span class="number">41</span>, <span class="number">770</span>, <span class="number">110</span>,</span><br><span class="line"><span class="number">73</span>, <span class="number">31</span>, <span class="number">918</span>, <span class="number">39</span>, <span class="number">120</span>, <span class="number">27</span>, <span class="number">1188</span>, <span class="number">47</span>, <span class="number">77</span>,</span><br><span class="line"><span class="number">24</span>, <span class="number">1352</span>, <span class="number">44</span>, <span class="number">81</span>, <span class="number">23</span>, <span class="number">1680</span>, <span class="number">46</span>, <span class="number">85</span>, <span class="number">15</span>, <span class="number">1870</span>, <span class="number">66</span>, <span class="number">91</span>, <span class="number">16</span>, <span class="number">4750</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">	<span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(cipher[i] - i)</span><br><span class="line">	<span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(cipher[i] + i)</span><br><span class="line">	<span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(cipher[i] / i))</span><br><span class="line">	<span class="keyword">elif</span> i % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">		flag += <span class="built_in">chr</span>(cipher[i] ^ i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="9-砸核桃"><a href="#9-砸核桃" class="headerlink" title="9.砸核桃"></a>9.砸核桃</h2><h5 id="NsPack壳儿"><a href="#NsPack壳儿" class="headerlink" title="NsPack壳儿"></a>NsPack壳儿</h5><p>[<a href="https://bbs.kanxue.com/thread-115901.htm">原创]NsPack 3.7 浅析 （7.3更新脱壳机和源码）-加壳脱壳-看雪-安全社区|安全招聘|kanxue.com</a></p><p>脱壳后简单分析：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">true_cipher = [<span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000014</span>, <span class="number">0x00000024</span>,</span><br><span class="line"><span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x0000003D</span>,<span class="number">0x00000056</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000067</span>, <span class="number">0x00000000</span>,<span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x00000046</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000044</span>, <span class="number">0x00000042</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000044</span>, <span class="number">0x00000072</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000040</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000004B</span>,</span><br><span class="line"><span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>,</span><br><span class="line"><span class="number">0x0000004C</span>, <span class="number">0x0000005E</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000017</span>, <span class="number">0x0000006E</span>,</span><br><span class="line"><span class="number">0x0000000C</span>, <span class="number">0x00000016</span>, <span class="number">0x00000068</span>,</span><br><span class="line"><span class="number">0x0000005B</span>, <span class="number">0x00000012</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>]</span><br><span class="line">XOR = [<span class="number">0x74</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(true_cipher)):</span><br><span class="line">flag += <span class="built_in">chr</span>(true_cipher[j] ^ XOR[j % <span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="10-ezmath"><a href="#10-ezmath" class="headerlink" title="10.ezmath"></a>10.ezmath</h2><h5 id="exe-py-Z3求解器"><a href="#exe-py-Z3求解器" class="headerlink" title="exe-py-Z3求解器"></a>exe-py-Z3求解器</h5><p>(?要经常更新pyexe库啊。。)</p><p>其实这个题还是很考验分析的，</p><p>太长了分开</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&quot;sum([flag[23] for _ in range(flag[23])]) + sum([flag[12] for _ in range(flag[12])]) + sum([flag[1] for _ in range(flag[1])]) - sum([flag[24] for _ in range(222)]) + sum([flag[22] for _ in range(flag[22])]) + sum([flag[31] for _ in range(flag[31])]) + sum([flag[26] for _ in range(flag[26])]) - sum([flag[9] for _ in range(178)]) - sum([flag[29] for _ in range(232)]) + sum([flag[17] for _ in range(flag[17])]) - sum([flag[23] for _ in range(150)]) - sum([flag[6] for _ in range(226)]) - sum([flag[7] for _ in range(110)]) + sum([flag[19] for _ in range(flag[19])]) + sum([flag[2] for _ in range(flag[2])]) - sum([flag[0] for _ in range(176)]) + sum([flag[10] for _ in range(flag[10])]) - sum([flag[12] for _ in range(198)]) + sum([flag[24] for _ in range(flag[24])]) + sum([flag[9] for _ in range(flag[9])]) - sum([flag[3] for _ in range(168)]) + sum([flag[8] for _ in range(flag[8])]) - sum([flag[2] for _ in range(134)]) + sum([flag[14] for _ in range(flag[14])]) - sum([flag[13] for _ in range(170)]) + sum([flag[4] for _ in range(flag[4])]) - sum([flag[10] for _ in range(142)]) + sum([flag[27] for _ in range(flag[27])]) + sum([flag[15] for _ in range(flag[15])]) - sum([flag[15] for _ in range(224)]) + sum([flag[16] for _ in range(flag[16])]) - sum([flag[11] for _ in range(230)]) - sum([flag[1] for _ in range(178)]) + sum([flag[28] for _ in range(flag[28])]) - sum([flag[5] for _ in range(246)]) - sum([flag[17] for _ in range(168)]) + sum([flag[30] for _ in range(flag[30])]) - sum([flag[21] for _ in range(220)]) - sum([flag[22] for _ in range(212)]) - sum([flag[16] for _ in range(232)]) + sum([flag[25] for _ in range(flag[25])]) - sum([flag[4] for _ in range(140)]) - sum([flag[31] for _ in range(250)]) - sum([flag[28] for _ in range(150)]) + sum([flag[11] for _ in range(flag[11])]) + sum([flag[13] for _ in range(flag[13])]) - sum([flag[14] for _ in range(234)]) + sum([flag[7] for _ in range(flag[7])]) - sum([flag[8] for _ in range(174)]) + sum([flag[3] for _ in range(flag[3])]) - sum([flag[25] for _ in range(242)]) + sum([flag[29] for _ in range(flag[29])]) + sum([flag[5] for _ in range(flag[5])]) - sum([flag[30] for _ in range(142)]) - sum([flag[26] for _ in range(170)]) - sum([flag[19] for _ in range(176)]) + sum([flag[0] for _ in range(flag[0])]) - sum([flag[27] for _ in range(168)]) + sum([flag[20] for _ in range(flag[20])]) - sum([flag[20] for _ in range(212)]) + sum([flag[21] for _ in range(flag[21])]) + sum([flag[6] for _ in range(flag[6])]) + sum([flag[18] for _ in range(flag[18])]) - sum([flag[18] for _ in range(178)])&quot;</span></span><br><span class="line">temp = data.split(<span class="string">&quot; + &quot;</span>)</span><br><span class="line">final = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> temp:</span><br><span class="line">        	t=j.split(<span class="string">&quot; - &quot;</span>)</span><br><span class="line">            final.extend(t)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> final:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">f&quot;flag[<span class="subst">&#123;j&#125;</span>]&quot;</span> <span class="keyword">in</span> k:</span><br><span class="line">            <span class="built_in">print</span>(k)</span><br><span class="line"> <span class="comment">####</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">176</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">0</span>])]) </span><br><span class="line"><span class="number">1</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">1</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">1</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">178</span>)]) </span><br><span class="line"><span class="number">2</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">2</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">2</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">134</span>)]) </span><br><span class="line"><span class="number">3</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">168</span>)]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">3</span>])]) </span><br><span class="line"><span class="number">4</span></span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(flag[<span class="number">4</span>])]) </span><br><span class="line"> <span class="built_in">sum</span>([flag[<span class="number">4</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">140</span>)]) </span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234131401.png" alt="image-20240429234131401"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240429234223092.png" alt="image-20240429234223092"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="11-给阿姨倒一杯卡布奇诺"><a href="#11-给阿姨倒一杯卡布奇诺" class="headerlink" title="11.给阿姨倒一杯卡布奇诺"></a><strong>11.给阿姨倒一杯卡布奇诺</strong></h2><h5 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">0x9B28ED45</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">  <span class="built_in">array</span>[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">sum += <span class="number">0x6E75316C</span>;</span><br><span class="line">data1           dd <span class="number">5F</span>797274h            ; DATA XREF: encrypt+<span class="number">2</span>A↑r</span><br><span class="line">.data:<span class="number">0000000000403010</span>                                         ; encrypt+<span class="number">33</span>↑w ...</span><br><span class="line">.data:<span class="number">0000000000403014</span>                 public data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> ; <span class="type">uint32_t</span> data2</span><br><span class="line">.data:<span class="number">0000000000403014</span> data2           dd <span class="number">64726168</span>h            ; DATA XREF: encrypt+<span class="number">39</span>↑r</span><br><span class="line">.data:<span class="number">0000000000403014</span>                                </span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data1 = <span class="number">0x5F797274</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> data2 = <span class="number">0x64726168</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypto</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *cipher, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v0, v1;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> t0, t1;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> sum = <span class="number">0x6E75316C</span>ULL * <span class="number">32</span>;</span><br><span class="line">	</span><br><span class="line">    v0 = *cipher;</span><br><span class="line">	v1 = cipher[<span class="number">1</span>];</span><br><span class="line">	t0 = v0;</span><br><span class="line">	t1 = v1;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">	&#123;</span><br><span class="line">		v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]) ^ (v0 + sum) ^ (key[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ (sum +i);</span><br><span class="line">		v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]) ^ (v1 + sum) ^ (*key + <span class="number">16</span> * v1) ^ (sum + i);</span><br><span class="line">			sum -= <span class="number">0x6E75316C</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	*cipher = v0 ^ data1;</span><br><span class="line">	cipher[<span class="number">1</span>] = v1 ^ data2;</span><br><span class="line">	data1 = t0;</span><br><span class="line">	data2 = t1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> cipher[<span class="number">8</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> length, i;</span><br><span class="line">cipher[<span class="number">0</span>] = <span class="number">2603150661</span>;</span><br><span class="line">cipher[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">cipher[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">cipher[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">cipher[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">cipher[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">cipher[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">cipher[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">length = <span class="keyword">sizeof</span>(cipher);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> *in = (<span class="type">unsigned</span> <span class="type">int</span> *)cipher;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *out = (<span class="type">unsigned</span> <span class="type">char</span> *)cipher;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    decrypto(in + i, key);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, out[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag&#123;133bffe401d223a02385d90c5f1ca377&#125;</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430002632073.png" alt="image-20240430002632073"></p><h2 id="12-what’s-this"><a href="#12-what’s-this" class="headerlink" title="12.what’s this"></a>12.<strong>what’s this</strong></h2><h5 id="Lua加密？"><a href="#Lua加密？" class="headerlink" title="Lua加密？"></a>Lua加密？</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240430010432485.png" alt="image-20240430010432485"></p><p>使用XOR函数将字符与数字8进行异或操作，再加上3，base64加密，再进行字符替换</p><p>直接逆向逻辑，exp：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span></span><br><span class="line">new_cipher = cipher[::-<span class="number">1</span>]</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;g&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;H&quot;</span>)</span><br><span class="line">new_cipher = new_cipher.replace(<span class="string">&quot;6&quot;</span>, <span class="string">&quot;W&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Xor</span>(<span class="params">num1, num2</span>):</span><br><span class="line">tmp1 = num1</span><br><span class="line">tmp2 = num2</span><br><span class="line">str_result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> tmp1 != <span class="number">0</span> <span class="keyword">or</span> tmp2 != <span class="number">0</span>:</span><br><span class="line">s1 = tmp1 % <span class="number">2</span></span><br><span class="line">s2 = tmp2 % <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> s1 == s2:</span><br><span class="line">str_result = <span class="string">&quot;0&quot;</span> + str_result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">str_result = <span class="string">&quot;1&quot;</span> + str_result</span><br><span class="line">tmp1 = tmp1 // <span class="number">2</span></span><br><span class="line">tmp2 = tmp2 // <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(str_result, <span class="number">2</span>)</span><br><span class="line">d_cipher = base64.b64decode(new_cipher)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> d_cipher:</span><br><span class="line">flag += <span class="built_in">chr</span>(Xor(char - <span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5dcbaed781363fbfb7d8647c1aee6c&#125;</span></span><br></pre></td></tr></table></figure><h2 id="13-馒头"><a href="#13-馒头" class="headerlink" title="13.馒头"></a>13.馒头</h2><h5 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x000008DE</span>, <span class="number">0x00000395</span>, <span class="number">0x000001BE</span>, <span class="number">0x000000D9</span>, <span class="number">0x0000006A</span>, <span class="number">0x00000033</span>,</span><br><span class="line"><span class="number">0x00000014</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000011</span>,</span><br><span class="line"><span class="number">0x000000E5</span>, <span class="number">0x00000072</span>, <span class="number">0x00000010</span>, <span class="number">0x0000000B</span>, <span class="number">0x000001D7</span>, <span class="number">0x000000E9</span>,</span><br><span class="line"><span class="number">0x00000074</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000000D</span>,</span><br><span class="line"><span class="number">0x000000EE</span>, <span class="number">0x00000076</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000007</span>, <span class="number">0x00000549</span>, <span class="number">0x0000022D</span>,</span><br><span class="line"><span class="number">0x000000F8</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000006</span>,</span><br><span class="line"><span class="number">0x00000018</span>, <span class="number">0x00000135</span>, <span class="number">0x00000089</span>, <span class="number">0x00000043</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>,</span><br><span class="line"><span class="number">0x000000AC</span>, <span class="number">0x00000054</span>, <span class="number">0x00000004</span>,</span><br><span class="line"><span class="number">0x00000001</span>, <span class="number">0x0000031C</span>, <span class="number">0x0000017F</span>, <span class="number">0x000000BA</span>, <span class="number">0x00000059</span>, <span class="number">0x00000002</span>,</span><br><span class="line"><span class="number">0x00000008</span>, <span class="number">0x000000C5</span>, <span class="number">0x00000061</span>,</span><br><span class="line"><span class="number">0x00000030</span>, <span class="number">0x00000017</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000015</span>, <span class="number">0x0000019D</span>, <span class="number">0x000000CB</span>,</span><br><span class="line"><span class="number">0x00000065</span>, <span class="number">0x00000016</span>, <span class="number">0x00000009</span>,</span><br><span class="line"><span class="number">0x000000D2</span>, <span class="number">0x00000068</span>, <span class="number">0x00000013</span>, <span class="number">0x00000012</span>]</span><br><span class="line">num = []</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">num.append(data[i])</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="comment">#[2270, 917, 446, 217, 106, 51, 20, 15, 17, 229, 114, 16, 11, 471, 233, 116, 14,</span></span><br><span class="line"><span class="number">13</span>, <span class="number">238</span>, <span class="number">118</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1353</span>, <span class="number">557</span>, <span class="number">248</span>, <span class="number">123</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">309</span>, <span class="number">137</span>, <span class="number">67</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">172</span>, <span class="number">84</span>, <span class="number">4</span>,</span><br><span class="line"><span class="number">1</span>, <span class="number">796</span>, <span class="number">383</span>, <span class="number">186</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">197</span>, <span class="number">97</span>, <span class="number">48</span>, <span class="number">23</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">413</span>, <span class="number">203</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">210</span>,</span><br><span class="line"><span class="number">104</span>, <span class="number">19</span>, <span class="number">18</span>]</span><br></pre></td></tr></table></figure><h2 id="15-舔狗四部曲—记忆的时光机"><a href="#15-舔狗四部曲—记忆的时光机" class="headerlink" title="15.舔狗四部曲—记忆的时光机"></a>15.舔狗四部曲—记忆的时光机</h2><h5 id="linux动态调试-看汇编（qwq"><a href="#linux动态调试-看汇编（qwq" class="headerlink" title="linux动态调试  看汇编（qwq"></a>linux动态调试 看汇编（qwq</h5><h2 id="16-舔狗四部曲—简爱"><a href="#16-舔狗四部曲—简爱" class="headerlink" title="16.舔狗四部曲—简爱"></a>16.舔狗四部曲—简爱</h2><h5 id="o编译-链接。妈的"><a href="#o编译-链接。妈的" class="headerlink" title=".o编译 ? 链接。妈的"></a>.o编译 ? 链接。妈的</h5><h2 id="17-舔狗四部曲—相逢已是上上签"><a href="#17-舔狗四部曲—相逢已是上上签" class="headerlink" title="17.舔狗四部曲—相逢已是上上签"></a>17.舔狗四部曲—相逢已是上上签</h2><h5 id="修复损坏的DOS文件-魔改key的xxtea"><a href="#修复损坏的DOS文件-魔改key的xxtea" class="headerlink" title="修复损坏的DOS文件  魔改key的xxtea"></a>修复损坏的DOS文件 魔改key的xxtea</h5><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240501003325519.png" alt="image-20240501003325519"></p><h2 id="18-舔狗四部曲—我的白月光"><a href="#18-舔狗四部曲—我的白月光" class="headerlink" title="18.舔狗四部曲—我的白月光"></a>18.舔狗四部曲—我的白月光</h2><h5 id="什么病毒？"><a href="#什么病毒？" class="headerlink" title="什么病毒？"></a>什么病毒？</h5><h2 id="19-ez-enc"><a href="#19-ez-enc" class="headerlink" title="19.ez_enc"></a>19.ez_enc</h2><p>z3</p><h2 id="20-easy-lauguage"><a href="#20-easy-lauguage" class="headerlink" title="20.easy lauguage"></a>20.easy lauguage</h2><p>base64+AES</p><p>没换表</p><h2 id="21-钩子"><a href="#21-钩子" class="headerlink" title="21.钩子"></a>21.钩子</h2><h5 id="反调试-hook-rc4"><a href="#反调试-hook-rc4" class="headerlink" title="反调试 hook rc4"></a>反调试 hook rc4</h5><h2 id="22-44-BaseCTF2024（22道）"><a href="#22-44-BaseCTF2024（22道）" class="headerlink" title="22-44.BaseCTF2024（22道）"></a>22-44.BaseCTF2024（22道）</h2><h3 id="You-are-good-at-IDA"><a href="#You-are-good-at-IDA" class="headerlink" title="You are good at IDA"></a>You are good at IDA</h3><p>Part1</p><p>打开IDA按F5，得到第一部分</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135041482.png" alt="image-20240824135041482"></p><p>Part2</p><p>根据以上提示，shift+F2:</p><p>Second字符点击进入，按“X”交叉引入找到对应函数，</p><p>得到第二部分flag，按“R”转换为字符：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135517153.png" alt="image-20240824135517153"></p><p>Part3</p><p>第三部分flag在一个Interesting的函数中：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135453999.png" alt="image-20240824135453999"></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824135535863.png" alt="image-20240824135535863"></p><p>flag:</p><p>BaseCTF{Y0u_4Re_900d_47_id4}</p><h3 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h3><p>拖DIE中查壳儿，4.01版本</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824140522684.png" alt="image-20240824140522684"></p><p><code>upx -d UPXmini.exe</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824143602786.png" alt="image-20240824143602786"></p><p>点击base64函数，发现没换表，有密文，直接出flag</p><p>附一个标准base64：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">base64_encode</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+20h] [rbp-70h] BYREF</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+74h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *Str; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  Str = a1;</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v1 = v6 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v6 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">1</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v1 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">2</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( !v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">4</span> * (v6 / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v11 + <span class="number">1</span>);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; v6 - v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v9] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v9 + <span class="number">1</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v8]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v9 + <span class="number">2</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v8 + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * Str[v8 + <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v9 + <span class="number">3</span>] = v4[Str[v8 + <span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8 += <span class="number">3</span>;</span><br><span class="line">    v9 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v10 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[(<span class="number">16</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v2 = &amp;v5[v11 - <span class="number">1</span>];</span><br><span class="line">    *v2 = <span class="number">61</span>;</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v10 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v11 - <span class="number">4</span>] = v4[(<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">2</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5[v11 - <span class="number">3</span>] = v4[((<span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[v6 - <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * Str[v6 - <span class="number">2</span>]) &amp; <span class="number">0x30</span>];</span><br><span class="line">    v5[v11 - <span class="number">2</span>] = v4[(<span class="number">4</span> * Str[v6 - <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v5[v11 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v5[v11] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ez-Xor"><a href="#Ez-Xor" class="headerlink" title="Ez Xor"></a>Ez Xor</h3><p>无壳</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824144240382.png" alt="image-20240824144240382"></p><p>看逻辑，判断输入字符为28位，处理v4(假设为密钥”Xor”)，加密输入字符，与密文比较——</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20240824144219198.png" alt="image-20240824144219198"></p><p>Set item type 改数据类型</p><p>异或串1由i异或key循环产生28位</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824154936713.png" alt="image-20240824154936713"></p><p>flag与 逆转的异或串1 异或产生字符串Str</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824193746260.png" alt="image-20240824193746260"></p><p>最后Str与给的密文比较</p><p>逻辑也简单，写脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x58</span>,<span class="number">0x6F</span>,<span class="number">0x72</span>] <span class="comment">#Xor转16进制</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">box = []</span><br><span class="line">b = <span class="string">&quot;&quot;</span></span><br><span class="line">Str = [</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2D</span>, <span class="number">0x0B</span>, <span class="number">0x1D</span>, </span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x7A</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x1E</span>, <span class="number">0x49</span>, <span class="number">0x3D</span>, <span class="number">0x67</span>, </span><br><span class="line">    <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x6E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, </span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x40</span>, <span class="number">0x3b</span>, <span class="number">0x25</span>, ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">28</span>):</span><br><span class="line">   flag +=<span class="built_in">chr</span>(i ^ enflag[<span class="number">27</span>-i] ^ key[i%<span class="number">3</span>] )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># BaseCTF&#123;X0R_I5_345Y_F0r_y0U&#125; </span></span><br></pre></td></tr></table></figure><h3 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h3><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200108696.png" alt="image-20240824200108696"></p><p>wa！迷宫！</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200625193.png" alt="image-20240824200625193"></p><p>出来啦！<code>sssssssddddwwwddsssssssdddsssddddd</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200720082.png" alt="image-20240824200720082"></p><h3 id="BasePlus"><a href="#BasePlus" class="headerlink" title="BasePlus"></a>BasePlus</h3><p>看题目，看main函数：</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824200822549.png" alt="image-20240824200822549"></p><p>encode：看着像base64，但是Plus！细细看，不只是换了表</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r10d</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// r9</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ebp</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">bool</span> v12; <span class="comment">// r13</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+8h] [rbp-40h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+9h] [rbp-3Fh]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v16; <span class="comment">// [rsp+Bh] [rbp-3Dh]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">60</span>]; <span class="comment">// [rsp+Ch] [rbp-3Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(result) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v17;</span><br><span class="line">    v5 = <span class="number">4</span>i64;</span><br><span class="line">    v6 = <span class="number">0</span>i64;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">      v16 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v7 + <span class="number">1</span>;</span><br><span class="line">        v11 = <span class="number">1</span>i64;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v7 = v10;</span><br><span class="line">          *(&amp;v14 + v11) = a1[v10 - <span class="number">1</span>];</span><br><span class="line">          v12 = (<span class="type">int</span>)v11 &lt;= <span class="number">2</span>;</span><br><span class="line">          v13 = v3 &gt; (<span class="type">int</span>)v10++;</span><br><span class="line">          ++v11;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v13 &amp;&amp; v12 );</span><br><span class="line">      &#125;</span><br><span class="line">      v17[<span class="number">0</span>] = Secret[(<span class="type">unsigned</span> __int8)v15 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v17[<span class="number">1</span>] = Secret[(HIBYTE(v15) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * (_BYTE)v15) &amp; <span class="number">0x30</span>];</span><br><span class="line">      v17[<span class="number">2</span>] = Secret[(v16 &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * HIBYTE(v15)) &amp; <span class="number">0x3C</span>];</span><br><span class="line">      v17[<span class="number">3</span>] = Secret[v16 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v8 = v6;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        *(_BYTE *)(a2 + v8) = v4[v8] ^ <span class="number">0xE</span>;</span><br><span class="line">        ++v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v8 != v5 );</span><br><span class="line">      LODWORD(result) = v5;</span><br><span class="line">      v6 += <span class="number">4</span>i64;</span><br><span class="line">      v4 -= <span class="number">4</span>;</span><br><span class="line">      v5 += <span class="number">4</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &gt; v7 );</span><br><span class="line">  &#125;</span><br><span class="line">  result = (<span class="type">int</span>)result;</span><br><span class="line">  *(_BYTE *)(a2 + (<span class="type">int</span>)result) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201050815.png" alt="image-20240824201050815"></p><p>果然结果异或0xE</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240824201316243.png" alt="image-20240824201316243"></p><h3 id="1z-RC4"><a href="#1z-RC4" class="headerlink" title="1z_RC4"></a>1z_RC4</h3><p>F5没有什么东西，往下翻，看到.t3xt，应该是子修改代码：</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241008162135839.png" alt="image-20241008162135839"></p><p>之后是标准的base64编码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400131C0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v10; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+C4h] [rbp+A4h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+E8h] [rbp+C8h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v13; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v14; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v15; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [rsp+1B4h] [rbp+194h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v12 = (<span class="number">3</span> - a2 % <span class="number">3</span>) % <span class="number">3</span>;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  v5 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( v4 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = *(_BYTE *)(v4 + a1);</span><br><span class="line">    ++v4;</span><br><span class="line">    v9 = v13;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v14 = *(_BYTE *)(v4 + a1);</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v14;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = *(_BYTE *)(v4 + a1);</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    v11 = v15 | (v10 &lt;&lt; <span class="number">8</span>) | (v9 &lt;&lt; <span class="number">16</span>);</span><br><span class="line">    *(_BYTE *)(v5 + a3) = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v6 = v5 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(v6 + a3) = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v7 = v6 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 &lt;= <span class="number">1</span> )</span><br><span class="line">      v16 = aAbcdefghijklmn[(v11 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v16 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v7 + a3) = v16;</span><br><span class="line">    v8 = v7 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">      v17 = <span class="number">61</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v17 = aAbcdefghijklmn[v11 &amp; <span class="number">0x3F</span>];</span><br><span class="line">    *(_BYTE *)(v8 + a3) = v17;</span><br><span class="line">    v5 = v8 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v5 + a3;</span><br><span class="line">  *(_BYTE *)(v5 + a3) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">表：ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/没改过</span><br></pre></td></tr></table></figure><p>往下是初始化init函数，：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140013530</span><span class="params">(__int64 a1, __int64 a2, <span class="type">unsigned</span> <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">276</span>]; <span class="comment">// [rsp+70h] [rbp+50h]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+184h] [rbp+164h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v7;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0x62</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + j) = j;</span><br><span class="line">    v10[j] = *(_BYTE *)(a2 + j % a3);</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = ((<span class="type">unsigned</span> __int8)v10[j] + *(<span class="type">unsigned</span> __int8 *)(a1 + j) + v9) % <span class="number">256</span>;</span><br><span class="line">    v11 = *(_BYTE *)(a1 + j);</span><br><span class="line">    *(_BYTE *)(a1 + j) = *(_BYTE *)(a1 + v9);</span><br><span class="line">    *(_BYTE *)(a1 + v9) = v11;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_140011348(v6, &amp;unk_14001CCD0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RC4加密：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400136E0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2, __int64 a3, <span class="type">unsigned</span> <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">276</span>]; <span class="comment">// [rsp+30h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+144h] [rbp+124h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+164h] [rbp+144h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+184h] [rbp+164h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+1A4h] [rbp+184h]</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [rsp+1C4h] [rbp+1A4h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+298h] [rbp+278h]</span></span><br><span class="line"></span><br><span class="line">  v4 = v8;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">114</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v4 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v4 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  sub_14001130C(v9, a3, a4);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; a2; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (v10 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v11 = ((<span class="type">unsigned</span> __int8)v9[v10] + v11) % <span class="number">256</span>;</span><br><span class="line">    v14 = v9[v10];</span><br><span class="line">    v9[v10] = v9[v11];</span><br><span class="line">    v9[v11] = v14;</span><br><span class="line">    v12 = ((<span class="type">unsigned</span> __int8)v9[v11] + (<span class="type">unsigned</span> __int8)v9[v10]) % <span class="number">256</span>;</span><br><span class="line">    *(_BYTE *)(a1 + j) ^= v9[v12];</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011348(v7, &amp;unk_14001CD50);</span><br><span class="line">  <span class="keyword">return</span> sub_1400111D6((<span class="type">unsigned</span> __int64)v8 ^ v15);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对smc的处理：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140013920</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a2;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= (<span class="type">int</span>)a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) ^= <span class="number">0x81</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>处理t3xt段异或：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x140011000</span>,<span class="number">0x140012E00</span>):</span><br><span class="line"> 	patch_byte(i,get_wide_byte(i)^<span class="number">0x81</span>)</span><br></pre></td></tr></table></figure><p>恢复后，U，C，P来回倒腾。。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140011977</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-174h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp-154h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+44h] [rbp-134h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+64h] [rbp-114h]</span></span><br><span class="line">    </span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v5 = *a2;</span><br><span class="line">  v6 = a2[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (v7 + *(_DWORD *)(a3 + <span class="number">4</span>i64 * (v7 &amp; <span class="number">3</span>)) + <span class="number">102</span>) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6))) ^ <span class="number">0x88</span>;</span><br><span class="line">    v7 -= <span class="number">0x61C88647</span>;</span><br><span class="line">    v6 += (*(_DWORD *)(a3 + <span class="number">4</span>i64 * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5))) ^ <span class="number">0x99</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a2 = v5;</span><br><span class="line">  result = <span class="number">4</span>i64;</span><br><span class="line">  a2[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>是xtea</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_140011420</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-F4h]</span></span><br><span class="line"> </span><br><span class="line">result = sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">4</span>i64 * i) != *(_DWORD *)(a2 + <span class="number">4</span>i64 * i) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>i64;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure><p>？xtea</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400119A0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> *a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  v5 = *a2;</span><br><span class="line">  v6 = a2[<span class="number">1</span>];</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 += (v7 + *(_DWORD *)(a3 + <span class="number">4</span>i64 * (v7 &amp; <span class="number">3</span>)) + <span class="number">102</span>) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6))) ^ <span class="number">0x88</span>;</span><br><span class="line">    v7 -= <span class="number">0x61C88647</span>;</span><br><span class="line">    v6 += (*(_DWORD *)(a3 + <span class="number">4</span>i64 * ((v7 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + v7) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5))) ^ <span class="number">0x99</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *a2 = v5;</span><br><span class="line">  result = <span class="number">4</span>i64;</span><br><span class="line">  a2[<span class="number">1</span>] = v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1400118D0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1400113B1(&amp;unk_1400250A4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>i64; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a2;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * i) = HIBYTE(*(_DWORD *)(a1 + <span class="number">4</span> * i)) | ((<span class="type">unsigned</span> __int8)BYTE2(*(_DWORD *)(a1 + <span class="number">4</span> * i)) &lt;&lt; <span class="number">8</span>) | ((<span class="type">unsigned</span> __int8)BYTE1(*(_DWORD *)(a1 + <span class="number">4</span> * i)) &lt;&lt; <span class="number">16</span>) | ((<span class="type">unsigned</span> __int8)*(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>XTEA脚本：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* TEA 加密函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> *v, <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>] + <span class="number">0x66</span>) ^ <span class="number">0x88</span>;</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ <span class="number">0x99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* TEA 解密函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> *v, <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x9E3779B9</span>, sum = delta * num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^ <span class="number">0x99</span>;</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>] + <span class="number">0x66</span>) ^ <span class="number">0x88</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">10</span>] = &#123;<span class="number">0x36C40533</span>, <span class="number">0xB4C3BCE9</span>, <span class="number">0xB89B052B</span>, <span class="number">0xF4417985</span>, <span class="number">0xC6261DE0</span>, <span class="number">0xC9FB1734</span>, <span class="number">0xABC590D3</span>, <span class="number">0xC1002115</span>, <span class="number">0x88D3BE04</span>, <span class="number">0xC798B0DE</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> r = <span class="number">64</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解密数据块</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        decipher(r, &amp;v[<span class="number">2</span> * i], k);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出解密后的十六进制结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%08X, &quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出解密后的ASCII字符</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               (v[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, </span><br><span class="line">               v[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BaseRe"><a href="#BaseRe" class="headerlink" title="BaseRe"></a>BaseRe</h3><p>互补跳转花指令：<br><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009112924761.png" alt="image-20241009112924761"></p><p>TLSCallback反调试：<br>挑了很久没干掉反调试，直接nop掉exit()</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009130005735.png" alt="image-20241009130005735"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009125128515.png" alt="image-20241009125128515"></p><h3 id="Dont-debug-me"><a href="#Dont-debug-me" class="headerlink" title="Dont-debug-me"></a>Dont-debug-me</h3><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241009133617354.png" alt="image-20241009133617354"></p><p>BaseCTF{8ea2710a717f89d83af695d312fe3b625df14a6ba6b3a74e15ed1e2d35cb10}</p><h3 id="EZVM"><a href="#EZVM" class="headerlink" title="*EZVM"></a>*EZVM</h3><p>pyinstaller打包的linux可执行文件，序列号应该是flag</p><p>main.pyc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: 123.pyc (Python 3.10)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> what</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_6f4d0e83</span>(<span class="params">serial</span>):</span><br><span class="line">    _359d3c18 = what._fdd4e0af()</span><br><span class="line">    _1b5598dc = _359d3c18._55d43f6f(serial)</span><br><span class="line">    <span class="keyword">return</span> what._c3a786e1 == _1b5598dc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_8ecf2044</span>():</span><br><span class="line">    _dca32e81 = <span class="built_in">input</span>(<span class="string">&#x27;璇疯緭鍏ュ簭鍒楀彿锛?</span></span><br></pre></td></tr></table></figure><p>中文被截断了…，不过用的是what库，去看看</p><p>what.pyc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">_c3a786e1 = [<span class="number">35</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">38</span>,<span class="number">23</span>,<span class="number">18</span>,<span class="number">61</span>,<span class="number">25</span>,<span class="number">83</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">83</span>,<span class="number">95</span>,<span class="number">20</span>,<span class="number">29</span>,<span class="number">83</span>,<span class="number">82</span>,<span class="number">1</span>,<span class="number">29</span>,<span class="number">25</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">81</span>,<span class="number">72</span>,<span class="number">76</span>,<span class="number">85</span>,<span class="number">3</span>,<span class="number">85</span>,<span class="number">79</span>,<span class="number">73</span>,<span class="number">83</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">85</span>,<span class="number">7</span>,<span class="number">80</span>,<span class="number">82</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">84</span>,<span class="number">77</span>,<span class="number">130</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_20123c25</span>:</span><br><span class="line">    _7cb79e4b = <span class="number">240</span></span><br><span class="line">    _b44f7700 = <span class="number">241</span></span><br><span class="line">    _fbdb45b4 = <span class="number">242</span></span><br><span class="line">    _ceb71abe = <span class="number">243</span></span><br><span class="line">    _8c16a52d = <span class="number">244</span></span><br><span class="line">    _38a31ca7 = <span class="number">245</span></span><br><span class="line">    _97406181 = <span class="number">246</span></span><br><span class="line">    _2cc0f75f = <span class="number">247</span></span><br><span class="line">    _1a5742f5 = <span class="number">248</span></span><br><span class="line">    _e3f3ae4d = <span class="number">249</span></span><br><span class="line">    _749af0a3 = <span class="number">250</span></span><br><span class="line">    _d1654b69 = <span class="number">251</span></span><br><span class="line">    _57da3130 = <span class="number">252</span></span><br><span class="line">    _5b84e015 = <span class="number">253</span></span><br><span class="line">    _20285265 = <span class="number">254</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_fdd4e0af</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._01111091 = []</span><br><span class="line">        self._ca6cab33 = []</span><br><span class="line">        self._da4e2ce1 = <span class="number">0</span></span><br><span class="line">        self._35d0bf74 = &#123; &#125;</span><br><span class="line">        self._1351c19a = &#123; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_977a3a1c</span>(<span class="params">self, value</span>):</span><br><span class="line">        self._01111091.append(value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_bf001739</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self._01111091:</span><br><span class="line">            <span class="keyword">raise</span> IndexError(<span class="string">&#x27;something wrong..&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>._01111091.pop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_dd931be4</span>(<span class="params">self</span>):</span><br><span class="line">Warning: Stack history <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">Warning: block stack <span class="keyword">is</span> <span class="keyword">not</span> empty!</span><br><span class="line">        _35d0bf74 = &#123; &#125;</span><br><span class="line">        _da4e2ce1 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> _da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">            <span class="keyword">if</span> self._ca6cab33[_da4e2ce1] == _20123c25._1a5742f5:</span><br><span class="line">                _aac5228e = self._ca6cab33[_da4e2ce1 + <span class="number">1</span>]</span><br><span class="line">                _35d0bf74[_aac5228e] = _da4e2ce1</span><br><span class="line">                _da4e2ce1 += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                _da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> _da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">                <span class="keyword">return</span> _35d0bf74</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fbdb45b4</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 &amp; _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ceb71abe</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 | _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_8c16a52d</span>(<span class="params">self</span>):</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(~_65fcba24)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_38a31ca7</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 ^ _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_97406181</span>(<span class="params">self</span>):</span><br><span class="line">        _aac5228e = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._da4e2ce1 = self._35d0bf74[_aac5228e]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_2cc0f75f</span>(<span class="params">self</span>):</span><br><span class="line">        _aac5228e = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        <span class="keyword">if</span> _11d53c86 == _65fcba24:</span><br><span class="line">            self._da4e2ce1 = self._35d0bf74[_aac5228e]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_e3f3ae4d</span>(<span class="params">self</span>):</span><br><span class="line">        _c5baa923 = self._bf001739()</span><br><span class="line">        self._977a3a1c(<span class="built_in">len</span>(_c5baa923))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_749af0a3</span>(<span class="params">self</span>):</span><br><span class="line">        _c5baa923 = self._bf001739()</span><br><span class="line">        _ace0efc8 = self._bf001739()</span><br><span class="line">        self._977a3a1c(<span class="built_in">ord</span>(_c5baa923[_ace0efc8]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_d1654b69</span>(<span class="params">self</span>):</span><br><span class="line">        _95e1fdb8 = self._bf001739()</span><br><span class="line">        _550cd13d = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        <span class="keyword">if</span> _550cd13d == <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> _550cd13d <span class="keyword">not</span> <span class="keyword">in</span> self._1351c19a:</span><br><span class="line">                self._1351c19a[_550cd13d] = []</span><br><span class="line">            self._1351c19a[_550cd13d].append(_95e1fdb8)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._1351c19a[_550cd13d] = _95e1fdb8</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_57da3130</span>(<span class="params">self</span>):</span><br><span class="line">        _550cd13d = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">        self._977a3a1c(self._1351c19a[_550cd13d])</span><br><span class="line">        self._da4e2ce1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_5b84e015</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 + _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_20285265</span>(<span class="params">self</span>):</span><br><span class="line">        _11d53c86 = self._bf001739()</span><br><span class="line">        _65fcba24 = self._bf001739()</span><br><span class="line">        self._977a3a1c(_65fcba24 - _11d53c86)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_75b873e6</span>(<span class="params">self, _b75d3e2a</span>):</span><br><span class="line">        self._ca6cab33 = _b75d3e2a</span><br><span class="line">        self._da4e2ce1 = <span class="number">0</span></span><br><span class="line">        self._35d0bf74 = self._dd931be4()</span><br><span class="line">        <span class="keyword">if</span> self._da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">            _5ff494f7 = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">            self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> _5ff494f7 == _20123c25._7cb79e4b:</span><br><span class="line">                _95e1fdb8 = self._ca6cab33[self._da4e2ce1]</span><br><span class="line">                self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">                self._977a3a1c(_95e1fdb8)</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._b44f7700:</span><br><span class="line">                self._bf001739()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._fbdb45b4:</span><br><span class="line">                self._fbdb45b4()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._ceb71abe:</span><br><span class="line">                self._ceb71abe()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._8c16a52d:</span><br><span class="line">                self._8c16a52d()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._38a31ca7:</span><br><span class="line">                self._38a31ca7()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._97406181:</span><br><span class="line">                self._97406181()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._2cc0f75f:</span><br><span class="line">                self._2cc0f75f()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._1a5742f5:</span><br><span class="line">                self._da4e2ce1 += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._e3f3ae4d:</span><br><span class="line">                self._e3f3ae4d()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._749af0a3:</span><br><span class="line">                self._749af0a3()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._d1654b69:</span><br><span class="line">                self._d1654b69()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._57da3130:</span><br><span class="line">                self._57da3130()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._5b84e015:</span><br><span class="line">                self._5b84e015()</span><br><span class="line">            <span class="keyword">elif</span> _5ff494f7 == _20123c25._20285265:</span><br><span class="line">                self._20285265()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;something wrong&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self._da4e2ce1 &lt; <span class="built_in">len</span>(self._ca6cab33):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_55d43f6f</span>(<span class="params">self, _5345245d</span>):</span><br><span class="line">        _ca6cab33 = [][_20123c25._7cb79e4b][_5345245d][_20123c25._e3f3ae4d][_20123c25._d1654b69][<span class="string">&#x27;l1&#x27;</span>][_20123c25._7cb79e4b][<span class="number">0</span>][_20123c25._d1654b69][<span class="string">&#x27;i&#x27;</span>][_20123c25._1a5742f5][<span class="string">&#x27;s&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;l1&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._20285265][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._2cc0f75f][<span class="string">&#x27;e&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._5b84e015][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._38a31ca7][_20123c25._d1654b69][<span class="string">&#x27;r&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][<span class="number">1</span>][_20123c25._5b84e015][_20123c25._d1654b69][<span class="string">&#x27;i&#x27;</span>][_20123c25._97406181][<span class="string">&#x27;s&#x27;</span>][_20123c25._1a5742f5][<span class="string">&#x27;e&#x27;</span>][_20123c25._57da3130][<span class="string">&#x27;i&#x27;</span>][_20123c25._7cb79e4b][_5345245d][_20123c25._749af0a3][_20123c25._7cb79e4b][<span class="number">255</span>][_20123c25._38a31ca7][_20123c25._d1654b69][<span class="string">&#x27;r&#x27;</span>]</span><br><span class="line">        self._75b873e6(_ca6cab33)</span><br><span class="line">        _5e2e5337 = self._1351c19a[<span class="string">&#x27;r&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> _5e2e5337</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="45-56-Newstar-CTF"><a href="#45-56-Newstar-CTF" class="headerlink" title="45-56 Newstar CTF"></a>45-56 Newstar CTF</h2><h4 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h4><p>脱壳，</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/36175641/1728221448720-13dd8ea8-de9c-4af1-9373-d482160b49e1.png" alt="img"></p><p>flag{Do_you_know_UPX?}</p><h4 id="drink-TEA"><a href="#drink-TEA" class="headerlink" title="*drink_TEA"></a>*drink_TEA</h4><p>TEA加密：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">void tea_dec(uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0 = v[0], v1 = v[1];  // v0、v1分别是密文的左、右半部分</span><br><span class="line">    uint32_t delta =  0x61C88647;     //作为sum每次累加的变化值，题目中往往会修改此值</span><br><span class="line">    uint32_t sum = 32 * delta;      //此处需要分析32轮加密结束后sum的值与delta的变化, 以此处加密为例子，32轮每次sum+=delta，因此最后sum=32*delta</span><br><span class="line">    for (int i = 0; i &lt; 32; i++) &#123;  // tea加密进行32轮</span><br><span class="line">        //根据加密时的顺序颠倒下面3行的顺序，将加法改为减法（异或部分都是整体，不用管），就是逆向解密过程</span><br><span class="line">        v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    // 解密后的内容要还给v数组</span><br><span class="line">    v[0] = v0;</span><br><span class="line">    v[1] = v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main() &#123;</span><br><span class="line">    uint32_t k[4] = &#123;0x636C6557,0x54656D6F,0x77654E6F,0x72617453&#125;;</span><br><span class="line">    int8_t input[33] = &#123;  0x78, 0x20, 0xF7, 0xB3, 0xC5, 0x42, 0xCE, 0xDA, 0x85, 0x59, </span><br><span class="line">  0x21, 0x1A, 0x26, 0x56, 0x5A, 0x59, 0x29, 0x02, 0x0D, 0xED, </span><br><span class="line">  0x07, 0xA8, 0xB9, 0xEE, 0x36, 0x59, 0x11, 0x87, 0xFD, 0x5C, </span><br><span class="line">  0x23, 0x24&#125;;</span><br><span class="line"> </span><br><span class="line">    for (int i = 0; i &lt; 32; i += 8) &#123;</span><br><span class="line">        uint32_t v[2] = &#123;*(uint32_t*)&amp;input[i], *(uint32_t*)&amp;input[i + 4]&#125;;</span><br><span class="line">        tea_dec(v, k);</span><br><span class="line">        </span><br><span class="line">        for (int j = 0; j &lt; 2; j++) &#123;</span><br><span class="line">            for (int k = 0; k &lt; 4; k++) &#123;</span><br><span class="line">                printf(&quot;%c&quot;, v[j] &amp; 0xff);</span><br><span class="line">                v[j] &gt;&gt;= 8;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="flower"><a href="#flower" class="headerlink" title="flower"></a>flower</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/1728562726425-bb959236-f66a-4e1b-924f-4c0dad5c0f36.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/36175641/1728562725546-696167da-9b6c-4b48-9751-2abb5a76f246.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enflag = [2,5,19,19,2,30,83,31,92,26,39,67,29,54,67,7,38,45,85,13,3,27,28,45,2,28,28,48,56,50,85,2,27,22,84,15]</span><br><span class="line">key = &#x27;dirty_flower&#x27;</span><br><span class="line">for i in range(36):</span><br><span class="line">    print(chr(enflag[i]^ord(key[i%len(key)])&amp;0xff),end=&#x27;&#x27;)</span><br><span class="line">#flag&#123;A5s3mB1y_1s_r3ally_funDAm3nta1&#125;</span><br></pre></td></tr></table></figure><h4 id="ezencrypt"><a href="#ezencrypt" class="headerlink" title="*ezencrypt"></a>*ezencrypt</h4><h4 id="Pangbai泰拉记"><a href="#Pangbai泰拉记" class="headerlink" title="*Pangbai泰拉记"></a>*Pangbai泰拉记</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">key = [0x6B, 0x65, 0x79, 0x31, 0x6B, 0x65, 0x79, 0x32, 0x6B, 0x65, 0x79, 0x33, 0x6B, 0x65, 0x79, 0x34, 0x6B, 0x65, 0x79, 0x36,  0x6B, 0x65, 0x79, 0x37, 0x6B, 0x65, 0x79, 0x38, 0x6B, 0x65, 0x79, 0x39]</span><br><span class="line">flag = [ 0x63, 0x61, 0x6E, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x66, 0x69, 0x6E, 0x64, 0x20, 0x6D, 0x65, 0x20, 0x63, 0x61, 0x6E, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x66, 0x69, 0x6E, 0x64, 0x20, 0x6D, 0x65, 0x3F]</span><br><span class="line">aaa=&#x27;nhvviCSR&#123;e8%oCrdepIvebcRb&gt;&amp;ah&#123;b&gt;&amp;ah&#123;&#x27;</span><br><span class="line">v5 = &#x27;nhvviguMI?u\&quot;,o/fWivoM;Homy2.l#&#123;&#x27;</span><br><span class="line">for i in range(len(v5)):</span><br><span class="line">    print(chr(key[i]^ord(v5[i])),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure><h4 id="Ptrace"><a href="#Ptrace" class="headerlink" title="Ptrace"></a>Ptrace</h4><p>flag{Do_you_really_know_ptrace?}</p><h4 id="begin"><a href="#begin" class="headerlink" title="begin"></a>begin</h4><p>打开IDA</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124925519.png" alt="image-20241005124925519"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125051687.png" alt="image-20241005125051687"></p><p><strong>flag{Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse}</strong></p><h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><p>密文告了，表也换了，扔cyberchef里ok</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005125142014.png" alt="image-20241005125142014"></p><p><strong>flag{y0u_kn0w_base64_well}</strong></p><h4 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = [ <span class="number">0x47</span>, <span class="number">0x95</span>, <span class="number">0x34</span>, <span class="number">0x48</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x35</span>, <span class="number">0x88</span>, <span class="number">0x64</span>, <span class="number">0x16</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0x14</span>, <span class="number">0x6A</span>, <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0xA2</span>, <span class="number">0x0A</span>, <span class="number">0x37</span>, <span class="number">0x5C</span>, <span class="number">0x07</span>, <span class="number">0x5A</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x12</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0x12</span>, <span class="number">0x8E</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]+<span class="number">0x1f</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">3</span> ==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]-<span class="number">0x29</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]^<span class="number">0x55</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">     </span><br><span class="line"><span class="comment"># flag&#123;IT_15_R3Al1y_V3Ry-51Mp1e&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ezAndroidStudy"><a href="#ezAndroidStudy" class="headerlink" title="ezAndroidStudy"></a>ezAndroidStudy</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120848944.png" alt="image-20241005120848944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005120912817.png" alt="image-20241005120912817"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005124636944.png" alt="image-20241005124636944"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20241005121101080.png" alt="image-20241005121101080"></p><p>part5,用IDA打开就是</p><p><strong>flag{Y0u_@r4_900d_andr01d_r4V4rs4r}</strong></p><h4 id="ez-debug"><a href="#ez-debug" class="headerlink" title="ez_debug"></a>ez_debug</h4><p>动调，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;ATRI&quot;</span></span><br><span class="line">flag = [  <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x24</span>, <span class="number">0x39</span>, <span class="number">0x2D</span>, <span class="number">0x3A</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x09</span>, <span class="number">0x22</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x09</span>, <span class="number">0x24</span>, <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0x05</span>, <span class="number">0x01</span>,<span class="number">0x12</span>,<span class="number">0x26</span>,<span class="number">0x27</span>,<span class="number">0x2b</span>,<span class="number">0x6f</span>,<span class="number">0x3e</span>]</span><br><span class="line"></span><br><span class="line">decrypted_flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    decrypted_flag += <span class="built_in">chr</span>(<span class="number">0x17</span>^flag[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, decrypted_flag)</span><br><span class="line"><span class="comment"># flag&#123;y0u_ar3_g0od_@_Debu9&#125;</span></span><br></pre></td></tr></table></figure><h3 id="-1"><a href="#-1" class="headerlink"></a></h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://github.com/xyy9233/xyy9233.github.io.git">wind_9233</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/">https://github.com/xyy9233/xyy9233.github.io.git/2024/05/04/Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://github.com/xyy9233/xyy9233.github.io.git" target="_blank">能打一辈子CTF吗？</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91/">逆向</a></div><div class="post_share"><div class="social-share" data-image="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/03/ppwn/"><img class="prev-cover" src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pwn30--52</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/16/NSSCTF/"><img class="next-cover" src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">NSSCTF</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img1.baidu.com/it/u=38471470,3942836709&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=889&amp;h=500" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">wind_9233</div><div class="author-info__description">网安逆向</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" href="https://github.com/xyy9233"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Re%E7%99%BE%E9%A2%98%E8%AE%A1%E5%88%92%EF%BC%88"><span class="toc-number">1.</span> <span class="toc-text">Re百题计划（</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">1.你是真的大学生吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A1%AC%E8%AF%BB%E6%B1%87%E7%BC%96"><span class="toc-number">1.1.0.0.1.</span> <span class="toc-text">硬读汇编</span></a></li></ol></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Debugme"><span class="toc-number">1.2.</span> <span class="toc-text">2.Debugme</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95apk"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">动态调试apk</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Trustme"><span class="toc-number">1.3.</span> <span class="toc-text">3.*Trustme</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.3.0.0.1.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-ez-cube"><span class="toc-number">1.4.</span> <span class="toc-text">4.ez_cube</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F-%E6%8B%A7%E9%AD%94%E6%96%B9%EF%BC%9F"><span class="toc-number">1.4.0.0.1.</span> <span class="toc-text">模拟+拧魔方？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4"><span class="toc-number">1.5.</span> <span class="toc-text">5.今夕是何年</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%BE%99%E8%8A%AFloongarch"><span class="toc-number">1.5.0.0.1.</span> <span class="toc-text">龙芯loongarch</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-baby-unity"><span class="toc-number">1.6.</span> <span class="toc-text">6.*baby unity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-ez-rand"><span class="toc-number">1.7.</span> <span class="toc-text">7.ez_rand</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%A7%8D%E5%AD%90"><span class="toc-number">1.7.0.0.1.</span> <span class="toc-text">随机数种子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%BD%95%E9%A1%BB%E7%9B%B8%E6%80%9D%E7%85%AE%E4%BD%99%E5%B9%B4"><span class="toc-number">1.8.</span> <span class="toc-text">8.何须相思煮余年</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AC%E6%B1%87%E7%BC%96%EF%BC%8C%E5%8E%BB%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="toc-number">1.8.0.0.1.</span> <span class="toc-text">转汇编，去花指令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%A0%B8%E6%A0%B8%E6%A1%83"><span class="toc-number">1.9.</span> <span class="toc-text">9.砸核桃</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NsPack%E5%A3%B3%E5%84%BF"><span class="toc-number">1.9.0.0.1.</span> <span class="toc-text">NsPack壳儿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-ezmath"><span class="toc-number">1.10.</span> <span class="toc-text">10.ezmath</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#exe-py-Z3%E6%B1%82%E8%A7%A3%E5%99%A8"><span class="toc-number">1.10.0.0.1.</span> <span class="toc-text">exe-py-Z3求解器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E7%BB%99%E9%98%BF%E5%A7%A8%E5%80%92%E4%B8%80%E6%9D%AF%E5%8D%A1%E5%B8%83%E5%A5%87%E8%AF%BA"><span class="toc-number">1.11.</span> <span class="toc-text">11.给阿姨倒一杯卡布奇诺</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#tea"><span class="toc-number">1.11.0.0.1.</span> <span class="toc-text">tea</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-what%E2%80%99s-this"><span class="toc-number">1.12.</span> <span class="toc-text">12.what’s this</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lua%E5%8A%A0%E5%AF%86%EF%BC%9F"><span class="toc-number">1.12.0.0.1.</span> <span class="toc-text">Lua加密？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E9%A6%92%E5%A4%B4"><span class="toc-number">1.13.</span> <span class="toc-text">13.馒头</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81"><span class="toc-number">1.13.0.0.1.</span> <span class="toc-text">哈夫曼编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%94%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA"><span class="toc-number">1.14.</span> <span class="toc-text">15.舔狗四部曲—记忆的时光机</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#linux%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95-%E7%9C%8B%E6%B1%87%E7%BC%96%EF%BC%88qwq"><span class="toc-number">1.14.0.0.1.</span> <span class="toc-text">linux动态调试 看汇编（qwq</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%94%E7%AE%80%E7%88%B1"><span class="toc-number">1.15.</span> <span class="toc-text">16.舔狗四部曲—简爱</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#o%E7%BC%96%E8%AF%91-%E9%93%BE%E6%8E%A5%E3%80%82%E5%A6%88%E7%9A%84"><span class="toc-number">1.15.0.0.1.</span> <span class="toc-text">.o编译 ? 链接。妈的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%94%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE"><span class="toc-number">1.16.</span> <span class="toc-text">17.舔狗四部曲—相逢已是上上签</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D%E6%8D%9F%E5%9D%8F%E7%9A%84DOS%E6%96%87%E4%BB%B6-%E9%AD%94%E6%94%B9key%E7%9A%84xxtea"><span class="toc-number">1.16.0.0.1.</span> <span class="toc-text">修复损坏的DOS文件 魔改key的xxtea</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%94%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-number">1.17.</span> <span class="toc-text">18.舔狗四部曲—我的白月光</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E7%97%85%E6%AF%92%EF%BC%9F"><span class="toc-number">1.17.0.0.1.</span> <span class="toc-text">什么病毒？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-ez-enc"><span class="toc-number">1.18.</span> <span class="toc-text">19.ez_enc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-easy-lauguage"><span class="toc-number">1.19.</span> <span class="toc-text">20.easy lauguage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E9%92%A9%E5%AD%90"><span class="toc-number">1.20.</span> <span class="toc-text">21.钩子</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8D%E8%B0%83%E8%AF%95-hook-rc4"><span class="toc-number">1.20.0.0.1.</span> <span class="toc-text">反调试 hook rc4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-44-BaseCTF2024%EF%BC%8822%E9%81%93%EF%BC%89"><span class="toc-number">1.21.</span> <span class="toc-text">22-44.BaseCTF2024（22道）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#You-are-good-at-IDA"><span class="toc-number">1.21.1.</span> <span class="toc-text">You are good at IDA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UPX-mini"><span class="toc-number">1.21.2.</span> <span class="toc-text">UPX mini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-Xor"><span class="toc-number">1.21.3.</span> <span class="toc-text">Ez Xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-maze"><span class="toc-number">1.21.4.</span> <span class="toc-text">ez_maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BasePlus"><span class="toc-number">1.21.5.</span> <span class="toc-text">BasePlus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1z-RC4"><span class="toc-number">1.21.6.</span> <span class="toc-text">1z_RC4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BaseRe"><span class="toc-number">1.21.7.</span> <span class="toc-text">BaseRe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dont-debug-me"><span class="toc-number">1.21.8.</span> <span class="toc-text">Dont-debug-me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZVM"><span class="toc-number">1.21.9.</span> <span class="toc-text">*EZVM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-56-Newstar-CTF"><span class="toc-number">1.22.</span> <span class="toc-text">45-56 Newstar CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#UPX"><span class="toc-number">1.22.0.1.</span> <span class="toc-text">UPX</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#drink-TEA"><span class="toc-number">1.22.0.2.</span> <span class="toc-text">*drink_TEA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flower"><span class="toc-number">1.22.0.3.</span> <span class="toc-text">flower</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ezencrypt"><span class="toc-number">1.22.0.4.</span> <span class="toc-text">*ezencrypt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pangbai%E6%B3%B0%E6%8B%89%E8%AE%B0"><span class="toc-number">1.22.0.5.</span> <span class="toc-text">*Pangbai泰拉记</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ptrace"><span class="toc-number">1.22.0.6.</span> <span class="toc-text">Ptrace</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#begin"><span class="toc-number">1.22.0.7.</span> <span class="toc-text">begin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#base64"><span class="toc-number">1.22.0.8.</span> <span class="toc-text">base64</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Simple-encryption"><span class="toc-number">1.22.0.9.</span> <span class="toc-text">Simple_encryption</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ezAndroidStudy"><span class="toc-number">1.22.0.10.</span> <span class="toc-text">ezAndroidStudy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ez-debug"><span class="toc-number">1.22.0.11.</span> <span class="toc-text">ez_debug</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">1.22.1.</span> <span class="toc-text"></span></a></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/10/30/SEKAICTF%20%20Reverse/" title="无题"><img src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="无题"></a><div class="content"><a class="title" href="/2024/10/30/SEKAICTF%20%20Reverse/" title="无题">无题</a><time datetime="2024-10-29T20:27:28.004Z" title="发表于 2024-10-30 04:27:28">2024-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/30/%E9%85%8D%E7%BD%AEcuckoo%E8%B8%A9%E7%9A%84%E5%9D%91%E2%80%94%E2%80%94/" title="配置cuckoo踩的坑——"><img src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="配置cuckoo踩的坑——"></a><div class="content"><a class="title" href="/2024/10/30/%E9%85%8D%E7%BD%AEcuckoo%E8%B8%A9%E7%9A%84%E5%9D%91%E2%80%94%E2%80%94/" title="配置cuckoo踩的坑——">配置cuckoo踩的坑——</a><time datetime="2024-10-29T16:00:00.000Z" title="发表于 2024-10-30 00:00:00">2024-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/15/DEFCONquals_Rev_ncHEVjuw/" title="DEFCON quals | Rev  ncHEVjuw.txt"><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/73a44fe35920fd3b99c662dccfcaa8605cfbf5b1.gif" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="DEFCON quals | Rev  ncHEVjuw.txt"></a><div class="content"><a class="title" href="/2024/09/15/DEFCONquals_Rev_ncHEVjuw/" title="DEFCON quals | Rev  ncHEVjuw.txt">DEFCON quals | Rev ncHEVjuw.txt</a><time datetime="2024-09-14T16:00:00.000Z" title="发表于 2024-09-15 00:00:00">2024-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/15/NKgame/" title="NKGame 实验报告"><img src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="NKGame 实验报告"></a><div class="content"><a class="title" href="/2024/09/15/NKgame/" title="NKGame 实验报告">NKGame 实验报告</a><time datetime="2024-09-14T16:00:00.000Z" title="发表于 2024-09-15 00:00:00">2024-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/" title="羊城杯2024 | Reverse_docCrack"><img src="https://images.dmzj.com/news/article/77394/row_6409512934343.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="羊城杯2024 | Reverse_docCrack"></a><div class="content"><a class="title" href="/2024/09/04/%F0%9F%90%8F%E7%BE%8A%E5%9F%8E%E6%9D%AF2024%20%20Reverse/" title="羊城杯2024 | Reverse_docCrack">羊城杯2024 | Reverse_docCrack</a><time datetime="2024-09-03T16:00:00.000Z" title="发表于 2024-09-04 00:00:00">2024-09-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By wind_9233</div><div class="framework-info"><span>框架 </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>