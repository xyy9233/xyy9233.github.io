<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="Flare-on 11, 求知欲，好奇心，勇毅前行"><meta name="description" content="Flare-on 11
参考资料：
https://clarkiv.dev/posts/Flareon11
Flare-On 11 Challenge Solutions 

frog运行可执行文件，要求接触到雕像才给flag
看源码，fl"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>Flare-on 11 | 求知欲，好奇心，勇毅前行</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="/libs/awesome/css/all.min.css"><link rel="stylesheet" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" href="/libs/aos/aos.css"><link rel="stylesheet" href="/libs/animate/animate.min.css"><link rel="stylesheet" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="/css/matery.css"><link rel="stylesheet" href="/css/my.css"><link rel="stylesheet" href="/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><link rel="stylesheet" href="/css/post.css"><script src="/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="求知欲，好奇心，勇毅前行" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">求知欲，好奇心，勇毅前行</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">求知欲，好奇心，勇毅前行</div><div class="logo-desc">网安逆向</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/13.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">Flare-on 11</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Re/"><span class="chip bg-color">Re</span></a></div></div><div class="col s5 right-align"></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2025-03-18</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="Flare-on-11"><a href="#Flare-on-11" class="headerlink" title="Flare-on 11"></a>Flare-on 11</h1><blockquote><p>参考资料：</p><p><a href="https://clarkiv.dev/posts/Flareon11">https://clarkiv.dev/posts/Flareon11</a></p><p><a href="https://cloud.google.com/blog/topics/threat-intelligence/flareon-11-challenge-solutions">Flare-On 11 Challenge Solutions</a></p></blockquote><h2 id="frog"><a href="#frog" class="headerlink" title="frog"></a>frog</h2><p>运行可执行文件，要求接触到雕像才给flag</p><p>看源码，flag生成：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">GenerateFlagText</span>(<span class="params">x, y</span>):</span><br><span class="line">    key = x + y*<span class="number">20</span></span><br><span class="line">    encoded = <span class="string">&quot;\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ key) <span class="keyword">for</span> c <span class="keyword">in</span> encoded])</span><br></pre></td></tr></table></figure><p>这个xy在这里被调用</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318112237556.png" alt="image-20250318112237556"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318112247537.png" alt="image-20250318112247537"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">victory_tile = pygame.Vector2(<span class="number">10</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><h4 id="exp："><a href="#exp：" class="headerlink" title="exp："></a><strong>exp：</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">GenerateFlagText</span>(<span class="params">x, y</span>):</span><br><span class="line">    key = x + y*<span class="number">20</span></span><br><span class="line">    encoded = <span class="string">&quot;\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ key) <span class="keyword">for</span> c <span class="keyword">in</span> encoded])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(GenerateFlagText(<span class="number">10</span>, <span class="number">10</span>))</span><br></pre></td></tr></table></figure><p>当时候做题是直接把砖块全删掉</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318112711089.png" alt="image-20250318112711089"></p><h2 id="checksum"><a href="#checksum" class="headerlink" title="checksum"></a>checksum</h2><p>运行</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318113755368.png" alt="image-20250318113755368"></p><p>ida字符串搜索，定位main_main函数</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318113313203.png" alt="image-20250318113313203"></p><p>程序流程为 运算、检验checksum，如果某一步出问题，都会跳到main_b</p><p>进入main_a：</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318120403708.png" alt="image-20250318120403708"></p><p>逆向写程序出flag：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">enflaged = <span class="string">&#x27;cQoFRQErX1YAVw1zVQdFUSxfAQNRBXUNAxBSe15QCVRVJ1pQEwd/WFBUAlElCFBFUnlaB1ULByRdBEFdfVtWVA==&#x27;</span></span><br><span class="line">enflag = base64.b64decode(enflaged)</span><br><span class="line">key = <span class="string">&#x27;FlareOn2024&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enflag)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(enflag[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 7fd7dd1d0e959f74c133c13abb740b9faa61ab06bd0ecd177645e93b1e3825dd</span></span><br></pre></td></tr></table></figure><p>写入checksum，文件发现FLAG文件</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318122208730.png" alt="image-20250318122208730"></p><h2 id="Aray"><a href="#Aray" class="headerlink" title="Aray"></a>Aray</h2><p>Yara规则匹配</p><p>（挠头）很多都是没什么用的信息</p><p>把hash加密过的短字符串先恢复出来，几乎全出来了（手工活）</p><p><code>1RuleADayK33p$Malw4r3Aw4y@flare-on.com</code></p><h2 id="Meme-Maker-3000"><a href="#Meme-Maker-3000" class="headerlink" title="Meme Maker 3000"></a>Meme Maker 3000</h2><p>JS 逆向 和 混淆<a href="https://deobfuscate.relative.im/">JavaScript Deobfuscator</a></p><p>去混淆后，定位可疑代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">function a0k() &#123;</span><br><span class="line">  const a = a0g.alt.split(&#x27;/&#x27;).pop()</span><br><span class="line">  if (a !== Object.keys(a0e)[5]) &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  const b = a0l.textContent,</span><br><span class="line">    c = a0m.textContent,</span><br><span class="line">    d = a0n.textContent</span><br><span class="line">  if (</span><br><span class="line">    a0c.indexOf(b) == 14 &amp;&amp;</span><br><span class="line">    a0c.indexOf(c) == a0c.length - 1 &amp;&amp;</span><br><span class="line">    a0c.indexOf(d) == 22</span><br><span class="line">  ) &#123;</span><br><span class="line">    var e = new Date().getTime()</span><br><span class="line">    while (new Date().getTime() &lt; e + 3000) &#123;&#125;</span><br><span class="line">    var f =</span><br><span class="line">      d[3] +</span><br><span class="line">      &#x27;h&#x27; +</span><br><span class="line">      a[10] +</span><br><span class="line">      b[2] +</span><br><span class="line">      a[3] +</span><br><span class="line">      c[5] +</span><br><span class="line">      c[c.length - 1] +</span><br><span class="line">      &#x27;5&#x27; +</span><br><span class="line">      a[3] +</span><br><span class="line">      &#x27;4&#x27; +</span><br><span class="line">      a[3] +</span><br><span class="line">      c[2] +</span><br><span class="line">      c[4] +</span><br><span class="line">      c[3] +</span><br><span class="line">      &#x27;3&#x27; +</span><br><span class="line">      d[2] +</span><br><span class="line">      a[3] +</span><br><span class="line">      &#x27;j4&#x27; +</span><br><span class="line">      a0c[1][2] +</span><br><span class="line">      d[4] +</span><br><span class="line">      &#x27;5&#x27; +</span><br><span class="line">      c[2] +</span><br><span class="line">      d[5] +</span><br><span class="line">      &#x27;1&#x27; +</span><br><span class="line">      c[11] +</span><br><span class="line">      &#x27;7&#x27; +</span><br><span class="line">      a0c[21][1] +</span><br><span class="line">      b.replace(&#x27; &#x27;, &#x27;-&#x27;) +</span><br><span class="line">      a[11] +</span><br><span class="line">      a0c[4].substring(12, 15)</span><br><span class="line">    f = f.toLowerCase()</span><br><span class="line">    alert(atob(&#x27;Q29uZ3JhdHVsYXRpb25zISBIZXJlIHlvdSBnbzog&#x27;) + f)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318132223649.png" alt="image-20250318132223649"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">const a0c = [</span><br><span class="line">    &#x27;When you <span class="built_in">find</span> a buffer overflow <span class="keyword">in</span> legacy code&#x27;,</span><br><span class="line">    &#x27;Reverse Engineer&#x27;,</span><br><span class="line">    &#x27;When you decompile the obfuscated code and it makes perfect sense&#x27;,</span><br><span class="line">    &#x27;Me after a week of reverse engineering&#x27;,</span><br><span class="line">    &#x27;When your decompiler crashes&#x27;,</span><br><span class="line">    &quot;It&#x27;s <span class="keyword">not</span> a bug, it&#x27;a a feature&quot;,</span><br><span class="line">    &quot;Security &#x27;Expert&#x27;&quot;,</span><br><span class="line">    &#x27;AI&#x27;,</span><br><span class="line">    &quot;That&#x27;s great, but can you hack it?&quot;,</span><br><span class="line">    &#x27;When your code compiles <span class="keyword">for</span> the first <span class="built_in">time</span>&#x27;,</span><br><span class="line">    &quot;<span class="keyword">If</span> it ain&#x27;t broke, <span class="built_in">break</span> it&quot;,</span><br><span class="line">    &quot;Reading someone <span class="keyword">else</span>&#x27;s code&quot;,</span><br><span class="line">    &#x27;EDR&#x27;,</span><br><span class="line">    &#x27;This is fine&#x27;,</span><br><span class="line">    &#x27;FLARE On&#x27;,</span><br><span class="line">    &quot;It&#x27;s always DNS&quot;,</span><br><span class="line">    &#x27;strings.exe&#x27;,</span><br><span class="line">    &quot;Don&#x27;t click on that.&quot;,</span><br><span class="line">    &#x27;When you <span class="built_in">find</span> the perfect <span class="number">0</span>-day exploit&#x27;,</span><br><span class="line">    &#x27;Security through obscurity&#x27;,</span><br><span class="line">    &#x27;Instant Coffee&#x27;,</span><br><span class="line">    &#x27;H@x0r&#x27;,</span><br><span class="line">    &#x27;Malware&#x27;,</span><br><span class="line">    &#x27;$<span class="number">1</span>,<span class="number">000</span>,<span class="number">000</span>&#x27;,</span><br><span class="line">    &#x27;IDA Pro&#x27;,</span><br><span class="line">    &#x27;Security Expert&#x27;,</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">const a = &#x27;boy_friend0.jpg&#x27;;</span><br><span class="line">const b = &#x27;FLARE On&#x27;;</span><br><span class="line">const c = &#x27;Security Expert&#x27;;</span><br><span class="line">const d = &#x27;Malware&#x27;;</span><br><span class="line"></span><br><span class="line">var f =d[<span class="number">3</span>] +&#x27;h&#x27; +a[<span class="number">10</span>] +b[<span class="number">2</span>] +a[<span class="number">3</span>] +c[<span class="number">5</span>] +c[c.length - <span class="number">1</span>] +&#x27;<span class="number">5</span>&#x27; +a[<span class="number">3</span>] +&#x27;<span class="number">4</span>&#x27; +a[<span class="number">3</span>] +c[<span class="number">2</span>] +c[<span class="number">4</span>] +c[<span class="number">3</span>] +&#x27;<span class="number">3</span>&#x27; +d[<span class="number">2</span>] +a[<span class="number">3</span>] +&#x27;j4&#x27; +a0c[<span class="number">1</span>][<span class="number">2</span>] +d[<span class="number">4</span>] +&#x27;<span class="number">5</span>&#x27; +c[<span class="number">2</span>] +d[<span class="number">5</span>] +&#x27;<span class="number">1</span>&#x27; +c[<span class="number">11</span>] +&#x27;<span class="number">7</span>&#x27; +a0c[<span class="number">21</span>][<span class="number">1</span>] +b.<span class="built_in">replace</span>(&#x27; &#x27;, &#x27;-&#x27;) +a[<span class="number">11</span>] +a0c[<span class="number">4</span>].substring(<span class="number">12</span>, <span class="number">15</span>);</span><br><span class="line">f = f.toLowerCase();</span><br><span class="line"></span><br><span class="line">alert(atob(&#x27;Q29uZ3JhdHVsYXRpb25zISBIZXJlIHlvdSBnbzog&#x27;) + f);</span><br><span class="line"></span><br><span class="line">// wh0a_it5_4_cru3l_j4va5cr1p7@flare-on.com</span><br></pre></td></tr></table></figure><h2 id="sshd"><a href="#sshd" class="headerlink" title="sshd"></a>sshd</h2><h3 id="Crashdump"><a href="#Crashdump" class="headerlink" title="Crashdump"></a>Crashdump</h3><p>蒽，从时间来看，找到了sshd.core文件</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/flareon-sshd/ssh_container]</span><br><span class="line">└─$ <span class="built_in">find</span> . -<span class="built_in">type</span> f -printf &#x27;%T@ %p\n&#x27; | <span class="built_in">sort</span> -nr  | head</span><br><span class="line"><span class="number">1726088159</span>.<span class="number">0000000000</span> ./root/flag.txt</span><br><span class="line"><span class="number">1725917676</span>.<span class="number">0000000000</span> ./var/lib/systemd/coredump/sshd.core.<span class="number">93794</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">11</span>.<span class="number">1725917676</span></span><br><span class="line"><span class="number">1725917673</span>.<span class="number">0000000000</span> ./usr/lib/x86_64-linux-gnu/liblzma.so.<span class="number">5</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line"><span class="number">1725916919</span>.<span class="number">0000000000</span> ./var/log/dpkg.log</span><br><span class="line"><span class="number">1725916919</span>.<span class="number">0000000000</span> ./var/log/apt/term.log</span><br><span class="line"><span class="number">1725916919</span>.<span class="number">0000000000</span> ./var/log/apt/history.log</span><br><span class="line"><span class="number">1725916919</span>.<span class="number">0000000000</span> ./var/lib/dpkg/status</span><br><span class="line"><span class="number">1725916919</span>.<span class="number">0000000000</span> ./etc/ssl/certs/ca-certificates.crt</span><br><span class="line"><span class="number">1725916918</span>.<span class="number">0000000000</span> ./var/cache/ldconfig/<span class="built_in">aux</span>-cache</span><br><span class="line"><span class="number">1725916918</span>.<span class="number">0000000000</span> ./usr/share/mime/XMLnamespaces</span><br></pre></td></tr></table></figure><p>因为题目文件是拖入之前存在的虚拟机里面，所以需要设置sshd的使用路径</p><ol><li>启动 GDB：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb</span><br></pre></td></tr></table></figure><ol start="2"><li>设置 <code>sysroot</code> 为文件夹路径：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) <span class="built_in">set</span> sysroot /path/to/your/folder</span><br></pre></td></tr></table></figure><ol start="3"><li>加载可执行文件和核心转储文件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) file /path/to/your/folder/usr/sbin/sshd</span><br><span class="line">(gdb) core /path/to/your/folder/var/lib/systemd/coredump/sshd.core.93794.0.0.11.1725917676</span><br></pre></td></tr></table></figure><hr><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318191344090.png" alt="image-20250318191344090"></p><p>接着跟踪堆栈，bt查看崩溃时调用栈</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318191601116.png" alt="image-20250318191601116"></p><p>提到.&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;liblzma.so.5和.&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;liblzma.so.5.4.1，去看看</p><h3 id="XZ-Utils-Background"><a href="#XZ-Utils-Background" class="headerlink" title="XZ Utils Background"></a>XZ Utils Background</h3><p>sshd and liblzma, which lead us to the famous CVE-2024-3094</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318192819051.png" alt="image-20250318192819051"></p><p>拖liblzma.so.5.4.1进入IDA，找到RSA_public_decrypt被调用处，且*a2&#x3D;0xC5407A48时被调用</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318200928837.png" alt="image-20250318200928837"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318195627669.png" alt="image-20250318195627669"></p><h3 id="Decrypt-Shellcode"><a href="#Decrypt-Shellcode" class="headerlink" title="Decrypt Shellcode"></a>Decrypt Shellcode</h3><p>这里对这个解密算法理解的很好：<a href="https://blog.omroot.io/flareon11-challenge-5-sshd/">FlareOn11: Challenge 5 - sshd ~ Flareon11：挑战5 -SSHD</a></p><p>sub_93F0进入，<img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318201657818.png" alt="image-20250318201657818"></p><p>key是刚刚的a2+1到a2+9前</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318201743331.png" alt="image-20250318201743331"></p><p>943df638a81813e2de6318a507f9a0ba2dbb8a7ba63666d08d11a65ec914d66f</p><p>nonce是a2+9到a2+12：f236839f4dcd711a52862955</p><p>0x23960—+0x0F96—–0x248F6</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318205223681.png" alt="image-20250318205223681"></p><h3 id="shellcode分析"><a href="#shellcode分析" class="headerlink" title="shellcode分析"></a>shellcode分析</h3><h4 id="socket-传入ip-port"><a href="#socket-传入ip-port" class="headerlink" title="socket 传入ip:port"></a>socket 传入ip:port</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318212713292.png" alt="image-20250318212713292"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318212627179.png" alt="image-20250318212627179"></p><h4 id="chacha20初始化"><a href="#chacha20初始化" class="headerlink" title="chacha20初始化"></a>chacha20初始化</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/rev_5.JPG" alt="ChaCha key"></p><p>因为IDA很多没有分析出来，直接看汇编，这里传参+调用syscal</p><p>可以通过系统调用号判断做了什么，0x2d是接受、0x02是打开、0x00是读入</p><p>shellcode执行了一些shellcode，0x20\0x0c\0x04，分别是chacha20的key、nonce、长度、文件路径</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318213429414.png" alt="image-20250318213429414"></p><h4 id="发送文件"><a href="#发送文件" class="headerlink" title="发送文件"></a>发送文件</h4><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318214439307.png" alt="image-20250318214439307"></p><h4 id="恢复文件"><a href="#恢复文件" class="headerlink" title="恢复文件"></a>恢复文件</h4><p>在字符串中，此为K而非k，所以是非标准chacha20</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318210058221.png" alt="image-20250318210058221"></p><p>返回转储文件core</p><p>这里根据“路径”，继续找可能存放的位置</p><blockquote><p>The file path is null terminated and is prepended by a 4-byte value.</p></blockquote><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318215417980.png" alt="image-20250318215417980"></p><p>恰好这里有四个缓冲区</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318215621842.png" alt="image-20250318215621842"></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318215834808.png" alt="image-20250318215834808"></p><p>看起来D18–D3D是密文部分</p><p>但这里不是普通的chacha20，自定义算法，</p><h5 id="还原算法1"><a href="#还原算法1" class="headerlink" title="还原算法1"></a>还原算法1</h5><p>比较牛逼一点直接写自定义chacha20，但我不会，先放这边：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotl32</span>(<span class="params">v: <span class="built_in">int</span>, c: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Rotate left operation&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> ((v &lt;&lt; c) &amp; <span class="number">0xffffffff</span>) | (v &gt;&gt; (<span class="number">32</span> - c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quarter_round</span>(<span class="params">state: <span class="type">List</span>[<span class="built_in">int</span>], a: <span class="built_in">int</span>, b: <span class="built_in">int</span>, c: <span class="built_in">int</span>, d: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ChaCha20 quarter round operation&quot;&quot;&quot;</span></span><br><span class="line">    state[a] = (state[a] + state[b]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    state[d] ^= state[a]</span><br><span class="line">    state[d] = rotl32(state[d], <span class="number">16</span>)</span><br><span class="line">    </span><br><span class="line">    state[c] = (state[c] + state[d]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    state[b] ^= state[c]</span><br><span class="line">    state[b] = rotl32(state[b], <span class="number">12</span>)</span><br><span class="line">    </span><br><span class="line">    state[a] = (state[a] + state[b]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    state[d] ^= state[a]</span><br><span class="line">    state[d] = rotl32(state[d], <span class="number">8</span>)</span><br><span class="line">    </span><br><span class="line">    state[c] = (state[c] + state[d]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    state[b] ^= state[c]</span><br><span class="line">    state[b] = rotl32(state[b], <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chacha20_block</span>(<span class="params">key: <span class="built_in">bytes</span>, counter: <span class="built_in">int</span>, nonce: <span class="built_in">bytes</span>, sigma: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate a ChaCha20 block&quot;&quot;&quot;</span></span><br><span class="line">    state = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    </span><br><span class="line">    state[<span class="number">0</span>:<span class="number">4</span>] = struct.unpack(<span class="string">&#x27;&lt;IIII&#x27;</span>, sigma)</span><br><span class="line">    state[<span class="number">4</span>:<span class="number">12</span>] = struct.unpack(<span class="string">&#x27;&lt;IIIIIIII&#x27;</span>, key)</span><br><span class="line">    state[<span class="number">12</span>] = counter</span><br><span class="line">    state[<span class="number">13</span>:<span class="number">16</span>] = struct.unpack(<span class="string">&#x27;&lt;III&#x27;</span>, nonce)</span><br><span class="line">    </span><br><span class="line">    working_state = state.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        quarter_round(working_state, <span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">12</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>)</span><br><span class="line">        quarter_round(working_state, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>)</span><br><span class="line">    </span><br><span class="line">    working_state = [(working_state[i] + state[i]) &amp; <span class="number">0xffffffff</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, x) <span class="keyword">for</span> x <span class="keyword">in</span> working_state)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chacha20_crypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, nonce: <span class="built_in">bytes</span>, counter: <span class="built_in">int</span> = <span class="number">0</span>, sigma: <span class="built_in">bytes</span> = <span class="string">b&#x27;expand 32-byte k&#x27;</span></span>) -&gt; <span class="built_in">bytes</span>:        </span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">64</span>):</span><br><span class="line">        keystream = chacha20_block(key, counter + (i // <span class="number">64</span>), nonce, sigma)</span><br><span class="line">        chunk = ciphertext[i:i + <span class="number">64</span>]</span><br><span class="line">        plaintext.extend(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(chunk, keystream[:<span class="built_in">len</span>(chunk)]))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># key (32 bytes)</span></span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;8D EC 91 12 EB 76 0E DA 7C 7D 87 A4 43 27 1C 35 D9 E0 CB 87 89 93 B4 D9 04 AE F9 34 FA 21 66 D7&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="comment"># nonce (12 bytes)</span></span><br><span class="line">    nonce = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;11 11 11 11 11 11 11 11 11 11 11 11&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="comment"># Custom sigma constant (capital K)</span></span><br><span class="line">    custom_sigma = <span class="string">b&#x27;expand 32-byte K&#x27;</span></span><br><span class="line">    </span><br><span class="line">    encrypted_data = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;A9 F6 34 08 42 2A 9E 1C 0C 03 A8 08 94 70 BB 8D AA DC 6D 7B 24 FF 7F 24 7C DA 83 9E 92 F7 07 1D 02 63 90 2E C1 58&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    decrypted = chacha20_crypt(encrypted_data, key, nonce, <span class="number">0</span>, custom_sigma)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(decrypted.decode(errors=<span class="string">&quot;ignore&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line">  <span class="comment"># supp1y_cha1n_sund4y@flare-on.com</span></span><br><span class="line"><span class="comment">#XmU</span></span><br></pre></td></tr></table></figure><h5 id="还原算法2"><a href="#还原算法2" class="headerlink" title="还原算法2:"></a>还原算法2:</h5><blockquote><p><a href="https://naupjjin.github.io/2024/11/13/FlareOn-11/">Flare-On CTF 11-writeup | 堇姬 Naup’s Blog</a></p></blockquote><p>chacha20實作參考這個<br><a href="https://github.com/marcizhu/ChaCha20/">https://github.com/marcizhu/ChaCha20/</a></p><p>改這個庫裡面的 <code>#define CHACHA20_CONSTANT &quot;expand 32-byte K&quot;</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> CHACHA20_IMPLEMENTATION</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ChaCha20.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">key256_t</span> key = &#123;<span class="number">0x8d</span>, <span class="number">0xec</span>, <span class="number">0x91</span>, <span class="number">0x12</span>, <span class="number">0xeb</span>, <span class="number">0x76</span>, <span class="number">0x0e</span>, <span class="number">0xda</span>,</span><br><span class="line">                               <span class="number">0x7c</span>, <span class="number">0x7d</span>, <span class="number">0x87</span>, <span class="number">0xa4</span>, <span class="number">0x43</span>, <span class="number">0x27</span>, <span class="number">0x1c</span>, <span class="number">0x35</span>,</span><br><span class="line">                               <span class="number">0xd9</span>, <span class="number">0xe0</span>, <span class="number">0xcb</span>, <span class="number">0x87</span>, <span class="number">0x89</span>, <span class="number">0x93</span>, <span class="number">0xb4</span>, <span class="number">0xd9</span>,</span><br><span class="line">                               <span class="number">0x04</span>, <span class="number">0xae</span>, <span class="number">0xf9</span>, <span class="number">0x34</span>, <span class="number">0xfa</span>, <span class="number">0x21</span>, <span class="number">0x66</span>, <span class="number">0xd7</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="type">static</span> <span class="type">nonce96_t</span> nonce = &#123;<span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>,</span><br><span class="line">                                  <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="type">uint32_t</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">static</span> <span class="type">uint8_t</span> data[] = &#123;<span class="number">0xa9</span>, <span class="number">0xf6</span>, <span class="number">0x34</span>, <span class="number">0x08</span>, <span class="number">0x42</span>, <span class="number">0x2a</span>, <span class="number">0x9e</span>, <span class="number">0x1c</span>,</span><br><span class="line">                                 <span class="number">0x0c</span>, <span class="number">0x03</span>, <span class="number">0xa8</span>, <span class="number">0x08</span>, <span class="number">0x94</span>, <span class="number">0x70</span>, <span class="number">0xbb</span>, <span class="number">0x8d</span>,</span><br><span class="line">                                 <span class="number">0xaa</span>, <span class="number">0xdc</span>, <span class="number">0x6d</span>, <span class="number">0x7b</span>, <span class="number">0x24</span>, <span class="number">0xff</span>, <span class="number">0x7f</span>, <span class="number">0x24</span>,</span><br><span class="line">                                 <span class="number">0x7c</span>, <span class="number">0xda</span>, <span class="number">0x83</span>, <span class="number">0x9e</span>, <span class="number">0x92</span>, <span class="number">0xf7</span>, <span class="number">0x07</span>, <span class="number">0x1d</span>&#125;;</span><br><span class="line"></span><br><span class="line">	ChaCha20_Ctx ctx;</span><br><span class="line">	ChaCha20_init(&amp;ctx, key, nonce, count);</span><br><span class="line">	ChaCha20_xor(&amp;ctx, data, <span class="keyword">sizeof</span>(data));</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span> data; i++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,data[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The array &#x27;data&#x27; is now encrypted (or decrypted if it</span></span><br><span class="line">	<span class="comment">// was already encrypted)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318222408535.png" alt="image-20250318222408535"></p><h5 id="学到一种，写服务器法"><a href="#学到一种，写服务器法" class="headerlink" title="学到一种，写服务器法"></a>学到一种，写服务器法</h5><p>修改刚刚的ip为127.0.0.1</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250318220846198.png" alt="image-20250318220846198"></p><p>擦，没有复现成功</p><h2 id="bloke2"><a href="#bloke2" class="headerlink" title="bloke2"></a>bloke2</h2><blockquote><p><a href="https://services.google.com/fh/files/misc/flare-on11-challenge6-bloke2.pdf">6: bloke2</a></p><p><a href="https://clarkiv.dev/posts/Flareon11">https://clarkiv.dev/posts/Flareon11</a></p></blockquote><p>data_mgr.v</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> data_mgr #(</span><br><span class="line">    <span class="keyword">parameter</span> W = <span class="number">32</span>  <span class="comment">// 参数 W，定义数据宽度，默认值为 32</span></span><br><span class="line">) (</span><br><span class="line">    <span class="keyword">input</span> clk,        <span class="comment">// 时钟信号</span></span><br><span class="line">    <span class="keyword">input</span> rst,        <span class="comment">// 复位信号，高电平有效</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] data_in,  <span class="comment">// 8 位输入数据</span></span><br><span class="line">    <span class="keyword">input</span>       dv_in,     <span class="comment">// 数据有效信号，指示 data_in 是否有效</span></span><br><span class="line">    <span class="keyword">output</span>      drdy_out,  <span class="comment">// 数据准备好信号，指示模块是否可以接收新数据</span></span><br><span class="line">    <span class="keyword">input</span>       start,     <span class="comment">// 开始信号，用于初始化模块</span></span><br><span class="line">    <span class="keyword">input</span>       finish,    <span class="comment">// 结束信号，指示输入数据流结束</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span>              msg_strobe,  <span class="comment">// 消息选通信号，用于指示消息处理完成</span></span><br><span class="line">    <span class="keyword">output</span> [(W*<span class="number">16</span>)-<span class="number">1</span>:<span class="number">0</span>] m_out,       <span class="comment">// 输出消息数据，宽度为 W*16</span></span><br><span class="line">    <span class="keyword">output</span> [(W*<span class="number">2</span>)-<span class="number">1</span>:<span class="number">0</span>]  t_out,       <span class="comment">// 输出时间戳数据，宽度为 W*2</span></span><br><span class="line">    <span class="keyword">output</span>              f_out,       <span class="comment">// 完成信号，指示数据处理完成</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">input</span> [(W*<span class="number">8</span>)-<span class="number">1</span>:<span class="number">0</span>] h_in,  <span class="comment">// 外部输入的哈希值，宽度为 W*8</span></span><br><span class="line">    <span class="keyword">input</span>             h_rdy,  <span class="comment">// 哈希值有效信号，指示 h_in 是否有效</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] data_out,  <span class="comment">// 8 位输出数据</span></span><br><span class="line">    <span class="keyword">output</span>       dv_out,    <span class="comment">// 数据有效信号，指示 data_out 是否有效</span></span><br><span class="line">    <span class="keyword">output</span>       data_end   <span class="comment">// 数据结束信号，指示输出数据流结束</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义局部参数</span></span><br><span class="line">    <span class="keyword">localparam</span> MSG_BITS = W * <span class="number">16</span>;  <span class="comment">// 消息数据的总位数</span></span><br><span class="line">    <span class="keyword">reg</span> [MSG_BITS-<span class="number">1</span>:<span class="number">0</span>] m;          <span class="comment">// 存储输入数据的寄存器</span></span><br><span class="line">    <span class="keyword">assign</span> m_out = m;              <span class="comment">// 将 m 的值输出到 m_out</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> [W*<span class="number">2</span>-<span class="number">1</span>:<span class="number">0</span>] t;               <span class="comment">// 存储时间戳的寄存器</span></span><br><span class="line">    <span class="keyword">assign</span> t_out = &#123;t[<span class="number">0</span> +: W], t[W +: W]&#125;;  <span class="comment">// 将 t 的值分为两部分输出到 t_out</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> f;                         <span class="comment">// 完成标志寄存器</span></span><br><span class="line">    <span class="keyword">assign</span> f_out = f;              <span class="comment">// 将 f 的值输出到 f_out</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> tst;                       <span class="comment">// 测试标志寄存器，用于控制哈希值的处理</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义计数器宽度</span></span><br><span class="line">    <span class="keyword">localparam</span> CNT_BITS = <span class="built_in">$clog2</span>(W * <span class="number">16</span> / <span class="number">8</span>);  <span class="comment">// 计数器宽度，计算方式为 log2(W*16/8)</span></span><br><span class="line">    <span class="keyword">reg</span>  [CNT_BITS-<span class="number">1</span>:<span class="number">0</span>] cnt;                   <span class="comment">// 计数器，用于跟踪输入数据的字节位置</span></span><br><span class="line">    <span class="keyword">wire</span> [CNT_BITS:<span class="number">0</span>]   next_cnt = cnt + <span class="number">1</span>;    <span class="comment">// 下一个计数器的值</span></span><br><span class="line">    <span class="keyword">wire</span>                carry = next_cnt[CNT_BITS];  <span class="comment">// 计数器进位信号</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成 msg_strobe 信号</span></span><br><span class="line">    <span class="keyword">assign</span> msg_strobe = (carry &amp; dv_in) | (finish &amp; ~f &amp; ~start);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主逻辑：处理输入数据</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (rst | start) <span class="keyword">begin</span>  <span class="comment">// 复位或启动时初始化</span></span><br><span class="line">            m   &lt;= &#123;MSG_BITS&#123;<span class="number">1&#x27;b0</span>&#125;&#125;;  <span class="comment">// 清零消息寄存器</span></span><br><span class="line">            cnt &lt;= &#123;CNT_BITS&#123;<span class="number">1&#x27;b0</span>&#125;&#125;;  <span class="comment">// 清零计数器</span></span><br><span class="line">            t   &lt;= &#123;(W*<span class="number">2</span>)&#123;<span class="number">1&#x27;b0</span>&#125;&#125;;     <span class="comment">// 清零时间戳寄存器</span></span><br><span class="line">            f   &lt;= <span class="number">1&#x27;b0</span>;              <span class="comment">// 清零完成标志</span></span><br><span class="line">            tst &lt;= finish;            <span class="comment">// 更新测试标志</span></span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (dv_in) <span class="keyword">begin</span>  <span class="comment">// 如果输入数据有效</span></span><br><span class="line">                m[((W - cnt) * <span class="number">8</span>) +: <span class="number">8</span>] &lt;= data_in;  <span class="comment">// 将 data_in 存储到 m 的适当位置</span></span><br><span class="line">                cnt &lt;= next_cnt[CNT_BITS-<span class="number">1</span>:<span class="number">0</span>];        <span class="comment">// 更新计数器</span></span><br><span class="line">                t   &lt;= t + <span class="number">1</span>;                        <span class="comment">// 更新时间戳</span></span><br><span class="line">                f   &lt;= finish;                       <span class="comment">// 更新完成标志</span></span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span> (finish) <span class="keyword">begin</span>  <span class="comment">// 如果结束信号有效</span></span><br><span class="line">                f &lt;= <span class="number">1&#x27;b1</span>;  <span class="comment">// 设置完成标志</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义测试值</span></span><br><span class="line">    <span class="keyword">localparam</span> TEST_VAL = <span class="number">512&#x27;h3c9cf0addf2e45ef548b011f736cc99144bdfee0d69df4090c8a39c520e18ec3bdc1277aad1706f756affca41178dac066e4beb8ab7dd2d1402c4d624aaabe40</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义哈希值寄存器和输出计数器</span></span><br><span class="line">    <span class="keyword">reg</span> [(W*<span class="number">8</span>)-<span class="number">1</span>:<span class="number">0</span>] h;               <span class="comment">// 存储哈希值的寄存器</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="built_in">$clog2</span>(W):<span class="number">0</span>] out_cnt;       <span class="comment">// 输出计数器，用于跟踪输出数据的字节位置</span></span><br><span class="line">    <span class="keyword">assign</span> data_out = h[<span class="number">7</span>:<span class="number">0</span>];        <span class="comment">// 输出 h 的最低 8 位</span></span><br><span class="line">    <span class="keyword">assign</span> dv_out = (out_cnt != <span class="number">0</span>);  <span class="comment">// 如果 out_cnt 不为零，则 dv_out 有效</span></span><br><span class="line">    <span class="keyword">assign</span> data_end = (out_cnt == <span class="number">1</span>);  <span class="comment">// 如果 out_cnt 为 1，则 data_end 有效</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主逻辑：处理输出数据</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (rst) <span class="keyword">begin</span>  <span class="comment">// 复位时初始化</span></span><br><span class="line">            out_cnt &lt;= <span class="number">0</span>;  <span class="comment">// 清零输出计数器</span></span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (h_rdy) <span class="keyword">begin</span>  <span class="comment">// 如果哈希值有效</span></span><br><span class="line">                out_cnt &lt;= W;  <span class="comment">// 设置输出计数器为 W</span></span><br><span class="line">                h &lt;= h_in ^ (TEST_VAL &amp; &#123;(W*<span class="number">16</span>)&#123;tst&#125;&#125;);  <span class="comment">// 将 h_in 与 TEST_VAL 异或后存储到 h</span></span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span> (out_cnt != <span class="number">0</span>) <span class="keyword">begin</span>  <span class="comment">// 如果输出计数器不为零</span></span><br><span class="line">                out_cnt &lt;= out_cnt - <span class="number">1</span>;  <span class="comment">// 递减输出计数器</span></span><br><span class="line">                h &lt;= &#123;<span class="number">8&#x27;b0</span>, h[W*<span class="number">8</span>-<span class="number">1</span>:<span class="number">8</span>]&#125;;  <span class="comment">// 将 h 右移 8 位</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>在kali中安装iverilog并make tests</p><p>仅通过修改代码并将TST行更改为TST &lt;&#x3D; 1;我们将获得以下输出</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250319220144003.png" alt="image-20250319220144003"></p><p>或许是一个思路，官方的想法：</p><p>根据输入输出的高低电频？</p><h2 id="fullspeed"><a href="#fullspeed" class="headerlink" title="fullspeed"></a>fullspeed</h2><blockquote><p><a href="https://0xdf.gitlab.io/flare-on-2024/fullspeed#">https://0xdf.gitlab.io/flare-on-2024/fullspeed#</a></p><p><a href="https://sec.vnpt.vn/2024/11/flareon-11-writeup-part-2/">Flareon 11 Writeup Part 2 - VNPT Cyber Immunity ~</a></p></blockquote><p><em>Has this all been far too easy? Where’s the math? Where’s the science? Where’s the, I don’t know…. cryptography? Well we don’t know about any of that, but here is a little <strong>.NET</strong> binary to chew on while you discuss career changes with your life coach.</em></p><ul><li>Ahead-of-Time (AOT) compiled：</li></ul><p>提前（AOT）汇编是一个过程，将程序在执行机器代码之前被编译到机器代码中，而不是在运行时（如在Just-In-time（JIT）汇编）中进行解释或编译。在AOT中，在构建过程中将源代码（或字节码之类的中间表示）编译为目标平台的本机机器代码。这仅表示用C＃编写的.NET程序已编译为本机机器代码。</p><p>附件是一个小流量包+64位exe程序</p><p>流量包</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250320134145566.png" alt="image-20250320134145566"></p><p>看程序字符串，BouncyCastle加密的内容</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250320095626931.png" alt="image-20250320095626931"></p><p>还调用了.NET核心应用程序及其特定版本</p><h3 id="FLIRT"><a href="#FLIRT" class="headerlink" title="FLIRT"></a>FLIRT</h3><p>第一步是快速库标识（Fast Library Identification and Recognition Technology）</p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">W3nL0u</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://github.com/xyy9233/xyy9233.github.io.git/2025/03/18/flare-on2024/">https://github.com/xyy9233/xyy9233.github.io.git/2025/03/18/flare-on2024/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">W3nL0u</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Re/"><span class="chip bg-color">Re</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2025/03/21/mi-ma-xue-jiu-jiu-wo/"><div class="card-image"><img src="/medias/featureimages/19.jpg" class="responsive-img" alt="密码学！！救救我！！！"> <span class="card-title">密码学！！救救我！！！</span></div></a><div class="card-content article-content"><div class="summary block-with-text">This blog is encrypted.</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-03-21 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div><div class="card-action article-tags"><a href="/tags/Crypto/"><span class="chip bg-color">Crypto</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/2025/03/05/vm-re-pwn-patch/"><div class="card-image"><img src="/medias/featureimages/22.jpg" class="responsive-img" alt="VM_re_pwn_patch(课程报告喵)"> <span class="card-title">VM_re_pwn_patch(课程报告喵)</span></div></a><div class="card-content article-content"><div class="summary block-with-text">This blog is encrypted.</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-03-05 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div><div class="card-action article-tags"><a href="/tags/VM/"><span class="chip bg-color">VM</span></a></div></div></div></div></article></div><script src="/libs/codeBlock/codeBlockFuction.js"></script><script src="/libs/codeBlock/codeLang.js"></script><script src="/libs/codeBlock/codeCopy.js"></script><script src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h2, h3, h4"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget"),n=($(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")}),"expanded"),i=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){i.hasClass(n)?(i.removeClass(n).hide(),l.removeClass("l9")):(i.addClass(n).show(),l.addClass("l9"));var e="artDetail",o="prenext-posts";if(0!==(e=$("#"+e)).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+o).width(t)}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2023-2025</span> <a href="/about" target="_blank">W3nL0u</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t="2023",n=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),e=e.getSeconds(),s=Date.UTC(t,"9","23","0","0","0"),i=Date.UTC(n,i,a,r,o,e)-s,a=Math.floor(i/31536e6),r=Math.floor(i/864e5-365*a);t===String(n)?(document.getElementById("year").innerHTML=n,o="This site has been running for "+r+" days",o="本站已运行 "+r+" 天",document.getElementById("sitetime").innerHTML=o):(document.getElementById("year").innerHTML=t+" - "+n,e="This site has been running for "+a+" years and "+r+" days",e="本站已运行 "+a+" 年 "+r+" 天",document.getElementById("sitetime").innerHTML=e)};calcSiteTime()</script><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/xyy9233" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:1768765226@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1768765226" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1768765226" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://www.zhihu.com/" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script>$(function(){var e,r,s;e="/search.xml",r="searchInput",s="searchResult",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),e=document.getElementById(r),n=document.getElementById(s);e.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(t.forEach(function(e){var n,t,r,s=!0,a=e.title.trim().toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=0===(i=e.url).indexOf("/")?e.url:"/"+i,c=-1,u=-1;""!==a&&""!==l&&h.forEach(function(e,t){n=a.indexOf(e),c=l.indexOf(e),n<0&&c<0?s=!1:(c<0&&(c=0),0===t&&(u=c))}),s&&(o+="<li><a href='"+i+"' class='search-result-title'>"+a+"</a>",i=e.content.trim().replace(/<[^>]+>/g,""),0<=u&&(e=u+80,(e=0===(t=(t=u-20)<0?0:t)?100:e)>i.length&&(e=i.length),r=i.substr(t,e),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,'<em class="search-keyword">'+e+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>')</script><script src="https://ssl.captcha.qq.com/TCaptcha.js"></script><script src="/libs/others/TencentCaptcha.js"></script><button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button><script>(()=>{var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)})()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script></body></html>