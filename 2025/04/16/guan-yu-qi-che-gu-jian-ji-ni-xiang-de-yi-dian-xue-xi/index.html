<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="关于汽车固件及逆向的一点学习, 求知欲，好奇心，勇毅前行"><meta name="description" content="关于汽车固件及逆向的一点学习
参考文章：
腾讯科恩实验室对奔驰梅赛德斯车机研究
[T-BOX：车联网关键组件的演进与功能剖析-CSDN博客](https://blog.csdn.net/wteruiycbqqvwt/article/deta"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>关于汽车固件及逆向的一点学习 | 求知欲，好奇心，勇毅前行</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="/libs/awesome/css/all.min.css"><link rel="stylesheet" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" href="/libs/aos/aos.css"><link rel="stylesheet" href="/libs/animate/animate.min.css"><link rel="stylesheet" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="/css/matery.css"><link rel="stylesheet" href="/css/my.css"><link rel="stylesheet" href="/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><link rel="stylesheet" href="/css/post.css"><script src="/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="求知欲，好奇心，勇毅前行" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">求知欲，好奇心，勇毅前行</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">求知欲，好奇心，勇毅前行</div><div class="logo-desc">网安逆向</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/4.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">关于汽车固件及逆向的一点学习</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Re/"><span class="chip bg-color">Re</span></a></div></div><div class="col s5 right-align"></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2025-04-16</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="关于汽车固件及逆向的一点学习"><a href="#关于汽车固件及逆向的一点学习" class="headerlink" title="关于汽车固件及逆向的一点学习"></a>关于汽车固件及逆向的一点学习</h1><blockquote><p>参考文章：</p><p><a href="https://keenlab.tencent.com/en/whitepapers/Mercedes_Benz_Security_Research_Report_Final.pdf">腾讯科恩实验室对奔驰梅赛德斯车机研究</a></p><p>[T-BOX：车联网关键组件的演进与功能剖析-CSDN博客](<a href="https://blog.csdn.net/wteruiycbqqvwt/article/details/120526194#:~:text=1%E3%80%81TBOX%E4%BD%9C%E4%B8%BA%E9%87%8F%E4%BA%A7%E4%BB%B6%E4%BA%A7%E7%94%9F%E7%9A%84%E6%9C%80%E5%88%9D%E5%8E%9F%E5%9B%A0%E6%98%AF%E6%B3%95%E8%A7%84%E7%AD%89%E8%A6%81%E6%B1%82%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%EF%BC%8C%E4%BD%86%E5%9C%A8%E6%B3%95%E8%A7%84%E6%9C%AA%E5%BC%BA%E5%88%B6%E6%97%B6%EF%BC%8CTBOX%E5%B7%B2%E7%BB%8F%E5%9C%A8%E8%BD%A6%E5%8E%82%E5%85%B7%E5%A4%87%E5%BD%A2%E6%80%81%E3%80%82">https://blog.csdn.net/wteruiycbqqvwt/article/details/120526194#:~:text=1、TBOX作为量产件产生的最初原因是法规等要求的数据传输，但在法规未强制时，TBOX已经在车厂具备形态。</a> 车，联网，是万物互联时代的大势所趋；,2、同时，TBOX是在基于传统车辆的功能和架构衍生出的新模块，因此， TBOX的功能定义、硬件形态等都具有架构的时代特征，与网络相关的功能，基本都是体现在TBOX上，比如远控、OTA、远程诊断等。 接下来从宏观到微观对T-BOX分析。)</p><p><a href="https://www.iotsec-zone.com/article/332">车联网安全基础知识之TBOX主要功能 - IOTsec-Zone</a></p><p>这里是对资料内容的个人整理和一些思考</p><p>为什么要学习车联网呢，或许命运，或许选择</p></blockquote><h1 id="第一部分："><a href="#第一部分：" class="headerlink" title="第一部分："></a>第一部分：</h1><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>Many cutting-edge technologies presented on this system, such as virtualization, TEE, augmented reality, etc</p><p>Earlier this year, Qihoo 360 published their research on Mercedes-Benz [7], which mainly focused on <strong>Mercedes-Benz ‘s T-Box</strong>, <strong>instead of the central infotainment ECU: head unit.</strong> The test bench showed in their presentation was built with an <strong>NTG5 head unit</strong>, which is a bit <strong>old</strong>.</p><p>In MBUX, the tested head unit version is <strong>NTG6</strong> (being used in A-, E-Class, GLE, GLS and EQC). Our research was based on this brand <strong>new system MBUX, NTG6 head unit, and vehicle W177.</strong></p><p>In our research, we analyzed many attack surfaces and successfully exploited some of them on <strong>head unit and T-Box</strong>. By combining some of them, we can compromise the head unit for two attack scenarios, <strong>the removed head units and the real-world vehicles.</strong> We showed what we could do after we compromised the head unit. Figure 1.1 demonstrates the compromisation of an actual car.</p><p>We <strong>didn’t find a way to compromise the T-Box.</strong> However, we demonstrated <strong>how to send arbitrary CAN messages from T-Box and bypass the code signing mechanism to fash a custom SH2A MCU firmware by utilizing the vulnerability we found in SH2A firmware on a debug version T-Box.</strong></p><h2 id="2-Architecture-overview-结构概述"><a href="#2-Architecture-overview-结构概述" class="headerlink" title="2. Architecture overview 结构概述"></a>2. Architecture overview 结构概述</h2><p><strong>introduces the whole architecture</strong> overview about hardware, software, and CAN networks</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416094800720.png" alt="Architecture overview"></p><h3 id="Hardware"><a href="#Hardware" class="headerlink" title="Hardware"></a>Hardware</h3><h4 id="Head-Unit-主机"><a href="#Head-Unit-主机" class="headerlink" title="Head Unit 主机"></a>Head Unit 主机</h4><p>Head unit’s version is <strong>NTG6</strong>. It plays a vital role in the MBUX infotainment system. It provides <strong>multimedia, navigation, voice control, and other functions.</strong></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416102011538.png" alt="Head unit Interfaces"></p><p>NTG6 head unit composes three main PCB boards inside. Vendor named them <strong>Multimedia Board(MMB), Base Board(BB) and Country Specific Board(CSB).</strong></p><h5 id="Multimedia-Board-MMB"><a href="#Multimedia-Board-MMB" class="headerlink" title="Multimedia Board(MMB)"></a>Multimedia Board(MMB)</h5><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416102120220.png" alt="Multimedia Board"></p><p>On Multimedia Board, there is a big Nvidia Parker SoC. Near the SoC, there is a 32GB MMC. This MMC stores the main file system of the head unit system.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416102139932.png" alt="DRAM and NAND flash"></p><p>After removing this SoC’s cooling shield, we can see <strong>4 DRAM</strong>, <strong>a NAND flash chip</strong>, and its <strong>main processor</strong>. The NAND flash contains bootloader, hypervisor, and TEE related code and data</p><h5 id="Base-Board"><a href="#Base-Board" class="headerlink" title="Base Board"></a>Base Board</h5><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416102626572.png" alt="Base Board Top View"></p><p>On the top side of the Base Board, there is an RH850 chip <strong>R7F7015223</strong> from Renesas. It is mainly responsible for <strong>CAN transmission.</strong> One <strong>MOST interface controller OS81118,</strong> which provides the MOST network to the <strong>head unit operating system</strong>. Two <strong>5G Wi-Fi chips BCM89359</strong>. One is for connections to <strong>passengers’ devices</strong>. The other one is for connections to <strong>T-Box</strong></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416104948592.png" alt="Base Board Bottom View"></p><p>On the bottom side of the Base Board, there is a switch chip: <strong>KSZ8895MLU</strong>. This <strong>switch chip is the center of head unit Ethernet</strong>. Most of the system in head unit that requires Ethernet connects to this chip</p><p>There is a DSP chip from Analog Devices: <strong>ADSP-21489.</strong> According to our analysis, it is responsible for <strong>audio processing.</strong> The architecture is SHARC.</p><h5 id="Country-Specific-Board"><a href="#Country-Specific-Board" class="headerlink" title="Country Specific Board"></a>Country Specific Board</h5><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416105212099.png" alt="Country Specific Board"></p><p>&#x2F;&#x2F;?真假的？根据国家各异？</p><p>The Country Specific Board in head unit varies by country. The board in our head unit runs a Jacinto 5 Linux system. There is a radio solution from NXP, named Saturn. And there is a GNSS chip from u-blox.</p><h4 id="T-Box"><a href="#T-Box" class="headerlink" title="T-Box"></a>T-Box</h4><p>T-Box, it’s also called <strong>TCU or HERMES module</strong>. It connects the vehicle to <strong>LTE network</strong>, <strong>provides head unit internet connection, and receives vehicle control commands from the cloud server.</strong></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416105517637.png" alt="T-Box"></p><h4 id="Electronic-Ignition-Switch-电子点火开关"><a href="#Electronic-Ignition-Switch-电子点火开关" class="headerlink" title="Electronic Ignition Switch 电子点火开关"></a>Electronic Ignition Switch 电子点火开关</h4><p>The Electronic Ignition Switch(EIS) is the <strong>gateway ECU</strong> in the vehicle. It mainly contains two functions, the <strong>keyless function</strong> and the gateway function. According to our experiment, this <strong>ECU also acts as a firewall that filters CAN messages</strong></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416105549136.png" alt="Electronic Ignition Switch"></p><h4 id="Instrument-Cluster-仪表盘"><a href="#Instrument-Cluster-仪表盘" class="headerlink" title="Instrument Cluster 仪表盘"></a>Instrument Cluster 仪表盘</h4><p>Figure 2.11 shows the instrument cluster ECU. There is an RH850 chip inside, which runs an RTOS. It connects to head unit with Ethernet and a video wire</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416110752077.png" alt=" Instrument Cluster"></p><h3 id="Software"><a href="#Software" class="headerlink" title="Software"></a>Software</h3><h4 id="Head-Unit"><a href="#Head-Unit" class="headerlink" title="Head Unit"></a>Head Unit</h4><p>On the NTG6 head unit, the Multimedia Board consists of the Tegra T18X SoC. Therefore, the hardware can support the Nvidia Tegra hypervisor very well. <strong>The hypervisor virtualizes two Linux systems.</strong> One is the primary Linux system, and another is the display server. Besides, the Multimedia Board also supports <strong>Trusty TEE , which is used for encrypting some sensitive data of the system.</strong></p><h4 id="T-Box-1"><a href="#T-Box-1" class="headerlink" title="T-Box"></a>T-Box</h4><p>&#x2F;&#x2F;？啊？huawei designed？？？</p><p>On T-Box, the system runs on SoC ME919bs designed by Huawei. It is a Linux system, but <strong>similar to an Android</strong> in some ways. For example, <strong>the dynamic linker and the format of the boot image.</strong> <strong>Programs are developed by Harman and Huawei</strong></p><h3 id="CAN-Network-Overview-CAN-网络概述"><a href="#CAN-Network-Overview-CAN-网络概述" class="headerlink" title="CAN Network Overview CAN 网络概述"></a>CAN Network Overview CAN 网络概述</h3><p>There are many CAN buses on Mercedes-Benz A200L cars. Figure 2.12 shows the overview of the CAN network.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416111116498.png" alt="CAN Network Overview"></p><h2 id="3-Research-Environment-Setup-研究环境设置"><a href="#3-Research-Environment-Setup-研究环境设置" class="headerlink" title="3. Research Environment Setup  研究环境设置"></a>3. Research Environment Setup 研究环境设置</h2><p>describes our <strong>test bench setup</strong>, how we <strong>built a low-cost testing environment,</strong> how we <strong>collected ECUs and wired them up</strong>, and how we <strong>powered up our test bench.</strong></p><p>Testing on a real car is convenient, but for a security test, <strong>testing on a test bench can reduce the risk of vehicle damage and provide more flexibility.</strong> We bought many infotainment ECUs for building our test bench, including four head units, server T-Boxes, and other ECUs.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416111753764.png" alt=" Second-hand ECUs"></p><p>In this chapter, we show our steps to assemble ECUs we bought into a working test bench.</p><h3 id="Connecting-ECUs"><a href="#Connecting-ECUs" class="headerlink" title="Connecting ECUs"></a>Connecting ECUs</h3><p>According to Mercedes-Benz software’s whole view of the wiring diagram, we wired the ECUs we bought. Figure 3.2 shows our test bench’s connection diagram.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416112026739.png" alt="Bench connection diagram"></p><h3 id="Wake-Up-Test-Bench-唤醒测试台"><a href="#Wake-Up-Test-Bench-唤醒测试台" class="headerlink" title="Wake Up Test Bench 唤醒测试台"></a>Wake Up Test Bench 唤醒测试台</h3><p>The test bench won’t simply be powered on after connected to the power supply. In an actual car, <u><strong>when you ignite the engine, wake-up CAN signals come from CAN bus to power the head unit up.</strong></u></p><p><strong>We need to capture and replay these signals.</strong> We don’t have a real car to capture the signals at that time. <u>However, we found that there are <strong>tiny boxes</strong> in the vehicle market that emit wake-up signals.</u> We bought one of these boxes and successfully powered on our test bench.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416112625205.png" alt="Wake-up CAN box"></p><p>Out of curiosity, we captured signals that came from this box. It emits three CAN signals periodically.</p><table><thead><tr><th>ID</th><th>DATA</th></tr></thead><tbody><tr><td>0x25E</td><td>64 64 64 00 03 00 00 00</td></tr><tr><td>0x2F7</td><td>C2 50 10 57 12 5D 5F 53</td></tr><tr><td>0x020</td><td>39 C9 41 1C C0 00 00 C0</td></tr></tbody></table><p>Connect this wake-up CAN box to CAN-HMI, head unit boots, and the screen lights up.</p><h3 id="Anti-Theft-防盗"><a href="#Anti-Theft-防盗" class="headerlink" title="Anti-Theft 防盗"></a>Anti-Theft 防盗</h3><p><u>After the head unit booted up, it enters Anti-Theft mode.</u> A notification UI layer covers the touch screen in this mode, <strong>preventing the user from operating on the screen</strong>. We will show our method of Anti-Theft unlocking in the following chapters</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416113251164.png" alt=" Anti-Theft screen"></p><h2 id="4-Attack-Surfaces-Analysis-攻击面分析"><a href="#4-Attack-Surfaces-Analysis-攻击面分析" class="headerlink" title="4. Attack Surfaces Analysis 攻击面分析"></a>4. Attack Surfaces Analysis 攻击面分析</h2><p>illustrates the <strong>potential attack surfaces on head unit and T-Box.</strong></p><p>After the testing environment has been set up, we analyzed the attack surfaces of MBUX. In this chapter. We will list the <strong>common attack surfaces that exist on <u>head unit and T-Box.</u></strong> We will also assess the difficulty and the possibility of compromising these attack surfaces. Figure 4.1 shows the attack surfaces we found on Mercedes-Benz A200L. We only tried some of the attack surfaces</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250417100328911.png" alt="Attack surfaces"></p><h3 id="Head-Unit-主机-1"><a href="#Head-Unit-主机-1" class="headerlink" title="Head Unit 主机"></a>Head Unit 主机</h3><h4 id="Attack-Through-Browser-通过浏览器进行攻击"><a href="#Attack-Through-Browser-通过浏览器进行攻击" class="headerlink" title="Attack Through Browser 通过浏览器进行攻击"></a>Attack Through Browser 通过浏览器进行攻击</h4><p>MBUX provides a browser application for the driver and passengers on the touch screen. From a security point of view, it opens a dangerous attack interface since the <strong>browser’s JavaScript engine</strong> is more likely to be vulnerable.</p><h4 id="Wi-Fi"><a href="#Wi-Fi" class="headerlink" title="Wi-Fi"></a>Wi-Fi</h4><h5 id="Attack-Wi-Fi-chip"><a href="#Attack-Wi-Fi-chip" class="headerlink" title="Attack Wi-Fi chip"></a>Attack Wi-Fi chip</h5><p>In NTG6 head unit, there are two BCM89359 Wi-Fi modules on broad BB. The BCM89359 chip a 5G Wi-Fi&#x2F;Bluetooth Smart 2X2 MIMO Combo Chip. One is used to set up an AP for passengers. The other is used to set up an AP for T-Box.</p><p>In the year 2020, we published a research about the <strong>Wi-Fi Stack</strong> on Tesla. The research demonstrates two attack surfaces <strong>belong to an attack chain, from wireless packet to Wi-Fi chip and from Wi-Fi chip to host system.</strong> For NTG6 head unit, the two attack vectors are <u>different.</u></p><p>For the first attack vector that from <strong>wireless packet to Wi-Fi chip</strong>, a vulnerability should be found in the Broadcom BCM89359 firmware. Project zero published their researches on Broadcom Wi-Fi firmware and showed how to exploit the Broadcom firmware vulnerability. We didn’t reproduce such a kind of attack on NTG6 head unit</p><h5 id="Attack-from-Wi-Fi-chip-to-Host-system"><a href="#Attack-from-Wi-Fi-chip-to-Host-system" class="headerlink" title="Attack from Wi-Fi chip to Host system"></a>Attack from Wi-Fi chip to Host system</h5><p>On <strong>NTG6</strong> head unit, the <strong>Wi-Fi chip connects to the host system via the PCI-E</strong> interface. According to <strong>project zero’s</strong> research, <u>it is possible to perform a <strong>DMA attack</strong> to write the host’s physical memory directly if the <strong>host does not enable IOMMU or VT-d.</strong></u> On NTG6 head unit, the host system is launched by the <strong>Nvidia hypervisor</strong>. What’s important is that the IOMMU is enabled. Eventually we didn’t achieve a successful exploit. In the worst case, the hypervisor will <strong>panic.</strong></p><h4 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h4><p>The version of the Linux kernel in the system is <strong>3.18.71,</strong> which is <strong>outdated.</strong> In our research, We <strong>utilized a kernel vulnerability to achieve privilege escalation.</strong></p><h4 id="Ports-on-MMB-MMB-上的端口"><a href="#Ports-on-MMB-MMB-上的端口" class="headerlink" title="Ports on MMB  MMB 上的端口"></a>Ports on MMB MMB 上的端口</h4><p><strong>The CSB system and MMB system are both Linux systems.</strong> They can communicate through Ethernet. Their IP addresses belong to the subnet <strong>192.168.210.109&#x2F;30.</strong> Many TCP or UDP ports on the MMB system can be accessed by CSB. For example, the radio information is transferred through a TCP socket. <strong><u>Therefore, there are many attack vectors from CSB</u></strong></p><h4 id="Bluetooth"><a href="#Bluetooth" class="headerlink" title="Bluetooth"></a>Bluetooth</h4><p>Head unit provides Bluetooth functions to passengers. <u>If there are vulnerabilities in Bluetooth stack, it’s possible to achieve code execution in head unit.</u> We <strong>demonstrated</strong> this kind of attack in our Lexus research[2]. We didn’t focus on Bluetooth this time on Mercedes-Benz.</p><h4 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h4><p>As far as we know, head unit supports USB sticks. <u>There is code to save user configurations and system logs to USB sticks. Also, there is code to read map data and Point of Interest(POI) data from a USB stick.</u> Improper handling of these data can lead to security risks.</p><p>Head unit supports <strong>Carplay, Android Auto, MirrorLink, and CarLife</strong>. These functions can be accessed via USB. If there are vulnerabilities in any of these functions, <strong>it will be possible to attack head unit through USB.</strong></p><h4 id="App"><a href="#App" class="headerlink" title="App"></a>App</h4><p>Nowadays, <u>vendors like to put third-party apps in their head unit.</u> According to our previous experience, third-party apps are prone to <strong>Man-In-the-Middle attacks.</strong></p><p>Mercedes-Benz also supports third-party Apps, which communicate with <strong>remote servers</strong>. The functions of these Apps are very <strong>limited</strong>. We didn’t test this attack surface in our research because the Apps in our test bench are not working</p><h3 id="T-Box-2"><a href="#T-Box-2" class="headerlink" title="**T-Box **"></a>**T-Box **</h3><h4 id="Attack-Through-Wi-Fi-Chip"><a href="#Attack-Through-Wi-Fi-Chip" class="headerlink" title="Attack Through Wi-Fi Chip"></a>Attack Through Wi-Fi Chip</h4><p>On T-Box, the vendor of the wireless chip is <strong>Broadcom</strong>, and the model is <strong>bcm4359.</strong> Inspired by Project Zero’s research, we also investigated if the <strong>T-Box is vulnerable to the same DMA issue.</strong> <strong><u>The chip can overwrite arbitrary physical memory unlimited since this bcm4359 connects to the host system through the PCI-E bus</u></strong></p><h4 id="Attack-Through-GNSS"><a href="#Attack-Through-GNSS" class="headerlink" title="Attack Through GNSS"></a>Attack Through GNSS</h4><p>On T-Box, there is a chip <strong>STA8090</strong> which is a single die standalone positioning receiver IC （单晶片独立定位接收器 IC）working on <strong>multiple constellations</strong>. This chip connects to the host system via serial. <u>The process Location receives NMEA messages from the STA8090 through this serial.</u></p><p>The firmware can be found from the file system. It is an RTOS system based on OS20. Therefore, there are two attack vectors. <u>The first one is from wireless to STA8090 chip. The second one is to attack the host system from the STA8090 chip through serial.</u></p><h4 id="CAN"><a href="#CAN" class="headerlink" title="CAN"></a>CAN</h4><p>On Mercedes-Benz A200L Cars, T-Box connects to CAN bus <strong>CAN-D</strong>. The SH2A chip is responsible for transmitting and receiving CAN messages between the Linux system and CAN bus. Therefore, a difficult attack surface is that attacking the SH2A chip from the CAN-D bus.</p><p>Additionally, some processes will process the message wrapped by CANTP protocol or other protocol. <u>It gives the attacker a chance to attack the user mode process from the CAN bus</u></p><h4 id="Baseband"><a href="#Baseband" class="headerlink" title="Baseband."></a>Baseband.</h4><p>The T-Box <strong>utilizes Huawei’s LTE</strong> solution me919bs. <strong>It means the baseband is balong and the firmware for cellular baseband locates on T-Box’s file system.</strong></p><p>In 2017, we compromised Huawei’s balong baseband in pwn2own. We found in T-Box firmware version E311, the bug we used in pwn2own exists.</p><p>We set up the environment we used in pwn2own. But we found that the T-Box wouldn’t connect to our station. The T-Box uses <strong>UMTS</strong> but not CDMA2000. The bug we used in pwn2own lays in <strong>CDMA2000</strong> protocol stack. Although the code contains the bug, it cannot be triggered.</p><p>We tried to find other bugs by analyzing the balong firmware. Besides the leaked source code online, we found that the firmware <strong>contains a symbol table</strong>. <u>In this <strong>symbol table</strong>, there are function names, function addresses, and function sizes. The symbols helped us a lot in understanding the firmware.</u></p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250416150238908.png" alt=" symbols in firmware"></p><p>Later we upgrade T-Box firmware to <strong>E511</strong>. The new baseband firmware introduced more security mitigations and <strong>fixed the bug</strong> we used in pwn2own, <strong>which made it very difficult for us to attack from base band.</strong></p><h4 id="GSM-hijack-GSM-劫持"><a href="#GSM-hijack-GSM-劫持" class="headerlink" title="GSM hijack  GSM 劫持"></a>GSM hijack GSM 劫持</h4><p><u>T-Box receives vehicle control commands from <strong>a remote server</strong> via the cellular network.</u> Vehicle control commands can be received by T-Box via <strong>HTTPS, MQTT, or GSM text messages</strong>. <strong><u>T-Box verifies server identifications in HTTPS and MQTT. So hijacking vehicle control commands in these two protocols is not possible.</u></strong></p><p>T-Box connects to the cellular station via <strong>LTE</strong>. We can <u>downgrade</u> it to <strong>GSM</strong> and make T-Box connects to our base station. We set up a base station using USRP and OpenBTS. After T-Box connected to our station, we can send GSM text messages to T-Box.</p><p>We analyzed the vehicle control message format and found that the message <strong>is signed by Mercedes-Benz’s private secret key.</strong> And it is authenticated inside T-Box. <strong>Without the private secret key, we are unable to construct a valid vehicle control message.</strong> <strong>We analyzed the cryptography algorithm and did not found any weakness.</strong></p><p>We then reversed the code and tried to find memory corruption bugs in the SMS handling code. However, <strong>we did not find exploitable bugs.</strong></p><hr><h2 id="5-Compromise-Head-Unit"><a href="#5-Compromise-Head-Unit" class="headerlink" title="5. Compromise Head Unit"></a>5. Compromise Head Unit</h2><p>presents the details of <strong>four attack surfaces of head unit</strong> in the direction from the outside to the internal system This chapter presents the details of four attack surfaces of head unit in the direction from the outside to the internal system, including <strong>how we connected to the head unit’s intranet by soldering wires on the PCB</strong>, <strong>how we achieve remote code execution in head unit by exploiting the HiQnet protocol and the browser</strong>. <strong>Finally, we will details how to achieve local privilege escalation in head unit</strong></p><h3 id="Access-to-the-Intranet-of-Head-Unit-访问总部内联网"><a href="#Access-to-the-Intranet-of-Head-Unit-访问总部内联网" class="headerlink" title="Access to the Intranet of Head Unit 访问总部内联网 ."></a>Access to the Intranet of Head Unit 访问总部内联网 .</h3><h4 id="Connect-to-Head-Unit-as-T-Box-以-T-形盒式连接至主机"><a href="#Connect-to-Head-Unit-as-T-Box-以-T-形盒式连接至主机" class="headerlink" title="Connect to Head Unit as T-Box 以 T 形盒式连接至主机"></a>Connect to Head Unit as T-Box 以 T 形盒式连接至主机</h4><h4 id="Connect-to-MMB-as-CSB-作为-CSB-连接至-MMB"><a href="#Connect-to-MMB-as-CSB-作为-CSB-连接至-MMB" class="headerlink" title="Connect to MMB as CSB 作为 CSB 连接至 MMB"></a>Connect to MMB as CSB 作为 CSB 连接至 MMB</h4><h3 id="Remote-Code-Execution-on-Head-Unit-在主机上执行远程代码"><a href="#Remote-Code-Execution-on-Head-Unit-在主机上执行远程代码" class="headerlink" title="Remote Code Execution on Head Unit 在主机上执行远程代码"></a>Remote Code Execution on Head Unit 在主机上执行远程代码</h3><h4 id="Implementation-of-HiQnet-Protocol-实施-HiQnet-协议"><a href="#Implementation-of-HiQnet-Protocol-实施-HiQnet-协议" class="headerlink" title="Implementation of HiQnet Protocol 实施 HiQnet 协议"></a>Implementation of HiQnet Protocol 实施 HiQnet 协议</h4><h4 id="Vulnerabilities-in-HiQnet-Protocol-HiQnet-协议中的漏洞"><a href="#Vulnerabilities-in-HiQnet-Protocol-HiQnet-协议中的漏洞" class="headerlink" title="Vulnerabilities in HiQnet Protocol HiQnet 协议中的漏洞"></a>Vulnerabilities in HiQnet Protocol HiQnet 协议中的漏洞</h4><h4 id="Exploit-HiQnet-Protocol-Vulnerability-利用-HiQnet-协议漏洞"><a href="#Exploit-HiQnet-Protocol-Vulnerability-利用-HiQnet-协议漏洞" class="headerlink" title="Exploit HiQnet Protocol Vulnerability 利用 HiQnet 协议漏洞"></a>Exploit HiQnet Protocol Vulnerability 利用 HiQnet 协议漏洞</h4><h3 id="Exploit-the-Browser-利用浏览器"><a href="#Exploit-the-Browser-利用浏览器" class="headerlink" title="Exploit the Browser 利用浏览器"></a>Exploit the Browser 利用浏览器</h3><h4 id="QtWebEngine"><a href="#QtWebEngine" class="headerlink" title="QtWebEngine"></a>QtWebEngine</h4><h4 id="Exploit-the-QtWebEngine"><a href="#Exploit-the-QtWebEngine" class="headerlink" title="Exploit the QtWebEngine"></a>Exploit the QtWebEngine</h4><h3 id="Local-Privilege-Escalation-本地权限升级"><a href="#Local-Privilege-Escalation-本地权限升级" class="headerlink" title="Local Privilege Escalation 本地权限升级"></a>Local Privilege Escalation 本地权限升级</h3><h4 id="Kernel-LPE-with-A-perf-Bug-内核-LPE-存在灌注错误"><a href="#Kernel-LPE-with-A-perf-Bug-内核-LPE-存在灌注错误" class="headerlink" title="Kernel LPE with A perf Bug 内核 LPE 存在灌注错误"></a>Kernel LPE with A perf Bug 内核 LPE 存在灌注错误</h4><h4 id="CVE-2017-6786-6001"><a href="#CVE-2017-6786-6001" class="headerlink" title="CVE-2017-6786,6001"></a>CVE-2017-6786,6001</h4><h4 id="Bypass-Cgroups-Restriction-绕过-C-组限制"><a href="#Bypass-Cgroups-Restriction-绕过-C-组限制" class="headerlink" title="Bypass Cgroups Restriction 绕过 C 组限制"></a>Bypass Cgroups Restriction 绕过 C 组限制</h4><h2 id="6-Post-Attack-in-Head-Unit-Head设备的攻击"><a href="#6-Post-Attack-in-Head-Unit-Head设备的攻击" class="headerlink" title="6. Post Attack in Head Unit Head设备的攻击"></a>6. Post Attack in Head Unit Head设备的攻击</h2><p>will discuss the potential impact <strong>after</strong> the head unit is compromised. For example, we can tamper with the images displayed on the screen and perform some vehicle actions after we compromised the head unit.</p><h3 id="Anti-Theft-Unlock-防盗解锁"><a href="#Anti-Theft-Unlock-防盗解锁" class="headerlink" title="Anti-Theft Unlock 防盗解锁"></a>Anti-Theft Unlock 防盗解锁</h3><h3 id="Unlocking-Vehicle-Functions-解锁车辆功能"><a href="#Unlocking-Vehicle-Functions-解锁车辆功能" class="headerlink" title="Unlocking Vehicle Functions  解锁车辆功能"></a>Unlocking Vehicle Functions 解锁车辆功能</h3><h3 id="Engineering-Mode-工程模式"><a href="#Engineering-Mode-工程模式" class="headerlink" title="Engineering Mode 工程模式"></a>Engineering Mode 工程模式</h3><h3 id="Persistent-Backdoor-持久后门"><a href="#Persistent-Backdoor-持久后门" class="headerlink" title="Persistent Backdoor 持久后门"></a>Persistent Backdoor 持久后门</h3><h3 id="Display-Screen-Tampering-篡改显示屏"><a href="#Display-Screen-Tampering-篡改显示屏" class="headerlink" title="Display Screen Tampering 篡改显示屏"></a>Display Screen Tampering 篡改显示屏</h3><h3 id="RH850-Denial-of-Service-RH850-拒绝服务"><a href="#RH850-Denial-of-Service-RH850-拒绝服务" class="headerlink" title="RH850 Denial of Service RH850 拒绝服务"></a>RH850 Denial of Service RH850 拒绝服务</h3><h3 id="Perform-Vehicle-Control-Actions-执行车辆控制操作"><a href="#Perform-Vehicle-Control-Actions-执行车辆控制操作" class="headerlink" title="Perform Vehicle Control Actions 执行车辆控制操作"></a>Perform Vehicle Control Actions 执行车辆控制操作</h3><h2 id="7-Compromise-T-Box"><a href="#7-Compromise-T-Box" class="headerlink" title="7. Compromise T-Box"></a>7. Compromise T-Box</h2><p>This chapter shows two attack attempts for two attack surfaces, the Wi-Fi and CAN bus of T-Box in the direction from the outside to the internal system.</p><h3 id="Compromise-Host-from-Wi-Fi-chip-从-Wi-Fi-芯片破坏主机"><a href="#Compromise-Host-from-Wi-Fi-chip-从-Wi-Fi-芯片破坏主机" class="headerlink" title="Compromise Host from Wi-Fi chip 从 Wi-Fi 芯片破坏主机"></a>Compromise Host from Wi-Fi chip 从 Wi-Fi 芯片破坏主机</h3><h3 id="Trigger-Memory-Corruption-From-SH2A-Chip-从-SH2A-芯片触发内存破坏"><a href="#Trigger-Memory-Corruption-From-SH2A-Chip-从-SH2A-芯片触发内存破坏" class="headerlink" title="Trigger Memory Corruption From SH2A Chip 从 SH2A 芯片触发内存破坏"></a>Trigger Memory Corruption From SH2A Chip 从 SH2A 芯片触发内存破坏</h3><h4 id="Message-Format-between-SH2A-MCU-and-Host-SH2A-MCU-和主机之间的信息格式"><a href="#Message-Format-between-SH2A-MCU-and-Host-SH2A-MCU-和主机之间的信息格式" class="headerlink" title="Message Format between SH2A MCU and Host SH2A MCU 和主机之间的信息格式"></a>Message Format between SH2A MCU and Host SH2A MCU 和主机之间的信息格式</h4><p>The message packet between SH2A MCU and Host consists of header and body. The size of the header is 8 bytes, and its format is shown in Figure</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250417110511476.png" alt="Header of packet transmit in channel"></p><p>The first two bytes are fixed. The 6th byte is the length of the payload. The 7th byte represents the channel number of this packet. The format of payload varies by the number of channels.</p><h4 id="Out-of-bound-Vulnerability-in-RemoteDiagnosis-RemoteDiagnosis-中的越界漏洞"><a href="#Out-of-bound-Vulnerability-in-RemoteDiagnosis-RemoteDiagnosis-中的越界漏洞" class="headerlink" title="Out-of-bound Vulnerability in RemoteDiagnosis .RemoteDiagnosis 中的越界漏洞"></a>Out-of-bound Vulnerability in RemoteDiagnosis .RemoteDiagnosis 中的越界漏洞</h4><p>The process RemoteDiagnosisApp registered channel 10 RemoteDiagnosis with blockIpcServer. There is a vulnerability when the process RemoteDiagnosisApp parses the payload of channel 10 sent by SH2A MCU and transferred by blockIpcServer. The payload of channel 10 is shown in Figure 7.4</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250417110556574.png" alt="Format of payload for channel RemoteDiagnosis"></p><p>An array <strong>OOB</strong> read exists in function <strong>get_ovci_chn</strong>, which is shown in Figure 7.5.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250417110631926.png" alt="image-20250417110631926"></p><p>The size of the array chn_table is 88. Therefore, if the argument idx is above 88, an OOB read happens. The table array chn_table contains the channel index related to the ovci index. This means the result returned from function get_ovci_chn() may be above 1, according to the data outside the array. Then the ovci_data is stored in the ovci_data_area array, resulting in an OOB write. The code to trigger OOB write shows in Figure 7.6.</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/image-20250417110707509.png" alt="Code snippet that triggers OOB write"></p><p>According to the memory layout, some structures and pointers can be overwritten outside the array chn_table. On T-Box version E511.6, pointers are more random than version E334.2 since ASLR is enabled on version E511.6. We didn’t try to exploit this vulnerability on version E511.6</p><h2 id="8-Post-Attack-in-T-Box-在-T-Box-中发布攻击"><a href="#8-Post-Attack-in-T-Box-在-T-Box-中发布攻击" class="headerlink" title="8. Post Attack in T-Box 在 T-Box 中发布攻击"></a>8. Post Attack in T-Box 在 T-Box 中发布攻击</h2><p>describes <strong>two attack processes</strong> that <strong>target the SH2A MCU on T-Box</strong>. By utilizing the vulnerabilities in SH2A firmware, we can send arbitrary CAN messages to CAN-D CAN bus and ash a custom firmware on SH2A MCU.</p><h3 id="Sending-Arbitrary-CAN-message-from-T-Box从-T-Box-发送任意-CAN-报文"><a href="#Sending-Arbitrary-CAN-message-from-T-Box从-T-Box-发送任意-CAN-报文" class="headerlink" title="Sending Arbitrary CAN message from T-Box从 T-Box 发送任意 CAN 报文"></a>Sending Arbitrary CAN message from T-Box从 T-Box 发送任意 CAN 报文</h3><h4 id="CAN-Bus-Message-Transmit-Logic-CAN-总线报文发送逻辑"><a href="#CAN-Bus-Message-Transmit-Logic-CAN-总线报文发送逻辑" class="headerlink" title="CAN Bus Message Transmit Logic CAN 总线报文发送逻辑"></a>CAN Bus Message Transmit Logic CAN 总线报文发送逻辑</h4><h4 id="Vulnerability-in-SH2A-Firmware-SH2A-固件中的漏洞"><a href="#Vulnerability-in-SH2A-Firmware-SH2A-固件中的漏洞" class="headerlink" title="Vulnerability in SH2A Firmware SH2A 固件中的漏洞"></a>Vulnerability in SH2A Firmware SH2A 固件中的漏洞</h4><h4 id="Transmit-Arbitrary-CAN-Message-to-CAN-Bus-向-CAN-总线发送任意-CAN-报文"><a href="#Transmit-Arbitrary-CAN-Message-to-CAN-Bus-向-CAN-总线发送任意-CAN-报文" class="headerlink" title="Transmit Arbitrary CAN Message to CAN Bus 向 CAN 总线发送任意 CAN 报文"></a>Transmit Arbitrary CAN Message to CAN Bus 向 CAN 总线发送任意 CAN 报文</h4><h3 id="Flashing-Custom-Firmware-on-SH2A-MCU-在-SH2A-MCU-上闪烁自定义固件"><a href="#Flashing-Custom-Firmware-on-SH2A-MCU-在-SH2A-MCU-上闪烁自定义固件" class="headerlink" title="Flashing Custom Firmware on SH2A MCU 在 SH2A MCU 上闪烁自定义固件"></a>Flashing Custom Firmware on SH2A MCU 在 SH2A MCU 上闪烁自定义固件</h3><h4 id="Firmware-Downgrade-Vulnerability-固件降级漏洞"><a href="#Firmware-Downgrade-Vulnerability-固件降级漏洞" class="headerlink" title="Firmware Downgrade Vulnerability 固件降级漏洞"></a>Firmware Downgrade Vulnerability 固件降级漏洞</h4><h4 id="Bypass-Code-Signing-Check-During-Upgrading-在升级过程中绕过代码签名检查"><a href="#Bypass-Code-Signing-Check-During-Upgrading-在升级过程中绕过代码签名检查" class="headerlink" title="Bypass Code Signing Check During Upgrading 在升级过程中绕过代码签名检查"></a>Bypass Code Signing Check During Upgrading 在升级过程中绕过代码签名检查</h4><h2 id="9-Exploratory-Research-探索性研究"><a href="#9-Exploratory-Research-探索性研究" class="headerlink" title="9. Exploratory Research 探索性研究"></a>9. Exploratory Research 探索性研究</h2><p>demonstrates our research on the hardware module <strong>Country Specific Board and Airbag Controller Module</strong>. We will introduce the research on <strong>digital radio and the search process of the Airbag Controller Module.</strong></p><h3 id="Digital-Radio-Research-数字无线电研究"><a href="#Digital-Radio-Research-数字无线电研究" class="headerlink" title="Digital Radio Research 数字无线电研究"></a>Digital Radio Research 数字无线电研究</h3><h4 id="FM"><a href="#FM" class="headerlink" title="FM"></a>FM</h4><h4 id="Digital-Audio-Broadcasting"><a href="#Digital-Audio-Broadcasting" class="headerlink" title="Digital Audio Broadcasting"></a>Digital Audio Broadcasting</h4><h3 id="Airbag-Research"><a href="#Airbag-Research" class="headerlink" title="Airbag Research"></a>Airbag Research</h3><h2 id="Compromise-Scheme"><a href="#Compromise-Scheme" class="headerlink" title="Compromise Scheme"></a>Compromise Scheme</h2><h2 id="10-Verified-attack-chains-经过验证的攻击链"><a href="#10-Verified-attack-chains-经过验证的攻击链" class="headerlink" title="10. Verified attack chains 经过验证的攻击链"></a>10. Verified attack chains 经过验证的攻击链</h2><p>we analyze the <strong>potential attack chains</strong> by combining the potential attack surfaces. We successfully verified each of the head unit’s attack chains, the removed infotainment compromise scheme, and the actual vehicle compromise scheme. Also, we mention the <strong>unrealized attack chains</strong> in our research</p><h4 id="For-a-Removed-head-unit"><a href="#For-a-Removed-head-unit" class="headerlink" title="For a Removed head unit"></a>For a Removed head unit</h4><h4 id="For-a-Real-Vehicle"><a href="#For-a-Real-Vehicle" class="headerlink" title="For a Real Vehicle"></a>For a Real Vehicle</h4><h3 id="Unrealized-Attack-Chains-未实现的攻击链"><a href="#Unrealized-Attack-Chains-未实现的攻击链" class="headerlink" title="Unrealized Attack Chains 未实现的攻击链"></a>Unrealized Attack Chains 未实现的攻击链</h3><p>From Wi-Fi to Vehicle Control - 1.</p><p>From Cellular Network Hijack to Vehicle Control - 2</p><p>From Radio to Airbag Control Module - 3 .</p><p>From Head Unit to T-Box - 4</p><h2 id="Target-Version-目标版本"><a href="#Target-Version-目标版本" class="headerlink" title="Target Version 目标版本"></a>Target Version 目标版本</h2><h2 id="Vulnerabilities-List-漏洞列表"><a href="#Vulnerabilities-List-漏洞列表" class="headerlink" title="Vulnerabilities List 漏洞列表"></a>Vulnerabilities List 漏洞列表</h2><hr><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><h1 id="第二部分：T-Box架构"><a href="#第二部分：T-Box架构" class="headerlink" title="第二部分：T-Box架构"></a>第二部分：T-Box架构</h1><h2 id="硬件构架"><a href="#硬件构架" class="headerlink" title="硬件构架"></a>硬件构架</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/0bfb40957bc7151b5fbc15bd7d45676a.png" alt="img"></p><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/782423b115a576ca5a5f16ffa29ed99b.png" alt="img"></p><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/e98eb71ef3cfadadc42f32ff10cb3496.png" alt="img"></p><h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/76d049fa9a789f8f77e4ca5c7df9b5d5.png" alt="img"></p><h1 id="第三部分：-Tbox主要功能"><a href="#第三部分：-Tbox主要功能" class="headerlink" title="第三部分： Tbox主要功能"></a>第三部分： Tbox主要功能</h1><p><a href="https://www.iotsec-zone.com/article/332">车联网安全基础知识之TBOX主要功能 - IOTsec-Zone</a></p><p>TBOX 提供的功能有网络接入、OTA、远程控制、位置查询&#x2F;车辆追踪、电池管理、位置提醒、eCall、远程诊断、平台监控&#x2F;国家监管等。</p><p>实时监控：</p><p><img src="https://xyy9233.oss-cn-beijing.aliyuncs.com/hexoblog/d1bf643550d1879aec76bc8a02ca7d57.png" alt="image.png"></p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">W3nL0u</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://github.com/xyy9233/xyy9233.github.io.git/2025/04/16/guan-yu-qi-che-gu-jian-ji-ni-xiang-de-yi-dian-xue-xi/">https://github.com/xyy9233/xyy9233.github.io.git/2025/04/16/guan-yu-qi-che-gu-jian-ji-ni-xiang-de-yi-dian-xue-xi/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">W3nL0u</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Re/"><span class="chip bg-color">Re</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2025/04/16/wo-ji-de-wo-zhi-qian-you-yi-ge-web-lai-zhao/"><div class="card-image"><img src="/medias/featureimages/0.jpg" class="responsive-img" alt="webW3bwe2"> <span class="card-title">webW3bwe2</span></div></a><div class="card-content article-content"><div class="summary block-with-text">This blog is encrypted.</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-04-16 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/2025/04/15/android-ni-xiang/"><div class="card-image"><img src="/medias/featureimages/6.jpg" class="responsive-img" alt="Android 逆向"> <span class="card-title">Android 逆向</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-04-15 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> W3nL0u</span></div></div><div class="card-action article-tags"><a href="/tags/Android/"><span class="chip bg-color">Android</span></a></div></div></div></div></article></div><script src="/libs/codeBlock/codeBlockFuction.js"></script><script src="/libs/codeBlock/codeLang.js"></script><script src="/libs/codeBlock/codeCopy.js"></script><script src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h2, h3, h4"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget"),n=($(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")}),"expanded"),i=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){i.hasClass(n)?(i.removeClass(n).hide(),l.removeClass("l9")):(i.addClass(n).show(),l.addClass("l9"));var e="artDetail",o="prenext-posts";if(0!==(e=$("#"+e)).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+o).width(t)}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2022-2025</span> <a href="/about" target="_blank">W3nL0u</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t="2022",n=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),e=e.getSeconds(),s=Date.UTC(t,"9","23","0","0","0"),i=Date.UTC(n,i,a,r,o,e)-s,a=Math.floor(i/31536e6),r=Math.floor(i/864e5-365*a);t===String(n)?(document.getElementById("year").innerHTML=n,o="This site has been running for "+r+" days",o="本站已运行 "+r+" 天",document.getElementById("sitetime").innerHTML=o):(document.getElementById("year").innerHTML=t+" - "+n,e="This site has been running for "+a+" years and "+r+" days",e="本站已运行 "+a+" 年 "+r+" 天",document.getElementById("sitetime").innerHTML=e)};calcSiteTime()</script><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/xyy9233" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:1768765226@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1768765226" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1768765226" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://www.zhihu.com/" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script>$(function(){var e,r,s;e="/search.xml",r="searchInput",s="searchResult",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),e=document.getElementById(r),n=document.getElementById(s);e.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(t.forEach(function(e){var n,t,r,s=!0,a=e.title.trim().toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=0===(i=e.url).indexOf("/")?e.url:"/"+i,c=-1,u=-1;""!==a&&""!==l&&h.forEach(function(e,t){n=a.indexOf(e),c=l.indexOf(e),n<0&&c<0?s=!1:(c<0&&(c=0),0===t&&(u=c))}),s&&(o+="<li><a href='"+i+"' class='search-result-title'>"+a+"</a>",i=e.content.trim().replace(/<[^>]+>/g,""),0<=u&&(e=u+80,(e=0===(t=(t=u-20)<0?0:t)?100:e)>i.length&&(e=i.length),r=i.substr(t,e),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,'<em class="search-keyword">'+e+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>')</script><script src="https://ssl.captcha.qq.com/TCaptcha.js"></script><script src="/libs/others/TencentCaptcha.js"></script><button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button><script>(()=>{var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)})()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script></body></html>